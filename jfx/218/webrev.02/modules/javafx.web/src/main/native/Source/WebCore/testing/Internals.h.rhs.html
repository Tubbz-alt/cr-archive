<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/testing/Internals.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (C) 2012 Google Inc. All rights reserved.
  3  * Copyright (C) 2013-2019 Apple Inc. All rights reserved.
  4  *
  5  * Redistribution and use in source and binary forms, with or without
  6  * modification, are permitted provided that the following conditions
  7  * are met:
  8  *
  9  * 1.  Redistributions of source code must retain the above copyright
 10  *     notice, this list of conditions and the following disclaimer.
 11  * 2.  Redistributions in binary form must reproduce the above copyright
 12  *     notice, this list of conditions and the following disclaimer in the
 13  *     documentation and/or other materials provided with the distribution.
 14  *
 15  * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS &quot;AS IS&quot; AND ANY
 16  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 17  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 18  * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 19  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 20  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 21  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 22  * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 23  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 24  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 25  */
 26 
 27 #pragma once
 28 
 29 #include &quot;CSSComputedStyleDeclaration.h&quot;
 30 #include &quot;ContextDestructionObserver.h&quot;
 31 #include &quot;Cookie.h&quot;
 32 #include &quot;ExceptionOr.h&quot;
 33 #include &quot;HEVCUtilities.h&quot;
<a name="1" id="anc1"></a><span class="line-modified"> 34 #include &quot;IDLTypes.h&quot;</span>
 35 #include &quot;OrientationNotifier.h&quot;
 36 #include &quot;PageConsoleClient.h&quot;
 37 #include &quot;RealtimeMediaSource.h&quot;
 38 #include &quot;TextIndicator.h&quot;
 39 #include &lt;JavaScriptCore/Float32Array.h&gt;
 40 #include &lt;wtf/Optional.h&gt;
 41 
 42 #if ENABLE(MEDIA_SESSION)
 43 #include &quot;MediaSessionInterruptionProvider.h&quot;
 44 #endif
 45 
 46 #if ENABLE(VIDEO)
 47 #include &quot;MediaElementSession.h&quot;
 48 #endif
 49 
 50 namespace WebCore {
 51 
 52 class AnimationTimeline;
 53 class AudioContext;
 54 class CacheStorageConnection;
 55 class DOMRect;
 56 class DOMRectList;
 57 class DOMRectReadOnly;
 58 class DOMURL;
 59 class DOMWindow;
 60 class Document;
 61 class Element;
 62 class EventListener;
 63 class ExtendableEvent;
 64 class FetchResponse;
 65 class File;
 66 class Frame;
 67 class GCObservation;
 68 class HTMLAnchorElement;
 69 class HTMLImageElement;
 70 class HTMLInputElement;
 71 class HTMLLinkElement;
 72 class HTMLMediaElement;
 73 class HTMLPictureElement;
 74 class HTMLSelectElement;
<a name="2" id="anc2"></a><span class="line-added"> 75 class HTMLVideoElement;</span>
 76 class ImageData;
 77 class InspectorStubFrontend;
<a name="3" id="anc3"></a><span class="line-added"> 78 class InternalsMapLike;</span>
 79 class InternalSettings;
<a name="4" id="anc4"></a><span class="line-added"> 80 class InternalsSetLike;</span>
<span class="line-added"> 81 class Location;</span>
 82 class MallocStatistics;
 83 class MediaSession;
 84 class MediaStream;
 85 class MediaStreamTrack;
 86 class MemoryInfo;
 87 class MockCDMFactory;
 88 class MockContentFilterSettings;
 89 class MockPageOverlay;
 90 class MockPaymentCoordinator;
 91 class NodeList;
 92 class Page;
 93 class RTCPeerConnection;
 94 class Range;
 95 class RenderedDocumentMarker;
 96 class SVGSVGElement;
 97 class SerializedScriptValue;
 98 class SourceBuffer;
 99 class StringCallback;
100 class StyleSheet;
101 class TimeRanges;
102 class TypeConversions;
<a name="5" id="anc5"></a><span class="line-added">103 class UnsuspendableActiveDOMObject;</span>
104 class VoidCallback;
105 class WebGLRenderingContext;
<a name="6" id="anc6"></a><span class="line-added">106 class WindowProxy;</span>
107 class XMLHttpRequest;
108 
109 #if ENABLE(VIDEO_TRACK)
110 class TextTrackCueGeneric;
111 #endif
112 
113 #if ENABLE(SERVICE_WORKER)
114 class ServiceWorker;
115 #endif
116 
<a name="7" id="anc7"></a><span class="line-added">117 template&lt;typename IDLType&gt; class DOMPromiseDeferred;</span>
<span class="line-added">118 </span>
<span class="line-added">119 struct MockWebAuthenticationConfiguration;</span>
<span class="line-added">120 </span>
121 class Internals final : public RefCounted&lt;Internals&gt;, private ContextDestructionObserver
122 #if ENABLE(MEDIA_STREAM)
123     , private RealtimeMediaSource::Observer
124 #endif
125     {
126 public:
127     static Ref&lt;Internals&gt; create(Document&amp;);
128     virtual ~Internals();
129 
130     static void resetToConsistentState(Page&amp;);
131 
132     ExceptionOr&lt;String&gt; elementRenderTreeAsText(Element&amp;);
133     bool hasPausedImageAnimations(Element&amp;);
134 
135     bool isPaintingFrequently(Element&amp;);
136     void incrementFrequentPaintCounter(Element&amp;);
137 
138     String address(Node&amp;);
139     bool nodeNeedsStyleRecalc(Node&amp;);
140     String styleChangeType(Node&amp;);
141     String description(JSC::JSValue);
142 
143     bool isPreloaded(const String&amp; url);
144     bool isLoadingFromMemoryCache(const String&amp; url);
145     String fetchResponseSource(FetchResponse&amp;);
146     String xhrResponseSource(XMLHttpRequest&amp;);
147     bool isSharingStyleSheetContents(HTMLLinkElement&amp;, HTMLLinkElement&amp;);
148     bool isStyleSheetLoadingSubresources(HTMLLinkElement&amp;);
149     enum class CachePolicy { UseProtocolCachePolicy, ReloadIgnoringCacheData, ReturnCacheDataElseLoad, ReturnCacheDataDontLoad };
150     void setOverrideCachePolicy(CachePolicy);
151     ExceptionOr&lt;void&gt; setCanShowModalDialogOverride(bool allow);
152     enum class ResourceLoadPriority { ResourceLoadPriorityVeryLow, ResourceLoadPriorityLow, ResourceLoadPriorityMedium, ResourceLoadPriorityHigh, ResourceLoadPriorityVeryHigh };
153     void setOverrideResourceLoadPriority(ResourceLoadPriority);
154     void setStrictRawResourceValidationPolicyDisabled(bool);
155 
156     void clearMemoryCache();
157     void pruneMemoryCacheToSize(unsigned size);
158     void destroyDecodedDataForAllImages();
159     unsigned memoryCacheSize() const;
160 
161     unsigned imageFrameIndex(HTMLImageElement&amp;);
162     unsigned imageFrameCount(HTMLImageElement&amp;);
163     float imageFrameDurationAtIndex(HTMLImageElement&amp;, unsigned index);
164     void setImageFrameDecodingDuration(HTMLImageElement&amp;, float duration);
165     void resetImageAnimation(HTMLImageElement&amp;);
166     bool isImageAnimating(HTMLImageElement&amp;);
167     unsigned imagePendingDecodePromisesCountForTesting(HTMLImageElement&amp;);
168     void setClearDecoderAfterAsyncFrameRequestForTesting(HTMLImageElement&amp;, bool enabled);
169     unsigned imageDecodeCount(HTMLImageElement&amp;);
170     unsigned pdfDocumentCachingCount(HTMLImageElement&amp;);
171     void setLargeImageAsyncDecodingEnabledForTesting(HTMLImageElement&amp;, bool enabled);
172     void setForceUpdateImageDataEnabledForTesting(HTMLImageElement&amp;, bool enabled);
173 
174     void setGridMaxTracksLimit(unsigned);
175 
<a name="8" id="anc8"></a><span class="line-modified">176     void clearBackForwardCache();</span>
<span class="line-modified">177     unsigned backForwardCacheSize() const;</span>
<span class="line-added">178     void preventDocumentFromEnteringBackForwardCache();</span>
179 
180     void disableTileSizeUpdateDelay();
181 
182     void setSpeculativeTilingDelayDisabledForTesting(bool);
183 
184     Ref&lt;CSSComputedStyleDeclaration&gt; computedStyleIncludingVisitedInfo(Element&amp;) const;
185 
186     Node* ensureUserAgentShadowRoot(Element&amp; host);
187     Node* shadowRoot(Element&amp; host);
188     ExceptionOr&lt;String&gt; shadowRootType(const Node&amp;) const;
189     String shadowPseudoId(Element&amp;);
190     void setShadowPseudoId(Element&amp;, const String&amp;);
191 
192     // CSS Deferred Parsing Testing
193     unsigned deferredStyleRulesCount(StyleSheet&amp;);
194     unsigned deferredGroupRulesCount(StyleSheet&amp;);
195     unsigned deferredKeyframesRulesCount(StyleSheet&amp;);
196 
197     // DOMTimers throttling testing.
198     ExceptionOr&lt;bool&gt; isTimerThrottled(int timeoutId);
199     bool isRequestAnimationFrameThrottled() const;
200     double requestAnimationFrameInterval() const;
201     bool scriptedAnimationsAreSuspended() const;
202     bool areTimersThrottled() const;
203 
204     enum EventThrottlingBehavior { Responsive, Unresponsive };
205     void setEventThrottlingBehaviorOverride(Optional&lt;EventThrottlingBehavior&gt;);
206     Optional&lt;EventThrottlingBehavior&gt; eventThrottlingBehaviorOverride() const;
207 
208     // Spatial Navigation testing.
209     ExceptionOr&lt;unsigned&gt; lastSpatialNavigationCandidateCount() const;
210 
211     // CSS Animation testing.
212     unsigned numberOfActiveAnimations() const;
213     ExceptionOr&lt;bool&gt; animationsAreSuspended() const;
214     ExceptionOr&lt;void&gt; suspendAnimations() const;
215     ExceptionOr&lt;void&gt; resumeAnimations() const;
216     ExceptionOr&lt;bool&gt; pauseAnimationAtTimeOnElement(const String&amp; animationName, double pauseTime, Element&amp;);
217     ExceptionOr&lt;bool&gt; pauseAnimationAtTimeOnPseudoElement(const String&amp; animationName, double pauseTime, Element&amp;, const String&amp; pseudoId);
218     double animationsInterval() const;
219 
220     // CSS Transition testing.
221     ExceptionOr&lt;bool&gt; pauseTransitionAtTimeOnElement(const String&amp; propertyName, double pauseTime, Element&amp;);
222     ExceptionOr&lt;bool&gt; pauseTransitionAtTimeOnPseudoElement(const String&amp; property, double pauseTime, Element&amp;, const String&amp; pseudoId);
223 
224     // Web Animations testing.
225     struct AcceleratedAnimation {
226         String property;
227         double speed;
228     };
229     Vector&lt;AcceleratedAnimation&gt; acceleratedAnimationsForElement(Element&amp;);
230     unsigned numberOfAnimationTimelineInvalidations() const;
231 
232     // For animations testing, we need a way to get at pseudo elements.
233     ExceptionOr&lt;RefPtr&lt;Element&gt;&gt; pseudoElement(Element&amp;, const String&amp;);
234 
235     Node* treeScopeRootNode(Node&amp;);
236     Node* parentTreeScope(Node&amp;);
237 
238     String visiblePlaceholder(Element&amp;);
<a name="9" id="anc9"></a><span class="line-added">239     void setCanShowPlaceholder(Element&amp;, bool);</span>
<span class="line-added">240 </span>
241     void selectColorInColorChooser(HTMLInputElement&amp;, const String&amp; colorValue);
242     ExceptionOr&lt;Vector&lt;String&gt;&gt; formControlStateOfPreviousHistoryItem();
243     ExceptionOr&lt;void&gt; setFormControlStateOfPreviousHistoryItem(const Vector&lt;String&gt;&amp;);
244 
245     ExceptionOr&lt;Ref&lt;DOMRect&gt;&gt; absoluteCaretBounds();
246     ExceptionOr&lt;bool&gt; isCaretBlinkingSuspended();
247 
248     Ref&lt;DOMRect&gt; boundingBox(Element&amp;);
249 
250     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; inspectorHighlightRects();
251 
252     ExceptionOr&lt;unsigned&gt; markerCountForNode(Node&amp;, const String&amp;);
253     ExceptionOr&lt;RefPtr&lt;Range&gt;&gt; markerRangeForNode(Node&amp;, const String&amp; markerType, unsigned index);
254     ExceptionOr&lt;String&gt; markerDescriptionForNode(Node&amp;, const String&amp; markerType, unsigned index);
255     ExceptionOr&lt;String&gt; dumpMarkerRects(const String&amp; markerType);
256     void addTextMatchMarker(const Range&amp;, bool isActive);
257     ExceptionOr&lt;void&gt; setMarkedTextMatchesAreHighlighted(bool);
258 
259     void invalidateFontCache();
260     void setFontSmoothingEnabled(bool);
261 
262     ExceptionOr&lt;void&gt; setLowPowerModeEnabled(bool);
263 
264     ExceptionOr&lt;void&gt; setScrollViewPosition(int x, int y);
265     ExceptionOr&lt;void&gt; unconstrainedScrollTo(Element&amp;, double x, double y);
266 
267     ExceptionOr&lt;Ref&lt;DOMRect&gt;&gt; layoutViewportRect();
268     ExceptionOr&lt;Ref&lt;DOMRect&gt;&gt; visualViewportRect();
269 
270     ExceptionOr&lt;void&gt; setViewIsTransparent(bool);
271 
272     ExceptionOr&lt;String&gt; viewBaseBackgroundColor();
273     ExceptionOr&lt;void&gt; setViewBaseBackgroundColor(const String&amp; colorValue);
274 
275     ExceptionOr&lt;void&gt; setPagination(const String&amp; mode, int gap, int pageLength);
276     ExceptionOr&lt;void&gt; setPaginationLineGridEnabled(bool);
277     ExceptionOr&lt;String&gt; configurationForViewport(float devicePixelRatio, int deviceWidth, int deviceHeight, int availableWidth, int availableHeight);
278 
279     ExceptionOr&lt;bool&gt; wasLastChangeUserEdit(Element&amp; textField);
280     bool elementShouldAutoComplete(HTMLInputElement&amp;);
281     void setAutofilled(HTMLInputElement&amp;, bool enabled);
282     void setAutoFilledAndViewable(HTMLInputElement&amp;, bool enabled);
283     enum class AutoFillButtonType { None, Contacts, Credentials, StrongPassword, CreditCard };
284     void setShowAutoFillButton(HTMLInputElement&amp;, AutoFillButtonType);
285     AutoFillButtonType autoFillButtonType(const HTMLInputElement&amp;);
286     AutoFillButtonType lastAutoFillButtonType(const HTMLInputElement&amp;);
287     ExceptionOr&lt;void&gt; scrollElementToRect(Element&amp;, int x, int y, int w, int h);
288 
289     ExceptionOr&lt;String&gt; autofillFieldName(Element&amp;);
290 
291     ExceptionOr&lt;void&gt; invalidateControlTints();
292 
293     RefPtr&lt;Range&gt; rangeFromLocationAndLength(Element&amp; scope, int rangeLocation, int rangeLength);
294     unsigned locationFromRange(Element&amp; scope, const Range&amp;);
295     unsigned lengthFromRange(Element&amp; scope, const Range&amp;);
296     String rangeAsText(const Range&amp;);
297     String rangeAsTextUsingBackwardsTextIterator(const Range&amp;);
298     Ref&lt;Range&gt; subrange(Range&amp;, int rangeLocation, int rangeLength);
299     ExceptionOr&lt;RefPtr&lt;Range&gt;&gt; rangeForDictionaryLookupAtLocation(int x, int y);
300     RefPtr&lt;Range&gt; rangeOfStringNearLocation(const Range&amp;, const String&amp;, unsigned);
301 
302     ExceptionOr&lt;void&gt; setDelegatesScrolling(bool enabled);
303 
304     ExceptionOr&lt;int&gt; lastSpellCheckRequestSequence();
305     ExceptionOr&lt;int&gt; lastSpellCheckProcessedSequence();
306 
307     Vector&lt;String&gt; userPreferredLanguages() const;
308     void setUserPreferredLanguages(const Vector&lt;String&gt;&amp;);
309 
310     Vector&lt;String&gt; userPreferredAudioCharacteristics() const;
311     void setUserPreferredAudioCharacteristic(const String&amp;);
312 
<a name="10" id="anc10"></a><span class="line-added">313     void setMaxCanvasPixelMemory(unsigned);</span>
<span class="line-added">314 </span>
315     ExceptionOr&lt;unsigned&gt; wheelEventHandlerCount();
316     ExceptionOr&lt;unsigned&gt; touchEventHandlerCount();
317 
318     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; touchEventRectsForEvent(const String&amp;);
319     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; passiveTouchEventListenerRects();
320 
321     ExceptionOr&lt;RefPtr&lt;NodeList&gt;&gt; nodesFromRect(Document&amp;, int x, int y, unsigned topPadding, unsigned rightPadding, unsigned bottomPadding, unsigned leftPadding, bool ignoreClipping, bool allowUserAgentShadowContent, bool allowChildFrameContent) const;
322 
323     String parserMetaData(JSC::JSValue = JSC::JSValue::JSUndefined);
324 
325     void updateEditorUINowIfScheduled();
326 
327     bool sentenceRetroCorrectionEnabled() const
328     {
329 #if PLATFORM(MAC) &amp;&amp; __MAC_OS_X_VERSION_MIN_REQUIRED &gt;= 101400
330         return true;
331 #else
332         return false;
333 #endif
334     }
335     bool hasSpellingMarker(int from, int length);
336     bool hasGrammarMarker(int from, int length);
337     bool hasAutocorrectedMarker(int from, int length);
338     void setContinuousSpellCheckingEnabled(bool);
339     void setAutomaticQuoteSubstitutionEnabled(bool);
340     void setAutomaticLinkDetectionEnabled(bool);
341     void setAutomaticDashSubstitutionEnabled(bool);
342     void setAutomaticTextReplacementEnabled(bool);
343     void setAutomaticSpellingCorrectionEnabled(bool);
344 
345     void handleAcceptedCandidate(const String&amp; candidate, unsigned location, unsigned length);
346     void changeSelectionListType();
347 
348     bool isOverwriteModeEnabled();
349     void toggleOverwriteModeEnabled();
350 
351     bool testProcessIncomingSyncMessagesWhenWaitingForSyncReply();
352 
353     ExceptionOr&lt;RefPtr&lt;Range&gt;&gt; rangeOfString(const String&amp;, RefPtr&lt;Range&gt;&amp;&amp;, const Vector&lt;String&gt;&amp; findOptions);
354     ExceptionOr&lt;unsigned&gt; countMatchesForText(const String&amp;, const Vector&lt;String&gt;&amp; findOptions, const String&amp; markMatches);
355     ExceptionOr&lt;unsigned&gt; countFindMatches(const String&amp;, const Vector&lt;String&gt;&amp; findOptions);
356 
357     unsigned numberOfScrollableAreas();
358 
359     ExceptionOr&lt;bool&gt; isPageBoxVisible(int pageNumber);
360 
361     static const char* internalsId;
362 
363     InternalSettings* settings() const;
364     unsigned workerThreadCount() const;
365     ExceptionOr&lt;bool&gt; areSVGAnimationsPaused() const;
366     ExceptionOr&lt;double&gt; svgAnimationsInterval(SVGSVGElement&amp;) const;
367 
368     enum {
369         // Values need to be kept in sync with Internals.idl.
370         LAYER_TREE_INCLUDES_VISIBLE_RECTS = 1,
371         LAYER_TREE_INCLUDES_TILE_CACHES = 2,
372         LAYER_TREE_INCLUDES_REPAINT_RECTS = 4,
373         LAYER_TREE_INCLUDES_PAINTING_PHASES = 8,
374         LAYER_TREE_INCLUDES_CONTENT_LAYERS = 16,
375         LAYER_TREE_INCLUDES_ACCELERATES_DRAWING = 32,
376         LAYER_TREE_INCLUDES_CLIPPING = 64,
377         LAYER_TREE_INCLUDES_BACKING_STORE_ATTACHED = 128,
378         LAYER_TREE_INCLUDES_ROOT_LAYER_PROPERTIES = 256,
379         LAYER_TREE_INCLUDES_EVENT_REGION = 512,
<a name="11" id="anc11"></a><span class="line-added">380         LAYER_TREE_INCLUDES_DEEP_COLOR = 1024,</span>
381     };
382     ExceptionOr&lt;String&gt; layerTreeAsText(Document&amp;, unsigned short flags) const;
383     ExceptionOr&lt;uint64_t&gt; layerIDForElement(Element&amp;);
384     ExceptionOr&lt;String&gt; repaintRectsAsText() const;
385 
386     ExceptionOr&lt;String&gt; scrollbarOverlayStyle(Node*) const;
387     ExceptionOr&lt;bool&gt; scrollbarUsingDarkAppearance(Node*) const;
388 
389     ExceptionOr&lt;String&gt; scrollingStateTreeAsText() const;
390     ExceptionOr&lt;String&gt; mainThreadScrollingReasons() const;
391     ExceptionOr&lt;Ref&lt;DOMRectList&gt;&gt; nonFastScrollableRects() const;
392 
393     ExceptionOr&lt;void&gt; setElementUsesDisplayListDrawing(Element&amp;, bool usesDisplayListDrawing);
394     ExceptionOr&lt;void&gt; setElementTracksDisplayListReplay(Element&amp;, bool isTrackingReplay);
395 
396     enum {
397         // Values need to be kept in sync with Internals.idl.
398         DISPLAY_LIST_INCLUDES_PLATFORM_OPERATIONS = 1,
399     };
400     ExceptionOr&lt;String&gt; displayListForElement(Element&amp;, unsigned short flags);
401     ExceptionOr&lt;String&gt; replayDisplayListForElement(Element&amp;, unsigned short flags);
402 
403     ExceptionOr&lt;void&gt; garbageCollectDocumentResources() const;
404 
405     void beginSimulatedMemoryPressure();
406     void endSimulatedMemoryPressure();
407     bool isUnderMemoryPressure();
408 
409     ExceptionOr&lt;void&gt; insertAuthorCSS(const String&amp;) const;
410     ExceptionOr&lt;void&gt; insertUserCSS(const String&amp;) const;
411 
412 #if ENABLE(INDEXED_DATABASE)
413     unsigned numberOfIDBTransactions() const;
414 #endif
415 
416     unsigned numberOfLiveNodes() const;
417     unsigned numberOfLiveDocuments() const;
418     unsigned referencingNodeCount(const Document&amp;) const;
419 
420 #if ENABLE(INTERSECTION_OBSERVER)
421     unsigned numberOfIntersectionObservers(const Document&amp;) const;
422 #endif
423 
424     uint64_t documentIdentifier(const Document&amp;) const;
425     bool isDocumentAlive(uint64_t documentIdentifier) const;
426 
<a name="12" id="anc12"></a><span class="line-added">427     uint64_t storageAreaMapCount() const;</span>
<span class="line-added">428 </span>
<span class="line-added">429     uint64_t elementIdentifier(Element&amp;) const;</span>
<span class="line-added">430     uint64_t frameIdentifier(const Document&amp;) const;</span>
<span class="line-added">431     uint64_t pageIdentifier(const Document&amp;) const;</span>
<span class="line-added">432 </span>
433     bool isAnyWorkletGlobalScopeAlive() const;
434 
435     String serviceWorkerClientIdentifier(const Document&amp;) const;
436 
437     RefPtr&lt;WindowProxy&gt; openDummyInspectorFrontend(const String&amp; url);
438     void closeDummyInspectorFrontend();
439     ExceptionOr&lt;void&gt; setInspectorIsUnderTest(bool);
440 
441     String counterValue(Element&amp;);
442 
443     int pageNumber(Element&amp;, float pageWidth = 800, float pageHeight = 600);
444     Vector&lt;String&gt; shortcutIconURLs() const;
445 
446     int numberOfPages(float pageWidthInPixels = 800, float pageHeightInPixels = 600);
447     ExceptionOr&lt;String&gt; pageProperty(const String&amp; propertyName, int pageNumber) const;
448     ExceptionOr&lt;String&gt; pageSizeAndMarginsInPixels(int pageNumber, int width, int height, int marginTop, int marginRight, int marginBottom, int marginLeft) const;
449 
450     ExceptionOr&lt;float&gt; pageScaleFactor() const;
451 
452     ExceptionOr&lt;void&gt; setPageScaleFactor(float scaleFactor, int x, int y);
453     ExceptionOr&lt;void&gt; setPageZoomFactor(float);
454     ExceptionOr&lt;void&gt; setTextZoomFactor(float);
455 
456     ExceptionOr&lt;void&gt; setUseFixedLayout(bool);
457     ExceptionOr&lt;void&gt; setFixedLayoutSize(int width, int height);
458     ExceptionOr&lt;void&gt; setViewExposedRect(float left, float top, float width, float height);
459     void setPrinting(int width, int height);
460 
461     void setHeaderHeight(float);
462     void setFooterHeight(float);
463 
464     void setTopContentInset(float);
465 
466 #if ENABLE(FULLSCREEN_API)
467     void webkitWillEnterFullScreenForElement(Element&amp;);
468     void webkitDidEnterFullScreenForElement(Element&amp;);
469     void webkitWillExitFullScreenForElement(Element&amp;);
470     void webkitDidExitFullScreenForElement(Element&amp;);
471     bool isAnimatingFullScreen() const;
472 #endif
473 
474     struct FullscreenInsets {
475         float top { 0 };
476         float left { 0 };
477         float bottom { 0 };
478         float right { 0 };
479     };
480     void setFullscreenInsets(FullscreenInsets);
481     void setFullscreenAutoHideDuration(double);
482     void setFullscreenControlsHidden(bool);
483 
484     WEBCORE_TESTSUPPORT_EXPORT void setApplicationCacheOriginQuota(unsigned long long);
485 
486     void registerURLSchemeAsBypassingContentSecurityPolicy(const String&amp; scheme);
487     void removeURLSchemeRegisteredAsBypassingContentSecurityPolicy(const String&amp; scheme);
488 
489     void registerDefaultPortForProtocol(unsigned short port, const String&amp; protocol);
490 
491     Ref&lt;MallocStatistics&gt; mallocStatistics() const;
492     Ref&lt;TypeConversions&gt; typeConversions() const;
493     Ref&lt;MemoryInfo&gt; memoryInfo() const;
494 
495     Vector&lt;String&gt; getReferencedFilePaths() const;
496 
497     ExceptionOr&lt;void&gt; startTrackingRepaints();
498     ExceptionOr&lt;void&gt; stopTrackingRepaints();
499 
500     ExceptionOr&lt;void&gt; startTrackingLayerFlushes();
501     ExceptionOr&lt;unsigned&gt; layerFlushCount();
502 
503     ExceptionOr&lt;void&gt; startTrackingStyleRecalcs();
504     ExceptionOr&lt;unsigned&gt; styleRecalcCount();
505     unsigned lastStyleUpdateSize() const;
506 
507     ExceptionOr&lt;void&gt; startTrackingCompositingUpdates();
508     ExceptionOr&lt;unsigned&gt; compositingUpdateCount();
509 
510     enum CompositingPolicy { Normal, Conservative };
511     ExceptionOr&lt;void&gt; setCompositingPolicyOverride(Optional&lt;CompositingPolicy&gt;);
512     ExceptionOr&lt;Optional&lt;CompositingPolicy&gt;&gt; compositingPolicyOverride() const;
513 
514     ExceptionOr&lt;void&gt; updateLayoutIgnorePendingStylesheetsAndRunPostLayoutTasks(Node*);
515     unsigned layoutCount() const;
516 
517     Ref&lt;ArrayBuffer&gt; serializeObject(const RefPtr&lt;SerializedScriptValue&gt;&amp;) const;
518     Ref&lt;SerializedScriptValue&gt; deserializeBuffer(ArrayBuffer&amp;) const;
519 
520     bool isFromCurrentWorld(JSC::JSValue) const;
<a name="13" id="anc13"></a><span class="line-added">521     JSC::JSValue evaluateInWorldIgnoringException(const String&amp; name, const String&amp; source);</span>
522 
523     void setUsesOverlayScrollbars(bool);
524     void setUsesMockScrollAnimator(bool);
525 
526     ExceptionOr&lt;String&gt; getCurrentCursorInfo();
527 
528     String markerTextForListItem(Element&amp;);
529 
530     String toolTipFromElement(Element&amp;) const;
531 
532     void forceReload(bool endToEnd);
533     void reloadExpiredOnly();
534 
535     void enableAutoSizeMode(bool enabled, int width, int height);
536 
537 #if ENABLE(LEGACY_ENCRYPTED_MEDIA)
538     void initializeMockCDM();
539 #endif
540 
541 #if ENABLE(ENCRYPTED_MEDIA)
542     Ref&lt;MockCDMFactory&gt; registerMockCDM();
543 #endif
544 
545     void enableMockMediaCapabilities();
546 
547 #if ENABLE(SPEECH_SYNTHESIS)
548     void enableMockSpeechSynthesizer();
549 #endif
550 
551 #if ENABLE(MEDIA_STREAM)
552     void setShouldInterruptAudioOnPageVisibilityChange(bool);
<a name="14" id="anc14"></a>
553     void setMediaCaptureRequiresSecureConnection(bool);
554     void setCustomPrivateRecorderCreator();
555 #endif
556 
557 #if ENABLE(WEB_RTC)
558     void emulateRTCPeerConnectionPlatformEvent(RTCPeerConnection&amp;, const String&amp; action);
559     void useMockRTCPeerConnectionFactory(const String&amp;);
560     void setICECandidateFiltering(bool);
561     void setEnumeratingAllNetworkInterfacesEnabled(bool);
562     void stopPeerConnection(RTCPeerConnection&amp;);
563     void clearPeerConnectionFactory();
564     void applyRotationForOutgoingVideoSources(RTCPeerConnection&amp;);
565     void setEnableWebRTCEncryption(bool);
<a name="15" id="anc15"></a><span class="line-added">566     void setUseDTLS10(bool);</span>
<span class="line-added">567     void setUseGPUProcessForWebRTC(bool);</span>
568 #endif
569 
570     String getImageSourceURL(Element&amp;);
571 
572 #if ENABLE(VIDEO)
573     Vector&lt;String&gt; mediaResponseSources(HTMLMediaElement&amp;);
574     Vector&lt;String&gt; mediaResponseContentRanges(HTMLMediaElement&amp;);
575     void simulateAudioInterruption(HTMLMediaElement&amp;);
576     ExceptionOr&lt;bool&gt; mediaElementHasCharacteristic(HTMLMediaElement&amp;, const String&amp;);
577     void beginSimulatedHDCPError(HTMLMediaElement&amp;);
578     void endSimulatedHDCPError(HTMLMediaElement&amp;);
579 
580     bool elementShouldBufferData(HTMLMediaElement&amp;);
581     String elementBufferingPolicy(HTMLMediaElement&amp;);
582     double privatePlayerVolume(const HTMLMediaElement&amp;);
583 #endif
584 
585     bool isSelectPopupVisible(HTMLSelectElement&amp;);
586 
587     ExceptionOr&lt;String&gt; captionsStyleSheetOverride();
588     ExceptionOr&lt;void&gt; setCaptionsStyleSheetOverride(const String&amp;);
589     ExceptionOr&lt;void&gt; setPrimaryAudioTrackLanguageOverride(const String&amp;);
590     ExceptionOr&lt;void&gt; setCaptionDisplayMode(const String&amp;);
591 #if ENABLE(VIDEO_TRACK)
592     RefPtr&lt;TextTrackCueGeneric&gt; createGenericCue(double startTime, double endTime, String text);
593 #endif
594 
595 #if ENABLE(VIDEO)
596     Ref&lt;TimeRanges&gt; createTimeRanges(Float32Array&amp; startTimes, Float32Array&amp; endTimes);
597     double closestTimeToTimeRanges(double time, TimeRanges&amp;);
598 #endif
599 
600     ExceptionOr&lt;Ref&lt;DOMRect&gt;&gt; selectionBounds();
601     void setSelectionWithoutValidation(Ref&lt;Node&gt; baseNode, unsigned baseOffset, RefPtr&lt;Node&gt; extentNode, unsigned extentOffset);
602 
603     ExceptionOr&lt;bool&gt; isPluginUnavailabilityIndicatorObscured(Element&amp;);
604     ExceptionOr&lt;String&gt; unavailablePluginReplacementText(Element&amp;);
605     bool isPluginSnapshotted(Element&amp;);
606     bool pluginIsBelowSizeThreshold(Element&amp;);
607 
608 #if ENABLE(MEDIA_SOURCE)
609     WEBCORE_TESTSUPPORT_EXPORT void initializeMockMediaSource();
610     Vector&lt;String&gt; bufferedSamplesForTrackID(SourceBuffer&amp;, const AtomString&amp;);
611     Vector&lt;String&gt; enqueuedSamplesForTrackID(SourceBuffer&amp;, const AtomString&amp;);
612     double minimumUpcomingPresentationTimeForTrackID(SourceBuffer&amp;, const AtomString&amp;);
613     void setShouldGenerateTimestamps(SourceBuffer&amp;, bool);
614     void setMaximumQueueDepthForTrackID(SourceBuffer&amp;, const AtomString&amp;, size_t);
615 #endif
616 
617 #if ENABLE(VIDEO)
618     ExceptionOr&lt;void&gt; beginMediaSessionInterruption(const String&amp;);
619     void endMediaSessionInterruption(const String&amp;);
620     void applicationWillBecomeInactive();
621     void applicationDidBecomeActive();
622     void applicationWillEnterForeground(bool suspendedUnderLock) const;
623     void applicationDidEnterBackground(bool suspendedUnderLock) const;
624     ExceptionOr&lt;void&gt; setMediaSessionRestrictions(const String&amp; mediaType, StringView restrictionsString);
625     ExceptionOr&lt;String&gt; mediaSessionRestrictions(const String&amp; mediaType) const;
626     void setMediaElementRestrictions(HTMLMediaElement&amp;, StringView restrictionsString);
627     ExceptionOr&lt;void&gt; postRemoteControlCommand(const String&amp;, float argument);
628     bool elementIsBlockingDisplaySleep(HTMLMediaElement&amp;) const;
629 #endif
630 
631 #if ENABLE(MEDIA_SESSION)
632     void sendMediaSessionStartOfInterruptionNotification(MediaSessionInterruptingCategory);
633     void sendMediaSessionEndOfInterruptionNotification(MediaSessionInterruptingCategory);
634     String mediaSessionCurrentState(MediaSession&amp;) const;
635     double mediaElementPlayerVolume(HTMLMediaElement&amp;) const;
636     enum class MediaControlEvent { PlayPause, NextTrack, PreviousTrack };
637     void sendMediaControlEvent(MediaControlEvent);
638 #endif
639 
640 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
641     void setMockMediaPlaybackTargetPickerEnabled(bool);
642     ExceptionOr&lt;void&gt; setMockMediaPlaybackTargetPickerState(const String&amp; deviceName, const String&amp; deviceState);
<a name="16" id="anc16"></a><span class="line-added">643     void mockMediaPlaybackTargetPickerDismissPopup();</span>
644 #endif
645 
646 #if ENABLE(WEB_AUDIO)
647     void setAudioContextRestrictions(AudioContext&amp;, StringView restrictionsString);
<a name="17" id="anc17"></a><span class="line-added">648     void useMockAudioDestinationCocoa();</span>
649 #endif
650 
651     void simulateSystemSleep() const;
652     void simulateSystemWake() const;
653 
654     enum class PageOverlayType { View, Document };
655     ExceptionOr&lt;Ref&lt;MockPageOverlay&gt;&gt; installMockPageOverlay(PageOverlayType);
656     ExceptionOr&lt;String&gt; pageOverlayLayerTreeAsText(unsigned short flags) const;
657 
658     void setPageMuted(StringView);
659     String pageMediaState();
660 
661     void setPageDefersLoading(bool);
662     ExceptionOr&lt;bool&gt; pageDefersLoading();
663 
664     RefPtr&lt;File&gt; createFile(const String&amp;);
665     void queueMicroTask(int);
666     bool testPreloaderSettingViewport();
667 
668 #if ENABLE(CONTENT_FILTERING)
669     MockContentFilterSettings&amp; mockContentFilterSettings();
670 #endif
671 
672 #if ENABLE(CSS_SCROLL_SNAP)
673     ExceptionOr&lt;String&gt; scrollSnapOffsets(Element&amp;);
674     void setPlatformMomentumScrollingPredictionEnabled(bool);
675 #endif
676 
677     ExceptionOr&lt;String&gt; pathStringWithShrinkWrappedRects(const Vector&lt;double&gt;&amp; rectComponents, double radius);
678 
679     String getCurrentMediaControlsStatusForElement(HTMLMediaElement&amp;);
680 
681     String userVisibleString(const DOMURL&amp;);
682     void setShowAllPlugins(bool);
683 
684     String resourceLoadStatisticsForURL(const DOMURL&amp;);
685     void setResourceLoadStatisticsEnabled(bool);
686 
687 #if ENABLE(STREAMS_API)
<a name="18" id="anc18"></a><span class="line-modified">688     bool isReadableStreamDisturbed(JSC::JSGlobalObject&amp;, JSC::JSValue);</span>
<span class="line-modified">689     JSC::JSValue cloneArrayBuffer(JSC::JSGlobalObject&amp;, JSC::JSValue, JSC::JSValue, JSC::JSValue);</span>
690 #endif
691 
692     String composedTreeAsText(Node&amp;);
693 
694     bool isProcessingUserGesture();
695     double lastHandledUserGestureTimestamp();
696 
697     void withUserGesture(RefPtr&lt;VoidCallback&gt;&amp;&amp;);
698 
699     bool userIsInteracting();
700 
701     RefPtr&lt;GCObservation&gt; observeGC(JSC::JSValue);
702 
703     enum class UserInterfaceLayoutDirection : uint8_t { LTR, RTL };
704     void setUserInterfaceLayoutDirection(UserInterfaceLayoutDirection);
705 
706     bool userPrefersReducedMotion() const;
707 
708     void reportBacktrace();
709 
710     enum class BaseWritingDirection { Natural, Ltr, Rtl };
711     void setBaseWritingDirection(BaseWritingDirection);
712 
713 #if ENABLE(POINTER_LOCK)
714     bool pageHasPendingPointerLock() const;
715     bool pageHasPointerLock() const;
716 #endif
717 
718     Vector&lt;String&gt; accessKeyModifiers() const;
719 
720     void setQuickLookPassword(const String&amp;);
721 
722     void setAsRunningUserScripts(Document&amp;);
723 #if ENABLE(APPLE_PAY)
724     void setApplePayIsActive(Document&amp;);
725 #endif
726 
727 #if ENABLE(WEBGL)
728     void simulateWebGLContextChanged(WebGLRenderingContext&amp;);
729     void failNextGPUStatusCheck(WebGLRenderingContext&amp;);
730     bool hasLowAndHighPowerGPUs();
731 #endif
732 
733     void setPageVisibility(bool isVisible);
734     void setPageIsFocusedAndActive(bool);
735 
736 
737 #if ENABLE(WEB_RTC)
738     void setH264HardwareEncoderAllowed(bool allowed);
739 #endif
740 
741 #if ENABLE(MEDIA_STREAM)
742     void setMockAudioTrackChannelNumber(MediaStreamTrack&amp;, unsigned short);
743     void setCameraMediaStreamTrackOrientation(MediaStreamTrack&amp;, int orientation);
744     unsigned long trackAudioSampleCount() const { return m_trackAudioSampleCount; }
745     unsigned long trackVideoSampleCount() const { return m_trackVideoSampleCount; }
746     void observeMediaStreamTrack(MediaStreamTrack&amp;);
747     using TrackFramePromise = DOMPromiseDeferred&lt;IDLInterface&lt;ImageData&gt;&gt;;
748     void grabNextMediaStreamTrackFrame(TrackFramePromise&amp;&amp;);
749     void delayMediaStreamTrackSamples(MediaStreamTrack&amp;, float);
750     void setMediaStreamTrackMuted(MediaStreamTrack&amp;, bool);
751     void removeMediaStreamTrack(MediaStream&amp;, MediaStreamTrack&amp;);
752     void simulateMediaStreamTrackCaptureSourceFailure(MediaStreamTrack&amp;);
753     void setMediaStreamTrackIdentifier(MediaStreamTrack&amp;, String&amp;&amp; id);
754     void setMediaStreamSourceInterrupted(MediaStreamTrack&amp;, bool);
<a name="19" id="anc19"></a><span class="line-modified">755     bool isMockRealtimeMediaSourceCenterEnabled();</span>
756 #endif
757 
<a name="20" id="anc20"></a><span class="line-added">758     bool supportsAudioSession() const;</span>
759     String audioSessionCategory() const;
760     double preferredAudioBufferSize() const;
761     bool audioSessionActive() const;
762 
763     void storeRegistrationsOnDisk(DOMPromiseDeferred&lt;void&gt;&amp;&amp;);
764 
765     void clearCacheStorageMemoryRepresentation(DOMPromiseDeferred&lt;void&gt;&amp;&amp;);
766     void cacheStorageEngineRepresentation(DOMPromiseDeferred&lt;IDLDOMString&gt;&amp;&amp;);
767     void setResponseSizeWithPadding(FetchResponse&amp;, uint64_t size);
768     uint64_t responseSizeWithPadding(FetchResponse&amp;) const;
769 
770     void updateQuotaBasedOnSpaceUsage();
771 
772     void setConsoleMessageListener(RefPtr&lt;StringCallback&gt;&amp;&amp;);
773 
774 #if ENABLE(SERVICE_WORKER)
775     using HasRegistrationPromise = DOMPromiseDeferred&lt;IDLBoolean&gt;;
776     void hasServiceWorkerRegistration(const String&amp; clientURL, HasRegistrationPromise&amp;&amp;);
777     void terminateServiceWorker(ServiceWorker&amp;);
<a name="21" id="anc21"></a><span class="line-modified">778     void isServiceWorkerRunning(ServiceWorker&amp;, DOMPromiseDeferred&lt;IDLBoolean&gt;&amp;&amp;);</span>
779 #endif
780 
781 #if ENABLE(APPLE_PAY)
782     MockPaymentCoordinator&amp; mockPaymentCoordinator(Document&amp;);
783 #endif
784 
785     bool isSystemPreviewLink(Element&amp;) const;
786     bool isSystemPreviewImage(Element&amp;) const;
787 
788     void postTask(RefPtr&lt;VoidCallback&gt;&amp;&amp;);
<a name="22" id="anc22"></a><span class="line-added">789     ExceptionOr&lt;void&gt; queueTask(ScriptExecutionContext&amp;, const String&amp; source, RefPtr&lt;VoidCallback&gt;&amp;&amp;);</span>
<span class="line-added">790     ExceptionOr&lt;void&gt; queueTaskToQueueMicrotask(Document&amp;, const String&amp; source, RefPtr&lt;VoidCallback&gt;&amp;&amp;);</span>
<span class="line-added">791     ExceptionOr&lt;bool&gt; hasSameEventLoopAs(WindowProxy&amp;);</span>
<span class="line-added">792 </span>
793     void markContextAsInsecure();
794 
795     bool usingAppleInternalSDK() const;
796 
797     struct NowPlayingState {
798         String title;
799         double duration;
800         double elapsedTime;
801         uint64_t uniqueIdentifier;
802         bool hasActiveSession;
803         bool registeredAsNowPlayingApplication;
804     };
805     ExceptionOr&lt;NowPlayingState&gt; nowPlayingState() const;
806 
807 #if ENABLE(VIDEO)
808     using PlaybackControlsPurpose = MediaElementSession::PlaybackControlsPurpose;
809     RefPtr&lt;HTMLMediaElement&gt; bestMediaElementForShowingPlaybackControlsManager(PlaybackControlsPurpose);
810 
811     using MediaSessionState = PlatformMediaSession::State;
812     MediaSessionState mediaSessionState(HTMLMediaElement&amp;);
813 #endif
814 
815     void setCaptureExtraNetworkLoadMetricsEnabled(bool);
816     String ongoingLoadsDescriptions() const;
817 
818     void reloadWithoutContentExtensions();
819 
820     void setUseSystemAppearance(bool);
821 
822     size_t pluginCount();
823 
824     void notifyResourceLoadObserver();
825 
826     unsigned primaryScreenDisplayID();
827 
828     bool capsLockIsOn();
829 
830     bool supportsVCPEncoder();
831 
832     using HEVCParameterSet = WebCore::HEVCParameterSet;
833     Optional&lt;HEVCParameterSet&gt; parseHEVCCodecParameters(const String&amp; codecString);
834 
<a name="23" id="anc23"></a><span class="line-added">835     using DoViParameterSet = WebCore::DoViParameterSet;</span>
<span class="line-added">836     Optional&lt;DoViParameterSet&gt; parseDoViCodecParameters(const String&amp; codecString);</span>
<span class="line-added">837 </span>
838     struct CookieData {
839         String name;
840         String value;
841         String domain;
842         // Expiration dates are expressed as milliseconds since the UNIX epoch.
843         double expires { 0 };
844         bool isHttpOnly { false };
845         bool isSecure { false };
846         bool isSession { false };
847         bool isSameSiteLax { false };
848         bool isSameSiteStrict { false };
849 
850         CookieData(Cookie cookie)
851             : name(cookie.name)
852             , value(cookie.value)
853             , domain(cookie.domain)
854             , expires(cookie.expires)
855             , isHttpOnly(cookie.httpOnly)
856             , isSecure(cookie.secure)
857             , isSession(cookie.session)
858             , isSameSiteLax(cookie.sameSite == Cookie::SameSitePolicy::Lax)
859             , isSameSiteStrict(cookie.sameSite == Cookie::SameSitePolicy::Strict)
860         {
861             ASSERT(!(isSameSiteLax &amp;&amp; isSameSiteStrict));
862         }
863 
864         CookieData()
865         {
866         }
867     };
868     Vector&lt;CookieData&gt; getCookies() const;
869 
870     void setAlwaysAllowLocalWebarchive(bool);
871     void processWillSuspend();
872     void processDidResume();
873 
874     void testDictionaryLogging();
875 
876     void setXHRMaximumIntervalForUserGestureForwarding(XMLHttpRequest&amp;, double);
<a name="24" id="anc24"></a><span class="line-added">877     void setTransientActivationDuration(double seconds);</span>
878 
879     void setIsPlayingToAutomotiveHeadUnit(bool);
880 
881     struct TextIndicatorInfo {
882         RefPtr&lt;DOMRectReadOnly&gt; textBoundingRectInRootViewCoordinates;
883         RefPtr&lt;DOMRectList&gt; textRectsInBoundingRectCoordinates;
884 
885         TextIndicatorInfo();
886         TextIndicatorInfo(const WebCore::TextIndicatorData&amp;);
887         ~TextIndicatorInfo();
888     };
889 
890     struct TextIndicatorOptions {
891         bool useBoundingRectAndPaintAllContentForComplexRanges { false };
892         bool computeEstimatedBackgroundColor { false };
893         bool respectTextColor { false };
894 
895         WebCore::TextIndicatorOptions core()
896         {
897             WebCore::TextIndicatorOptions options = 0;
898             if (useBoundingRectAndPaintAllContentForComplexRanges)
899                 options = options | TextIndicatorOptionUseBoundingRectAndPaintAllContentForComplexRanges;
900             if (computeEstimatedBackgroundColor)
901                 options = options | TextIndicatorOptionComputeEstimatedBackgroundColor;
902             if (respectTextColor)
903                 options = options | TextIndicatorOptionRespectTextColor;
904             return options;
905         }
906     };
907 
908     TextIndicatorInfo textIndicatorForRange(const Range&amp;, TextIndicatorOptions);
909 
910     void addPrefetchLoadEventListener(HTMLLinkElement&amp;, RefPtr&lt;EventListener&gt;&amp;&amp;);
911 
<a name="25" id="anc25"></a><span class="line-added">912 #if ENABLE(WEB_AUTHN)</span>
<span class="line-added">913     void setMockWebAuthenticationConfiguration(const MockWebAuthenticationConfiguration&amp;);</span>
<span class="line-added">914 #endif</span>
<span class="line-added">915 </span>
<span class="line-added">916 #if ENABLE(PICTURE_IN_PICTURE_API)</span>
<span class="line-added">917     void setPictureInPictureAPITestEnabled(HTMLVideoElement&amp;, bool);</span>
<span class="line-added">918 #endif</span>
<span class="line-added">919 </span>
<span class="line-added">920     int processIdentifier() const;</span>
<span class="line-added">921 </span>
<span class="line-added">922     Ref&lt;InternalsSetLike&gt; createInternalsSetLike();</span>
<span class="line-added">923     Ref&lt;InternalsMapLike&gt; createInternalsMapLike();</span>
<span class="line-added">924 </span>
<span class="line-added">925     bool hasSandboxMachLookupAccessToGlobalName(const String&amp; process, const String&amp; service);</span>
<span class="line-added">926     bool hasSandboxMachLookupAccessToXPCServiceName(const String&amp; process, const String&amp; service);</span>
<span class="line-added">927 </span>
<span class="line-added">928     String highlightPseudoElementColor(const String&amp; highlightName, Element&amp;);</span>
<span class="line-added">929 </span>
<span class="line-added">930     String windowLocationHost(DOMWindow&amp;);</span>
<span class="line-added">931 </span>
<span class="line-added">932     String systemColorForCSSValue(const String&amp; cssValue, bool useDarkModeAppearance, bool useElevatedUserInterfaceLevel);</span>
<span class="line-added">933 </span>
<span class="line-added">934     bool systemHasBattery() const;</span>
<span class="line-added">935 </span>
<span class="line-added">936     String mediaMIMETypeForExtension(const String&amp; extension);</span>
<span class="line-added">937 </span>
<span class="line-added">938     String focusRingColor();</span>
<span class="line-added">939 </span>
940 private:
941     explicit Internals(Document&amp;);
942     Document* contextDocument() const;
943     Frame* frame() const;
944 
945     ExceptionOr&lt;RenderedDocumentMarker*&gt; markerAt(Node&amp;, const String&amp; markerType, unsigned index);
946 
947     // RealtimeMediaSource::Observer API
948 #if ENABLE(MEDIA_STREAM)
949     void videoSampleAvailable(MediaSample&amp;) final;
950     void audioSamplesAvailable(const MediaTime&amp;, const PlatformAudioData&amp;, const AudioStreamDescription&amp;, size_t) final { m_trackAudioSampleCount++; }
951 
952     OrientationNotifier m_orientationNotifier;
953     unsigned long m_trackVideoSampleCount { 0 };
954     unsigned long m_trackAudioSampleCount { 0 };
955     RefPtr&lt;MediaStreamTrack&gt; m_track;
<a name="26" id="anc26"></a><span class="line-modified">956     std::unique_ptr&lt;TrackFramePromise&gt; m_nextTrackFramePromise;</span>
957 #endif
958 
959     std::unique_ptr&lt;InspectorStubFrontend&gt; m_inspectorFrontend;
960     RefPtr&lt;CacheStorageConnection&gt; m_cacheStorageConnection;
961 };
962 
963 } // namespace WebCore
<a name="27" id="anc27"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="27" type="hidden" />
</body>
</html>