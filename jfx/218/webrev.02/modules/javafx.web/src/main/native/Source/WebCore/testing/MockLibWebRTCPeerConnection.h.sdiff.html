<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/testing/MockLibWebRTCPeerConnection.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MockLibWebRTCPeerConnection.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MockPaymentCoordinator.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/testing/MockLibWebRTCPeerConnection.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 15  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 16  * DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 17  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 18  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 19  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 20  * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 21  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 22  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 23  */
 24 
 25 #pragma once
 26 
 27 #if USE(LIBWEBRTC)
 28 
 29 #include &quot;LibWebRTCMacros.h&quot;
 30 
 31 ALLOW_UNUSED_PARAMETERS_BEGIN
 32 
<span class="line-modified"> 33 #include &lt;webrtc/api/mediastreaminterface.h&gt;</span>
<span class="line-modified"> 34 #include &lt;webrtc/api/peerconnectioninterface.h&gt;</span>
 35 
 36 ALLOW_UNUSED_PARAMETERS_END
 37 
 38 #include &lt;wtf/text/WTFString.h&gt;
 39 
 40 namespace WebCore {
 41 
 42 class LibWebRTCProvider;
 43 class MockRtpSender;
 44 
 45 void useMockRTCPeerConnectionFactory(LibWebRTCProvider*, const String&amp;);
 46 void useRealRTCPeerConnectionFactory(LibWebRTCProvider&amp;);
 47 
 48 class MockLibWebRTCSessionDescription: public webrtc::SessionDescriptionInterface {
 49 public:
 50     explicit MockLibWebRTCSessionDescription(std::string&amp;&amp; sdp) : m_sdp(WTFMove(sdp)) { }
 51 
 52 private:
 53     bool ToString(std::string* out) const final { *out = m_sdp; return true; }
 54 
</pre>
<hr />
<pre>
164     bool m_reliable { false };
165     int m_id { -1 };
166 };
167 
168 class MockRtpSender : public webrtc::RtpSenderInterface {
169 public:
170     explicit MockRtpSender(rtc::scoped_refptr&lt;webrtc::MediaStreamTrackInterface&gt;&amp;&amp; track) : m_track(WTFMove(track)) { }
171 
172 private:
173     bool SetTrack(webrtc::MediaStreamTrackInterface* track) final
174     {
175         m_track = track;
176         return true;
177     }
178     rtc::scoped_refptr&lt;webrtc::MediaStreamTrackInterface&gt; track() const final { return m_track; }
179 
180     uint32_t ssrc() const { return 0; }
181     cricket::MediaType media_type() const { return cricket::MEDIA_TYPE_VIDEO; }
182     std::string id() const { return &quot;&quot;; }
183     std::vector&lt;std::string&gt; stream_ids() const { return { }; }
<span class="line-modified">184     webrtc::RtpParameters GetParameters() final { return { }; }</span>
185     webrtc::RTCError SetParameters(const webrtc::RtpParameters&amp;) final { return { }; }
186     rtc::scoped_refptr&lt;webrtc::DtmfSenderInterface&gt; GetDtmfSender() const final { return nullptr; }
187 
188 private:
189     rtc::scoped_refptr&lt;webrtc::MediaStreamTrackInterface&gt; m_track;
190 };
191 
192 class MockRtpReceiver : public webrtc::RtpReceiverInterface {
193 private:
194     cricket::MediaType media_type() const final { return cricket::MEDIA_TYPE_VIDEO; }
195     std::string id() const { return { }; }
196     webrtc::RtpParameters GetParameters() const { return { }; }
197     bool SetParameters(const webrtc::RtpParameters&amp;) { return true; }
198     void SetObserver(webrtc::RtpReceiverObserverInterface*) { }
199     rtc::scoped_refptr&lt;webrtc::MediaStreamTrackInterface&gt; track() const final { return { }; }

200 };
201 
202 class MockRtpTransceiver : public webrtc::RtpTransceiverInterface {
203 public:
204     MockRtpTransceiver(rtc::scoped_refptr&lt;webrtc::RtpSenderInterface&gt;&amp;&amp; sender, rtc::scoped_refptr&lt;webrtc::RtpReceiverInterface&gt;&amp;&amp; receiver)
205         : m_sender(WTFMove(sender))
206         , m_receiver(WTFMove(receiver))
207     {
208     }
209 
210     rtc::scoped_refptr&lt;webrtc::RtpSenderInterface&gt; sender() const final { return m_sender; }
211 
212 private:
213     cricket::MediaType media_type() const final { return m_sender-&gt;media_type(); }
214     absl::optional&lt;std::string&gt; mid() const final { return { }; }
215     rtc::scoped_refptr&lt;webrtc::RtpReceiverInterface&gt; receiver() const final { return m_receiver; }
216     bool stopped() const final { return false; }
217     webrtc::RtpTransceiverDirection direction() const final { return webrtc::RtpTransceiverDirection::kSendRecv; }
218     void SetDirection(webrtc::RtpTransceiverDirection) final { }
219     absl::optional&lt;webrtc::RtpTransceiverDirection&gt; current_direction() const final { return { }; }
</pre>
<hr />
<pre>
269     bool m_isReceivingAudio { false };
270     bool m_isReceivingVideo { false };
271     std::string m_streamLabel;
272 };
273 
274 class MockLibWebRTCPeerConnectionFactory : public webrtc::PeerConnectionFactoryInterface {
275 public:
276     static rtc::scoped_refptr&lt;webrtc::PeerConnectionFactoryInterface&gt; create(const String&amp; testCase) { return new rtc::RefCountedObject&lt;MockLibWebRTCPeerConnectionFactory&gt;(testCase); }
277 
278 protected:
279     explicit MockLibWebRTCPeerConnectionFactory(const String&amp;);
280 
281 private:
282     rtc::scoped_refptr&lt;webrtc::PeerConnectionInterface&gt; CreatePeerConnection(const webrtc::PeerConnectionInterface::RTCConfiguration&amp;, webrtc::PeerConnectionDependencies) final;
283 
284     rtc::scoped_refptr&lt;webrtc::MediaStreamInterface&gt; CreateLocalMediaStream(const std::string&amp;) final;
285 
286     void SetOptions(const Options&amp;) final { }
287     rtc::scoped_refptr&lt;webrtc::AudioSourceInterface&gt; CreateAudioSource(const cricket::AudioOptions&amp;) final { return nullptr; }
288 
<span class="line-removed">289     rtc::scoped_refptr&lt;webrtc::VideoTrackSourceInterface&gt; CreateVideoSource(cricket::VideoCapturer*) final { return nullptr; }</span>
<span class="line-removed">290     rtc::scoped_refptr&lt;webrtc::VideoTrackSourceInterface&gt; CreateVideoSource(std::unique_ptr&lt;cricket::VideoCapturer&gt;, const webrtc::MediaConstraintsInterface*) final { return nullptr; }</span>
<span class="line-removed">291 </span>
292     rtc::scoped_refptr&lt;webrtc::VideoTrackInterface&gt; CreateVideoTrack(const std::string&amp;, webrtc::VideoTrackSourceInterface*) final;
293     rtc::scoped_refptr&lt;webrtc::AudioTrackInterface&gt; CreateAudioTrack(const std::string&amp;, webrtc::AudioSourceInterface*) final;
294 
<span class="line-removed">295     bool StartAecDump(rtc::PlatformFile, int64_t) final { return false; }</span>
296     void StopAecDump() final { }
297 
298 private:
299     String m_testCase;
300 };
301 
302 } // namespace WebCore
303 
304 #endif // USE(LIBWEBRTC)
</pre>
</td>
<td>
<hr />
<pre>
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 15  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 16  * DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 17  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 18  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 19  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 20  * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 21  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 22  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 23  */
 24 
 25 #pragma once
 26 
 27 #if USE(LIBWEBRTC)
 28 
 29 #include &quot;LibWebRTCMacros.h&quot;
 30 
 31 ALLOW_UNUSED_PARAMETERS_BEGIN
 32 
<span class="line-modified"> 33 #include &lt;webrtc/api/media_stream_interface.h&gt;</span>
<span class="line-modified"> 34 #include &lt;webrtc/api/peer_connection_interface.h&gt;</span>
 35 
 36 ALLOW_UNUSED_PARAMETERS_END
 37 
 38 #include &lt;wtf/text/WTFString.h&gt;
 39 
 40 namespace WebCore {
 41 
 42 class LibWebRTCProvider;
 43 class MockRtpSender;
 44 
 45 void useMockRTCPeerConnectionFactory(LibWebRTCProvider*, const String&amp;);
 46 void useRealRTCPeerConnectionFactory(LibWebRTCProvider&amp;);
 47 
 48 class MockLibWebRTCSessionDescription: public webrtc::SessionDescriptionInterface {
 49 public:
 50     explicit MockLibWebRTCSessionDescription(std::string&amp;&amp; sdp) : m_sdp(WTFMove(sdp)) { }
 51 
 52 private:
 53     bool ToString(std::string* out) const final { *out = m_sdp; return true; }
 54 
</pre>
<hr />
<pre>
164     bool m_reliable { false };
165     int m_id { -1 };
166 };
167 
168 class MockRtpSender : public webrtc::RtpSenderInterface {
169 public:
170     explicit MockRtpSender(rtc::scoped_refptr&lt;webrtc::MediaStreamTrackInterface&gt;&amp;&amp; track) : m_track(WTFMove(track)) { }
171 
172 private:
173     bool SetTrack(webrtc::MediaStreamTrackInterface* track) final
174     {
175         m_track = track;
176         return true;
177     }
178     rtc::scoped_refptr&lt;webrtc::MediaStreamTrackInterface&gt; track() const final { return m_track; }
179 
180     uint32_t ssrc() const { return 0; }
181     cricket::MediaType media_type() const { return cricket::MEDIA_TYPE_VIDEO; }
182     std::string id() const { return &quot;&quot;; }
183     std::vector&lt;std::string&gt; stream_ids() const { return { }; }
<span class="line-modified">184     webrtc::RtpParameters GetParameters() const final { return { }; }</span>
185     webrtc::RTCError SetParameters(const webrtc::RtpParameters&amp;) final { return { }; }
186     rtc::scoped_refptr&lt;webrtc::DtmfSenderInterface&gt; GetDtmfSender() const final { return nullptr; }
187 
188 private:
189     rtc::scoped_refptr&lt;webrtc::MediaStreamTrackInterface&gt; m_track;
190 };
191 
192 class MockRtpReceiver : public webrtc::RtpReceiverInterface {
193 private:
194     cricket::MediaType media_type() const final { return cricket::MEDIA_TYPE_VIDEO; }
195     std::string id() const { return { }; }
196     webrtc::RtpParameters GetParameters() const { return { }; }
197     bool SetParameters(const webrtc::RtpParameters&amp;) { return true; }
198     void SetObserver(webrtc::RtpReceiverObserverInterface*) { }
199     rtc::scoped_refptr&lt;webrtc::MediaStreamTrackInterface&gt; track() const final { return { }; }
<span class="line-added">200     void SetJitterBufferMinimumDelay(absl::optional&lt;double&gt;) final { }</span>
201 };
202 
203 class MockRtpTransceiver : public webrtc::RtpTransceiverInterface {
204 public:
205     MockRtpTransceiver(rtc::scoped_refptr&lt;webrtc::RtpSenderInterface&gt;&amp;&amp; sender, rtc::scoped_refptr&lt;webrtc::RtpReceiverInterface&gt;&amp;&amp; receiver)
206         : m_sender(WTFMove(sender))
207         , m_receiver(WTFMove(receiver))
208     {
209     }
210 
211     rtc::scoped_refptr&lt;webrtc::RtpSenderInterface&gt; sender() const final { return m_sender; }
212 
213 private:
214     cricket::MediaType media_type() const final { return m_sender-&gt;media_type(); }
215     absl::optional&lt;std::string&gt; mid() const final { return { }; }
216     rtc::scoped_refptr&lt;webrtc::RtpReceiverInterface&gt; receiver() const final { return m_receiver; }
217     bool stopped() const final { return false; }
218     webrtc::RtpTransceiverDirection direction() const final { return webrtc::RtpTransceiverDirection::kSendRecv; }
219     void SetDirection(webrtc::RtpTransceiverDirection) final { }
220     absl::optional&lt;webrtc::RtpTransceiverDirection&gt; current_direction() const final { return { }; }
</pre>
<hr />
<pre>
270     bool m_isReceivingAudio { false };
271     bool m_isReceivingVideo { false };
272     std::string m_streamLabel;
273 };
274 
275 class MockLibWebRTCPeerConnectionFactory : public webrtc::PeerConnectionFactoryInterface {
276 public:
277     static rtc::scoped_refptr&lt;webrtc::PeerConnectionFactoryInterface&gt; create(const String&amp; testCase) { return new rtc::RefCountedObject&lt;MockLibWebRTCPeerConnectionFactory&gt;(testCase); }
278 
279 protected:
280     explicit MockLibWebRTCPeerConnectionFactory(const String&amp;);
281 
282 private:
283     rtc::scoped_refptr&lt;webrtc::PeerConnectionInterface&gt; CreatePeerConnection(const webrtc::PeerConnectionInterface::RTCConfiguration&amp;, webrtc::PeerConnectionDependencies) final;
284 
285     rtc::scoped_refptr&lt;webrtc::MediaStreamInterface&gt; CreateLocalMediaStream(const std::string&amp;) final;
286 
287     void SetOptions(const Options&amp;) final { }
288     rtc::scoped_refptr&lt;webrtc::AudioSourceInterface&gt; CreateAudioSource(const cricket::AudioOptions&amp;) final { return nullptr; }
289 



290     rtc::scoped_refptr&lt;webrtc::VideoTrackInterface&gt; CreateVideoTrack(const std::string&amp;, webrtc::VideoTrackSourceInterface*) final;
291     rtc::scoped_refptr&lt;webrtc::AudioTrackInterface&gt; CreateAudioTrack(const std::string&amp;, webrtc::AudioSourceInterface*) final;
292 

293     void StopAecDump() final { }
294 
295 private:
296     String m_testCase;
297 };
298 
299 } // namespace WebCore
300 
301 #endif // USE(LIBWEBRTC)
</pre>
</td>
</tr>
</table>
<center><a href="MockLibWebRTCPeerConnection.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MockPaymentCoordinator.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>