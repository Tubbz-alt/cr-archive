<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/page/Page.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Page.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="PageConfiguration.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/page/Page.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (C) 2006-2017 Apple Inc. All rights reserved.</span>
   3  * Copyright (C) 2008 Torch Mobile Inc. All rights reserved. (http://www.torchmobile.com/)
   4  *
   5  * This library is free software; you can redistribute it and/or
   6  * modify it under the terms of the GNU Library General Public
   7  * License as published by the Free Software Foundation; either
   8  * version 2 of the License, or (at your option) any later version.
   9  *
  10  * This library is distributed in the hope that it will be useful,
  11  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  12  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  13  * Library General Public License for more details.
  14  *
  15  * You should have received a copy of the GNU Library General Public License
  16  * along with this library; see the file COPYING.LIB.  If not, write to
  17  * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
  18  * Boston, MA 02110-1301, USA.
  19  */
  20 
  21 #pragma once
  22 
  23 #include &quot;ActivityState.h&quot;
  24 #include &quot;DisabledAdaptations.h&quot;
  25 #include &quot;Document.h&quot;
  26 #include &quot;FindOptions.h&quot;
  27 #include &quot;FrameLoaderTypes.h&quot;
  28 #include &quot;LayoutMilestone.h&quot;
  29 #include &quot;LayoutRect.h&quot;
  30 #include &quot;LengthBox.h&quot;
  31 #include &quot;MediaProducer.h&quot;
  32 #include &quot;Pagination.h&quot;
  33 #include &quot;RTCController.h&quot;
  34 #include &quot;Region.h&quot;
  35 #include &quot;RegistrableDomain.h&quot;
  36 #include &quot;RenderingUpdateScheduler.h&quot;
  37 #include &quot;ScrollTypes.h&quot;
  38 #include &quot;Supplementable.h&quot;
  39 #include &quot;Timer.h&quot;
  40 #include &quot;UserInterfaceLayoutDirection.h&quot;
  41 #include &quot;ViewportArguments.h&quot;
  42 #include &quot;VisibilityState.h&quot;
<span class="line-modified">  43 #include &quot;WheelEventTestTrigger.h&quot;</span>
  44 #include &lt;memory&gt;
  45 #include &lt;pal/SessionID.h&gt;
  46 #include &lt;wtf/Assertions.h&gt;
  47 #include &lt;wtf/Forward.h&gt;
  48 #include &lt;wtf/Function.h&gt;
  49 #include &lt;wtf/HashSet.h&gt;
  50 #include &lt;wtf/Noncopyable.h&gt;
  51 #include &lt;wtf/Ref.h&gt;
  52 #include &lt;wtf/UniqueRef.h&gt;
  53 #include &lt;wtf/WeakPtr.h&gt;
  54 #include &lt;wtf/text/WTFString.h&gt;
  55 
  56 #if PLATFORM(COCOA)
  57 #include &lt;wtf/SchedulePair.h&gt;
  58 #endif
  59 
  60 #if ENABLE(APPLICATION_MANIFEST)
  61 #include &quot;ApplicationManifest.h&quot;
  62 #endif
  63 
  64 #if ENABLE(MEDIA_SESSION)
  65 #include &quot;MediaSessionEvents.h&quot;
  66 #endif
  67 
  68 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
  69 #include &quot;MediaPlaybackTargetContext.h&quot;
  70 #endif
  71 




  72 namespace JSC {
  73 class Debugger;
  74 }
  75 
  76 namespace WebCore {
  77 
  78 namespace IDBClient {
  79 class IDBConnectionToServer;
  80 }
  81 

  82 class AlternativeTextClient;
  83 class ApplicationCacheStorage;
  84 class AuthenticatorCoordinator;
  85 class BackForwardController;
<span class="line-removed">  86 class BackForwardClient;</span>
  87 class CacheStorageProvider;
  88 class Chrome;
<span class="line-removed">  89 class ChromeClient;</span>
  90 class Color;
<span class="line-removed">  91 class ContextMenuClient;</span>
  92 class ContextMenuController;
  93 class CookieJar;
<span class="line-removed">  94 class DOMRect;</span>
  95 class DOMRectList;
  96 class DatabaseProvider;
  97 class DiagnosticLoggingClient;
  98 class DragCaretController;
<span class="line-removed">  99 class DragClient;</span>
 100 class DragController;
 101 class EditorClient;
 102 class Element;
 103 class FocusController;
 104 class Frame;
<span class="line-removed"> 105 class FrameLoaderClient;</span>
<span class="line-removed"> 106 class HistoryItem;</span>
 107 class HTMLMediaElement;
<span class="line-modified"> 108 class UserInputBridge;</span>
 109 class InspectorClient;
 110 class InspectorController;
 111 class LibWebRTCProvider;
 112 class LowPowerModeNotifier;
 113 class MediaCanStartListener;
 114 class MediaPlaybackTarget;

 115 class PageConfiguration;
 116 class PageConsoleClient;
 117 class PageDebuggable;
 118 class PageGroup;
 119 class PageOverlayController;
 120 class PaymentCoordinator;
 121 class PerformanceLogging;
 122 class PerformanceLoggingClient;
 123 class PerformanceMonitor;
 124 class PlugInClient;
 125 class PluginData;
 126 class PluginInfoProvider;
 127 class PluginViewBase;
 128 class PointerCaptureController;
 129 class PointerLockController;
 130 class ProgressTracker;
<span class="line-removed"> 131 class ProgressTrackerClient;</span>
 132 class Range;
 133 class RenderObject;
<span class="line-removed"> 134 class RenderTheme;</span>
 135 class ResourceUsageOverlay;
<span class="line-removed"> 136 class VisibleSelection;</span>
 137 class ScrollLatchingState;
<span class="line-removed"> 138 class ScrollableArea;</span>
 139 class ScrollingCoordinator;
 140 class ServicesOverlayController;
 141 class Settings;
 142 class SocketProvider;

 143 class StorageNamespace;
 144 class StorageNamespaceProvider;
 145 class UserContentProvider;


 146 class ValidationMessageClient;
<span class="line-modified"> 147 class ActivityStateChangeObserver;</span>
 148 class VisitedLinkStore;
 149 class WebGLStateTracker;
<span class="line-removed"> 150 class SpeechSynthesisClient;</span>
 151 class WheelEventDeltaFilter;
 152 
<span class="line-modified"> 153 typedef uint64_t SharedStringHash;</span>
 154 
<span class="line-modified"> 155 enum FindDirection {</span>
<span class="line-modified"> 156     FindDirectionForward,</span>
<span class="line-modified"> 157     FindDirectionBackward</span>
<span class="line-modified"> 158 };</span>
 159 
<span class="line-modified"> 160 enum class EventThrottlingBehavior {</span>
<span class="line-removed"> 161     Responsive,</span>
<span class="line-removed"> 162     Unresponsive</span>
<span class="line-removed"> 163 };</span>
 164 
<span class="line-modified"> 165 enum class CompositingPolicy : uint8_t {</span>
 166     Normal,
 167     Conservative, // Used in low memory situations.
 168 };
 169 
<span class="line-removed"> 170 enum class CanWrap : bool;</span>
<span class="line-removed"> 171 enum class DidWrap : bool;</span>
<span class="line-removed"> 172 enum class RouteSharingPolicy : uint8_t;</span>
<span class="line-removed"> 173 enum class ShouldTreatAsContinuingLoad : bool;</span>
<span class="line-removed"> 174 </span>
 175 class Page : public Supplementable&lt;Page&gt;, public CanMakeWeakPtr&lt;Page&gt; {
 176     WTF_MAKE_NONCOPYABLE(Page);
 177     WTF_MAKE_FAST_ALLOCATED;
 178     friend class SettingsBase;
 179 
 180 public:
 181     WEBCORE_EXPORT static void updateStyleForAllPagesAfterGlobalChangeInEnvironment();
 182     WEBCORE_EXPORT static void clearPreviousItemFromAllPages(HistoryItem*);
 183 
 184     void updateStyleAfterChangeInEnvironment();
 185 
 186     WEBCORE_EXPORT explicit Page(PageConfiguration&amp;&amp;);
 187     WEBCORE_EXPORT ~Page();
 188 
 189     WEBCORE_EXPORT uint64_t renderTreeSize() const;
 190 
 191     WEBCORE_EXPORT void setNeedsRecalcStyleInAllFrames();
 192 
 193     WEBCORE_EXPORT OptionSet&lt;DisabledAdaptations&gt; disabledAdaptations() const;
 194     WEBCORE_EXPORT ViewportArguments viewportArguments() const;
 195 
 196     const Optional&lt;ViewportArguments&gt;&amp; overrideViewportArguments() const { return m_overrideViewportArguments; }
 197     WEBCORE_EXPORT void setOverrideViewportArguments(const Optional&lt;ViewportArguments&gt;&amp;);
 198 
 199     static void refreshPlugins(bool reload);
 200     WEBCORE_EXPORT PluginData&amp; pluginData();
 201     void clearPluginData();
 202 
 203     WEBCORE_EXPORT void setCanStartMedia(bool);
 204     bool canStartMedia() const { return m_canStartMedia; }
 205 
 206     EditorClient&amp; editorClient() { return m_editorClient.get(); }
<span class="line-modified"> 207     PlugInClient* plugInClient() const { return m_plugInClient; }</span>
 208 
 209     Frame&amp; mainFrame() { return m_mainFrame.get(); }
 210     const Frame&amp; mainFrame() const { return m_mainFrame.get(); }
 211 
 212     bool openedByDOM() const;
 213     void setOpenedByDOM();
 214 
 215     bool openedByDOMWithOpener() const { return m_openedByDOMWithOpener; }
 216     void setOpenedByDOMWithOpener() { m_openedByDOMWithOpener = true; }
 217 
 218     WEBCORE_EXPORT void goToItem(HistoryItem&amp;, FrameLoadType, ShouldTreatAsContinuingLoad);
 219 
 220     WEBCORE_EXPORT void setGroupName(const String&amp;);
 221     WEBCORE_EXPORT const String&amp; groupName() const;
 222 
 223     PageGroup&amp; group();
 224 
 225     WEBCORE_EXPORT static void forEachPage(const WTF::Function&lt;void(Page&amp;)&gt;&amp;);
 226 
 227     void incrementSubframeCount() { ++m_subframeCount; }
</pre>
<hr />
<pre>
 288 
 289     Seconds domTimerAlignmentInterval() const { return m_domTimerAlignmentInterval; }
 290 
 291     void setTabKeyCyclesThroughElements(bool b) { m_tabKeyCyclesThroughElements = b; }
 292     bool tabKeyCyclesThroughElements() const { return m_tabKeyCyclesThroughElements; }
 293 
 294     WEBCORE_EXPORT bool findString(const String&amp;, FindOptions, DidWrap* = nullptr);
 295     WEBCORE_EXPORT uint32_t replaceRangesWithText(const Vector&lt;Ref&lt;Range&gt;&gt;&amp; rangesToReplace, const String&amp; replacementText, bool selectionOnly);
 296     WEBCORE_EXPORT uint32_t replaceSelectionWithText(const String&amp; replacementText);
 297 
 298     WEBCORE_EXPORT RefPtr&lt;Range&gt; rangeOfString(const String&amp;, Range*, FindOptions);
 299 
 300     WEBCORE_EXPORT unsigned countFindMatches(const String&amp;, FindOptions, unsigned maxMatchCount);
 301     WEBCORE_EXPORT unsigned markAllMatchesForText(const String&amp;, FindOptions, bool shouldHighlight, unsigned maxMatchCount);
 302 
 303     WEBCORE_EXPORT void unmarkAllTextMatches();
 304 
 305     WEBCORE_EXPORT void dispatchBeforePrintEvent();
 306     WEBCORE_EXPORT void dispatchAfterPrintEvent();
 307 
<span class="line-modified"> 308     // find all the Ranges for the matching text.</span>
 309     // Upon return, indexForSelection will be one of the following:
 310     // 0 if there is no user selection
 311     // the index of the first range after the user selection
 312     // NoMatchAfterUserSelection if there is no matching text after the user selection.
 313     enum { NoMatchAfterUserSelection = -1 };
 314     WEBCORE_EXPORT void findStringMatchingRanges(const String&amp;, FindOptions, int maxCount, Vector&lt;RefPtr&lt;Range&gt;&gt;&amp;, int&amp; indexForSelection);

 315 #if PLATFORM(COCOA)
 316     void platformInitialize();
 317     WEBCORE_EXPORT void addSchedulePair(Ref&lt;SchedulePair&gt;&amp;&amp;);
 318     WEBCORE_EXPORT void removeSchedulePair(Ref&lt;SchedulePair&gt;&amp;&amp;);
 319     SchedulePairHashSet* scheduledRunLoopPairs() { return m_scheduledRunLoopPairs.get(); }
 320 
 321     std::unique_ptr&lt;SchedulePairHashSet&gt; m_scheduledRunLoopPairs;
 322 #endif
 323 
 324     WEBCORE_EXPORT const VisibleSelection&amp; selection() const;
 325 
 326     WEBCORE_EXPORT void setDefersLoading(bool);
 327     bool defersLoading() const { return m_defersLoading; }
 328 
 329     WEBCORE_EXPORT void clearUndoRedoOperations();
 330 
 331     WEBCORE_EXPORT bool inLowQualityImageInterpolationMode() const;
 332     WEBCORE_EXPORT void setInLowQualityImageInterpolationMode(bool = true);
 333 
 334     float mediaVolume() const { return m_mediaVolume; }
 335     WEBCORE_EXPORT void setMediaVolume(float);
 336 
 337     WEBCORE_EXPORT void setPageScaleFactor(float scale, const IntPoint&amp; origin, bool inStableState = true);
 338     float pageScaleFactor() const { return m_pageScaleFactor; }
 339 
 340     UserInterfaceLayoutDirection userInterfaceLayoutDirection() const { return m_userInterfaceLayoutDirection; }
 341     WEBCORE_EXPORT void setUserInterfaceLayoutDirection(UserInterfaceLayoutDirection);
 342 
 343     WEBCORE_EXPORT void updateMediaElementRateChangeRestrictions();
 344 
 345     void didStartProvisionalLoad();
 346     void didFinishLoad(); // Called when the load has been committed in the main frame.
 347 



 348     // The view scale factor is multiplied into the page scale factor by all
 349     // callers of setPageScaleFactor.
 350     WEBCORE_EXPORT void setViewScaleFactor(float);
 351     float viewScaleFactor() const { return m_viewScaleFactor; }
 352 
 353     WEBCORE_EXPORT void setZoomedOutPageScaleFactor(float);
 354     float zoomedOutPageScaleFactor() const { return m_zoomedOutPageScaleFactor; }
 355 
 356     float deviceScaleFactor() const { return m_deviceScaleFactor; }
 357     WEBCORE_EXPORT void setDeviceScaleFactor(float);
 358 
 359     float initialScale() const { return m_initialScale; }
 360     WEBCORE_EXPORT void setInitialScale(float);
 361 
 362     float topContentInset() const { return m_topContentInset; }
 363     WEBCORE_EXPORT void setTopContentInset(float);
 364 
 365     const FloatBoxExtent&amp; obscuredInsets() const { return m_obscuredInsets; }
 366     void setObscuredInsets(const FloatBoxExtent&amp; obscuredInsets) { m_obscuredInsets = obscuredInsets; }
 367 
</pre>
<hr />
<pre>
 396 
 397     const Seconds fullscreenAutoHideDuration() const { return m_fullscreenAutoHideDuration; }
 398     WEBCORE_EXPORT void setFullscreenAutoHideDuration(Seconds);
 399     WEBCORE_EXPORT void setFullscreenControlsHidden(bool);
 400 
 401     bool shouldSuppressScrollbarAnimations() const { return m_suppressScrollbarAnimations; }
 402     WEBCORE_EXPORT void setShouldSuppressScrollbarAnimations(bool suppressAnimations);
 403     void lockAllOverlayScrollbarsToHidden(bool lockOverlayScrollbars);
 404 
 405     WEBCORE_EXPORT void setVerticalScrollElasticity(ScrollElasticity);
 406     ScrollElasticity verticalScrollElasticity() const { return static_cast&lt;ScrollElasticity&gt;(m_verticalScrollElasticity); }
 407 
 408     WEBCORE_EXPORT void setHorizontalScrollElasticity(ScrollElasticity);
 409     ScrollElasticity horizontalScrollElasticity() const { return static_cast&lt;ScrollElasticity&gt;(m_horizontalScrollElasticity); }
 410 
 411     WEBCORE_EXPORT void accessibilitySettingsDidChange();
 412     WEBCORE_EXPORT void appearanceDidChange();
 413 
 414     // Page and FrameView both store a Pagination value. Page::pagination() is set only by API,
 415     // and FrameView::pagination() is set only by CSS. Page::pagination() will affect all
<span class="line-modified"> 416     // FrameViews in the page cache, but FrameView::pagination() only affects the current</span>
 417     // FrameView.
 418     const Pagination&amp; pagination() const { return m_pagination; }
 419     WEBCORE_EXPORT void setPagination(const Pagination&amp;);
 420     bool paginationLineGridEnabled() const { return m_paginationLineGridEnabled; }
 421     WEBCORE_EXPORT void setPaginationLineGridEnabled(bool flag);
 422 
 423     WEBCORE_EXPORT unsigned pageCount() const;
 424 
 425     WEBCORE_EXPORT DiagnosticLoggingClient&amp; diagnosticLoggingClient() const;
 426 
 427     PerformanceLoggingClient* performanceLoggingClient() const { return m_performanceLoggingClient.get(); }
 428 
 429     WheelEventDeltaFilter* wheelEventDeltaFilter() { return m_recentWheelEventDeltaFilter.get(); }
 430     PageOverlayController&amp; pageOverlayController() { return *m_pageOverlayController; }
 431 
<span class="line-modified"> 432 #if PLATFORM(MAC)</span>
<span class="line-removed"> 433 #if ENABLE(SERVICE_CONTROLS) || ENABLE(TELEPHONE_NUMBER_DETECTION)</span>
 434     ServicesOverlayController&amp; servicesOverlayController() { return *m_servicesOverlayController; }
<span class="line-modified"> 435 #endif // ENABLE(SERVICE_CONTROLS) || ENABLE(TELEPHONE_NUMBER_DETECTION)</span>
 436 

 437     ScrollLatchingState* latchingState();
 438     void pushNewLatchingState();
 439     void popLatchingState();
 440     void resetLatchingState();
 441     void removeLatchingStateForTarget(Element&amp;);
 442 #endif // PLATFORM(MAC)
 443 
 444 #if ENABLE(APPLE_PAY)
 445     PaymentCoordinator&amp; paymentCoordinator() const { return *m_paymentCoordinator; }
 446     WEBCORE_EXPORT void setPaymentCoordinator(std::unique_ptr&lt;PaymentCoordinator&gt;&amp;&amp;);
 447 #endif
 448 
 449 #if ENABLE(WEB_AUTHN)
 450     AuthenticatorCoordinator&amp; authenticatorCoordinator() { return m_authenticatorCoordinator.get(); }
 451 #endif
 452 
 453 #if ENABLE(APPLICATION_MANIFEST)
 454     const Optional&lt;ApplicationManifest&gt;&amp; applicationManifest() const { return m_applicationManifest; }
 455 #endif
 456 
</pre>
<hr />
<pre>
 531     WEBCORE_EXPORT void removeLayoutMilestones(OptionSet&lt;LayoutMilestone&gt;);
 532     OptionSet&lt;LayoutMilestone&gt; requestedLayoutMilestones() const { return m_requestedLayoutMilestones; }
 533 
 534     WEBCORE_EXPORT void setHeaderHeight(int);
 535     WEBCORE_EXPORT void setFooterHeight(int);
 536 
 537     int headerHeight() const { return m_headerHeight; }
 538     int footerHeight() const { return m_footerHeight; }
 539 
 540     WEBCORE_EXPORT Color pageExtendedBackgroundColor() const;
 541 
 542     bool isCountingRelevantRepaintedObjects() const;
 543     void setIsCountingRelevantRepaintedObjects(bool isCounting) { m_isCountingRelevantRepaintedObjects = isCounting; }
 544     void startCountingRelevantRepaintedObjects();
 545     void resetRelevantPaintedObjectCounter();
 546     void addRelevantRepaintedObject(RenderObject*, const LayoutRect&amp; objectPaintRect);
 547     void addRelevantUnpaintedObject(RenderObject*, const LayoutRect&amp; objectPaintRect);
 548 
 549     WEBCORE_EXPORT void suspendActiveDOMObjectsAndAnimations();
 550     WEBCORE_EXPORT void resumeActiveDOMObjectsAndAnimations();
<span class="line-removed"> 551     void suspendDeviceMotionAndOrientationUpdates();</span>
<span class="line-removed"> 552     void resumeDeviceMotionAndOrientationUpdates();</span>
 553 
 554 #ifndef NDEBUG
 555     void setIsPainting(bool painting) { m_isPainting = painting; }
 556     bool isPainting() const { return m_isPainting; }
 557 #endif
 558 
<span class="line-modified"> 559     AlternativeTextClient* alternativeTextClient() const { return m_alternativeTextClient; }</span>
 560 
 561     bool hasSeenPlugin(const String&amp; serviceType) const;
 562     WEBCORE_EXPORT bool hasSeenAnyPlugin() const;
 563     void sawPlugin(const String&amp; serviceType);
 564     void resetSeenPlugins();
 565 
 566     bool hasSeenMediaEngine(const String&amp; engineName) const;
 567     bool hasSeenAnyMediaEngine() const;
 568     void sawMediaEngine(const String&amp; engineName);
 569     void resetSeenMediaEngines();
 570 
 571     PageConsoleClient&amp; console() { return *m_consoleClient; }
 572 
 573 #if ENABLE(REMOTE_INSPECTOR)
 574     PageDebuggable&amp; inspectorDebuggable() const { return *m_inspectorDebuggable.get(); }
 575 #endif
 576 
 577     void hiddenPageCSSAnimationSuspensionStateChanged();
 578 
 579 #if ENABLE(VIDEO_TRACK)
 580     void captionPreferencesChanged();
 581 #endif
 582 
 583     void forbidPrompts();
 584     void allowPrompts();
 585     bool arePromptsAllowed();
 586 




 587     void mainFrameLoadStarted(const URL&amp;, FrameLoadType);
 588 
 589     void setLastSpatialNavigationCandidateCount(unsigned count) { m_lastSpatialNavigationCandidatesCount = count; }
 590     unsigned lastSpatialNavigationCandidateCount() const { return m_lastSpatialNavigationCandidatesCount; }
 591 
 592     ApplicationCacheStorage&amp; applicationCacheStorage() { return m_applicationCacheStorage; }
 593     DatabaseProvider&amp; databaseProvider() { return m_databaseProvider; }
 594     CacheStorageProvider&amp; cacheStorageProvider() { return m_cacheStorageProvider; }
 595     SocketProvider&amp; socketProvider() { return m_socketProvider; }

 596     CookieJar&amp; cookieJar() { return m_cookieJar.get(); }
 597 
 598     StorageNamespaceProvider&amp; storageNamespaceProvider() { return m_storageNamespaceProvider.get(); }
 599 
 600     PluginInfoProvider&amp; pluginInfoProvider();
 601 
 602     WEBCORE_EXPORT UserContentProvider&amp; userContentProvider();
 603     WEBCORE_EXPORT void setUserContentProvider(Ref&lt;UserContentProvider&gt;&amp;&amp;);
 604 
 605     VisitedLinkStore&amp; visitedLinkStore();
 606     WEBCORE_EXPORT void setVisitedLinkStore(Ref&lt;VisitedLinkStore&gt;&amp;&amp;);
 607 
 608     WEBCORE_EXPORT PAL::SessionID sessionID() const;
 609     WEBCORE_EXPORT void setSessionID(PAL::SessionID);
<span class="line-removed"> 610     WEBCORE_EXPORT void enableLegacyPrivateBrowsing(bool privateBrowsingEnabled);</span>
 611     bool usesEphemeralSession() const { return m_sessionID.isEphemeral(); }
 612 
 613     MediaProducer::MediaStateFlags mediaState() const { return m_mediaState; }
 614     void updateIsPlayingMedia(uint64_t);
 615     MediaProducer::MutedStateFlags mutedState() const { return m_mutedState; }
 616     bool isAudioMuted() const { return m_mutedState &amp; MediaProducer::AudioIsMuted; }
 617     bool isMediaCaptureMuted() const { return m_mutedState &amp; MediaProducer::MediaStreamCaptureIsMuted; };
 618     void schedulePlaybackControlsManagerUpdate();
 619     WEBCORE_EXPORT void setMuted(MediaProducer::MutedStateFlags);
 620     WEBCORE_EXPORT void stopMediaCapture();
 621 
 622     WEBCORE_EXPORT void stopAllMediaPlayback();
 623     WEBCORE_EXPORT void suspendAllMediaPlayback();
 624     WEBCORE_EXPORT void resumeAllMediaPlayback();
 625     bool mediaPlaybackIsSuspended() const { return m_mediaPlaybackIsSuspended; }
 626     WEBCORE_EXPORT void suspendAllMediaBuffering();
 627     WEBCORE_EXPORT void resumeAllMediaBuffering();
 628     bool mediaBufferingIsSuspended() const { return m_mediaBufferingIsSuspended; }
 629 



 630 #if ENABLE(MEDIA_SESSION)
 631     WEBCORE_EXPORT void handleMediaEvent(MediaEventType);
 632     WEBCORE_EXPORT void setVolumeOfMediaElement(double, uint64_t);
 633 #endif
 634 
 635 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
 636     void addPlaybackTargetPickerClient(uint64_t);
 637     void removePlaybackTargetPickerClient(uint64_t);
 638     void showPlaybackTargetPicker(uint64_t, const IntPoint&amp;, bool, RouteSharingPolicy, const String&amp;);
 639     void playbackTargetPickerClientStateDidChange(uint64_t, MediaProducer::MediaStateFlags);
 640     WEBCORE_EXPORT void setMockMediaPlaybackTargetPickerEnabled(bool);
 641     WEBCORE_EXPORT void setMockMediaPlaybackTargetPickerState(const String&amp;, MediaPlaybackTargetContext::State);

 642 
 643     WEBCORE_EXPORT void setPlaybackTarget(uint64_t, Ref&lt;MediaPlaybackTarget&gt;&amp;&amp;);
 644     WEBCORE_EXPORT void playbackTargetAvailabilityDidChange(uint64_t, bool);
 645     WEBCORE_EXPORT void setShouldPlayToPlaybackTarget(uint64_t, bool);

 646 #endif
 647 
<span class="line-modified"> 648     RefPtr&lt;WheelEventTestTrigger&gt; testTrigger() const { return m_testTrigger; }</span>
<span class="line-modified"> 649     WEBCORE_EXPORT WheelEventTestTrigger&amp; ensureTestTrigger();</span>
<span class="line-modified"> 650     void clearTrigger() { m_testTrigger = nullptr; }</span>
<span class="line-modified"> 651     bool expectsWheelEventTriggers() const { return !!m_testTrigger; }</span>
<span class="line-removed"> 652 </span>
<span class="line-removed"> 653     void setIsForSanitizingWebContent() { m_isForSanitizingWebContent = true; }</span>
<span class="line-removed"> 654     bool isForSanitizingWebContent() const { return m_isForSanitizingWebContent; }</span>
 655 
 656 #if ENABLE(VIDEO)
 657     bool allowsMediaDocumentInlinePlayback() const { return m_allowsMediaDocumentInlinePlayback; }
 658     WEBCORE_EXPORT void setAllowsMediaDocumentInlinePlayback(bool);
 659 #endif
 660 
 661     bool allowsPlaybackControlsForAutoplayingAudio() const { return m_allowsPlaybackControlsForAutoplayingAudio; }
 662     void setAllowsPlaybackControlsForAutoplayingAudio(bool allowsPlaybackControlsForAutoplayingAudio) { m_allowsPlaybackControlsForAutoplayingAudio = allowsPlaybackControlsForAutoplayingAudio; }
 663 
 664 #if ENABLE(INDEXED_DATABASE)
 665     IDBClient::IDBConnectionToServer&amp; idbConnection();
 666     WEBCORE_EXPORT IDBClient::IDBConnectionToServer* optionalIDBConnection();
 667     WEBCORE_EXPORT void clearIDBConnection();
 668 #endif
 669 
 670     void setShowAllPlugins(bool showAll) { m_showAllPlugins = showAll; }
 671     bool showAllPlugins() const;
 672 
 673     WEBCORE_EXPORT void setDOMTimerAlignmentIntervalIncreaseLimit(Seconds);
 674 
 675     bool isControlledByAutomation() const { return m_controlledByAutomation; }
 676     void setControlledByAutomation(bool controlled) { m_controlledByAutomation = controlled; }
 677 
 678     WEBCORE_EXPORT bool isAlwaysOnLoggingAllowed() const;
 679 
 680     String captionUserPreferencesStyleSheet();
 681     void setCaptionUserPreferencesStyleSheet(const String&amp;);
 682 
<span class="line-modified"> 683     bool isResourceCachingDisabled() const { return m_resourceCachingDisabled || m_resourceCachingDisabledOverride; }</span>
<span class="line-modified"> 684     void setResourceCachingDisabled(bool disabled) { m_resourceCachingDisabled = disabled; }</span>
<span class="line-removed"> 685 </span>
<span class="line-removed"> 686     // Web Inspector can override whatever value is set via WebKit SPI, but only while it is open.</span>
<span class="line-removed"> 687     void setResourceCachingDisabledOverride(bool disabled) { m_resourceCachingDisabledOverride = disabled; }</span>
 688 
 689     Optional&lt;EventThrottlingBehavior&gt; eventThrottlingBehaviorOverride() const { return m_eventThrottlingBehaviorOverride; }
 690     void setEventThrottlingBehaviorOverride(Optional&lt;EventThrottlingBehavior&gt; throttling) { m_eventThrottlingBehaviorOverride = throttling; }
 691 
 692     Optional&lt;CompositingPolicy&gt; compositingPolicyOverride() const { return m_compositingPolicyOverride; }
 693     void setCompositingPolicyOverride(Optional&lt;CompositingPolicy&gt; policy) { m_compositingPolicyOverride = policy; }
 694 
 695 #if ENABLE(WEBGL)
 696     WebGLStateTracker* webGLStateTracker() const { return m_webGLStateTracker.get(); }
 697 #endif
 698 
 699 #if ENABLE(SPEECH_SYNTHESIS)
 700     SpeechSynthesisClient* speechSynthesisClient() const { return m_speechSynthesisClient.get(); }
 701 #endif
 702 
 703     bool isOnlyNonUtilityPage() const;
 704     bool isUtilityPage() const { return m_isUtilityPage; }
 705 
<span class="line-removed"> 706 #if ENABLE(DATA_INTERACTION)</span>
<span class="line-removed"> 707     WEBCORE_EXPORT bool hasSelectionAtPosition(const FloatPoint&amp;) const;</span>
<span class="line-removed"> 708 #endif</span>
<span class="line-removed"> 709 </span>
 710     bool isLowPowerModeEnabled() const;
 711     WEBCORE_EXPORT void setLowPowerModeEnabledOverrideForTesting(Optional&lt;bool&gt;);
 712 
 713     WEBCORE_EXPORT void applicationWillResignActive();
 714     WEBCORE_EXPORT void applicationDidEnterBackground();
 715     WEBCORE_EXPORT void applicationWillEnterForeground();
 716     WEBCORE_EXPORT void applicationDidBecomeActive();
 717 
 718     PerformanceLogging&amp; performanceLogging() const { return *m_performanceLogging; }
 719 
 720     void configureLoggingChannel(const String&amp;, WTFLogChannelState, WTFLogLevel);
 721 











 722 private:
 723     struct Navigation {
 724         RegistrableDomain domain;
 725         FrameLoadType type;
 726     };
 727     void logNavigation(const Navigation&amp;);
 728 
 729     WEBCORE_EXPORT void initGroup();
 730 
 731     void setIsInWindowInternal(bool);
 732     void setIsVisibleInternal(bool);
 733     void setIsVisuallyIdleInternal(bool);
 734 
<span class="line-removed"> 735 #if ASSERT_DISABLED</span>
<span class="line-removed"> 736     void checkSubframeCountConsistency() const { }</span>
<span class="line-removed"> 737 #else</span>
 738     void checkSubframeCountConsistency() const;
<span class="line-removed"> 739 #endif</span>
 740 
 741     enum ShouldHighlightMatches { DoNotHighlightMatches, HighlightMatches };
 742     enum ShouldMarkMatches { DoNotMarkMatches, MarkMatches };
 743 
 744     unsigned findMatchesForText(const String&amp;, FindOptions, unsigned maxMatchCount, ShouldHighlightMatches, ShouldMarkMatches);
 745 
 746     Optional&lt;std::pair&lt;MediaCanStartListener&amp;, Document&amp;&gt;&gt; takeAnyMediaCanStartListener();
 747 
 748 #if ENABLE(VIDEO)
 749     void playbackControlsManagerUpdateTimerFired();
 750 #endif
 751 
 752     Vector&lt;Ref&lt;PluginViewBase&gt;&gt; pluginViews();
 753 
 754     void handleLowModePowerChange(bool);
 755 
<span class="line-removed"> 756     void forEachDocument(const WTF::Function&lt;void(Document&amp;)&gt;&amp;);</span>
<span class="line-removed"> 757 </span>
 758     enum class TimerThrottlingState { Disabled, Enabled, EnabledIncreasing };
 759     void hiddenPageDOMTimerThrottlingStateChanged();
 760     void setTimerThrottlingState(TimerThrottlingState);
 761     void updateTimerThrottlingState();
 762     void updateDOMTimerAlignmentInterval();
 763     void domTimerAlignmentIntervalIncreaseTimerFired();
 764 
 765     const std::unique_ptr&lt;Chrome&gt; m_chrome;
 766     const std::unique_ptr&lt;DragCaretController&gt; m_dragCaretController;
 767 
 768 #if ENABLE(DRAG_SUPPORT)
 769     const std::unique_ptr&lt;DragController&gt; m_dragController;
 770 #endif
 771     const std::unique_ptr&lt;FocusController&gt; m_focusController;
 772 #if ENABLE(CONTEXT_MENUS)
 773     const std::unique_ptr&lt;ContextMenuController&gt; m_contextMenuController;
 774 #endif
 775     const std::unique_ptr&lt;UserInputBridge&gt; m_userInputBridge;
 776     const std::unique_ptr&lt;InspectorController&gt; m_inspectorController;
 777 #if ENABLE(POINTER_EVENTS)
 778     const std::unique_ptr&lt;PointerCaptureController&gt; m_pointerCaptureController;
 779 #endif
 780 #if ENABLE(POINTER_LOCK)
 781     const std::unique_ptr&lt;PointerLockController&gt; m_pointerLockController;
 782 #endif
 783     RefPtr&lt;ScrollingCoordinator&gt; m_scrollingCoordinator;
 784 
 785     const RefPtr&lt;Settings&gt; m_settings;
 786     const std::unique_ptr&lt;ProgressTracker&gt; m_progress;
 787 
 788     const std::unique_ptr&lt;BackForwardController&gt; m_backForwardController;
 789     Ref&lt;Frame&gt; m_mainFrame;
 790 
 791     RefPtr&lt;PluginData&gt; m_pluginData;
 792 
 793     UniqueRef&lt;EditorClient&gt; m_editorClient;
<span class="line-modified"> 794     PlugInClient* m_plugInClient;</span>
 795     std::unique_ptr&lt;ValidationMessageClient&gt; m_validationMessageClient;
 796     std::unique_ptr&lt;DiagnosticLoggingClient&gt; m_diagnosticLoggingClient;
 797     std::unique_ptr&lt;PerformanceLoggingClient&gt; m_performanceLoggingClient;
 798 
 799 #if ENABLE(WEBGL)
 800     std::unique_ptr&lt;WebGLStateTracker&gt; m_webGLStateTracker;
 801 #endif
 802 
 803 #if ENABLE(SPEECH_SYNTHESIS)
 804     std::unique_ptr&lt;SpeechSynthesisClient&gt; m_speechSynthesisClient;
 805 #endif
 806 

 807     UniqueRef&lt;LibWebRTCProvider&gt; m_libWebRTCProvider;
 808     RTCController m_rtcController;
 809 
 810     int m_nestedRunLoopCount { 0 };
 811     WTF::Function&lt;void()&gt; m_unnestCallback;
 812 
 813     int m_subframeCount { 0 };
 814     String m_groupName;
 815     bool m_openedByDOM { false };
 816     bool m_openedByDOMWithOpener { false };
 817 
 818     bool m_tabKeyCyclesThroughElements { true };
 819     bool m_defersLoading { false };
 820     unsigned m_defersLoadingCallCount { 0 };
 821 
 822     bool m_inLowQualityInterpolationMode { false };
 823     bool m_areMemoryCacheClientCallsEnabled { true };
 824     float m_mediaVolume { 1 };
 825     MediaProducer::MutedStateFlags m_mutedState { MediaProducer::NoneMuted };
 826 
</pre>
<hr />
<pre>
 882 
 883     bool m_isEditable { false };
 884     bool m_isPrerender { false };
 885     OptionSet&lt;ActivityState::Flag&gt; m_activityState;
 886 
 887     OptionSet&lt;LayoutMilestone&gt; m_requestedLayoutMilestones;
 888 
 889     int m_headerHeight { 0 };
 890     int m_footerHeight { 0 };
 891 
 892     std::unique_ptr&lt;RenderingUpdateScheduler&gt; m_renderingUpdateScheduler;
 893 
 894     HashSet&lt;RenderObject*&gt; m_relevantUnpaintedRenderObjects;
 895     Region m_topRelevantPaintedRegion;
 896     Region m_bottomRelevantPaintedRegion;
 897     Region m_relevantUnpaintedRegion;
 898     bool m_isCountingRelevantRepaintedObjects { false };
 899 #ifndef NDEBUG
 900     bool m_isPainting { false };
 901 #endif
<span class="line-modified"> 902     AlternativeTextClient* m_alternativeTextClient;</span>
 903 
 904     bool m_scriptedAnimationsSuspended { false };
 905     const std::unique_ptr&lt;PageConsoleClient&gt; m_consoleClient;
 906 
 907 #if ENABLE(REMOTE_INSPECTOR)
 908     const std::unique_ptr&lt;PageDebuggable&gt; m_inspectorDebuggable;
 909 #endif
 910 
 911 #if ENABLE(INDEXED_DATABASE)
 912     RefPtr&lt;IDBClient::IDBConnectionToServer&gt; m_idbConnectionToServer;
 913 #endif
 914 
 915     HashSet&lt;String&gt; m_seenPlugins;
 916     HashSet&lt;String&gt; m_seenMediaEngines;
 917 
 918     unsigned m_lastSpatialNavigationCandidatesCount { 0 };
 919     unsigned m_forbidPromptsDepth { 0 };

 920 
 921     Ref&lt;SocketProvider&gt; m_socketProvider;
 922     Ref&lt;CookieJar&gt; m_cookieJar;
 923     Ref&lt;ApplicationCacheStorage&gt; m_applicationCacheStorage;
 924     Ref&lt;CacheStorageProvider&gt; m_cacheStorageProvider;
 925     Ref&lt;DatabaseProvider&gt; m_databaseProvider;
 926     Ref&lt;PluginInfoProvider&gt; m_pluginInfoProvider;
 927     Ref&lt;StorageNamespaceProvider&gt; m_storageNamespaceProvider;
 928     Ref&lt;UserContentProvider&gt; m_userContentProvider;
 929     Ref&lt;VisitedLinkStore&gt; m_visitedLinkStore;
<span class="line-modified"> 930     RefPtr&lt;WheelEventTestTrigger&gt; m_testTrigger;</span>
<span class="line-removed"> 931 </span>
 932     HashSet&lt;ActivityStateChangeObserver*&gt; m_activityStateChangeObservers;
 933 
 934 #if ENABLE(RESOURCE_USAGE)
 935     std::unique_ptr&lt;ResourceUsageOverlay&gt; m_resourceUsageOverlay;
 936 #endif
 937 
 938     PAL::SessionID m_sessionID;
 939 
 940     bool m_isClosing { false };
 941     bool m_isRestoringCachedPage { false };
 942 
 943     MediaProducer::MediaStateFlags m_mediaState { MediaProducer::IsNotPlaying };
 944 
 945 #if ENABLE(VIDEO)
 946     Timer m_playbackControlsManagerUpdateTimer;
 947 #endif
 948 
 949     bool m_allowsMediaDocumentInlinePlayback { false };
 950     bool m_allowsPlaybackControlsForAutoplayingAudio { false };
 951     bool m_showAllPlugins { false };
 952     bool m_controlledByAutomation { false };
<span class="line-modified"> 953     bool m_resourceCachingDisabled { false };</span>
<span class="line-removed"> 954     bool m_resourceCachingDisabledOverride { false };</span>
 955     bool m_isUtilityPage;







 956     UserInterfaceLayoutDirection m_userInterfaceLayoutDirection { UserInterfaceLayoutDirection::LTR };
 957 
 958     // For testing.
 959     Optional&lt;EventThrottlingBehavior&gt; m_eventThrottlingBehaviorOverride;
 960     Optional&lt;CompositingPolicy&gt; m_compositingPolicyOverride;
 961 
 962     std::unique_ptr&lt;PerformanceMonitor&gt; m_performanceMonitor;
 963     std::unique_ptr&lt;LowPowerModeNotifier&gt; m_lowPowerModeNotifier;
 964     Optional&lt;bool&gt; m_lowPowerModeEnabledOverrideForTesting;
 965 
 966     Optional&lt;Navigation&gt; m_navigationToLogWhenVisible;
 967 
 968     std::unique_ptr&lt;PerformanceLogging&gt; m_performanceLogging;
 969 #if PLATFORM(MAC)
 970     Vector&lt;ScrollLatchingState&gt; m_latchingState;
<span class="line-removed"> 971 #if ENABLE(SERVICE_CONTROLS) || ENABLE(TELEPHONE_NUMBER_DETECTION)</span>
<span class="line-removed"> 972     std::unique_ptr&lt;ServicesOverlayController&gt; m_servicesOverlayController;</span>
 973 #endif


 974 #endif
 975 
 976     std::unique_ptr&lt;WheelEventDeltaFilter&gt; m_recentWheelEventDeltaFilter;
 977     std::unique_ptr&lt;PageOverlayController&gt; m_pageOverlayController;
 978 
 979 #if ENABLE(APPLE_PAY)
 980     std::unique_ptr&lt;PaymentCoordinator&gt; m_paymentCoordinator;
 981 #endif
 982 
 983 #if ENABLE(WEB_AUTHN)
 984     UniqueRef&lt;AuthenticatorCoordinator&gt; m_authenticatorCoordinator;
 985 #endif
 986 
 987 #if ENABLE(APPLICATION_MANIFEST)
 988     Optional&lt;ApplicationManifest&gt; m_applicationManifest;
 989 #endif
 990 
 991     Optional&lt;ViewportArguments&gt; m_overrideViewportArguments;
 992 
<span class="line-modified"> 993     bool m_shouldEnableICECandidateFilteringByDefault { true };</span>
<span class="line-modified"> 994     bool m_mediaPlaybackIsSuspended { false };</span>
<span class="line-modified"> 995     bool m_mediaBufferingIsSuspended { false };</span>
<span class="line-removed"> 996     bool m_inUpdateRendering { false };</span>
 997 
<span class="line-modified"> 998     bool m_isForSanitizingWebContent { false };</span>
 999 };
1000 
1001 inline PageGroup&amp; Page::group()
1002 {
1003     if (!m_group)
1004         initGroup();
1005     return *m_group;
1006 }
1007 








1008 } // namespace WebCore
</pre>
</td>
<td>
<hr />
<pre>
   1 /*
<span class="line-modified">   2  * Copyright (C) 2006-2019 Apple Inc. All rights reserved.</span>
   3  * Copyright (C) 2008 Torch Mobile Inc. All rights reserved. (http://www.torchmobile.com/)
   4  *
   5  * This library is free software; you can redistribute it and/or
   6  * modify it under the terms of the GNU Library General Public
   7  * License as published by the Free Software Foundation; either
   8  * version 2 of the License, or (at your option) any later version.
   9  *
  10  * This library is distributed in the hope that it will be useful,
  11  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  12  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  13  * Library General Public License for more details.
  14  *
  15  * You should have received a copy of the GNU Library General Public License
  16  * along with this library; see the file COPYING.LIB.  If not, write to
  17  * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
  18  * Boston, MA 02110-1301, USA.
  19  */
  20 
  21 #pragma once
  22 
  23 #include &quot;ActivityState.h&quot;
  24 #include &quot;DisabledAdaptations.h&quot;
  25 #include &quot;Document.h&quot;
  26 #include &quot;FindOptions.h&quot;
  27 #include &quot;FrameLoaderTypes.h&quot;
  28 #include &quot;LayoutMilestone.h&quot;
  29 #include &quot;LayoutRect.h&quot;
  30 #include &quot;LengthBox.h&quot;
  31 #include &quot;MediaProducer.h&quot;
  32 #include &quot;Pagination.h&quot;
  33 #include &quot;RTCController.h&quot;
  34 #include &quot;Region.h&quot;
  35 #include &quot;RegistrableDomain.h&quot;
  36 #include &quot;RenderingUpdateScheduler.h&quot;
  37 #include &quot;ScrollTypes.h&quot;
  38 #include &quot;Supplementable.h&quot;
  39 #include &quot;Timer.h&quot;
  40 #include &quot;UserInterfaceLayoutDirection.h&quot;
  41 #include &quot;ViewportArguments.h&quot;
  42 #include &quot;VisibilityState.h&quot;
<span class="line-modified">  43 #include &quot;WheelEventTestMonitor.h&quot;</span>
  44 #include &lt;memory&gt;
  45 #include &lt;pal/SessionID.h&gt;
  46 #include &lt;wtf/Assertions.h&gt;
  47 #include &lt;wtf/Forward.h&gt;
  48 #include &lt;wtf/Function.h&gt;
  49 #include &lt;wtf/HashSet.h&gt;
  50 #include &lt;wtf/Noncopyable.h&gt;
  51 #include &lt;wtf/Ref.h&gt;
  52 #include &lt;wtf/UniqueRef.h&gt;
  53 #include &lt;wtf/WeakPtr.h&gt;
  54 #include &lt;wtf/text/WTFString.h&gt;
  55 
  56 #if PLATFORM(COCOA)
  57 #include &lt;wtf/SchedulePair.h&gt;
  58 #endif
  59 
  60 #if ENABLE(APPLICATION_MANIFEST)
  61 #include &quot;ApplicationManifest.h&quot;
  62 #endif
  63 
  64 #if ENABLE(MEDIA_SESSION)
  65 #include &quot;MediaSessionEvents.h&quot;
  66 #endif
  67 
  68 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
  69 #include &quot;MediaPlaybackTargetContext.h&quot;
  70 #endif
  71 
<span class="line-added">  72 #if ENABLE(DEVICE_ORIENTATION) &amp;&amp; PLATFORM(IOS_FAMILY)</span>
<span class="line-added">  73 #include &quot;DeviceOrientationUpdateProvider.h&quot;</span>
<span class="line-added">  74 #endif</span>
<span class="line-added">  75 </span>
  76 namespace JSC {
  77 class Debugger;
  78 }
  79 
  80 namespace WebCore {
  81 
  82 namespace IDBClient {
  83 class IDBConnectionToServer;
  84 }
  85 
<span class="line-added">  86 class ActivityStateChangeObserver;</span>
  87 class AlternativeTextClient;
  88 class ApplicationCacheStorage;
  89 class AuthenticatorCoordinator;
  90 class BackForwardController;

  91 class CacheStorageProvider;
  92 class Chrome;

  93 class Color;

  94 class ContextMenuController;
  95 class CookieJar;

  96 class DOMRectList;
  97 class DatabaseProvider;
  98 class DiagnosticLoggingClient;
  99 class DragCaretController;

 100 class DragController;
 101 class EditorClient;
 102 class Element;
 103 class FocusController;
 104 class Frame;


 105 class HTMLMediaElement;
<span class="line-modified"> 106 class HistoryItem;</span>
 107 class InspectorClient;
 108 class InspectorController;
 109 class LibWebRTCProvider;
 110 class LowPowerModeNotifier;
 111 class MediaCanStartListener;
 112 class MediaPlaybackTarget;
<span class="line-added"> 113 class MediaRecorderProvider;</span>
 114 class PageConfiguration;
 115 class PageConsoleClient;
 116 class PageDebuggable;
 117 class PageGroup;
 118 class PageOverlayController;
 119 class PaymentCoordinator;
 120 class PerformanceLogging;
 121 class PerformanceLoggingClient;
 122 class PerformanceMonitor;
 123 class PlugInClient;
 124 class PluginData;
 125 class PluginInfoProvider;
 126 class PluginViewBase;
 127 class PointerCaptureController;
 128 class PointerLockController;
 129 class ProgressTracker;

 130 class Range;
 131 class RenderObject;

 132 class ResourceUsageOverlay;

 133 class ScrollLatchingState;

 134 class ScrollingCoordinator;
 135 class ServicesOverlayController;
 136 class Settings;
 137 class SocketProvider;
<span class="line-added"> 138 class SpeechSynthesisClient;</span>
 139 class StorageNamespace;
 140 class StorageNamespaceProvider;
 141 class UserContentProvider;
<span class="line-added"> 142 class UserContentURLPattern;</span>
<span class="line-added"> 143 class UserInputBridge;</span>
 144 class ValidationMessageClient;
<span class="line-modified"> 145 class VisibleSelection;</span>
 146 class VisitedLinkStore;
 147 class WebGLStateTracker;

 148 class WheelEventDeltaFilter;
 149 
<span class="line-modified"> 150 using SharedStringHash = uint32_t;</span>
 151 
<span class="line-modified"> 152 enum class CanWrap : bool;</span>
<span class="line-modified"> 153 enum class DidWrap : bool;</span>
<span class="line-modified"> 154 enum class RouteSharingPolicy : uint8_t;</span>
<span class="line-modified"> 155 enum class ShouldTreatAsContinuingLoad : bool;</span>
 156 
<span class="line-modified"> 157 enum class EventThrottlingBehavior : bool { Responsive, Unresponsive };</span>



 158 
<span class="line-modified"> 159 enum class CompositingPolicy : bool {</span>
 160     Normal,
 161     Conservative, // Used in low memory situations.
 162 };
 163 





 164 class Page : public Supplementable&lt;Page&gt;, public CanMakeWeakPtr&lt;Page&gt; {
 165     WTF_MAKE_NONCOPYABLE(Page);
 166     WTF_MAKE_FAST_ALLOCATED;
 167     friend class SettingsBase;
 168 
 169 public:
 170     WEBCORE_EXPORT static void updateStyleForAllPagesAfterGlobalChangeInEnvironment();
 171     WEBCORE_EXPORT static void clearPreviousItemFromAllPages(HistoryItem*);
 172 
 173     void updateStyleAfterChangeInEnvironment();
 174 
 175     WEBCORE_EXPORT explicit Page(PageConfiguration&amp;&amp;);
 176     WEBCORE_EXPORT ~Page();
 177 
 178     WEBCORE_EXPORT uint64_t renderTreeSize() const;
 179 
 180     WEBCORE_EXPORT void setNeedsRecalcStyleInAllFrames();
 181 
 182     WEBCORE_EXPORT OptionSet&lt;DisabledAdaptations&gt; disabledAdaptations() const;
 183     WEBCORE_EXPORT ViewportArguments viewportArguments() const;
 184 
 185     const Optional&lt;ViewportArguments&gt;&amp; overrideViewportArguments() const { return m_overrideViewportArguments; }
 186     WEBCORE_EXPORT void setOverrideViewportArguments(const Optional&lt;ViewportArguments&gt;&amp;);
 187 
 188     static void refreshPlugins(bool reload);
 189     WEBCORE_EXPORT PluginData&amp; pluginData();
 190     void clearPluginData();
 191 
 192     WEBCORE_EXPORT void setCanStartMedia(bool);
 193     bool canStartMedia() const { return m_canStartMedia; }
 194 
 195     EditorClient&amp; editorClient() { return m_editorClient.get(); }
<span class="line-modified"> 196     PlugInClient* plugInClient() const { return m_plugInClient.get(); }</span>
 197 
 198     Frame&amp; mainFrame() { return m_mainFrame.get(); }
 199     const Frame&amp; mainFrame() const { return m_mainFrame.get(); }
 200 
 201     bool openedByDOM() const;
 202     void setOpenedByDOM();
 203 
 204     bool openedByDOMWithOpener() const { return m_openedByDOMWithOpener; }
 205     void setOpenedByDOMWithOpener() { m_openedByDOMWithOpener = true; }
 206 
 207     WEBCORE_EXPORT void goToItem(HistoryItem&amp;, FrameLoadType, ShouldTreatAsContinuingLoad);
 208 
 209     WEBCORE_EXPORT void setGroupName(const String&amp;);
 210     WEBCORE_EXPORT const String&amp; groupName() const;
 211 
 212     PageGroup&amp; group();
 213 
 214     WEBCORE_EXPORT static void forEachPage(const WTF::Function&lt;void(Page&amp;)&gt;&amp;);
 215 
 216     void incrementSubframeCount() { ++m_subframeCount; }
</pre>
<hr />
<pre>
 277 
 278     Seconds domTimerAlignmentInterval() const { return m_domTimerAlignmentInterval; }
 279 
 280     void setTabKeyCyclesThroughElements(bool b) { m_tabKeyCyclesThroughElements = b; }
 281     bool tabKeyCyclesThroughElements() const { return m_tabKeyCyclesThroughElements; }
 282 
 283     WEBCORE_EXPORT bool findString(const String&amp;, FindOptions, DidWrap* = nullptr);
 284     WEBCORE_EXPORT uint32_t replaceRangesWithText(const Vector&lt;Ref&lt;Range&gt;&gt;&amp; rangesToReplace, const String&amp; replacementText, bool selectionOnly);
 285     WEBCORE_EXPORT uint32_t replaceSelectionWithText(const String&amp; replacementText);
 286 
 287     WEBCORE_EXPORT RefPtr&lt;Range&gt; rangeOfString(const String&amp;, Range*, FindOptions);
 288 
 289     WEBCORE_EXPORT unsigned countFindMatches(const String&amp;, FindOptions, unsigned maxMatchCount);
 290     WEBCORE_EXPORT unsigned markAllMatchesForText(const String&amp;, FindOptions, bool shouldHighlight, unsigned maxMatchCount);
 291 
 292     WEBCORE_EXPORT void unmarkAllTextMatches();
 293 
 294     WEBCORE_EXPORT void dispatchBeforePrintEvent();
 295     WEBCORE_EXPORT void dispatchAfterPrintEvent();
 296 
<span class="line-modified"> 297     // Find all the Ranges for the matching text.</span>
 298     // Upon return, indexForSelection will be one of the following:
 299     // 0 if there is no user selection
 300     // the index of the first range after the user selection
 301     // NoMatchAfterUserSelection if there is no matching text after the user selection.
 302     enum { NoMatchAfterUserSelection = -1 };
 303     WEBCORE_EXPORT void findStringMatchingRanges(const String&amp;, FindOptions, int maxCount, Vector&lt;RefPtr&lt;Range&gt;&gt;&amp;, int&amp; indexForSelection);
<span class="line-added"> 304 </span>
 305 #if PLATFORM(COCOA)
 306     void platformInitialize();
 307     WEBCORE_EXPORT void addSchedulePair(Ref&lt;SchedulePair&gt;&amp;&amp;);
 308     WEBCORE_EXPORT void removeSchedulePair(Ref&lt;SchedulePair&gt;&amp;&amp;);
 309     SchedulePairHashSet* scheduledRunLoopPairs() { return m_scheduledRunLoopPairs.get(); }
 310 
 311     std::unique_ptr&lt;SchedulePairHashSet&gt; m_scheduledRunLoopPairs;
 312 #endif
 313 
 314     WEBCORE_EXPORT const VisibleSelection&amp; selection() const;
 315 
 316     WEBCORE_EXPORT void setDefersLoading(bool);
 317     bool defersLoading() const { return m_defersLoading; }
 318 
 319     WEBCORE_EXPORT void clearUndoRedoOperations();
 320 
 321     WEBCORE_EXPORT bool inLowQualityImageInterpolationMode() const;
 322     WEBCORE_EXPORT void setInLowQualityImageInterpolationMode(bool = true);
 323 
 324     float mediaVolume() const { return m_mediaVolume; }
 325     WEBCORE_EXPORT void setMediaVolume(float);
 326 
 327     WEBCORE_EXPORT void setPageScaleFactor(float scale, const IntPoint&amp; origin, bool inStableState = true);
 328     float pageScaleFactor() const { return m_pageScaleFactor; }
 329 
 330     UserInterfaceLayoutDirection userInterfaceLayoutDirection() const { return m_userInterfaceLayoutDirection; }
 331     WEBCORE_EXPORT void setUserInterfaceLayoutDirection(UserInterfaceLayoutDirection);
 332 
 333     WEBCORE_EXPORT void updateMediaElementRateChangeRestrictions();
 334 
 335     void didStartProvisionalLoad();
 336     void didFinishLoad(); // Called when the load has been committed in the main frame.
 337 
<span class="line-added"> 338     bool delegatesScaling() const { return m_delegatesScaling; }</span>
<span class="line-added"> 339     WEBCORE_EXPORT void setDelegatesScaling(bool);</span>
<span class="line-added"> 340 </span>
 341     // The view scale factor is multiplied into the page scale factor by all
 342     // callers of setPageScaleFactor.
 343     WEBCORE_EXPORT void setViewScaleFactor(float);
 344     float viewScaleFactor() const { return m_viewScaleFactor; }
 345 
 346     WEBCORE_EXPORT void setZoomedOutPageScaleFactor(float);
 347     float zoomedOutPageScaleFactor() const { return m_zoomedOutPageScaleFactor; }
 348 
 349     float deviceScaleFactor() const { return m_deviceScaleFactor; }
 350     WEBCORE_EXPORT void setDeviceScaleFactor(float);
 351 
 352     float initialScale() const { return m_initialScale; }
 353     WEBCORE_EXPORT void setInitialScale(float);
 354 
 355     float topContentInset() const { return m_topContentInset; }
 356     WEBCORE_EXPORT void setTopContentInset(float);
 357 
 358     const FloatBoxExtent&amp; obscuredInsets() const { return m_obscuredInsets; }
 359     void setObscuredInsets(const FloatBoxExtent&amp; obscuredInsets) { m_obscuredInsets = obscuredInsets; }
 360 
</pre>
<hr />
<pre>
 389 
 390     const Seconds fullscreenAutoHideDuration() const { return m_fullscreenAutoHideDuration; }
 391     WEBCORE_EXPORT void setFullscreenAutoHideDuration(Seconds);
 392     WEBCORE_EXPORT void setFullscreenControlsHidden(bool);
 393 
 394     bool shouldSuppressScrollbarAnimations() const { return m_suppressScrollbarAnimations; }
 395     WEBCORE_EXPORT void setShouldSuppressScrollbarAnimations(bool suppressAnimations);
 396     void lockAllOverlayScrollbarsToHidden(bool lockOverlayScrollbars);
 397 
 398     WEBCORE_EXPORT void setVerticalScrollElasticity(ScrollElasticity);
 399     ScrollElasticity verticalScrollElasticity() const { return static_cast&lt;ScrollElasticity&gt;(m_verticalScrollElasticity); }
 400 
 401     WEBCORE_EXPORT void setHorizontalScrollElasticity(ScrollElasticity);
 402     ScrollElasticity horizontalScrollElasticity() const { return static_cast&lt;ScrollElasticity&gt;(m_horizontalScrollElasticity); }
 403 
 404     WEBCORE_EXPORT void accessibilitySettingsDidChange();
 405     WEBCORE_EXPORT void appearanceDidChange();
 406 
 407     // Page and FrameView both store a Pagination value. Page::pagination() is set only by API,
 408     // and FrameView::pagination() is set only by CSS. Page::pagination() will affect all
<span class="line-modified"> 409     // FrameViews in the back/forward cache, but FrameView::pagination() only affects the current</span>
 410     // FrameView.
 411     const Pagination&amp; pagination() const { return m_pagination; }
 412     WEBCORE_EXPORT void setPagination(const Pagination&amp;);
 413     bool paginationLineGridEnabled() const { return m_paginationLineGridEnabled; }
 414     WEBCORE_EXPORT void setPaginationLineGridEnabled(bool flag);
 415 
 416     WEBCORE_EXPORT unsigned pageCount() const;
 417 
 418     WEBCORE_EXPORT DiagnosticLoggingClient&amp; diagnosticLoggingClient() const;
 419 
 420     PerformanceLoggingClient* performanceLoggingClient() const { return m_performanceLoggingClient.get(); }
 421 
 422     WheelEventDeltaFilter* wheelEventDeltaFilter() { return m_recentWheelEventDeltaFilter.get(); }
 423     PageOverlayController&amp; pageOverlayController() { return *m_pageOverlayController; }
 424 
<span class="line-modified"> 425 #if PLATFORM(MAC) &amp;&amp; (ENABLE(SERVICE_CONTROLS) || ENABLE(TELEPHONE_NUMBER_DETECTION))</span>

 426     ServicesOverlayController&amp; servicesOverlayController() { return *m_servicesOverlayController; }
<span class="line-modified"> 427 #endif</span>
 428 
<span class="line-added"> 429 #if PLATFORM(MAC)</span>
 430     ScrollLatchingState* latchingState();
 431     void pushNewLatchingState();
 432     void popLatchingState();
 433     void resetLatchingState();
 434     void removeLatchingStateForTarget(Element&amp;);
 435 #endif // PLATFORM(MAC)
 436 
 437 #if ENABLE(APPLE_PAY)
 438     PaymentCoordinator&amp; paymentCoordinator() const { return *m_paymentCoordinator; }
 439     WEBCORE_EXPORT void setPaymentCoordinator(std::unique_ptr&lt;PaymentCoordinator&gt;&amp;&amp;);
 440 #endif
 441 
 442 #if ENABLE(WEB_AUTHN)
 443     AuthenticatorCoordinator&amp; authenticatorCoordinator() { return m_authenticatorCoordinator.get(); }
 444 #endif
 445 
 446 #if ENABLE(APPLICATION_MANIFEST)
 447     const Optional&lt;ApplicationManifest&gt;&amp; applicationManifest() const { return m_applicationManifest; }
 448 #endif
 449 
</pre>
<hr />
<pre>
 524     WEBCORE_EXPORT void removeLayoutMilestones(OptionSet&lt;LayoutMilestone&gt;);
 525     OptionSet&lt;LayoutMilestone&gt; requestedLayoutMilestones() const { return m_requestedLayoutMilestones; }
 526 
 527     WEBCORE_EXPORT void setHeaderHeight(int);
 528     WEBCORE_EXPORT void setFooterHeight(int);
 529 
 530     int headerHeight() const { return m_headerHeight; }
 531     int footerHeight() const { return m_footerHeight; }
 532 
 533     WEBCORE_EXPORT Color pageExtendedBackgroundColor() const;
 534 
 535     bool isCountingRelevantRepaintedObjects() const;
 536     void setIsCountingRelevantRepaintedObjects(bool isCounting) { m_isCountingRelevantRepaintedObjects = isCounting; }
 537     void startCountingRelevantRepaintedObjects();
 538     void resetRelevantPaintedObjectCounter();
 539     void addRelevantRepaintedObject(RenderObject*, const LayoutRect&amp; objectPaintRect);
 540     void addRelevantUnpaintedObject(RenderObject*, const LayoutRect&amp; objectPaintRect);
 541 
 542     WEBCORE_EXPORT void suspendActiveDOMObjectsAndAnimations();
 543     WEBCORE_EXPORT void resumeActiveDOMObjectsAndAnimations();


 544 
 545 #ifndef NDEBUG
 546     void setIsPainting(bool painting) { m_isPainting = painting; }
 547     bool isPainting() const { return m_isPainting; }
 548 #endif
 549 
<span class="line-modified"> 550     AlternativeTextClient* alternativeTextClient() const { return m_alternativeTextClient.get(); }</span>
 551 
 552     bool hasSeenPlugin(const String&amp; serviceType) const;
 553     WEBCORE_EXPORT bool hasSeenAnyPlugin() const;
 554     void sawPlugin(const String&amp; serviceType);
 555     void resetSeenPlugins();
 556 
 557     bool hasSeenMediaEngine(const String&amp; engineName) const;
 558     bool hasSeenAnyMediaEngine() const;
 559     void sawMediaEngine(const String&amp; engineName);
 560     void resetSeenMediaEngines();
 561 
 562     PageConsoleClient&amp; console() { return *m_consoleClient; }
 563 
 564 #if ENABLE(REMOTE_INSPECTOR)
 565     PageDebuggable&amp; inspectorDebuggable() const { return *m_inspectorDebuggable.get(); }
 566 #endif
 567 
 568     void hiddenPageCSSAnimationSuspensionStateChanged();
 569 
 570 #if ENABLE(VIDEO_TRACK)
 571     void captionPreferencesChanged();
 572 #endif
 573 
 574     void forbidPrompts();
 575     void allowPrompts();
 576     bool arePromptsAllowed();
 577 
<span class="line-added"> 578     void forbidSynchronousLoads();</span>
<span class="line-added"> 579     void allowSynchronousLoads();</span>
<span class="line-added"> 580     bool areSynchronousLoadsAllowed();</span>
<span class="line-added"> 581 </span>
 582     void mainFrameLoadStarted(const URL&amp;, FrameLoadType);
 583 
 584     void setLastSpatialNavigationCandidateCount(unsigned count) { m_lastSpatialNavigationCandidatesCount = count; }
 585     unsigned lastSpatialNavigationCandidateCount() const { return m_lastSpatialNavigationCandidatesCount; }
 586 
 587     ApplicationCacheStorage&amp; applicationCacheStorage() { return m_applicationCacheStorage; }
 588     DatabaseProvider&amp; databaseProvider() { return m_databaseProvider; }
 589     CacheStorageProvider&amp; cacheStorageProvider() { return m_cacheStorageProvider; }
 590     SocketProvider&amp; socketProvider() { return m_socketProvider; }
<span class="line-added"> 591     MediaRecorderProvider&amp; mediaRecorderProvider() { return m_mediaRecorderProvider; }</span>
 592     CookieJar&amp; cookieJar() { return m_cookieJar.get(); }
 593 
 594     StorageNamespaceProvider&amp; storageNamespaceProvider() { return m_storageNamespaceProvider.get(); }
 595 
 596     PluginInfoProvider&amp; pluginInfoProvider();
 597 
 598     WEBCORE_EXPORT UserContentProvider&amp; userContentProvider();
 599     WEBCORE_EXPORT void setUserContentProvider(Ref&lt;UserContentProvider&gt;&amp;&amp;);
 600 
 601     VisitedLinkStore&amp; visitedLinkStore();
 602     WEBCORE_EXPORT void setVisitedLinkStore(Ref&lt;VisitedLinkStore&gt;&amp;&amp;);
 603 
 604     WEBCORE_EXPORT PAL::SessionID sessionID() const;
 605     WEBCORE_EXPORT void setSessionID(PAL::SessionID);

 606     bool usesEphemeralSession() const { return m_sessionID.isEphemeral(); }
 607 
 608     MediaProducer::MediaStateFlags mediaState() const { return m_mediaState; }
 609     void updateIsPlayingMedia(uint64_t);
 610     MediaProducer::MutedStateFlags mutedState() const { return m_mutedState; }
 611     bool isAudioMuted() const { return m_mutedState &amp; MediaProducer::AudioIsMuted; }
 612     bool isMediaCaptureMuted() const { return m_mutedState &amp; MediaProducer::MediaStreamCaptureIsMuted; };
 613     void schedulePlaybackControlsManagerUpdate();
 614     WEBCORE_EXPORT void setMuted(MediaProducer::MutedStateFlags);
 615     WEBCORE_EXPORT void stopMediaCapture();
 616 
 617     WEBCORE_EXPORT void stopAllMediaPlayback();
 618     WEBCORE_EXPORT void suspendAllMediaPlayback();
 619     WEBCORE_EXPORT void resumeAllMediaPlayback();
 620     bool mediaPlaybackIsSuspended() const { return m_mediaPlaybackIsSuspended; }
 621     WEBCORE_EXPORT void suspendAllMediaBuffering();
 622     WEBCORE_EXPORT void resumeAllMediaBuffering();
 623     bool mediaBufferingIsSuspended() const { return m_mediaBufferingIsSuspended; }
 624 
<span class="line-added"> 625     void setHasResourceLoadClient(bool has) { m_hasResourceLoadClient = has; }</span>
<span class="line-added"> 626     bool hasResourceLoadClient() const { return m_hasResourceLoadClient; }</span>
<span class="line-added"> 627 </span>
 628 #if ENABLE(MEDIA_SESSION)
 629     WEBCORE_EXPORT void handleMediaEvent(MediaEventType);
 630     WEBCORE_EXPORT void setVolumeOfMediaElement(double, uint64_t);
 631 #endif
 632 
 633 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
 634     void addPlaybackTargetPickerClient(uint64_t);
 635     void removePlaybackTargetPickerClient(uint64_t);
 636     void showPlaybackTargetPicker(uint64_t, const IntPoint&amp;, bool, RouteSharingPolicy, const String&amp;);
 637     void playbackTargetPickerClientStateDidChange(uint64_t, MediaProducer::MediaStateFlags);
 638     WEBCORE_EXPORT void setMockMediaPlaybackTargetPickerEnabled(bool);
 639     WEBCORE_EXPORT void setMockMediaPlaybackTargetPickerState(const String&amp;, MediaPlaybackTargetContext::State);
<span class="line-added"> 640     WEBCORE_EXPORT void mockMediaPlaybackTargetPickerDismissPopup();</span>
 641 
 642     WEBCORE_EXPORT void setPlaybackTarget(uint64_t, Ref&lt;MediaPlaybackTarget&gt;&amp;&amp;);
 643     WEBCORE_EXPORT void playbackTargetAvailabilityDidChange(uint64_t, bool);
 644     WEBCORE_EXPORT void setShouldPlayToPlaybackTarget(uint64_t, bool);
<span class="line-added"> 645     WEBCORE_EXPORT void playbackTargetPickerWasDismissed(uint64_t);</span>
 646 #endif
 647 
<span class="line-modified"> 648     RefPtr&lt;WheelEventTestMonitor&gt; wheelEventTestMonitor() const { return m_wheelEventTestMonitor; }</span>
<span class="line-modified"> 649     WEBCORE_EXPORT WheelEventTestMonitor&amp; ensureWheelEventTestMonitor();</span>
<span class="line-modified"> 650     void clearWheelEventTestMonitor() { m_wheelEventTestMonitor = nullptr; }</span>
<span class="line-modified"> 651     bool isMonitoringWheelEvents() const { return !!m_wheelEventTestMonitor; }</span>



 652 
 653 #if ENABLE(VIDEO)
 654     bool allowsMediaDocumentInlinePlayback() const { return m_allowsMediaDocumentInlinePlayback; }
 655     WEBCORE_EXPORT void setAllowsMediaDocumentInlinePlayback(bool);
 656 #endif
 657 
 658     bool allowsPlaybackControlsForAutoplayingAudio() const { return m_allowsPlaybackControlsForAutoplayingAudio; }
 659     void setAllowsPlaybackControlsForAutoplayingAudio(bool allowsPlaybackControlsForAutoplayingAudio) { m_allowsPlaybackControlsForAutoplayingAudio = allowsPlaybackControlsForAutoplayingAudio; }
 660 
 661 #if ENABLE(INDEXED_DATABASE)
 662     IDBClient::IDBConnectionToServer&amp; idbConnection();
 663     WEBCORE_EXPORT IDBClient::IDBConnectionToServer* optionalIDBConnection();
 664     WEBCORE_EXPORT void clearIDBConnection();
 665 #endif
 666 
 667     void setShowAllPlugins(bool showAll) { m_showAllPlugins = showAll; }
 668     bool showAllPlugins() const;
 669 
 670     WEBCORE_EXPORT void setDOMTimerAlignmentIntervalIncreaseLimit(Seconds);
 671 
 672     bool isControlledByAutomation() const { return m_controlledByAutomation; }
 673     void setControlledByAutomation(bool controlled) { m_controlledByAutomation = controlled; }
 674 
 675     WEBCORE_EXPORT bool isAlwaysOnLoggingAllowed() const;
 676 
 677     String captionUserPreferencesStyleSheet();
 678     void setCaptionUserPreferencesStyleSheet(const String&amp;);
 679 
<span class="line-modified"> 680     bool isResourceCachingDisabledByWebInspector() const { return m_resourceCachingDisabledByWebInspector; }</span>
<span class="line-modified"> 681     void setResourceCachingDisabledByWebInspector(bool disabled) { m_resourceCachingDisabledByWebInspector = disabled; }</span>



 682 
 683     Optional&lt;EventThrottlingBehavior&gt; eventThrottlingBehaviorOverride() const { return m_eventThrottlingBehaviorOverride; }
 684     void setEventThrottlingBehaviorOverride(Optional&lt;EventThrottlingBehavior&gt; throttling) { m_eventThrottlingBehaviorOverride = throttling; }
 685 
 686     Optional&lt;CompositingPolicy&gt; compositingPolicyOverride() const { return m_compositingPolicyOverride; }
 687     void setCompositingPolicyOverride(Optional&lt;CompositingPolicy&gt; policy) { m_compositingPolicyOverride = policy; }
 688 
 689 #if ENABLE(WEBGL)
 690     WebGLStateTracker* webGLStateTracker() const { return m_webGLStateTracker.get(); }
 691 #endif
 692 
 693 #if ENABLE(SPEECH_SYNTHESIS)
 694     SpeechSynthesisClient* speechSynthesisClient() const { return m_speechSynthesisClient.get(); }
 695 #endif
 696 
 697     bool isOnlyNonUtilityPage() const;
 698     bool isUtilityPage() const { return m_isUtilityPage; }
 699 




 700     bool isLowPowerModeEnabled() const;
 701     WEBCORE_EXPORT void setLowPowerModeEnabledOverrideForTesting(Optional&lt;bool&gt;);
 702 
 703     WEBCORE_EXPORT void applicationWillResignActive();
 704     WEBCORE_EXPORT void applicationDidEnterBackground();
 705     WEBCORE_EXPORT void applicationWillEnterForeground();
 706     WEBCORE_EXPORT void applicationDidBecomeActive();
 707 
 708     PerformanceLogging&amp; performanceLogging() const { return *m_performanceLogging; }
 709 
 710     void configureLoggingChannel(const String&amp;, WTFLogChannelState, WTFLogLevel);
 711 
<span class="line-added"> 712     WEBCORE_EXPORT Vector&lt;Ref&lt;Element&gt;&gt; editableElementsInRect(const FloatRect&amp;) const;</span>
<span class="line-added"> 713 </span>
<span class="line-added"> 714 #if ENABLE(DEVICE_ORIENTATION) &amp;&amp; PLATFORM(IOS_FAMILY)</span>
<span class="line-added"> 715     DeviceOrientationUpdateProvider* deviceOrientationUpdateProvider() const { return m_deviceOrientationUpdateProvider.get(); }</span>
<span class="line-added"> 716 #endif</span>
<span class="line-added"> 717 </span>
<span class="line-added"> 718     WEBCORE_EXPORT void forEachDocument(const WTF::Function&lt;void(Document&amp;)&gt;&amp;) const;</span>
<span class="line-added"> 719     void forEachMediaElement(const WTF::Function&lt;void(HTMLMediaElement&amp;)&gt;&amp;);</span>
<span class="line-added"> 720 </span>
<span class="line-added"> 721     bool shouldDisableCorsForRequestTo(const URL&amp;) const;</span>
<span class="line-added"> 722 </span>
 723 private:
 724     struct Navigation {
 725         RegistrableDomain domain;
 726         FrameLoadType type;
 727     };
 728     void logNavigation(const Navigation&amp;);
 729 
 730     WEBCORE_EXPORT void initGroup();
 731 
 732     void setIsInWindowInternal(bool);
 733     void setIsVisibleInternal(bool);
 734     void setIsVisuallyIdleInternal(bool);
 735 



 736     void checkSubframeCountConsistency() const;

 737 
 738     enum ShouldHighlightMatches { DoNotHighlightMatches, HighlightMatches };
 739     enum ShouldMarkMatches { DoNotMarkMatches, MarkMatches };
 740 
 741     unsigned findMatchesForText(const String&amp;, FindOptions, unsigned maxMatchCount, ShouldHighlightMatches, ShouldMarkMatches);
 742 
 743     Optional&lt;std::pair&lt;MediaCanStartListener&amp;, Document&amp;&gt;&gt; takeAnyMediaCanStartListener();
 744 
 745 #if ENABLE(VIDEO)
 746     void playbackControlsManagerUpdateTimerFired();
 747 #endif
 748 
 749     Vector&lt;Ref&lt;PluginViewBase&gt;&gt; pluginViews();
 750 
 751     void handleLowModePowerChange(bool);
 752 


 753     enum class TimerThrottlingState { Disabled, Enabled, EnabledIncreasing };
 754     void hiddenPageDOMTimerThrottlingStateChanged();
 755     void setTimerThrottlingState(TimerThrottlingState);
 756     void updateTimerThrottlingState();
 757     void updateDOMTimerAlignmentInterval();
 758     void domTimerAlignmentIntervalIncreaseTimerFired();
 759 
 760     const std::unique_ptr&lt;Chrome&gt; m_chrome;
 761     const std::unique_ptr&lt;DragCaretController&gt; m_dragCaretController;
 762 
 763 #if ENABLE(DRAG_SUPPORT)
 764     const std::unique_ptr&lt;DragController&gt; m_dragController;
 765 #endif
 766     const std::unique_ptr&lt;FocusController&gt; m_focusController;
 767 #if ENABLE(CONTEXT_MENUS)
 768     const std::unique_ptr&lt;ContextMenuController&gt; m_contextMenuController;
 769 #endif
 770     const std::unique_ptr&lt;UserInputBridge&gt; m_userInputBridge;
 771     const std::unique_ptr&lt;InspectorController&gt; m_inspectorController;
 772 #if ENABLE(POINTER_EVENTS)
 773     const std::unique_ptr&lt;PointerCaptureController&gt; m_pointerCaptureController;
 774 #endif
 775 #if ENABLE(POINTER_LOCK)
 776     const std::unique_ptr&lt;PointerLockController&gt; m_pointerLockController;
 777 #endif
 778     RefPtr&lt;ScrollingCoordinator&gt; m_scrollingCoordinator;
 779 
 780     const RefPtr&lt;Settings&gt; m_settings;
 781     const std::unique_ptr&lt;ProgressTracker&gt; m_progress;
 782 
 783     const std::unique_ptr&lt;BackForwardController&gt; m_backForwardController;
 784     Ref&lt;Frame&gt; m_mainFrame;
 785 
 786     RefPtr&lt;PluginData&gt; m_pluginData;
 787 
 788     UniqueRef&lt;EditorClient&gt; m_editorClient;
<span class="line-modified"> 789     std::unique_ptr&lt;PlugInClient&gt; m_plugInClient;</span>
 790     std::unique_ptr&lt;ValidationMessageClient&gt; m_validationMessageClient;
 791     std::unique_ptr&lt;DiagnosticLoggingClient&gt; m_diagnosticLoggingClient;
 792     std::unique_ptr&lt;PerformanceLoggingClient&gt; m_performanceLoggingClient;
 793 
 794 #if ENABLE(WEBGL)
 795     std::unique_ptr&lt;WebGLStateTracker&gt; m_webGLStateTracker;
 796 #endif
 797 
 798 #if ENABLE(SPEECH_SYNTHESIS)
 799     std::unique_ptr&lt;SpeechSynthesisClient&gt; m_speechSynthesisClient;
 800 #endif
 801 
<span class="line-added"> 802     UniqueRef&lt;MediaRecorderProvider&gt; m_mediaRecorderProvider;</span>
 803     UniqueRef&lt;LibWebRTCProvider&gt; m_libWebRTCProvider;
 804     RTCController m_rtcController;
 805 
 806     int m_nestedRunLoopCount { 0 };
 807     WTF::Function&lt;void()&gt; m_unnestCallback;
 808 
 809     int m_subframeCount { 0 };
 810     String m_groupName;
 811     bool m_openedByDOM { false };
 812     bool m_openedByDOMWithOpener { false };
 813 
 814     bool m_tabKeyCyclesThroughElements { true };
 815     bool m_defersLoading { false };
 816     unsigned m_defersLoadingCallCount { 0 };
 817 
 818     bool m_inLowQualityInterpolationMode { false };
 819     bool m_areMemoryCacheClientCallsEnabled { true };
 820     float m_mediaVolume { 1 };
 821     MediaProducer::MutedStateFlags m_mutedState { MediaProducer::NoneMuted };
 822 
</pre>
<hr />
<pre>
 878 
 879     bool m_isEditable { false };
 880     bool m_isPrerender { false };
 881     OptionSet&lt;ActivityState::Flag&gt; m_activityState;
 882 
 883     OptionSet&lt;LayoutMilestone&gt; m_requestedLayoutMilestones;
 884 
 885     int m_headerHeight { 0 };
 886     int m_footerHeight { 0 };
 887 
 888     std::unique_ptr&lt;RenderingUpdateScheduler&gt; m_renderingUpdateScheduler;
 889 
 890     HashSet&lt;RenderObject*&gt; m_relevantUnpaintedRenderObjects;
 891     Region m_topRelevantPaintedRegion;
 892     Region m_bottomRelevantPaintedRegion;
 893     Region m_relevantUnpaintedRegion;
 894     bool m_isCountingRelevantRepaintedObjects { false };
 895 #ifndef NDEBUG
 896     bool m_isPainting { false };
 897 #endif
<span class="line-modified"> 898     std::unique_ptr&lt;AlternativeTextClient&gt; m_alternativeTextClient;</span>
 899 
 900     bool m_scriptedAnimationsSuspended { false };
 901     const std::unique_ptr&lt;PageConsoleClient&gt; m_consoleClient;
 902 
 903 #if ENABLE(REMOTE_INSPECTOR)
 904     const std::unique_ptr&lt;PageDebuggable&gt; m_inspectorDebuggable;
 905 #endif
 906 
 907 #if ENABLE(INDEXED_DATABASE)
 908     RefPtr&lt;IDBClient::IDBConnectionToServer&gt; m_idbConnectionToServer;
 909 #endif
 910 
 911     HashSet&lt;String&gt; m_seenPlugins;
 912     HashSet&lt;String&gt; m_seenMediaEngines;
 913 
 914     unsigned m_lastSpatialNavigationCandidatesCount { 0 };
 915     unsigned m_forbidPromptsDepth { 0 };
<span class="line-added"> 916     unsigned m_forbidSynchronousLoadsDepth { 0 };</span>
 917 
 918     Ref&lt;SocketProvider&gt; m_socketProvider;
 919     Ref&lt;CookieJar&gt; m_cookieJar;
 920     Ref&lt;ApplicationCacheStorage&gt; m_applicationCacheStorage;
 921     Ref&lt;CacheStorageProvider&gt; m_cacheStorageProvider;
 922     Ref&lt;DatabaseProvider&gt; m_databaseProvider;
 923     Ref&lt;PluginInfoProvider&gt; m_pluginInfoProvider;
 924     Ref&lt;StorageNamespaceProvider&gt; m_storageNamespaceProvider;
 925     Ref&lt;UserContentProvider&gt; m_userContentProvider;
 926     Ref&lt;VisitedLinkStore&gt; m_visitedLinkStore;
<span class="line-modified"> 927     RefPtr&lt;WheelEventTestMonitor&gt; m_wheelEventTestMonitor;</span>

 928     HashSet&lt;ActivityStateChangeObserver*&gt; m_activityStateChangeObservers;
 929 
 930 #if ENABLE(RESOURCE_USAGE)
 931     std::unique_ptr&lt;ResourceUsageOverlay&gt; m_resourceUsageOverlay;
 932 #endif
 933 
 934     PAL::SessionID m_sessionID;
 935 
 936     bool m_isClosing { false };
 937     bool m_isRestoringCachedPage { false };
 938 
 939     MediaProducer::MediaStateFlags m_mediaState { MediaProducer::IsNotPlaying };
 940 
 941 #if ENABLE(VIDEO)
 942     Timer m_playbackControlsManagerUpdateTimer;
 943 #endif
 944 
 945     bool m_allowsMediaDocumentInlinePlayback { false };
 946     bool m_allowsPlaybackControlsForAutoplayingAudio { false };
 947     bool m_showAllPlugins { false };
 948     bool m_controlledByAutomation { false };
<span class="line-modified"> 949     bool m_resourceCachingDisabledByWebInspector { false };</span>

 950     bool m_isUtilityPage;
<span class="line-added"> 951     bool m_shouldEnableICECandidateFilteringByDefault { true };</span>
<span class="line-added"> 952     bool m_mediaPlaybackIsSuspended { false };</span>
<span class="line-added"> 953     bool m_mediaBufferingIsSuspended { false };</span>
<span class="line-added"> 954     bool m_inUpdateRendering { false };</span>
<span class="line-added"> 955     bool m_hasResourceLoadClient { false };</span>
<span class="line-added"> 956     bool m_delegatesScaling { false };</span>
<span class="line-added"> 957 </span>
 958     UserInterfaceLayoutDirection m_userInterfaceLayoutDirection { UserInterfaceLayoutDirection::LTR };
 959 
 960     // For testing.
 961     Optional&lt;EventThrottlingBehavior&gt; m_eventThrottlingBehaviorOverride;
 962     Optional&lt;CompositingPolicy&gt; m_compositingPolicyOverride;
 963 
 964     std::unique_ptr&lt;PerformanceMonitor&gt; m_performanceMonitor;
 965     std::unique_ptr&lt;LowPowerModeNotifier&gt; m_lowPowerModeNotifier;
 966     Optional&lt;bool&gt; m_lowPowerModeEnabledOverrideForTesting;
 967 
 968     Optional&lt;Navigation&gt; m_navigationToLogWhenVisible;
 969 
 970     std::unique_ptr&lt;PerformanceLogging&gt; m_performanceLogging;
 971 #if PLATFORM(MAC)
 972     Vector&lt;ScrollLatchingState&gt; m_latchingState;


 973 #endif
<span class="line-added"> 974 #if PLATFORM(MAC) &amp;&amp; (ENABLE(SERVICE_CONTROLS) || ENABLE(TELEPHONE_NUMBER_DETECTION))</span>
<span class="line-added"> 975     std::unique_ptr&lt;ServicesOverlayController&gt; m_servicesOverlayController;</span>
 976 #endif
 977 
 978     std::unique_ptr&lt;WheelEventDeltaFilter&gt; m_recentWheelEventDeltaFilter;
 979     std::unique_ptr&lt;PageOverlayController&gt; m_pageOverlayController;
 980 
 981 #if ENABLE(APPLE_PAY)
 982     std::unique_ptr&lt;PaymentCoordinator&gt; m_paymentCoordinator;
 983 #endif
 984 
 985 #if ENABLE(WEB_AUTHN)
 986     UniqueRef&lt;AuthenticatorCoordinator&gt; m_authenticatorCoordinator;
 987 #endif
 988 
 989 #if ENABLE(APPLICATION_MANIFEST)
 990     Optional&lt;ApplicationManifest&gt; m_applicationManifest;
 991 #endif
 992 
 993     Optional&lt;ViewportArguments&gt; m_overrideViewportArguments;
 994 
<span class="line-modified"> 995 #if ENABLE(DEVICE_ORIENTATION) &amp;&amp; PLATFORM(IOS_FAMILY)</span>
<span class="line-modified"> 996     RefPtr&lt;DeviceOrientationUpdateProvider&gt; m_deviceOrientationUpdateProvider;</span>
<span class="line-modified"> 997 #endif</span>

 998 
<span class="line-modified"> 999     Vector&lt;UserContentURLPattern&gt; m_corsDisablingPatterns;</span>
1000 };
1001 
1002 inline PageGroup&amp; Page::group()
1003 {
1004     if (!m_group)
1005         initGroup();
1006     return *m_group;
1007 }
1008 
<span class="line-added">1009 #if !ASSERT_ENABLED</span>
<span class="line-added">1010 </span>
<span class="line-added">1011 inline void Page::checkSubframeCountConsistency() const</span>
<span class="line-added">1012 {</span>
<span class="line-added">1013 }</span>
<span class="line-added">1014 </span>
<span class="line-added">1015 #endif // !ASSERT_ENABLED</span>
<span class="line-added">1016 </span>
1017 } // namespace WebCore
</pre>
</td>
</tr>
</table>
<center><a href="Page.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="PageConfiguration.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>