<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/WebCoreMacros.cmake</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="SourcesWPE.txt.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="WebCorePrefix.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/WebCoreMacros.cmake</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 47 # Helper macro which wraps generate-bindings-all.pl script.
 48 #   target is a new target name to be added
 49 #   OUTPUT_SOURCE is a list name which will contain generated sources.(eg. WebCore_SOURCES)
 50 #   INPUT_FILES are IDL files to generate.
 51 #   BASE_DIR is base directory where script is called.
 52 #   IDL_INCLUDES is value of --include argument. (eg. ${WEBCORE_DIR}/bindings/js)
 53 #   FEATURES is a value of --defines argument.
 54 #   DESTINATION is a value of --outputDir argument.
 55 #   GENERATOR is a value of --generator argument.
 56 #   SUPPLEMENTAL_DEPFILE is a value of --supplementalDependencyFile. (optional)
 57 #   PP_EXTRA_OUTPUT is extra outputs of preprocess-idls.pl. (optional)
 58 #   PP_EXTRA_ARGS is extra arguments for preprocess-idls.pl. (optional)
 59 function(GENERATE_BINDINGS target)
 60     set(options)
 61     set(oneValueArgs OUTPUT_SOURCE BASE_DIR FEATURES DESTINATION GENERATOR SUPPLEMENTAL_DEPFILE)
 62     set(multiValueArgs INPUT_FILES IDL_INCLUDES PP_EXTRA_OUTPUT PP_EXTRA_ARGS)
 63     cmake_parse_arguments(arg &quot;${options}&quot; &quot;${oneValueArgs}&quot; &quot;${multiValueArgs}&quot; ${ARGN})
 64     set(binding_generator ${WEBCORE_DIR}/bindings/scripts/generate-bindings-all.pl)
 65     set(idl_attributes_file ${WEBCORE_DIR}/bindings/scripts/IDLAttributes.json)
 66     set(idl_files_list ${CMAKE_CURRENT_BINARY_DIR}/idl_files_${target}.tmp)

 67     set(_supplemental_dependency)
 68 
 69     set(content)
 70     foreach (f ${arg_INPUT_FILES})
 71         if (NOT IS_ABSOLUTE ${f})
 72             set(f ${CMAKE_CURRENT_SOURCE_DIR}/${f})
 73         endif ()
 74         set(content &quot;${content}${f}\n&quot;)
 75     endforeach ()
 76     file(WRITE ${idl_files_list} ${content})
 77 
 78     set(args
 79         --defines ${arg_FEATURES}
 80         --generator ${arg_GENERATOR}
 81         --outputDir ${arg_DESTINATION}
 82         --idlFilesList ${idl_files_list}

 83         --preprocessor &quot;${CODE_GENERATOR_PREPROCESSOR}&quot;
 84         --idlAttributesFile ${idl_attributes_file}
 85     )
 86     if (arg_SUPPLEMENTAL_DEPFILE)
 87         list(APPEND args --supplementalDependencyFile ${arg_SUPPLEMENTAL_DEPFILE})
 88     endif ()
 89     ProcessorCount(PROCESSOR_COUNT)
 90     if (PROCESSOR_COUNT)
 91         list(APPEND args --numOfJobs ${PROCESSOR_COUNT})
 92     endif ()
<span class="line-modified"> 93 </span>
<span class="line-modified"> 94     # https://support.microsoft.com/en-in/help/830473/command-prompt-cmd-exe-command-line-string-limitation</span>
<span class="line-modified"> 95     # pass --include dir list to tmp file instead of multiple argument</span>
<span class="line-modified"> 96     if (WIN32 AND PORT STREQUAL &quot;Java&quot;)</span>
<span class="line-modified"> 97         set(include_dir_list ${CMAKE_CURRENT_BINARY_DIR}/include_dir_${target}.tmp)</span>
<span class="line-modified"> 98         set(includeDirectories)</span>
<span class="line-modified"> 99         foreach (i IN LISTS arg_IDL_INCLUDES)</span>
<span class="line-modified">100             if (IS_ABSOLUTE ${i})</span>
<span class="line-modified">101                 set(includeDirectories &quot;${includeDirectories}${i}\n&quot;)</span>
<span class="line-modified">102             else ()</span>
<span class="line-removed">103                 set(includeDirectories &quot;${includeDirectories}${CMAKE_CURRENT_SOURCE_DIR}/${i}\n&quot;)</span>
<span class="line-removed">104             endif ()</span>
<span class="line-removed">105         endforeach ()</span>
<span class="line-removed">106         file(WRITE ${include_dir_list} ${includeDirectories})</span>
<span class="line-removed">107         list(APPEND args --includeDirList ${include_dir_list})</span>
<span class="line-removed">108     else ()</span>
<span class="line-removed">109             foreach (i IN LISTS arg_IDL_INCLUDES)</span>
<span class="line-removed">110             if (IS_ABSOLUTE ${i})</span>
<span class="line-removed">111                 list(APPEND args --include ${i})</span>
<span class="line-removed">112             else ()</span>
<span class="line-removed">113                 list(APPEND args --include ${CMAKE_CURRENT_SOURCE_DIR}/${i})</span>
<span class="line-removed">114             endif ()</span>
<span class="line-removed">115         endforeach ()</span>
<span class="line-removed">116     endif ()</span>
117 
118     foreach (i IN LISTS arg_PP_EXTRA_OUTPUT)
119         list(APPEND args --ppExtraOutput ${i})
120     endforeach ()
121     foreach (i IN LISTS arg_PP_EXTRA_ARGS)
122         list(APPEND args --ppExtraArgs ${i})
123     endforeach ()
124 
125     set(common_generator_dependencies
126         ${WEBCORE_DIR}/bindings/scripts/generate-bindings.pl
127         ${SCRIPTS_BINDINGS}
128         # Changing enabled features should trigger recompiling all IDL files
129         # because some of them use #if.
130         ${CMAKE_BINARY_DIR}/cmakeconfig.h
131     )
132     if (EXISTS ${WEBCORE_DIR}/bindings/scripts/CodeGenerator${arg_GENERATOR}.pm)
133         list(APPEND common_generator_dependencies ${WEBCORE_DIR}/bindings/scripts/CodeGenerator${arg_GENERATOR}.pm)
134     endif ()
135     if (EXISTS ${arg_BASE_DIR}/CodeGenerator${arg_GENERATOR}.pm)
136         list(APPEND common_generator_dependencies ${arg_BASE_DIR}/CodeGenerator${arg_GENERATOR}.pm)
</pre>
</td>
<td>
<hr />
<pre>
 47 # Helper macro which wraps generate-bindings-all.pl script.
 48 #   target is a new target name to be added
 49 #   OUTPUT_SOURCE is a list name which will contain generated sources.(eg. WebCore_SOURCES)
 50 #   INPUT_FILES are IDL files to generate.
 51 #   BASE_DIR is base directory where script is called.
 52 #   IDL_INCLUDES is value of --include argument. (eg. ${WEBCORE_DIR}/bindings/js)
 53 #   FEATURES is a value of --defines argument.
 54 #   DESTINATION is a value of --outputDir argument.
 55 #   GENERATOR is a value of --generator argument.
 56 #   SUPPLEMENTAL_DEPFILE is a value of --supplementalDependencyFile. (optional)
 57 #   PP_EXTRA_OUTPUT is extra outputs of preprocess-idls.pl. (optional)
 58 #   PP_EXTRA_ARGS is extra arguments for preprocess-idls.pl. (optional)
 59 function(GENERATE_BINDINGS target)
 60     set(options)
 61     set(oneValueArgs OUTPUT_SOURCE BASE_DIR FEATURES DESTINATION GENERATOR SUPPLEMENTAL_DEPFILE)
 62     set(multiValueArgs INPUT_FILES IDL_INCLUDES PP_EXTRA_OUTPUT PP_EXTRA_ARGS)
 63     cmake_parse_arguments(arg &quot;${options}&quot; &quot;${oneValueArgs}&quot; &quot;${multiValueArgs}&quot; ${ARGN})
 64     set(binding_generator ${WEBCORE_DIR}/bindings/scripts/generate-bindings-all.pl)
 65     set(idl_attributes_file ${WEBCORE_DIR}/bindings/scripts/IDLAttributes.json)
 66     set(idl_files_list ${CMAKE_CURRENT_BINARY_DIR}/idl_files_${target}.tmp)
<span class="line-added"> 67     set(idl_include_list ${CMAKE_CURRENT_BINARY_DIR}/idl_include_${target}.tmp)</span>
 68     set(_supplemental_dependency)
 69 
 70     set(content)
 71     foreach (f ${arg_INPUT_FILES})
 72         if (NOT IS_ABSOLUTE ${f})
 73             set(f ${CMAKE_CURRENT_SOURCE_DIR}/${f})
 74         endif ()
 75         set(content &quot;${content}${f}\n&quot;)
 76     endforeach ()
 77     file(WRITE ${idl_files_list} ${content})
 78 
 79     set(args
 80         --defines ${arg_FEATURES}
 81         --generator ${arg_GENERATOR}
 82         --outputDir ${arg_DESTINATION}
 83         --idlFilesList ${idl_files_list}
<span class="line-added"> 84         --includeDirsList ${idl_include_list}</span>
 85         --preprocessor &quot;${CODE_GENERATOR_PREPROCESSOR}&quot;
 86         --idlAttributesFile ${idl_attributes_file}
 87     )
 88     if (arg_SUPPLEMENTAL_DEPFILE)
 89         list(APPEND args --supplementalDependencyFile ${arg_SUPPLEMENTAL_DEPFILE})
 90     endif ()
 91     ProcessorCount(PROCESSOR_COUNT)
 92     if (PROCESSOR_COUNT)
 93         list(APPEND args --numOfJobs ${PROCESSOR_COUNT})
 94     endif ()
<span class="line-modified"> 95     set(include_dir)</span>
<span class="line-modified"> 96     foreach (i IN LISTS arg_IDL_INCLUDES)</span>
<span class="line-modified"> 97         if (IS_ABSOLUTE ${i})</span>
<span class="line-modified"> 98             set(f ${i})</span>
<span class="line-modified"> 99         else ()</span>
<span class="line-modified">100             set(f ${CMAKE_CURRENT_SOURCE_DIR}/${i})</span>
<span class="line-modified">101         endif ()</span>
<span class="line-modified">102         set(include_dir &quot;${include_dir}${f}\n&quot;)</span>
<span class="line-modified">103     endforeach ()</span>
<span class="line-modified">104     file(WRITE ${idl_include_list} ${include_dir})</span>














105 
106     foreach (i IN LISTS arg_PP_EXTRA_OUTPUT)
107         list(APPEND args --ppExtraOutput ${i})
108     endforeach ()
109     foreach (i IN LISTS arg_PP_EXTRA_ARGS)
110         list(APPEND args --ppExtraArgs ${i})
111     endforeach ()
112 
113     set(common_generator_dependencies
114         ${WEBCORE_DIR}/bindings/scripts/generate-bindings.pl
115         ${SCRIPTS_BINDINGS}
116         # Changing enabled features should trigger recompiling all IDL files
117         # because some of them use #if.
118         ${CMAKE_BINARY_DIR}/cmakeconfig.h
119     )
120     if (EXISTS ${WEBCORE_DIR}/bindings/scripts/CodeGenerator${arg_GENERATOR}.pm)
121         list(APPEND common_generator_dependencies ${WEBCORE_DIR}/bindings/scripts/CodeGenerator${arg_GENERATOR}.pm)
122     endif ()
123     if (EXISTS ${arg_BASE_DIR}/CodeGenerator${arg_GENERATOR}.pm)
124         list(APPEND common_generator_dependencies ${arg_BASE_DIR}/CodeGenerator${arg_GENERATOR}.pm)
</pre>
</td>
</tr>
</table>
<center><a href="SourcesWPE.txt.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="WebCorePrefix.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>