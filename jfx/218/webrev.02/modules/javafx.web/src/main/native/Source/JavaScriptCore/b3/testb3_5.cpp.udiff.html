<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/JavaScriptCore/b3/testb3_5.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="testb3_4.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="testb3_6.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/b3/testb3_5.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -930,10 +930,82 @@</span>
      CHECK(invoke&lt;int32_t&gt;(*code, 0ll) == 0);
      CHECK(invoke&lt;int32_t&gt;(*code, 1ll) == 2);
      CHECK(invoke&lt;int32_t&gt;(*code, std::numeric_limits&lt;int32_t&gt;::max()) == std::numeric_limits&lt;int32_t&gt;::max());
  }
  
<span class="udiff-line-added">+ void testCheckAddRemoveCheckWithSExt8(int8_t value)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     Procedure proc;</span>
<span class="udiff-line-added">+     BasicBlock* root = proc.addBlock();</span>
<span class="udiff-line-added">+     Value* arg = root-&gt;appendNew&lt;Value&gt;(proc, SExt32, Origin(), root-&gt;appendNew&lt;Value&gt;(proc, SExt8, Origin(), root-&gt;appendNew&lt;Value&gt;(proc, Trunc, Origin(), root-&gt;appendNew&lt;ArgumentRegValue&gt;(proc, Origin(), GPRInfo::argumentGPR0))));</span>
<span class="udiff-line-added">+     CheckValue* checkAdd = root-&gt;appendNew&lt;CheckValue&gt;(proc, CheckAdd, Origin(), arg, arg);</span>
<span class="udiff-line-added">+     checkAdd-&gt;setGenerator(</span>
<span class="udiff-line-added">+         [&amp;] (CCallHelpers&amp; jit, const StackmapGenerationParams&amp;) {</span>
<span class="udiff-line-added">+             AllowMacroScratchRegisterUsage allowScratch(jit);</span>
<span class="udiff-line-added">+             jit.abortWithReason(B3Oops);</span>
<span class="udiff-line-added">+         });</span>
<span class="udiff-line-added">+     root-&gt;appendNewControlValue(proc, Return, Origin(), checkAdd);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     auto code = compileProc(proc);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     CHECK(invoke&lt;int64_t&gt;(*code, value) == 2ll * static_cast&lt;int32_t&gt;(value));</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ void testCheckAddRemoveCheckWithSExt16(int16_t value)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     Procedure proc;</span>
<span class="udiff-line-added">+     BasicBlock* root = proc.addBlock();</span>
<span class="udiff-line-added">+     Value* arg = root-&gt;appendNew&lt;Value&gt;(proc, SExt32, Origin(), root-&gt;appendNew&lt;Value&gt;(proc, SExt16, Origin(), root-&gt;appendNew&lt;Value&gt;(proc, Trunc, Origin(), root-&gt;appendNew&lt;ArgumentRegValue&gt;(proc, Origin(), GPRInfo::argumentGPR0))));</span>
<span class="udiff-line-added">+     CheckValue* checkAdd = root-&gt;appendNew&lt;CheckValue&gt;(proc, CheckAdd, Origin(), arg, arg);</span>
<span class="udiff-line-added">+     checkAdd-&gt;setGenerator(</span>
<span class="udiff-line-added">+         [&amp;] (CCallHelpers&amp; jit, const StackmapGenerationParams&amp;) {</span>
<span class="udiff-line-added">+             AllowMacroScratchRegisterUsage allowScratch(jit);</span>
<span class="udiff-line-added">+             jit.abortWithReason(B3Oops);</span>
<span class="udiff-line-added">+         });</span>
<span class="udiff-line-added">+     root-&gt;appendNewControlValue(proc, Return, Origin(), checkAdd);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     auto code = compileProc(proc);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     CHECK(invoke&lt;int64_t&gt;(*code, value) == 2ll * static_cast&lt;int32_t&gt;(value));</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ void testCheckAddRemoveCheckWithSExt32(int32_t value)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     Procedure proc;</span>
<span class="udiff-line-added">+     BasicBlock* root = proc.addBlock();</span>
<span class="udiff-line-added">+     Value* arg = root-&gt;appendNew&lt;Value&gt;(proc, SExt32, Origin(), root-&gt;appendNew&lt;Value&gt;(proc, Trunc, Origin(), root-&gt;appendNew&lt;ArgumentRegValue&gt;(proc, Origin(), GPRInfo::argumentGPR0)));</span>
<span class="udiff-line-added">+     CheckValue* checkAdd = root-&gt;appendNew&lt;CheckValue&gt;(proc, CheckAdd, Origin(), arg, arg);</span>
<span class="udiff-line-added">+     checkAdd-&gt;setGenerator(</span>
<span class="udiff-line-added">+         [&amp;] (CCallHelpers&amp; jit, const StackmapGenerationParams&amp;) {</span>
<span class="udiff-line-added">+             AllowMacroScratchRegisterUsage allowScratch(jit);</span>
<span class="udiff-line-added">+             jit.abortWithReason(B3Oops);</span>
<span class="udiff-line-added">+         });</span>
<span class="udiff-line-added">+     root-&gt;appendNewControlValue(proc, Return, Origin(), checkAdd);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     auto code = compileProc(proc);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     CHECK(invoke&lt;int64_t&gt;(*code, value) == 2ll * value);</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ void testCheckAddRemoveCheckWithZExt32(int32_t value)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+     Procedure proc;</span>
<span class="udiff-line-added">+     BasicBlock* root = proc.addBlock();</span>
<span class="udiff-line-added">+     Value* arg = root-&gt;appendNew&lt;Value&gt;(proc, ZExt32, Origin(), root-&gt;appendNew&lt;Value&gt;(proc, Trunc, Origin(), root-&gt;appendNew&lt;ArgumentRegValue&gt;(proc, Origin(), GPRInfo::argumentGPR0)));</span>
<span class="udiff-line-added">+     CheckValue* checkAdd = root-&gt;appendNew&lt;CheckValue&gt;(proc, CheckAdd, Origin(), arg, arg);</span>
<span class="udiff-line-added">+     checkAdd-&gt;setGenerator(</span>
<span class="udiff-line-added">+         [&amp;] (CCallHelpers&amp; jit, const StackmapGenerationParams&amp;) {</span>
<span class="udiff-line-added">+             AllowMacroScratchRegisterUsage allowScratch(jit);</span>
<span class="udiff-line-added">+             jit.abortWithReason(B3Oops);</span>
<span class="udiff-line-added">+         });</span>
<span class="udiff-line-added">+     root-&gt;appendNewControlValue(proc, Return, Origin(), checkAdd);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     auto code = compileProc(proc);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     CHECK(invoke&lt;uint64_t&gt;(*code, value) == static_cast&lt;uint64_t&gt;(2 * static_cast&lt;uint64_t&gt;(static_cast&lt;uint32_t&gt;(value))));</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
  void testCheckSubImm()
  {
      Procedure proc;
      if (proc.optLevel() &lt; 1)
          return;
</pre>
<center><a href="testb3_4.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="testb3_6.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>