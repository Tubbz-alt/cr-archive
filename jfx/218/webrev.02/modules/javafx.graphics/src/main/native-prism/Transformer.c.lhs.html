<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.graphics/src/main/native-prism/Transformer.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
    <script type="text/javascript" src="../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2012, 2013, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 #include &lt;jni.h&gt;
 27 
 28 #include &quot;Transformer.h&quot;
 29 
 30 #define this (*((Transformer *) pTransformer))
 31 
 32 #define TX_Declare(TX_TYPE)                     \
 33 static MoveToFunc       TX_TYPE ## _moveTo;     \
 34 static LineToFunc       TX_TYPE ## _lineTo;     \
 35 static QuadToFunc       TX_TYPE ## _quadTo;     \
 36 static CurveToFunc      TX_TYPE ## _curveTo;
 37 
 38 TX_Declare(Translate)
 39 TX_Declare(DeltaScale)
 40 TX_Declare(ScaleTranslate)
 41 TX_Declare(DeltaTransform)
 42 TX_Declare(Transform)
 43 
 44 static ClosePathFunc    Transformer_closePath;
 45 static PathDoneFunc     Transformer_pathDone;
 46 
 47 #define TX_Init(TX_TYPE)                          \
 48     PathConsumer_init(&amp;pTransformer-&gt;consumer,    \
 49                       TX_TYPE ## _moveTo,         \
 50                       TX_TYPE ## _lineTo,         \
 51                       TX_TYPE ## _quadTo,         \
 52                       TX_TYPE ## _curveTo,        \
 53                       Transformer_closePath,      \
 54                       Transformer_pathDone)
 55 
 56 PathConsumer *Transformer_init(Transformer *pTransformer,
 57                                PathConsumer *out,
 58                                jdouble mxx, jdouble mxy, jdouble mxt,
 59                                jdouble myx, jdouble myy, jdouble myt)
 60 {
 61     if (mxy == 0.0 &amp;&amp; myx == 0.0) {
 62         if (mxx == 1.0 &amp;&amp; myy == 1.0) {
 63             if (mxt == 0.0 &amp;&amp; myt == 0.0) {
 64                 return out;
 65             } else {
 66                 TX_Init(Translate);
 67             }
 68         } else {
 69             if (mxt == 0.0 &amp;&amp; myt == 0.0) {
 70                 TX_Init(DeltaScale);
 71             } else {
 72                 TX_Init(ScaleTranslate);
 73             }
 74         }
 75     } else if (mxt == 0.0 &amp;&amp; myt == 0.0) {
 76         TX_Init(DeltaTransform);
 77     } else {
 78         TX_Init(Transform);
 79     }
 80 
 81     this.out = out;
 82     this.mxx = mxx;
 83     this.mxy = mxy;
 84     this.mxt = mxt;
 85     this.myx = myx;
 86     this.myy = myy;
 87     this.myt = myt;
 88     return &amp;pTransformer-&gt;consumer;
 89 }
 90 
<a name="2" id="anc2"></a><span class="line-modified"> 91 static void Translate_moveTo(PathConsumer *pTransformer,</span>
 92                              jfloat x0, jfloat y0)
 93 {
<a name="3" id="anc3"></a><span class="line-modified"> 94     this.out-&gt;moveTo(this.out,</span>
 95                      (jfloat) (x0 + this.mxt),
 96                      (jfloat) (y0 + this.myt));
 97 }
 98 
<a name="4" id="anc4"></a><span class="line-modified"> 99 static void Translate_lineTo(PathConsumer *pTransformer,</span>
100                              jfloat x1, jfloat y1)
101 {
<a name="5" id="anc5"></a><span class="line-modified">102     this.out-&gt;lineTo(this.out,</span>
103                      (jfloat) (x1 + this.mxt),
104                      (jfloat) (y1 + this.myt));
105 }
106 
<a name="6" id="anc6"></a><span class="line-modified">107 static void Translate_quadTo(PathConsumer *pTransformer,</span>
108                              jfloat xc, jfloat yc,
109                              jfloat x1, jfloat y1)
110 {
<a name="7" id="anc7"></a><span class="line-modified">111     this.out-&gt;quadTo(this.out,</span>
112                      (jfloat) (xc + this.mxt),
113                      (jfloat) (yc + this.myt),
114                      (jfloat) (x1 + this.mxt),
115                      (jfloat) (y1 + this.myt));
116 }
117 
<a name="8" id="anc8"></a><span class="line-modified">118 static void Translate_curveTo(PathConsumer *pTransformer,</span>
119                               jfloat xc0, jfloat yc0,
120                               jfloat xc1, jfloat yc1,
121                               jfloat x1, jfloat y1)
122 {
<a name="9" id="anc9"></a><span class="line-modified">123     this.out-&gt;curveTo(this.out,</span>
124                       (jfloat) (xc0 + this.mxt),
125                       (jfloat) (yc0 + this.myt),
126                       (jfloat) (xc1 + this.mxt),
127                       (jfloat) (yc1 + this.myt),
128                       (jfloat) (x1  + this.mxt),
129                       (jfloat) (y1  + this.myt));
130 }
131 
<a name="10" id="anc10"></a><span class="line-modified">132 static void DeltaScale_moveTo(PathConsumer *pTransformer,</span>
133                               jfloat x0, jfloat y0)
134 {
<a name="11" id="anc11"></a><span class="line-modified">135     this.out-&gt;moveTo(this.out,</span>
136                      (jfloat) (x0 * this.mxx),
137                      (jfloat) (y0 * this.myy));
138 }
139 
<a name="12" id="anc12"></a><span class="line-modified">140 static void DeltaScale_lineTo(PathConsumer *pTransformer,</span>
141                               jfloat x1, jfloat y1)
142 {
<a name="13" id="anc13"></a><span class="line-modified">143     this.out-&gt;lineTo(this.out,</span>
144                      (jfloat) (x1 * this.mxx),
145                      (jfloat) (y1 * this.myy));
146 }
147 
<a name="14" id="anc14"></a><span class="line-modified">148 static void DeltaScale_quadTo(PathConsumer *pTransformer,</span>
149                               jfloat xc, jfloat yc,
150                               jfloat x1, jfloat y1)
151 {
<a name="15" id="anc15"></a><span class="line-modified">152     this.out-&gt;quadTo(this.out,</span>
153                      (jfloat) (xc * this.mxx),
154                      (jfloat) (yc * this.myy),
155                      (jfloat) (x1 * this.mxx),
156                      (jfloat) (y1 * this.myy));
157 }
158 
<a name="16" id="anc16"></a><span class="line-modified">159 static void DeltaScale_curveTo(PathConsumer *pTransformer,</span>
160                                jfloat xc0, jfloat yc0,
161                                jfloat xc1, jfloat yc1,
162                                jfloat x1, jfloat y1)
163 {
<a name="17" id="anc17"></a><span class="line-modified">164     this.out-&gt;curveTo(this.out,</span>
165                       (jfloat) (xc0 * this.mxx),
166                       (jfloat) (yc0 * this.myy),
167                       (jfloat) (xc1 * this.mxx),
168                       (jfloat) (yc1 * this.myy),
169                       (jfloat) (x1  * this.mxx),
170                       (jfloat) (y1  * this.myy));
171 }
172 
<a name="18" id="anc18"></a><span class="line-modified">173 static void DeltaTransform_moveTo(PathConsumer *pTransformer,</span>
174                                   jfloat x0, jfloat y0)
175 {
<a name="19" id="anc19"></a><span class="line-modified">176     this.out-&gt;moveTo(this.out,</span>
177                      (jfloat) (x0 * this.mxx + y0 * this.mxy),
178                      (jfloat) (x0 * this.myx + y0 * this.myy));
179 }
180 
<a name="20" id="anc20"></a><span class="line-modified">181 static void DeltaTransform_lineTo(PathConsumer *pTransformer,</span>
182                                   jfloat x1, jfloat y1)
183 {
<a name="21" id="anc21"></a><span class="line-modified">184     this.out-&gt;lineTo(this.out,</span>
185                      (jfloat) (x1 * this.mxx + y1 * this.mxy),
186                      (jfloat) (x1 * this.myx + y1 * this.myy));
187 }
188 
<a name="22" id="anc22"></a><span class="line-modified">189 static void DeltaTransform_quadTo(PathConsumer *pTransformer,</span>
190                                   jfloat xc, jfloat yc,
191                                   jfloat x1, jfloat y1)
192 {
<a name="23" id="anc23"></a><span class="line-modified">193     this.out-&gt;quadTo(this.out,</span>
194                      (jfloat) (xc * this.mxx + yc * this.mxy),
195                      (jfloat) (xc * this.myx + yc * this.myy),
196                      (jfloat) (x1 * this.mxx + y1 * this.mxy),
197                      (jfloat) (x1 * this.myx + y1 * this.myy));
198 }
199 
<a name="24" id="anc24"></a><span class="line-modified">200 static void DeltaTransform_curveTo(PathConsumer *pTransformer,</span>
201                                    jfloat xc0, jfloat yc0,
202                                    jfloat xc1, jfloat yc1,
203                                    jfloat x1, jfloat y1)
204 {
<a name="25" id="anc25"></a><span class="line-modified">205     this.out-&gt;curveTo(this.out,</span>
206                       (jfloat) (xc0 * this.mxx + yc0 * this.mxy),
207                       (jfloat) (xc0 * this.myx + yc0 * this.myy),
208                       (jfloat) (xc1 * this.mxx + yc1 * this.mxy),
209                       (jfloat) (xc1 * this.myx + yc1 * this.myy),
210                       (jfloat) (x1  * this.mxx + y1  * this.mxy),
211                       (jfloat) (x1  * this.myx + y1  * this.myy));
212 }
213 
<a name="26" id="anc26"></a><span class="line-modified">214 static void ScaleTranslate_moveTo(PathConsumer *pTransformer,</span>
215                                   jfloat x0, jfloat y0)
216 {
<a name="27" id="anc27"></a><span class="line-modified">217     this.out-&gt;moveTo(this.out,</span>
218                      (jfloat) (x0 * this.mxx + this.mxt),
219                      (jfloat) (y0 * this.myy + this.myt));
220 }
221 
<a name="28" id="anc28"></a><span class="line-modified">222 static void ScaleTranslate_lineTo(PathConsumer *pTransformer,</span>
223                                   jfloat x1, jfloat y1)
224 {
<a name="29" id="anc29"></a><span class="line-modified">225     this.out-&gt;lineTo(this.out,</span>
226                      (jfloat) (x1 * this.mxx + this.mxt),
227                      (jfloat) (y1 * this.myy + this.myt));
228 }
229 
<a name="30" id="anc30"></a><span class="line-modified">230 static void ScaleTranslate_quadTo(PathConsumer *pTransformer,</span>
231                                   jfloat xc, jfloat yc,
232                                   jfloat x1, jfloat y1)
233 {
<a name="31" id="anc31"></a><span class="line-modified">234     this.out-&gt;quadTo(this.out,</span>
235                      (jfloat) (xc * this.mxx + this.mxt),
236                      (jfloat) (yc * this.myy + this.myt),
237                      (jfloat) (x1 * this.mxx + this.mxt),
238                      (jfloat) (y1 * this.myy + this.myt));
239 }
240 
<a name="32" id="anc32"></a><span class="line-modified">241 static void ScaleTranslate_curveTo(PathConsumer *pTransformer,</span>
242                                    jfloat xc0, jfloat yc0,
243                                    jfloat xc1, jfloat yc1,
244                                    jfloat x1, jfloat y1)
245 {
<a name="33" id="anc33"></a><span class="line-modified">246     this.out-&gt;curveTo(this.out,</span>
247                       (jfloat) (xc0 * this.mxx + this.mxt),
248                       (jfloat) (yc0 * this.myy + this.myt),
249                       (jfloat) (xc1 * this.mxx + this.mxt),
250                       (jfloat) (yc1 * this.myy + this.myt),
251                       (jfloat) (x1  * this.mxx + this.mxt),
252                       (jfloat) (y1  * this.myy + this.myt));
253 }
254 
<a name="34" id="anc34"></a><span class="line-modified">255 static void Transform_moveTo(PathConsumer *pTransformer,</span>
256                              jfloat x0, jfloat y0)
257 {
<a name="35" id="anc35"></a><span class="line-modified">258     this.out-&gt;moveTo(this.out,</span>
259                      (jfloat) (x0 * this.mxx + y0 * this.mxy + this.mxt),
260                      (jfloat) (x0 * this.myx + y0 * this.myy + this.myt));
261 }
262 
<a name="36" id="anc36"></a><span class="line-modified">263 static void Transform_lineTo(PathConsumer *pTransformer,</span>
264                              jfloat x1, jfloat y1)
265 {
<a name="37" id="anc37"></a><span class="line-modified">266     this.out-&gt;lineTo(this.out,</span>
267                      (jfloat) (x1 * this.mxx + y1 * this.mxy + this.mxt),
268                      (jfloat) (x1 * this.myx + y1 * this.myy + this.myt));
269 }
270 
<a name="38" id="anc38"></a><span class="line-modified">271 static void Transform_quadTo(PathConsumer *pTransformer,</span>
272                              jfloat xc, jfloat yc,
273                              jfloat x1, jfloat y1)
274 {
<a name="39" id="anc39"></a><span class="line-modified">275     this.out-&gt;quadTo(this.out,</span>
276                      (jfloat) (xc * this.mxx + yc * this.mxy + this.mxt),
277                      (jfloat) (xc * this.myx + yc * this.myy + this.myt),
278                      (jfloat) (x1 * this.mxx + y1 * this.mxy + this.mxt),
279                      (jfloat) (x1 * this.myx + y1 * this.myy + this.myt));
280 }
281 
<a name="40" id="anc40"></a><span class="line-modified">282 static void Transform_curveTo(PathConsumer *pTransformer,</span>
283                               jfloat xc0, jfloat yc0,
284                               jfloat xc1, jfloat yc1,
285                               jfloat x1, jfloat y1)
286 {
<a name="41" id="anc41"></a><span class="line-modified">287     this.out-&gt;curveTo(this.out,</span>
288                       (jfloat) (xc0 * this.mxx + yc0 * this.mxy + this.mxt),
289                       (jfloat) (xc0 * this.myx + yc0 * this.myy + this.myt),
290                       (jfloat) (xc1 * this.mxx + yc1 * this.mxy + this.mxt),
291                       (jfloat) (xc1 * this.myx + yc1 * this.myy + this.myt),
292                       (jfloat) (x1  * this.mxx + y1  * this.mxy + this.mxt),
293                       (jfloat) (x1  * this.myx + y1  * this.myy + this.myt));
294 }
295 
<a name="42" id="anc42"></a><span class="line-modified">296 static void Transformer_closePath(PathConsumer *pTransformer) {</span>
<span class="line-modified">297     this.out-&gt;closePath(this.out);</span>
298 }
299 
<a name="43" id="anc43"></a><span class="line-modified">300 static void Transformer_pathDone(PathConsumer *pTransformer) {</span>
<span class="line-modified">301     this.out-&gt;pathDone(this.out);</span>
302 }
<a name="44" id="anc44"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="44" type="hidden" />
</body>
</html>