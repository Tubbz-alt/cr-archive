<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.graphics/src/test/java/test/javafx/scene/NodeTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../animation/AnimationTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="shape/TestUtils.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.graphics/src/test/java/test/javafx/scene/NodeTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  27 
  28 import test.javafx.scene.shape.TestUtils;
  29 import test.javafx.scene.shape.CircleTest;
  30 import com.sun.javafx.geom.PickRay;
  31 import com.sun.javafx.geom.transform.Affine2D;
  32 import com.sun.javafx.geom.transform.Affine3D;
  33 import com.sun.javafx.geom.transform.BaseTransform;
  34 import com.sun.javafx.geom.transform.Translate2D;
  35 import test.com.sun.javafx.pgstub.StubToolkit;
  36 import com.sun.javafx.scene.DirtyBits;
  37 import com.sun.javafx.scene.NodeHelper;
  38 import com.sun.javafx.scene.input.PickResultChooser;
  39 import com.sun.javafx.scene.shape.RectangleHelper;
  40 import com.sun.javafx.sg.prism.NGGroup;
  41 import com.sun.javafx.sg.prism.NGNode;
  42 import com.sun.javafx.sg.prism.NGRectangle;
  43 import test.com.sun.javafx.test.objects.TestScene;
  44 import test.com.sun.javafx.test.objects.TestStage;
  45 import com.sun.javafx.tk.Toolkit;
  46 import com.sun.javafx.util.Utils;

  47 import javafx.beans.property.*;


  48 import javafx.geometry.BoundingBox;
  49 import javafx.geometry.Bounds;
  50 import javafx.geometry.NodeOrientation;
  51 import javafx.geometry.Point2D;
  52 import javafx.geometry.Point3D;
  53 import javafx.scene.effect.DropShadow;
  54 import javafx.scene.effect.Effect;
  55 import javafx.scene.shape.*;
  56 import javafx.scene.transform.Rotate;
  57 import javafx.scene.transform.Transform;
  58 import org.junit.Rule;
  59 import org.junit.Test;
  60 import org.junit.rules.ExpectedException;
  61 

  62 import java.lang.reflect.Method;
  63 import java.util.Comparator;


  64 import javafx.scene.Group;
  65 import javafx.scene.GroupShim;
  66 import javafx.scene.Node;
  67 import javafx.scene.NodeShim;
  68 import javafx.scene.ParallelCamera;
  69 import javafx.scene.ParentShim;
  70 import javafx.scene.PerspectiveCamera;
  71 import javafx.scene.Scene;
  72 import javafx.scene.SceneShim;
  73 import javafx.scene.SubScene;
  74 import javafx.scene.layout.AnchorPane;
  75 import javafx.scene.transform.Affine;
  76 import javafx.scene.transform.Scale;
  77 import javafx.scene.transform.Shear;
  78 import javafx.scene.transform.Translate;
  79 import javafx.stage.Stage;
  80 
  81 import static org.junit.Assert.*;
  82 /**
  83  * Tests various aspects of Node.
</pre>
<hr />
<pre>
 144 
 145         // Test various onMouseXXX event handlers
 146 
 147         // Test onKeyXXX handlers
 148 
 149         // Test focused is updated?
 150         // Test nodes which are not focusable are not focused!
 151         // Test focus... (SHOULD NOT DEPEND ON KEY LISTENERS BEING INSTALLED!!)
 152 
 153         // Test that clip is taken into account for both &quot;contains&quot; and
 154         // &quot;intersects&quot;. See http://javafx-jira.kenai.com/browse/RT-646
 155 
 156 
 157 
 158     /***************************************************************************
 159      *                                                                         *
 160      *                              Basic Node Tests                           *
 161      *                                                                         *
 162      **************************************************************************/
 163 




















































 164 // TODO disable this because it depends on TestNode
 165 //    @Test public void testPeerNotifiedOfVisibilityChanges() {
 166 //        Rectangle rect = new Rectangle();
 167 //        Node peer = rect.impl_getPGNode();
 168 //        assertEquals(peer.visible, rect.visible);
 169 //
 170 //        rect.visible = false;
 171 //        assertEquals(peer.visible, rect.visible);
 172 //
 173 //        rect.visible = true;
 174 //        assertEquals(peer.visible, rect.visible);
 175 //    }
 176 
 177     /***************************************************************************
 178      *                                                                         *
 179      *                            Testing Node Bounds                          *
 180      *                                                                         *
 181      **************************************************************************/
 182 
 183 // TODO disable this because it depends on TestNode
</pre>
</td>
<td>
<hr />
<pre>
  27 
  28 import test.javafx.scene.shape.TestUtils;
  29 import test.javafx.scene.shape.CircleTest;
  30 import com.sun.javafx.geom.PickRay;
  31 import com.sun.javafx.geom.transform.Affine2D;
  32 import com.sun.javafx.geom.transform.Affine3D;
  33 import com.sun.javafx.geom.transform.BaseTransform;
  34 import com.sun.javafx.geom.transform.Translate2D;
  35 import test.com.sun.javafx.pgstub.StubToolkit;
  36 import com.sun.javafx.scene.DirtyBits;
  37 import com.sun.javafx.scene.NodeHelper;
  38 import com.sun.javafx.scene.input.PickResultChooser;
  39 import com.sun.javafx.scene.shape.RectangleHelper;
  40 import com.sun.javafx.sg.prism.NGGroup;
  41 import com.sun.javafx.sg.prism.NGNode;
  42 import com.sun.javafx.sg.prism.NGRectangle;
  43 import test.com.sun.javafx.test.objects.TestScene;
  44 import test.com.sun.javafx.test.objects.TestStage;
  45 import com.sun.javafx.tk.Toolkit;
  46 import com.sun.javafx.util.Utils;
<span class="line-added">  47 import javafx.beans.InvalidationListener;</span>
  48 import javafx.beans.property.*;
<span class="line-added">  49 import javafx.collections.SetChangeListener;</span>
<span class="line-added">  50 import javafx.css.PseudoClass;</span>
  51 import javafx.geometry.BoundingBox;
  52 import javafx.geometry.Bounds;
  53 import javafx.geometry.NodeOrientation;
  54 import javafx.geometry.Point2D;
  55 import javafx.geometry.Point3D;
  56 import javafx.scene.effect.DropShadow;
  57 import javafx.scene.effect.Effect;
  58 import javafx.scene.shape.*;
  59 import javafx.scene.transform.Rotate;
  60 import javafx.scene.transform.Transform;
  61 import org.junit.Rule;
  62 import org.junit.Test;
  63 import org.junit.rules.ExpectedException;
  64 
<span class="line-added">  65 import java.lang.ref.WeakReference;</span>
  66 import java.lang.reflect.Method;
  67 import java.util.Comparator;
<span class="line-added">  68 import java.util.Set;</span>
<span class="line-added">  69 </span>
  70 import javafx.scene.Group;
  71 import javafx.scene.GroupShim;
  72 import javafx.scene.Node;
  73 import javafx.scene.NodeShim;
  74 import javafx.scene.ParallelCamera;
  75 import javafx.scene.ParentShim;
  76 import javafx.scene.PerspectiveCamera;
  77 import javafx.scene.Scene;
  78 import javafx.scene.SceneShim;
  79 import javafx.scene.SubScene;
  80 import javafx.scene.layout.AnchorPane;
  81 import javafx.scene.transform.Affine;
  82 import javafx.scene.transform.Scale;
  83 import javafx.scene.transform.Shear;
  84 import javafx.scene.transform.Translate;
  85 import javafx.stage.Stage;
  86 
  87 import static org.junit.Assert.*;
  88 /**
  89  * Tests various aspects of Node.
</pre>
<hr />
<pre>
 150 
 151         // Test various onMouseXXX event handlers
 152 
 153         // Test onKeyXXX handlers
 154 
 155         // Test focused is updated?
 156         // Test nodes which are not focusable are not focused!
 157         // Test focus... (SHOULD NOT DEPEND ON KEY LISTENERS BEING INSTALLED!!)
 158 
 159         // Test that clip is taken into account for both &quot;contains&quot; and
 160         // &quot;intersects&quot;. See http://javafx-jira.kenai.com/browse/RT-646
 161 
 162 
 163 
 164     /***************************************************************************
 165      *                                                                         *
 166      *                              Basic Node Tests                           *
 167      *                                                                         *
 168      **************************************************************************/
 169 
<span class="line-added"> 170     @Test</span>
<span class="line-added"> 171     public void testGetPseudoClassStatesShouldReturnSameSet() {</span>
<span class="line-added"> 172         Rectangle node = new Rectangle();</span>
<span class="line-added"> 173         Set&lt;PseudoClass&gt; set1 = node.getPseudoClassStates();</span>
<span class="line-added"> 174         Set&lt;PseudoClass&gt; set2 = node.getPseudoClassStates();</span>
<span class="line-added"> 175         assertSame(&quot;getPseudoClassStates() should always return the same instance&quot;,</span>
<span class="line-added"> 176                 set1, set2);</span>
<span class="line-added"> 177     }</span>
<span class="line-added"> 178 </span>
<span class="line-added"> 179     @Test(expected=UnsupportedOperationException.class)</span>
<span class="line-added"> 180     public void testPseudoClassStatesIsUnmodifiable() {</span>
<span class="line-added"> 181         Node node = new Rectangle();</span>
<span class="line-added"> 182         node.getPseudoClassStates().add(PseudoClass.getPseudoClass(&quot;dummy&quot;));</span>
<span class="line-added"> 183     }</span>
<span class="line-added"> 184 </span>
<span class="line-added"> 185     @Test</span>
<span class="line-added"> 186     public void testUnmodifiablePseudoClassStatesEqualsBackingStates() {</span>
<span class="line-added"> 187         Rectangle node = new Rectangle();</span>
<span class="line-added"> 188         PseudoClass pseudo = PseudoClass.getPseudoClass(&quot;Pseudo&quot;);</span>
<span class="line-added"> 189         node.pseudoClassStateChanged(pseudo, true);</span>
<span class="line-added"> 190         assertEquals(1, node.getPseudoClassStates().size());</span>
<span class="line-added"> 191         assertEquals(NodeShim.pseudoClassStates(node).size(), node.getPseudoClassStates().size());</span>
<span class="line-added"> 192         assertTrue(NodeShim.pseudoClassStates(node).contains(pseudo));</span>
<span class="line-added"> 193         assertTrue(node.getPseudoClassStates().contains(pseudo));</span>
<span class="line-added"> 194     }</span>
<span class="line-added"> 195 </span>
<span class="line-added"> 196     private boolean isInvalidationListenerInvoked;</span>
<span class="line-added"> 197     private boolean isChangeListenerInvoked;</span>
<span class="line-added"> 198     @Test</span>
<span class="line-added"> 199     public void testPseudoClassStatesListenersAreInvoked() {</span>
<span class="line-added"> 200         Rectangle node = new Rectangle();</span>
<span class="line-added"> 201         node.getPseudoClassStates().addListener((InvalidationListener) inv -&gt; {</span>
<span class="line-added"> 202             isInvalidationListenerInvoked = true;</span>
<span class="line-added"> 203         });</span>
<span class="line-added"> 204         node.getPseudoClassStates().addListener((SetChangeListener&lt;PseudoClass&gt;) c -&gt; {</span>
<span class="line-added"> 205             isChangeListenerInvoked = true;</span>
<span class="line-added"> 206         });</span>
<span class="line-added"> 207 </span>
<span class="line-added"> 208         PseudoClass pseudo = PseudoClass.getPseudoClass(&quot;Pseudo&quot;);</span>
<span class="line-added"> 209         node.pseudoClassStateChanged(pseudo, true);</span>
<span class="line-added"> 210         assertTrue(isInvalidationListenerInvoked);</span>
<span class="line-added"> 211         assertTrue(isChangeListenerInvoked);</span>
<span class="line-added"> 212     }</span>
<span class="line-added"> 213 </span>
<span class="line-added"> 214     @Test</span>
<span class="line-added"> 215     public void testPseudoClassStatesNotGCed() {</span>
<span class="line-added"> 216         Node node = new Rectangle();</span>
<span class="line-added"> 217         WeakReference&lt;Set&lt;?&gt;&gt; weakRef = new WeakReference&lt;&gt;(node.getPseudoClassStates());</span>
<span class="line-added"> 218         TestUtils.attemptGC(weakRef);</span>
<span class="line-added"> 219         assertNotNull(&quot;pseudoClassStates must not be gc&#39;ed&quot;, weakRef.get());</span>
<span class="line-added"> 220     }</span>
<span class="line-added"> 221 </span>
 222 // TODO disable this because it depends on TestNode
 223 //    @Test public void testPeerNotifiedOfVisibilityChanges() {
 224 //        Rectangle rect = new Rectangle();
 225 //        Node peer = rect.impl_getPGNode();
 226 //        assertEquals(peer.visible, rect.visible);
 227 //
 228 //        rect.visible = false;
 229 //        assertEquals(peer.visible, rect.visible);
 230 //
 231 //        rect.visible = true;
 232 //        assertEquals(peer.visible, rect.visible);
 233 //    }
 234 
 235     /***************************************************************************
 236      *                                                                         *
 237      *                            Testing Node Bounds                          *
 238      *                                                                         *
 239      **************************************************************************/
 240 
 241 // TODO disable this because it depends on TestNode
</pre>
</td>
</tr>
</table>
<center><a href="../animation/AnimationTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="shape/TestUtils.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>