<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/glib/pcre/pcre_internal.h</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
   1 /*************************************************
   2 *      Perl-Compatible Regular Expressions       *
   3 *************************************************/
   4 
   5 
   6 /* PCRE is a library of functions to support regular expressions whose syntax
   7 and semantics are as close as possible to those of the Perl 5 language.
   8 
   9                        Written by Philip Hazel
  10            Copyright (c) 1997-2012 University of Cambridge
  11 
  12 -----------------------------------------------------------------------------
  13 Redistribution and use in source and binary forms, with or without
  14 modification, are permitted provided that the following conditions are met:
  15 
  16     * Redistributions of source code must retain the above copyright notice,
  17       this list of conditions and the following disclaimer.
  18 
  19     * Redistributions in binary form must reproduce the above copyright
  20       notice, this list of conditions and the following disclaimer in the
  21       documentation and/or other materials provided with the distribution.
  22 
  23     * Neither the name of the University of Cambridge nor the names of its
  24       contributors may be used to endorse or promote products derived from
  25       this software without specific prior written permission.
  26 
  27 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;
  28 AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  29 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  30 ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
  31 LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
  32 CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
  33 SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
  34 INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
  35 CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
  36 ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  37 POSSIBILITY OF SUCH DAMAGE.
  38 -----------------------------------------------------------------------------
  39 */
  40 
  41 /* This header contains definitions that are shared between the different
  42 modules, but which are not relevant to the exported API. This includes some
  43 functions whose names all begin with &quot;_pcre_&quot; or &quot;_pcre16_&quot; depending on
  44 the PRIV macro. */
  45 
  46 #ifndef PCRE_INTERNAL_H
  47 #define PCRE_INTERNAL_H
  48 
  49 /* Define PCRE_DEBUG to get debugging output on stdout. */
  50 
  51 #if 0
  52 #define PCRE_DEBUG
  53 #endif
  54 
  55 /* PCRE is compiled as an 8 bit library if it is not requested otherwise. */
  56 #ifndef COMPILE_PCRE16
  57 #define COMPILE_PCRE8
  58 #endif
  59 
  60 /* If SUPPORT_UCP is defined, SUPPORT_UTF must also be defined. The
  61 &quot;configure&quot; script ensures this, but not everybody uses &quot;configure&quot;. */
  62 
  63 #if defined SUPPORT_UCP &amp;&amp; !(defined SUPPORT_UTF)
  64 #define SUPPORT_UTF 1
  65 #endif
  66 
  67 /* We define SUPPORT_UTF if SUPPORT_UTF8 is enabled for compatibility
  68 reasons with existing code. */
  69 
  70 #if defined SUPPORT_UTF8 &amp;&amp; !(defined SUPPORT_UTF)
  71 #define SUPPORT_UTF 1
  72 #endif
  73 
  74 /* Fixme: SUPPORT_UTF8 should be eventually disappear from the code.
  75 Until then we define it if SUPPORT_UTF is defined. */
  76 
  77 #if defined SUPPORT_UTF &amp;&amp; !(defined SUPPORT_UTF8)
  78 #define SUPPORT_UTF8 1
  79 #endif
  80 
  81 /* We do not support both EBCDIC and UTF-8/16 at the same time. The &quot;configure&quot;
  82 script prevents both being selected, but not everybody uses &quot;configure&quot;. */
  83 
  84 #if defined EBCDIC &amp;&amp; defined SUPPORT_UTF
  85 #error The use of both EBCDIC and SUPPORT_UTF8/16 is not supported.
  86 #endif
  87 
  88 /* Use a macro for debugging printing, &#39;cause that eliminates the use of #ifdef
  89 inline, and there are *still* stupid compilers about that don&#39;t like indented
  90 pre-processor statements, or at least there were when I first wrote this. After
  91 all, it had only been about 10 years then...
  92 
  93 It turns out that the Mac Debugging.h header also defines the macro DPRINTF, so
  94 be absolutely sure we get our version. */
  95 
  96 #undef DPRINTF
  97 #ifdef PCRE_DEBUG
  98 #define DPRINTF(p) printf p
  99 #else
 100 #define DPRINTF(p) /* Nothing */
 101 #endif
 102 
 103 
 104 /* Standard C headers plus the external interface definition. The only time
 105 setjmp and stdarg are used is when NO_RECURSE is set. */
 106 
 107 #include &lt;ctype.h&gt;
 108 #include &lt;limits.h&gt;
 109 #include &lt;stddef.h&gt;
 110 #include &lt;stdio.h&gt;
 111 #include &lt;stdlib.h&gt;
 112 #include &lt;string.h&gt;
 113 
 114 /* When compiling a DLL for Windows, the exported symbols have to be declared
 115 using some MS magic. I found some useful information on this web page:
 116 http://msdn2.microsoft.com/en-us/library/y4h7bcy6(VS.80).aspx. According to the
 117 information there, using __declspec(dllexport) without &quot;extern&quot; we have a
 118 definition; with &quot;extern&quot; we have a declaration. The settings here override the
 119 setting in pcre.h (which is included below); it defines only PCRE_EXP_DECL,
 120 which is all that is needed for applications (they just import the symbols). We
 121 use:
 122 
 123   PCRE_EXP_DECL       for declarations
 124   PCRE_EXP_DEFN       for definitions of exported functions
 125   PCRE_EXP_DATA_DEFN  for definitions of exported variables
 126 
 127 The reason for the two DEFN macros is that in non-Windows environments, one
 128 does not want to have &quot;extern&quot; before variable definitions because it leads to
 129 compiler warnings. So we distinguish between functions and variables. In
 130 Windows, the two should always be the same.
 131 
 132 The reason for wrapping this in #ifndef PCRE_EXP_DECL is so that pcretest,
 133 which is an application, but needs to import this file in order to &quot;peek&quot; at
 134 internals, can #include pcre.h first to get an application&#39;s-eye view.
 135 
 136 In principle, people compiling for non-Windows, non-Unix-like (i.e. uncommon,
 137 special-purpose environments) might want to stick other stuff in front of
 138 exported symbols. That&#39;s why, in the non-Windows case, we set PCRE_EXP_DEFN and
 139 PCRE_EXP_DATA_DEFN only if they are not already set. */
 140 
 141 #ifndef PCRE_EXP_DECL
 142 #  ifdef _WIN32
 143 #    ifndef PCRE_STATIC
 144 #      define PCRE_EXP_DECL       extern __declspec(dllexport)
 145 #      define PCRE_EXP_DEFN       __declspec(dllexport)
 146 #      define PCRE_EXP_DATA_DEFN  __declspec(dllexport)
 147 #    else
 148 #      define PCRE_EXP_DECL       extern
 149 #      define PCRE_EXP_DEFN
 150 #      define PCRE_EXP_DATA_DEFN
 151 #    endif
 152 #  else
 153 #    ifdef __cplusplus
 154 #      define PCRE_EXP_DECL       extern &quot;C&quot;
 155 #    else
 156 #      define PCRE_EXP_DECL       extern
 157 #    endif
 158 #    ifndef PCRE_EXP_DEFN
 159 #      define PCRE_EXP_DEFN       PCRE_EXP_DECL
 160 #    endif
 161 #    ifndef PCRE_EXP_DATA_DEFN
 162 #      define PCRE_EXP_DATA_DEFN
 163 #    endif
 164 #  endif
 165 #endif
 166 
 167 /* When compiling with the MSVC compiler, it is sometimes necessary to include
 168 a &quot;calling convention&quot; before exported function names. (This is secondhand
 169 information; I know nothing about MSVC myself). For example, something like
 170 
 171   void __cdecl function(....)
 172 
 173 might be needed. In order so make this easy, all the exported functions have
 174 PCRE_CALL_CONVENTION just before their names. It is rarely needed; if not
 175 set, we ensure here that it has no effect. */
 176 
 177 #ifndef PCRE_CALL_CONVENTION
 178 #define PCRE_CALL_CONVENTION
 179 #endif
 180 
 181 /* We need to have types that specify unsigned 8, 16 and 32-bit integers. We
 182 cannot determine these outside the compilation (e.g. by running a program as
 183 part of &quot;configure&quot;) because PCRE is often cross-compiled for use on other
 184 systems. Instead we make use of the maximum sizes that are available at
 185 preprocessor time in standard C environments. */
 186 
 187 typedef unsigned char pcre_uint8;
 188 
 189 #if USHRT_MAX == 65535
 190   typedef unsigned short pcre_uint16;
 191   typedef short pcre_int16;
 192 #elif UINT_MAX == 65535
 193   typedef unsigned int pcre_uint16;
 194   typedef int pcre_int16;
 195 #else
 196   #error Cannot determine a type for 16-bit unsigned integers
 197 #endif
 198 
 199 #if UINT_MAX == 4294967295
 200   typedef unsigned int pcre_uint32;
 201   typedef int pcre_int32;
 202 #elif ULONG_MAX == 4294967295
 203   typedef unsigned long int pcre_uint32;
 204   typedef long int pcre_int32;
 205 #else
 206   #error Cannot determine a type for 32-bit unsigned integers
 207 #endif
 208 
 209 /* When checking for integer overflow in pcre_compile(), we need to handle
 210 large integers. If a 64-bit integer type is available, we can use that.
 211 Otherwise we have to cast to double, which of course requires floating point
 212 arithmetic. Handle this by defining a macro for the appropriate type. If
 213 stdint.h is available, include it; it may define INT64_MAX. Systems that do not
 214 have stdint.h (e.g. Solaris) may have inttypes.h. The macro int64_t may be set
 215 by &quot;configure&quot;. */
 216 
 217 #if HAVE_STDINT_H
 218 #include &lt;stdint.h&gt;
 219 #elif HAVE_INTTYPES_H
 220 #include &lt;inttypes.h&gt;
 221 #endif
 222 
 223 #if defined INT64_MAX || defined int64_t
 224 #define INT64_OR_DOUBLE int64_t
 225 #else
 226 #define INT64_OR_DOUBLE double
 227 #endif
 228 
 229 /* All character handling must be done as unsigned characters. Otherwise there
 230 are problems with top-bit-set characters and functions such as isspace().
 231 However, we leave the interface to the outside world as char * or short *,
 232 because that should make things easier for callers. This character type is
 233 called pcre_uchar.
 234 
 235 The IN_UCHARS macro multiply its argument with the byte size of the current
 236 pcre_uchar type. Useful for memcpy and such operations, whose require the
 237 byte size of their input/output buffers.
 238 
 239 The MAX_255 macro checks whether its pcre_uchar input is less than 256.
 240 
 241 The TABLE_GET macro is designed for accessing elements of tables whose contain
 242 exactly 256 items. When the character is able to contain more than 256
 243 items, some check is needed before accessing these tables.
 244 */
 245 
 246 #ifdef COMPILE_PCRE8
 247 
 248 typedef unsigned char pcre_uchar;
 249 #define IN_UCHARS(x) (x)
 250 #define MAX_255(c) 1
 251 #define TABLE_GET(c, table, default) ((table)[c])
 252 
 253 #else
 254 
 255 #ifdef COMPILE_PCRE16
 256 #if USHRT_MAX != 65535
 257 /* This is a warning message. Change PCRE_UCHAR16 to a 16 bit data type in
 258 pcre.h(.in) and disable (comment out) this message. */
 259 #error Warning: PCRE_UCHAR16 is not a 16 bit data type.
 260 #endif
 261 
 262 typedef pcre_uint16 pcre_uchar;
 263 #define IN_UCHARS(x) ((x) &lt;&lt; 1)
 264 #define MAX_255(c) ((c) &lt;= 255u)
 265 #define TABLE_GET(c, table, default) (MAX_255(c)? ((table)[c]):(default))
 266 
 267 #else
 268 #error Unsupported compiling mode
 269 #endif /* COMPILE_PCRE16 */
 270 
 271 #endif /* COMPILE_PCRE8 */
 272 
 273 /* This is an unsigned int value that no character can ever have. UTF-8
 274 characters only go up to 0x7fffffff (though Unicode doesn&#39;t go beyond
 275 0x0010ffff). */
 276 
 277 #define NOTACHAR 0xffffffff
 278 
 279 /* PCRE is able to support several different kinds of newline (CR, LF, CRLF,
 280 &quot;any&quot; and &quot;anycrlf&quot; at present). The following macros are used to package up
 281 testing for newlines. NLBLOCK, PSSTART, and PSEND are defined in the various
 282 modules to indicate in which datablock the parameters exist, and what the
 283 start/end of string field names are. */
 284 
 285 #define NLTYPE_FIXED    0     /* Newline is a fixed length string */
 286 #define NLTYPE_ANY      1     /* Newline is any Unicode line ending */
 287 #define NLTYPE_ANYCRLF  2     /* Newline is CR, LF, or CRLF */
 288 
 289 /* This macro checks for a newline at the given position */
 290 
 291 #define IS_NEWLINE(p) \
 292   ((NLBLOCK-&gt;nltype != NLTYPE_FIXED)? \
 293     ((p) &lt; NLBLOCK-&gt;PSEND &amp;&amp; \
 294      PRIV(is_newline)((p), NLBLOCK-&gt;nltype, NLBLOCK-&gt;PSEND, \
 295        &amp;(NLBLOCK-&gt;nllen), utf)) \
 296     : \
 297     ((p) &lt;= NLBLOCK-&gt;PSEND - NLBLOCK-&gt;nllen &amp;&amp; \
 298      (p)[0] == NLBLOCK-&gt;nl[0] &amp;&amp; \
 299      (NLBLOCK-&gt;nllen == 1 || (p)[1] == NLBLOCK-&gt;nl[1]) \
 300     ) \
 301   )
 302 
 303 /* This macro checks for a newline immediately preceding the given position */
 304 
 305 #define WAS_NEWLINE(p) \
 306   ((NLBLOCK-&gt;nltype != NLTYPE_FIXED)? \
 307     ((p) &gt; NLBLOCK-&gt;PSSTART &amp;&amp; \
 308      PRIV(was_newline)((p), NLBLOCK-&gt;nltype, NLBLOCK-&gt;PSSTART, \
 309        &amp;(NLBLOCK-&gt;nllen), utf)) \
 310     : \
 311     ((p) &gt;= NLBLOCK-&gt;PSSTART + NLBLOCK-&gt;nllen &amp;&amp; \
 312      (p)[-NLBLOCK-&gt;nllen] == NLBLOCK-&gt;nl[0] &amp;&amp; \
 313      (NLBLOCK-&gt;nllen == 1 || (p)[-NLBLOCK-&gt;nllen+1] == NLBLOCK-&gt;nl[1]) \
 314     ) \
 315   )
 316 
 317 /* When PCRE is compiled as a C++ library, the subject pointer can be replaced
 318 with a custom type. This makes it possible, for example, to allow pcre_exec()
 319 to process subject strings that are discontinuous by using a smart pointer
 320 class. It must always be possible to inspect all of the subject string in
 321 pcre_exec() because of the way it backtracks. Two macros are required in the
 322 normal case, for sign-unspecified and unsigned char pointers. The former is
 323 used for the external interface and appears in pcre.h, which is why its name
 324 must begin with PCRE_. */
 325 
 326 #ifdef CUSTOM_SUBJECT_PTR
 327 #define PCRE_PUCHAR CUSTOM_SUBJECT_PTR
 328 #else
 329 #define PCRE_PUCHAR const pcre_uchar *
 330 #endif
 331 
 332 /* Include the public PCRE header and the definitions of UCP character property
 333 values. */
 334 
 335 #include &quot;pcre.h&quot;
 336 #include &quot;ucp.h&quot;
 337 
 338 /* When compiling for use with the Virtual Pascal compiler, these functions
 339 need to have their names changed. PCRE must be compiled with the -DVPCOMPAT
 340 option on the command line. */
 341 
 342 #ifdef VPCOMPAT
 343 #define strlen(s)        _strlen(s)
 344 #define strncmp(s1,s2,m) _strncmp(s1,s2,m)
 345 #define memcmp(s,c,n)    _memcmp(s,c,n)
 346 #define memcpy(d,s,n)    _memcpy(d,s,n)
 347 #define memmove(d,s,n)   _memmove(d,s,n)
 348 #define memset(s,c,n)    _memset(s,c,n)
 349 #else  /* VPCOMPAT */
 350 
 351 /* To cope with SunOS4 and other systems that lack memmove() but have bcopy(),
 352 define a macro for memmove() if HAVE_MEMMOVE is false, provided that HAVE_BCOPY
 353 is set. Otherwise, include an emulating function for those systems that have
 354 neither (there some non-Unix environments where this is the case). */
 355 
 356 #ifndef HAVE_MEMMOVE
 357 #undef  memmove        /* some systems may have a macro */
 358 #ifdef HAVE_BCOPY
 359 #define memmove(a, b, c) bcopy(b, a, c)
 360 #else  /* HAVE_BCOPY */
 361 static void *
 362 pcre_memmove(void *d, const void *s, size_t n)
 363 {
 364 size_t i;
 365 unsigned char *dest = (unsigned char *)d;
 366 const unsigned char *src = (const unsigned char *)s;
 367 if (dest &gt; src)
 368   {
 369   dest += n;
 370   src += n;
 371   for (i = 0; i &lt; n; ++i) *(--dest) = *(--src);
 372   return (void *)dest;
 373   }
 374 else
 375   {
 376   for (i = 0; i &lt; n; ++i) *dest++ = *src++;
 377   return (void *)(dest - n);
 378   }
 379 }
 380 #define memmove(a, b, c) pcre_memmove(a, b, c)
 381 #endif   /* not HAVE_BCOPY */
 382 #endif   /* not HAVE_MEMMOVE */
 383 #endif   /* not VPCOMPAT */
 384 
 385 
 386 /* PCRE keeps offsets in its compiled code as 2-byte quantities (always stored
 387 in big-endian order) by default. These are used, for example, to link from the
 388 start of a subpattern to its alternatives and its end. The use of 2 bytes per
 389 offset limits the size of the compiled regex to around 64K, which is big enough
 390 for almost everybody. However, I received a request for an even bigger limit.
 391 For this reason, and also to make the code easier to maintain, the storing and
 392 loading of offsets from the byte string is now handled by the macros that are
 393 defined here.
 394 
 395 The macros are controlled by the value of LINK_SIZE. This defaults to 2 in
 396 the config.h file, but can be overridden by using -D on the command line. This
 397 is automated on Unix systems via the &quot;configure&quot; command. */
 398 
 399 #ifdef COMPILE_PCRE8
 400 
 401 #if LINK_SIZE == 2
 402 
 403 #define PUT(a,n,d)   \
 404   (a[n] = (d) &gt;&gt; 8), \
 405   (a[(n)+1] = (d) &amp; 255)
 406 
 407 #define GET(a,n) \
 408   (((a)[n] &lt;&lt; 8) | (a)[(n)+1])
 409 
 410 #define MAX_PATTERN_SIZE (1 &lt;&lt; 16)
 411 
 412 
 413 #elif LINK_SIZE == 3
 414 
 415 #define PUT(a,n,d)       \
 416   (a[n] = (d) &gt;&gt; 16),    \
 417   (a[(n)+1] = (d) &gt;&gt; 8), \
 418   (a[(n)+2] = (d) &amp; 255)
 419 
 420 #define GET(a,n) \
 421   (((a)[n] &lt;&lt; 16) | ((a)[(n)+1] &lt;&lt; 8) | (a)[(n)+2])
 422 
 423 #define MAX_PATTERN_SIZE (1 &lt;&lt; 24)
 424 
 425 
 426 #elif LINK_SIZE == 4
 427 
 428 #define PUT(a,n,d)        \
 429   (a[n] = (d) &gt;&gt; 24),     \
 430   (a[(n)+1] = (d) &gt;&gt; 16), \
 431   (a[(n)+2] = (d) &gt;&gt; 8),  \
 432   (a[(n)+3] = (d) &amp; 255)
 433 
 434 #define GET(a,n) \
 435   (((a)[n] &lt;&lt; 24) | ((a)[(n)+1] &lt;&lt; 16) | ((a)[(n)+2] &lt;&lt; 8) | (a)[(n)+3])
 436 
 437 /* Keep it positive */
 438 #define MAX_PATTERN_SIZE (1 &lt;&lt; 30)
 439 
 440 #else
 441 #error LINK_SIZE must be either 2, 3, or 4
 442 #endif
 443 
 444 #else /* COMPILE_PCRE8 */
 445 
 446 #ifdef COMPILE_PCRE16
 447 
 448 #if LINK_SIZE == 2
 449 
 450 #undef LINK_SIZE
 451 #define LINK_SIZE 1
 452 
 453 #define PUT(a,n,d)   \
 454   (a[n] = (d))
 455 
 456 #define GET(a,n) \
 457   (a[n])
 458 
 459 #define MAX_PATTERN_SIZE (1 &lt;&lt; 16)
 460 
 461 #elif LINK_SIZE == 3 || LINK_SIZE == 4
 462 
 463 #undef LINK_SIZE
 464 #define LINK_SIZE 2
 465 
 466 #define PUT(a,n,d)   \
 467   (a[n] = (d) &gt;&gt; 16), \
 468   (a[(n)+1] = (d) &amp; 65535)
 469 
 470 #define GET(a,n) \
 471   (((a)[n] &lt;&lt; 16) | (a)[(n)+1])
 472 
 473 /* Keep it positive */
 474 #define MAX_PATTERN_SIZE (1 &lt;&lt; 30)
 475 
 476 #else
 477 #error LINK_SIZE must be either 2, 3, or 4
 478 #endif
 479 
 480 #else
 481 #error Unsupported compiling mode
 482 #endif /* COMPILE_PCRE16 */
 483 
 484 #endif /* COMPILE_PCRE8 */
 485 
 486 /* Convenience macro defined in terms of the others */
 487 
 488 #define PUTINC(a,n,d)   PUT(a,n,d), a += LINK_SIZE
 489 
 490 
 491 /* PCRE uses some other 2-byte quantities that do not change when the size of
 492 offsets changes. There are used for repeat counts and for other things such as
 493 capturing parenthesis numbers in back references. */
 494 
 495 #ifdef COMPILE_PCRE8
 496 
 497 #define IMM2_SIZE 2
 498 
 499 #define PUT2(a,n,d)   \
 500   a[n] = (d) &gt;&gt; 8; \
 501   a[(n)+1] = (d) &amp; 255
 502 
 503 #define GET2(a,n) \
 504   (((a)[n] &lt;&lt; 8) | (a)[(n)+1])
 505 
 506 #else /* COMPILE_PCRE8 */
 507 
 508 #ifdef COMPILE_PCRE16
 509 
 510 #define IMM2_SIZE 1
 511 
 512 #define PUT2(a,n,d)   \
 513    a[n] = d
 514 
 515 #define GET2(a,n) \
 516    a[n]
 517 
 518 #else
 519 #error Unsupported compiling mode
 520 #endif /* COMPILE_PCRE16 */
 521 
 522 #endif /* COMPILE_PCRE8 */
 523 
 524 #define PUT2INC(a,n,d)  PUT2(a,n,d), a += IMM2_SIZE
 525 
 526 /* The maximum length of a MARK name is currently one data unit; it may be
 527 changed in future to be a fixed number of bytes or to depend on LINK_SIZE. */
 528 
 529 #define MAX_MARK ((1 &lt;&lt; (sizeof(pcre_uchar)*8)) - 1)
 530 
 531 /* When UTF encoding is being used, a character is no longer just a single
 532 character. The macros for character handling generate simple sequences when
 533 used in character-mode, and more complicated ones for UTF characters.
 534 GETCHARLENTEST and other macros are not used when UTF is not supported,
 535 so they are not defined. To make sure they can never even appear when
 536 UTF support is omitted, we don&#39;t even define them. */
 537 
 538 #ifndef SUPPORT_UTF
 539 
 540 /* #define MAX_VALUE_FOR_SINGLE_CHAR */
 541 /* #define HAS_EXTRALEN(c) */
 542 /* #define GET_EXTRALEN(c) */
 543 /* #define NOT_FIRSTCHAR(c) */
 544 #define GETCHAR(c, eptr) c = *eptr;
 545 #define GETCHARTEST(c, eptr) c = *eptr;
 546 #define GETCHARINC(c, eptr) c = *eptr++;
 547 #define GETCHARINCTEST(c, eptr) c = *eptr++;
 548 #define GETCHARLEN(c, eptr, len) c = *eptr;
 549 /* #define GETCHARLENTEST(c, eptr, len) */
 550 /* #define BACKCHAR(eptr) */
 551 /* #define FORWARDCHAR(eptr) */
 552 /* #define ACROSSCHAR(condition, eptr, action) */
 553 
 554 #else   /* SUPPORT_UTF */
 555 
 556 #ifdef COMPILE_PCRE8
 557 
 558 /* These macros were originally written in the form of loops that used data
 559 from the tables whose names start with PRIV(utf8_table). They were rewritten by
 560 a user so as not to use loops, because in some environments this gives a
 561 significant performance advantage, and it seems never to do any harm. */
 562 
 563 /* Tells the biggest code point which can be encoded as a single character. */
 564 
 565 #define MAX_VALUE_FOR_SINGLE_CHAR 127
 566 
 567 /* Tests whether the code point needs extra characters to decode. */
 568 
 569 #define HAS_EXTRALEN(c) ((c) &gt;= 0xc0)
 570 
 571 /* Returns with the additional number of characters if IS_MULTICHAR(c) is TRUE.
 572 Otherwise it has an undefined behaviour. */
 573 
 574 #define GET_EXTRALEN(c) (PRIV(utf8_table4)[(c) &amp; 0x3f])
 575 
 576 /* Returns TRUE, if the given character is not the first character
 577 of a UTF sequence. */
 578 
 579 #define NOT_FIRSTCHAR(c) (((c) &amp; 0xc0) == 0x80)
 580 
 581 /* Base macro to pick up the remaining bytes of a UTF-8 character, not
 582 advancing the pointer. */
 583 
 584 #define GETUTF8(c, eptr) \
 585     { \
 586     if ((c &amp; 0x20) == 0) \
 587       c = ((c &amp; 0x1f) &lt;&lt; 6) | (eptr[1] &amp; 0x3f); \
 588     else if ((c &amp; 0x10) == 0) \
 589       c = ((c &amp; 0x0f) &lt;&lt; 12) | ((eptr[1] &amp; 0x3f) &lt;&lt; 6) | (eptr[2] &amp; 0x3f); \
 590     else if ((c &amp; 0x08) == 0) \
 591       c = ((c &amp; 0x07) &lt;&lt; 18) | ((eptr[1] &amp; 0x3f) &lt;&lt; 12) | \
 592       ((eptr[2] &amp; 0x3f) &lt;&lt; 6) | (eptr[3] &amp; 0x3f); \
 593     else if ((c &amp; 0x04) == 0) \
 594       c = ((c &amp; 0x03) &lt;&lt; 24) | ((eptr[1] &amp; 0x3f) &lt;&lt; 18) | \
 595           ((eptr[2] &amp; 0x3f) &lt;&lt; 12) | ((eptr[3] &amp; 0x3f) &lt;&lt; 6) | \
 596           (eptr[4] &amp; 0x3f); \
 597     else \
 598       c = ((c &amp; 0x01) &lt;&lt; 30) | ((eptr[1] &amp; 0x3f) &lt;&lt; 24) | \
 599           ((eptr[2] &amp; 0x3f) &lt;&lt; 18) | ((eptr[3] &amp; 0x3f) &lt;&lt; 12) | \
 600           ((eptr[4] &amp; 0x3f) &lt;&lt; 6) | (eptr[5] &amp; 0x3f); \
 601     }
 602 
 603 /* Get the next UTF-8 character, not advancing the pointer. This is called when
 604 we know we are in UTF-8 mode. */
 605 
 606 #define GETCHAR(c, eptr) \
 607   c = *eptr; \
 608   if (c &gt;= 0xc0) GETUTF8(c, eptr);
 609 
 610 /* Get the next UTF-8 character, testing for UTF-8 mode, and not advancing the
 611 pointer. */
 612 
 613 #define GETCHARTEST(c, eptr) \
 614   c = *eptr; \
 615   if (utf &amp;&amp; c &gt;= 0xc0) GETUTF8(c, eptr);
 616 
 617 /* Base macro to pick up the remaining bytes of a UTF-8 character, advancing
 618 the pointer. */
 619 
 620 #define GETUTF8INC(c, eptr) \
 621     { \
 622     if ((c &amp; 0x20) == 0) \
 623       c = ((c &amp; 0x1f) &lt;&lt; 6) | (*eptr++ &amp; 0x3f); \
 624     else if ((c &amp; 0x10) == 0) \
 625       { \
 626       c = ((c &amp; 0x0f) &lt;&lt; 12) | ((*eptr &amp; 0x3f) &lt;&lt; 6) | (eptr[1] &amp; 0x3f); \
 627       eptr += 2; \
 628       } \
 629     else if ((c &amp; 0x08) == 0) \
 630       { \
 631       c = ((c &amp; 0x07) &lt;&lt; 18) | ((*eptr &amp; 0x3f) &lt;&lt; 12) | \
 632           ((eptr[1] &amp; 0x3f) &lt;&lt; 6) | (eptr[2] &amp; 0x3f); \
 633       eptr += 3; \
 634       } \
 635     else if ((c &amp; 0x04) == 0) \
 636       { \
 637       c = ((c &amp; 0x03) &lt;&lt; 24) | ((*eptr &amp; 0x3f) &lt;&lt; 18) | \
 638           ((eptr[1] &amp; 0x3f) &lt;&lt; 12) | ((eptr[2] &amp; 0x3f) &lt;&lt; 6) | \
 639           (eptr[3] &amp; 0x3f); \
 640       eptr += 4; \
 641       } \
 642     else \
 643       { \
 644       c = ((c &amp; 0x01) &lt;&lt; 30) | ((*eptr &amp; 0x3f) &lt;&lt; 24) | \
 645           ((eptr[1] &amp; 0x3f) &lt;&lt; 18) | ((eptr[2] &amp; 0x3f) &lt;&lt; 12) | \
 646           ((eptr[3] &amp; 0x3f) &lt;&lt; 6) | (eptr[4] &amp; 0x3f); \
 647       eptr += 5; \
 648       } \
 649     }
 650 
 651 /* Get the next UTF-8 character, advancing the pointer. This is called when we
 652 know we are in UTF-8 mode. */
 653 
 654 #define GETCHARINC(c, eptr) \
 655   c = *eptr++; \
 656   if (c &gt;= 0xc0) GETUTF8INC(c, eptr);
 657 
 658 /* Get the next character, testing for UTF-8 mode, and advancing the pointer.
 659 This is called when we don&#39;t know if we are in UTF-8 mode. */
 660 
 661 #define GETCHARINCTEST(c, eptr) \
 662   c = *eptr++; \
 663   if (utf &amp;&amp; c &gt;= 0xc0) GETUTF8INC(c, eptr);
 664 
 665 /* Base macro to pick up the remaining bytes of a UTF-8 character, not
 666 advancing the pointer, incrementing the length. */
 667 
 668 #define GETUTF8LEN(c, eptr, len) \
 669     { \
 670     if ((c &amp; 0x20) == 0) \
 671       { \
 672       c = ((c &amp; 0x1f) &lt;&lt; 6) | (eptr[1] &amp; 0x3f); \
 673       len++; \
 674       } \
 675     else if ((c &amp; 0x10)  == 0) \
 676       { \
 677       c = ((c &amp; 0x0f) &lt;&lt; 12) | ((eptr[1] &amp; 0x3f) &lt;&lt; 6) | (eptr[2] &amp; 0x3f); \
 678       len += 2; \
 679       } \
 680     else if ((c &amp; 0x08)  == 0) \
 681       {\
 682       c = ((c &amp; 0x07) &lt;&lt; 18) | ((eptr[1] &amp; 0x3f) &lt;&lt; 12) | \
 683           ((eptr[2] &amp; 0x3f) &lt;&lt; 6) | (eptr[3] &amp; 0x3f); \
 684       len += 3; \
 685       } \
 686     else if ((c &amp; 0x04)  == 0) \
 687       { \
 688       c = ((c &amp; 0x03) &lt;&lt; 24) | ((eptr[1] &amp; 0x3f) &lt;&lt; 18) | \
 689           ((eptr[2] &amp; 0x3f) &lt;&lt; 12) | ((eptr[3] &amp; 0x3f) &lt;&lt; 6) | \
 690           (eptr[4] &amp; 0x3f); \
 691       len += 4; \
 692       } \
 693     else \
 694       {\
 695       c = ((c &amp; 0x01) &lt;&lt; 30) | ((eptr[1] &amp; 0x3f) &lt;&lt; 24) | \
 696           ((eptr[2] &amp; 0x3f) &lt;&lt; 18) | ((eptr[3] &amp; 0x3f) &lt;&lt; 12) | \
 697           ((eptr[4] &amp; 0x3f) &lt;&lt; 6) | (eptr[5] &amp; 0x3f); \
 698       len += 5; \
 699       } \
 700     }
 701 
 702 /* Get the next UTF-8 character, not advancing the pointer, incrementing length
 703 if there are extra bytes. This is called when we know we are in UTF-8 mode. */
 704 
 705 #define GETCHARLEN(c, eptr, len) \
 706   c = *eptr; \
 707   if (c &gt;= 0xc0) GETUTF8LEN(c, eptr, len);
 708 
 709 /* Get the next UTF-8 character, testing for UTF-8 mode, not advancing the
 710 pointer, incrementing length if there are extra bytes. This is called when we
 711 do not know if we are in UTF-8 mode. */
 712 
 713 #define GETCHARLENTEST(c, eptr, len) \
 714   c = *eptr; \
 715   if (utf &amp;&amp; c &gt;= 0xc0) GETUTF8LEN(c, eptr, len);
 716 
 717 /* If the pointer is not at the start of a character, move it back until
 718 it is. This is called only in UTF-8 mode - we don&#39;t put a test within the macro
 719 because almost all calls are already within a block of UTF-8 only code. */
 720 
 721 #define BACKCHAR(eptr) while((*eptr &amp; 0xc0) == 0x80) eptr--
 722 
 723 /* Same as above, just in the other direction. */
 724 #define FORWARDCHAR(eptr) while((*eptr &amp; 0xc0) == 0x80) eptr++
 725 
 726 /* Same as above, but it allows a fully customizable form. */
 727 #define ACROSSCHAR(condition, eptr, action) \
 728   while((condition) &amp;&amp; ((eptr) &amp; 0xc0) == 0x80) action
 729 
 730 #else /* COMPILE_PCRE8 */
 731 
 732 #ifdef COMPILE_PCRE16
 733 
 734 /* Tells the biggest code point which can be encoded as a single character. */
 735 
 736 #define MAX_VALUE_FOR_SINGLE_CHAR 65535
 737 
 738 /* Tests whether the code point needs extra characters to decode. */
 739 
 740 #define HAS_EXTRALEN(c) (((c) &amp; 0xfc00) == 0xd800)
 741 
 742 /* Returns with the additional number of characters if IS_MULTICHAR(c) is TRUE.
 743 Otherwise it has an undefined behaviour. */
 744 
 745 #define GET_EXTRALEN(c) 1
 746 
 747 /* Returns TRUE, if the given character is not the first character
 748 of a UTF sequence. */
 749 
 750 #define NOT_FIRSTCHAR(c) (((c) &amp; 0xfc00) == 0xdc00)
 751 
 752 /* Base macro to pick up the low surrogate of a UTF-16 character, not
 753 advancing the pointer. */
 754 
 755 #define GETUTF16(c, eptr) \
 756    { c = (((c &amp; 0x3ff) &lt;&lt; 10) | (eptr[1] &amp; 0x3ff)) + 0x10000; }
 757 
 758 /* Get the next UTF-16 character, not advancing the pointer. This is called when
 759 we know we are in UTF-16 mode. */
 760 
 761 #define GETCHAR(c, eptr) \
 762   c = *eptr; \
 763   if ((c &amp; 0xfc00) == 0xd800) GETUTF16(c, eptr);
 764 
 765 /* Get the next UTF-16 character, testing for UTF-16 mode, and not advancing the
 766 pointer. */
 767 
 768 #define GETCHARTEST(c, eptr) \
 769   c = *eptr; \
 770   if (utf &amp;&amp; (c &amp; 0xfc00) == 0xd800) GETUTF16(c, eptr);
 771 
 772 /* Base macro to pick up the low surrogate of a UTF-16 character, advancing
 773 the pointer. */
 774 
 775 #define GETUTF16INC(c, eptr) \
 776    { c = (((c &amp; 0x3ff) &lt;&lt; 10) | (*eptr++ &amp; 0x3ff)) + 0x10000; }
 777 
 778 /* Get the next UTF-16 character, advancing the pointer. This is called when we
 779 know we are in UTF-16 mode. */
 780 
 781 #define GETCHARINC(c, eptr) \
 782   c = *eptr++; \
 783   if ((c &amp; 0xfc00) == 0xd800) GETUTF16INC(c, eptr);
 784 
 785 /* Get the next character, testing for UTF-16 mode, and advancing the pointer.
 786 This is called when we don&#39;t know if we are in UTF-16 mode. */
 787 
 788 #define GETCHARINCTEST(c, eptr) \
 789   c = *eptr++; \
 790   if (utf &amp;&amp; (c &amp; 0xfc00) == 0xd800) GETUTF16INC(c, eptr);
 791 
 792 /* Base macro to pick up the low surrogate of a UTF-16 character, not
 793 advancing the pointer, incrementing the length. */
 794 
 795 #define GETUTF16LEN(c, eptr, len) \
 796    { c = (((c &amp; 0x3ff) &lt;&lt; 10) | (eptr[1] &amp; 0x3ff)) + 0x10000; len++; }
 797 
 798 /* Get the next UTF-16 character, not advancing the pointer, incrementing
 799 length if there is a low surrogate. This is called when we know we are in
 800 UTF-16 mode. */
 801 
 802 #define GETCHARLEN(c, eptr, len) \
 803   c = *eptr; \
 804   if ((c &amp; 0xfc00) == 0xd800) GETUTF16LEN(c, eptr, len);
 805 
 806 /* Get the next UTF-816character, testing for UTF-16 mode, not advancing the
 807 pointer, incrementing length if there is a low surrogate. This is called when
 808 we do not know if we are in UTF-16 mode. */
 809 
 810 #define GETCHARLENTEST(c, eptr, len) \
 811   c = *eptr; \
 812   if (utf &amp;&amp; (c &amp; 0xfc00) == 0xd800) GETUTF16LEN(c, eptr, len);
 813 
 814 /* If the pointer is not at the start of a character, move it back until
 815 it is. This is called only in UTF-16 mode - we don&#39;t put a test within the
 816 macro because almost all calls are already within a block of UTF-16 only
 817 code. */
 818 
 819 #define BACKCHAR(eptr) if ((*eptr &amp; 0xfc00) == 0xdc00) eptr--
 820 
 821 /* Same as above, just in the other direction. */
 822 #define FORWARDCHAR(eptr) if ((*eptr &amp; 0xfc00) == 0xdc00) eptr++
 823 
 824 /* Same as above, but it allows a fully customizable form. */
 825 #define ACROSSCHAR(condition, eptr, action) \
 826   if ((condition) &amp;&amp; ((eptr) &amp; 0xfc00) == 0xdc00) action
 827 
 828 #endif
 829 
 830 #endif /* COMPILE_PCRE8 */
 831 
 832 #endif  /* SUPPORT_UTF */
 833 
 834 
 835 /* In case there is no definition of offsetof() provided - though any proper
 836 Standard C system should have one. */
 837 
 838 #ifndef offsetof
 839 #define offsetof(p_type,field) ((size_t)&amp;(((p_type *)0)-&gt;field))
 840 #endif
 841 
 842 
 843 /* Private flags containing information about the compiled regex. They used to
 844 live at the top end of the options word, but that got almost full, so now they
 845 are in a 16-bit flags word. From release 8.00, PCRE_NOPARTIAL is unused, as
 846 the restrictions on partial matching have been lifted. It remains for backwards
 847 compatibility. */
 848 
 849 #ifdef COMPILE_PCRE8
 850 #define PCRE_MODE          0x0001  /* compiled in 8 bit mode */
 851 #endif
 852 #ifdef COMPILE_PCRE16
 853 #define PCRE_MODE          0x0002  /* compiled in 16 bit mode */
 854 #endif
 855 #define PCRE_FIRSTSET      0x0010  /* first_char is set */
 856 #define PCRE_FCH_CASELESS  0x0020  /* caseless first char */
 857 #define PCRE_REQCHSET      0x0040  /* req_byte is set */
 858 #define PCRE_RCH_CASELESS  0x0080  /* caseless requested char */
 859 #define PCRE_STARTLINE     0x0100  /* start after \n for multiline */
 860 #define PCRE_NOPARTIAL     0x0200  /* can&#39;t use partial with this regex */
 861 #define PCRE_JCHANGED      0x0400  /* j option used in regex */
 862 #define PCRE_HASCRORLF     0x0800  /* explicit \r or \n in pattern */
 863 #define PCRE_HASTHEN       0x1000  /* pattern contains (*THEN) */
 864 
 865 /* Flags for the &quot;extra&quot; block produced by pcre_study(). */
 866 
 867 #define PCRE_STUDY_MAPPED  0x0001  /* a map of starting chars exists */
 868 #define PCRE_STUDY_MINLEN  0x0002  /* a minimum length field exists */
 869 
 870 /* Masks for identifying the public options that are permitted at compile
 871 time, run time, or study time, respectively. */
 872 
 873 #define PCRE_NEWLINE_BITS (PCRE_NEWLINE_CR|PCRE_NEWLINE_LF|PCRE_NEWLINE_ANY| \
 874                            PCRE_NEWLINE_ANYCRLF)
 875 
 876 #define PUBLIC_COMPILE_OPTIONS \
 877   (PCRE_CASELESS|PCRE_EXTENDED|PCRE_ANCHORED|PCRE_MULTILINE| \
 878    PCRE_DOTALL|PCRE_DOLLAR_ENDONLY|PCRE_EXTRA|PCRE_UNGREEDY|PCRE_UTF8| \
 879    PCRE_NO_AUTO_CAPTURE|PCRE_NO_UTF8_CHECK|PCRE_AUTO_CALLOUT|PCRE_FIRSTLINE| \
 880    PCRE_DUPNAMES|PCRE_NEWLINE_BITS|PCRE_BSR_ANYCRLF|PCRE_BSR_UNICODE| \
 881    PCRE_JAVASCRIPT_COMPAT|PCRE_UCP|PCRE_NO_START_OPTIMIZE)
 882 
 883 #define PUBLIC_EXEC_OPTIONS \
 884   (PCRE_ANCHORED|PCRE_NOTBOL|PCRE_NOTEOL|PCRE_NOTEMPTY|PCRE_NOTEMPTY_ATSTART| \
 885    PCRE_NO_UTF8_CHECK|PCRE_PARTIAL_HARD|PCRE_PARTIAL_SOFT|PCRE_NEWLINE_BITS| \
 886    PCRE_BSR_ANYCRLF|PCRE_BSR_UNICODE|PCRE_NO_START_OPTIMIZE)
 887 
 888 #define PUBLIC_DFA_EXEC_OPTIONS \
 889   (PCRE_ANCHORED|PCRE_NOTBOL|PCRE_NOTEOL|PCRE_NOTEMPTY|PCRE_NOTEMPTY_ATSTART| \
 890    PCRE_NO_UTF8_CHECK|PCRE_PARTIAL_HARD|PCRE_PARTIAL_SOFT|PCRE_DFA_SHORTEST| \
 891    PCRE_DFA_RESTART|PCRE_NEWLINE_BITS|PCRE_BSR_ANYCRLF|PCRE_BSR_UNICODE| \
 892    PCRE_NO_START_OPTIMIZE)
 893 
 894 #define PUBLIC_STUDY_OPTIONS \
 895    (PCRE_STUDY_JIT_COMPILE|PCRE_STUDY_JIT_PARTIAL_SOFT_COMPILE| \
 896     PCRE_STUDY_JIT_PARTIAL_HARD_COMPILE)
 897 
 898 /* Magic number to provide a small check against being handed junk. */
 899 
 900 #define MAGIC_NUMBER  0x50435245UL   /* &#39;PCRE&#39; */
 901 
 902 /* This variable is used to detect a loaded regular expression
 903 in different endianness. */
 904 
 905 #define REVERSED_MAGIC_NUMBER  0x45524350UL   /* &#39;ERCP&#39; */
 906 
 907 /* Negative values for the firstchar and reqchar variables */
 908 
 909 #define REQ_UNSET (-2)
 910 #define REQ_NONE  (-1)
 911 
 912 /* The maximum remaining length of subject we are prepared to search for a
 913 req_byte match. */
 914 
 915 #define REQ_BYTE_MAX 1000
 916 
 917 /* Miscellaneous definitions. The #ifndef is to pacify compiler warnings in
 918 environments where these macros are defined elsewhere. Unfortunately, there
 919 is no way to do the same for the typedef. */
 920 
 921 typedef int BOOL;
 922 
 923 #ifndef FALSE
 924 #define FALSE   0
 925 #define TRUE    1
 926 #endif
 927 
 928 /* If PCRE is to support UTF-8 on EBCDIC platforms, we cannot use normal
 929 character constants like &#39;*&#39; because the compiler would emit their EBCDIC code,
 930 which is different from their ASCII/UTF-8 code. Instead we define macros for
 931 the characters so that they always use the ASCII/UTF-8 code when UTF-8 support
 932 is enabled. When UTF-8 support is not enabled, the definitions use character
 933 literals. Both character and string versions of each character are needed, and
 934 there are some longer strings as well.
 935 
 936 This means that, on EBCDIC platforms, the PCRE library can handle either
 937 EBCDIC, or UTF-8, but not both. To support both in the same compiled library
 938 would need different lookups depending on whether PCRE_UTF8 was set or not.
 939 This would make it impossible to use characters in switch/case statements,
 940 which would reduce performance. For a theoretical use (which nobody has asked
 941 for) in a minority area (EBCDIC platforms), this is not sensible. Any
 942 application that did need both could compile two versions of the library, using
 943 macros to give the functions distinct names. */
 944 
 945 #ifndef SUPPORT_UTF
 946 
 947 /* UTF-8 support is not enabled; use the platform-dependent character literals
 948 so that PCRE works on both ASCII and EBCDIC platforms, in non-UTF-mode only. */
 949 
 950 #define CHAR_HT                     &#39;\t&#39;
 951 #define CHAR_VT                     &#39;\v&#39;
 952 #define CHAR_FF                     &#39;\f&#39;
 953 #define CHAR_CR                     &#39;\r&#39;
 954 #define CHAR_NL                     &#39;\n&#39;
 955 #define CHAR_BS                     &#39;\b&#39;
 956 #define CHAR_BEL                    &#39;\a&#39;
 957 #ifdef EBCDIC
 958 #define CHAR_ESC                    &#39;\047&#39;
 959 #define CHAR_DEL                    &#39;\007&#39;
 960 #else
 961 #define CHAR_ESC                    &#39;\033&#39;
 962 #define CHAR_DEL                    &#39;\177&#39;
 963 #endif
 964 
 965 #define CHAR_SPACE                  &#39; &#39;
 966 #define CHAR_EXCLAMATION_MARK       &#39;!&#39;
 967 #define CHAR_QUOTATION_MARK         &#39;&quot;&#39;
 968 #define CHAR_NUMBER_SIGN            &#39;#&#39;
 969 #define CHAR_DOLLAR_SIGN            &#39;$&#39;
 970 #define CHAR_PERCENT_SIGN           &#39;%&#39;
 971 #define CHAR_AMPERSAND              &#39;&amp;&#39;
 972 #define CHAR_APOSTROPHE             &#39;\&#39;&#39;
 973 #define CHAR_LEFT_PARENTHESIS       &#39;(&#39;
 974 #define CHAR_RIGHT_PARENTHESIS      &#39;)&#39;
 975 #define CHAR_ASTERISK               &#39;*&#39;
 976 #define CHAR_PLUS                   &#39;+&#39;
 977 #define CHAR_COMMA                  &#39;,&#39;
 978 #define CHAR_MINUS                  &#39;-&#39;
 979 #define CHAR_DOT                    &#39;.&#39;
 980 #define CHAR_SLASH                  &#39;/&#39;
 981 #define CHAR_0                      &#39;0&#39;
 982 #define CHAR_1                      &#39;1&#39;
 983 #define CHAR_2                      &#39;2&#39;
 984 #define CHAR_3                      &#39;3&#39;
 985 #define CHAR_4                      &#39;4&#39;
 986 #define CHAR_5                      &#39;5&#39;
 987 #define CHAR_6                      &#39;6&#39;
 988 #define CHAR_7                      &#39;7&#39;
 989 #define CHAR_8                      &#39;8&#39;
 990 #define CHAR_9                      &#39;9&#39;
 991 #define CHAR_COLON                  &#39;:&#39;
 992 #define CHAR_SEMICOLON              &#39;;&#39;
 993 #define CHAR_LESS_THAN_SIGN         &#39;&lt;&#39;
 994 #define CHAR_EQUALS_SIGN            &#39;=&#39;
 995 #define CHAR_GREATER_THAN_SIGN      &#39;&gt;&#39;
 996 #define CHAR_QUESTION_MARK          &#39;?&#39;
 997 #define CHAR_COMMERCIAL_AT          &#39;@&#39;
 998 #define CHAR_A                      &#39;A&#39;
 999 #define CHAR_B                      &#39;B&#39;
1000 #define CHAR_C                      &#39;C&#39;
1001 #define CHAR_D                      &#39;D&#39;
1002 #define CHAR_E                      &#39;E&#39;
1003 #define CHAR_F                      &#39;F&#39;
1004 #define CHAR_G                      &#39;G&#39;
1005 #define CHAR_H                      &#39;H&#39;
1006 #define CHAR_I                      &#39;I&#39;
1007 #define CHAR_J                      &#39;J&#39;
1008 #define CHAR_K                      &#39;K&#39;
1009 #define CHAR_L                      &#39;L&#39;
1010 #define CHAR_M                      &#39;M&#39;
1011 #define CHAR_N                      &#39;N&#39;
1012 #define CHAR_O                      &#39;O&#39;
1013 #define CHAR_P                      &#39;P&#39;
1014 #define CHAR_Q                      &#39;Q&#39;
1015 #define CHAR_R                      &#39;R&#39;
1016 #define CHAR_S                      &#39;S&#39;
1017 #define CHAR_T                      &#39;T&#39;
1018 #define CHAR_U                      &#39;U&#39;
1019 #define CHAR_V                      &#39;V&#39;
1020 #define CHAR_W                      &#39;W&#39;
1021 #define CHAR_X                      &#39;X&#39;
1022 #define CHAR_Y                      &#39;Y&#39;
1023 #define CHAR_Z                      &#39;Z&#39;
1024 #define CHAR_LEFT_SQUARE_BRACKET    &#39;[&#39;
1025 #define CHAR_BACKSLASH              &#39;\\&#39;
1026 #define CHAR_RIGHT_SQUARE_BRACKET   &#39;]&#39;
1027 #define CHAR_CIRCUMFLEX_ACCENT      &#39;^&#39;
1028 #define CHAR_UNDERSCORE             &#39;_&#39;
1029 #define CHAR_GRAVE_ACCENT           &#39;`&#39;
1030 #define CHAR_a                      &#39;a&#39;
1031 #define CHAR_b                      &#39;b&#39;
1032 #define CHAR_c                      &#39;c&#39;
1033 #define CHAR_d                      &#39;d&#39;
1034 #define CHAR_e                      &#39;e&#39;
1035 #define CHAR_f                      &#39;f&#39;
1036 #define CHAR_g                      &#39;g&#39;
1037 #define CHAR_h                      &#39;h&#39;
1038 #define CHAR_i                      &#39;i&#39;
1039 #define CHAR_j                      &#39;j&#39;
1040 #define CHAR_k                      &#39;k&#39;
1041 #define CHAR_l                      &#39;l&#39;
1042 #define CHAR_m                      &#39;m&#39;
1043 #define CHAR_n                      &#39;n&#39;
1044 #define CHAR_o                      &#39;o&#39;
1045 #define CHAR_p                      &#39;p&#39;
1046 #define CHAR_q                      &#39;q&#39;
1047 #define CHAR_r                      &#39;r&#39;
1048 #define CHAR_s                      &#39;s&#39;
1049 #define CHAR_t                      &#39;t&#39;
1050 #define CHAR_u                      &#39;u&#39;
1051 #define CHAR_v                      &#39;v&#39;
1052 #define CHAR_w                      &#39;w&#39;
1053 #define CHAR_x                      &#39;x&#39;
1054 #define CHAR_y                      &#39;y&#39;
1055 #define CHAR_z                      &#39;z&#39;
1056 #define CHAR_LEFT_CURLY_BRACKET     &#39;{&#39;
1057 #define CHAR_VERTICAL_LINE          &#39;|&#39;
1058 #define CHAR_RIGHT_CURLY_BRACKET    &#39;}&#39;
1059 #define CHAR_TILDE                  &#39;~&#39;
1060 
1061 #define STR_HT                      &quot;\t&quot;
1062 #define STR_VT                      &quot;\v&quot;
1063 #define STR_FF                      &quot;\f&quot;
1064 #define STR_CR                      &quot;\r&quot;
1065 #define STR_NL                      &quot;\n&quot;
1066 #define STR_BS                      &quot;\b&quot;
1067 #define STR_BEL                     &quot;\a&quot;
1068 #ifdef EBCDIC
1069 #define STR_ESC                     &quot;\047&quot;
1070 #define STR_DEL                     &quot;\007&quot;
1071 #else
1072 #define STR_ESC                     &quot;\033&quot;
1073 #define STR_DEL                     &quot;\177&quot;
1074 #endif
1075 
1076 #define STR_SPACE                   &quot; &quot;
1077 #define STR_EXCLAMATION_MARK        &quot;!&quot;
1078 #define STR_QUOTATION_MARK          &quot;\&quot;&quot;
1079 #define STR_NUMBER_SIGN             &quot;#&quot;
1080 #define STR_DOLLAR_SIGN             &quot;$&quot;
1081 #define STR_PERCENT_SIGN            &quot;%&quot;
1082 #define STR_AMPERSAND               &quot;&amp;&quot;
1083 #define STR_APOSTROPHE              &quot;&#39;&quot;
1084 #define STR_LEFT_PARENTHESIS        &quot;(&quot;
1085 #define STR_RIGHT_PARENTHESIS       &quot;)&quot;
1086 #define STR_ASTERISK                &quot;*&quot;
1087 #define STR_PLUS                    &quot;+&quot;
1088 #define STR_COMMA                   &quot;,&quot;
1089 #define STR_MINUS                   &quot;-&quot;
1090 #define STR_DOT                     &quot;.&quot;
1091 #define STR_SLASH                   &quot;/&quot;
1092 #define STR_0                       &quot;0&quot;
1093 #define STR_1                       &quot;1&quot;
1094 #define STR_2                       &quot;2&quot;
1095 #define STR_3                       &quot;3&quot;
1096 #define STR_4                       &quot;4&quot;
1097 #define STR_5                       &quot;5&quot;
1098 #define STR_6                       &quot;6&quot;
1099 #define STR_7                       &quot;7&quot;
1100 #define STR_8                       &quot;8&quot;
1101 #define STR_9                       &quot;9&quot;
1102 #define STR_COLON                   &quot;:&quot;
1103 #define STR_SEMICOLON               &quot;;&quot;
1104 #define STR_LESS_THAN_SIGN          &quot;&lt;&quot;
1105 #define STR_EQUALS_SIGN             &quot;=&quot;
1106 #define STR_GREATER_THAN_SIGN       &quot;&gt;&quot;
1107 #define STR_QUESTION_MARK           &quot;?&quot;
1108 #define STR_COMMERCIAL_AT           &quot;@&quot;
1109 #define STR_A                       &quot;A&quot;
1110 #define STR_B                       &quot;B&quot;
1111 #define STR_C                       &quot;C&quot;
1112 #define STR_D                       &quot;D&quot;
1113 #define STR_E                       &quot;E&quot;
1114 #define STR_F                       &quot;F&quot;
1115 #define STR_G                       &quot;G&quot;
1116 #define STR_H                       &quot;H&quot;
1117 #define STR_I                       &quot;I&quot;
1118 #define STR_J                       &quot;J&quot;
1119 #define STR_K                       &quot;K&quot;
1120 #define STR_L                       &quot;L&quot;
1121 #define STR_M                       &quot;M&quot;
1122 #define STR_N                       &quot;N&quot;
1123 #define STR_O                       &quot;O&quot;
1124 #define STR_P                       &quot;P&quot;
1125 #define STR_Q                       &quot;Q&quot;
1126 #define STR_R                       &quot;R&quot;
1127 #define STR_S                       &quot;S&quot;
1128 #define STR_T                       &quot;T&quot;
1129 #define STR_U                       &quot;U&quot;
1130 #define STR_V                       &quot;V&quot;
1131 #define STR_W                       &quot;W&quot;
1132 #define STR_X                       &quot;X&quot;
1133 #define STR_Y                       &quot;Y&quot;
1134 #define STR_Z                       &quot;Z&quot;
1135 #define STR_LEFT_SQUARE_BRACKET     &quot;[&quot;
1136 #define STR_BACKSLASH               &quot;\\&quot;
1137 #define STR_RIGHT_SQUARE_BRACKET    &quot;]&quot;
1138 #define STR_CIRCUMFLEX_ACCENT       &quot;^&quot;
1139 #define STR_UNDERSCORE              &quot;_&quot;
1140 #define STR_GRAVE_ACCENT            &quot;`&quot;
1141 #define STR_a                       &quot;a&quot;
1142 #define STR_b                       &quot;b&quot;
1143 #define STR_c                       &quot;c&quot;
1144 #define STR_d                       &quot;d&quot;
1145 #define STR_e                       &quot;e&quot;
1146 #define STR_f                       &quot;f&quot;
1147 #define STR_g                       &quot;g&quot;
1148 #define STR_h                       &quot;h&quot;
1149 #define STR_i                       &quot;i&quot;
1150 #define STR_j                       &quot;j&quot;
1151 #define STR_k                       &quot;k&quot;
1152 #define STR_l                       &quot;l&quot;
1153 #define STR_m                       &quot;m&quot;
1154 #define STR_n                       &quot;n&quot;
1155 #define STR_o                       &quot;o&quot;
1156 #define STR_p                       &quot;p&quot;
1157 #define STR_q                       &quot;q&quot;
1158 #define STR_r                       &quot;r&quot;
1159 #define STR_s                       &quot;s&quot;
1160 #define STR_t                       &quot;t&quot;
1161 #define STR_u                       &quot;u&quot;
1162 #define STR_v                       &quot;v&quot;
1163 #define STR_w                       &quot;w&quot;
1164 #define STR_x                       &quot;x&quot;
1165 #define STR_y                       &quot;y&quot;
1166 #define STR_z                       &quot;z&quot;
1167 #define STR_LEFT_CURLY_BRACKET      &quot;{&quot;
1168 #define STR_VERTICAL_LINE           &quot;|&quot;
1169 #define STR_RIGHT_CURLY_BRACKET     &quot;}&quot;
1170 #define STR_TILDE                   &quot;~&quot;
1171 
1172 #define STRING_ACCEPT0              &quot;ACCEPT\0&quot;
1173 #define STRING_COMMIT0              &quot;COMMIT\0&quot;
1174 #define STRING_F0                   &quot;F\0&quot;
1175 #define STRING_FAIL0                &quot;FAIL\0&quot;
1176 #define STRING_MARK0                &quot;MARK\0&quot;
1177 #define STRING_PRUNE0               &quot;PRUNE\0&quot;
1178 #define STRING_SKIP0                &quot;SKIP\0&quot;
1179 #define STRING_THEN                 &quot;THEN&quot;
1180 
1181 #define STRING_alpha0               &quot;alpha\0&quot;
1182 #define STRING_lower0               &quot;lower\0&quot;
1183 #define STRING_upper0               &quot;upper\0&quot;
1184 #define STRING_alnum0               &quot;alnum\0&quot;
1185 #define STRING_ascii0               &quot;ascii\0&quot;
1186 #define STRING_blank0               &quot;blank\0&quot;
1187 #define STRING_cntrl0               &quot;cntrl\0&quot;
1188 #define STRING_digit0               &quot;digit\0&quot;
1189 #define STRING_graph0               &quot;graph\0&quot;
1190 #define STRING_print0               &quot;print\0&quot;
1191 #define STRING_punct0               &quot;punct\0&quot;
1192 #define STRING_space0               &quot;space\0&quot;
1193 #define STRING_word0                &quot;word\0&quot;
1194 #define STRING_xdigit               &quot;xdigit&quot;
1195 
1196 #define STRING_DEFINE               &quot;DEFINE&quot;
1197 
1198 #define STRING_CR_RIGHTPAR             &quot;CR)&quot;
1199 #define STRING_LF_RIGHTPAR             &quot;LF)&quot;
1200 #define STRING_CRLF_RIGHTPAR           &quot;CRLF)&quot;
1201 #define STRING_ANY_RIGHTPAR            &quot;ANY)&quot;
1202 #define STRING_ANYCRLF_RIGHTPAR        &quot;ANYCRLF)&quot;
1203 #define STRING_BSR_ANYCRLF_RIGHTPAR    &quot;BSR_ANYCRLF)&quot;
1204 #define STRING_BSR_UNICODE_RIGHTPAR    &quot;BSR_UNICODE)&quot;
1205 #ifdef COMPILE_PCRE8
1206 #define STRING_UTF_RIGHTPAR            &quot;UTF8)&quot;
1207 #endif
1208 #ifdef COMPILE_PCRE16
1209 #define STRING_UTF_RIGHTPAR            &quot;UTF16)&quot;
1210 #endif
1211 #define STRING_UCP_RIGHTPAR            &quot;UCP)&quot;
1212 #define STRING_NO_START_OPT_RIGHTPAR   &quot;NO_START_OPT)&quot;
1213 
1214 #else  /* SUPPORT_UTF */
1215 
1216 /* UTF-8 support is enabled; always use UTF-8 (=ASCII) character codes. This
1217 works in both modes non-EBCDIC platforms, and on EBCDIC platforms in UTF-8 mode
1218 only. */
1219 
1220 #define CHAR_HT                     &#39;\011&#39;
1221 #define CHAR_VT                     &#39;\013&#39;
1222 #define CHAR_FF                     &#39;\014&#39;
1223 #define CHAR_CR                     &#39;\015&#39;
1224 #define CHAR_NL                     &#39;\012&#39;
1225 #define CHAR_BS                     &#39;\010&#39;
1226 #define CHAR_BEL                    &#39;\007&#39;
1227 #define CHAR_ESC                    &#39;\033&#39;
1228 #define CHAR_DEL                    &#39;\177&#39;
1229 
1230 #define CHAR_SPACE                  &#39;\040&#39;
1231 #define CHAR_EXCLAMATION_MARK       &#39;\041&#39;
1232 #define CHAR_QUOTATION_MARK         &#39;\042&#39;
1233 #define CHAR_NUMBER_SIGN            &#39;\043&#39;
1234 #define CHAR_DOLLAR_SIGN            &#39;\044&#39;
1235 #define CHAR_PERCENT_SIGN           &#39;\045&#39;
1236 #define CHAR_AMPERSAND              &#39;\046&#39;
1237 #define CHAR_APOSTROPHE             &#39;\047&#39;
1238 #define CHAR_LEFT_PARENTHESIS       &#39;\050&#39;
1239 #define CHAR_RIGHT_PARENTHESIS      &#39;\051&#39;
1240 #define CHAR_ASTERISK               &#39;\052&#39;
1241 #define CHAR_PLUS                   &#39;\053&#39;
1242 #define CHAR_COMMA                  &#39;\054&#39;
1243 #define CHAR_MINUS                  &#39;\055&#39;
1244 #define CHAR_DOT                    &#39;\056&#39;
1245 #define CHAR_SLASH                  &#39;\057&#39;
1246 #define CHAR_0                      &#39;\060&#39;
1247 #define CHAR_1                      &#39;\061&#39;
1248 #define CHAR_2                      &#39;\062&#39;
1249 #define CHAR_3                      &#39;\063&#39;
1250 #define CHAR_4                      &#39;\064&#39;
1251 #define CHAR_5                      &#39;\065&#39;
1252 #define CHAR_6                      &#39;\066&#39;
1253 #define CHAR_7                      &#39;\067&#39;
1254 #define CHAR_8                      &#39;\070&#39;
1255 #define CHAR_9                      &#39;\071&#39;
1256 #define CHAR_COLON                  &#39;\072&#39;
1257 #define CHAR_SEMICOLON              &#39;\073&#39;
1258 #define CHAR_LESS_THAN_SIGN         &#39;\074&#39;
1259 #define CHAR_EQUALS_SIGN            &#39;\075&#39;
1260 #define CHAR_GREATER_THAN_SIGN      &#39;\076&#39;
1261 #define CHAR_QUESTION_MARK          &#39;\077&#39;
1262 #define CHAR_COMMERCIAL_AT          &#39;\100&#39;
1263 #define CHAR_A                      &#39;\101&#39;
1264 #define CHAR_B                      &#39;\102&#39;
1265 #define CHAR_C                      &#39;\103&#39;
1266 #define CHAR_D                      &#39;\104&#39;
1267 #define CHAR_E                      &#39;\105&#39;
1268 #define CHAR_F                      &#39;\106&#39;
1269 #define CHAR_G                      &#39;\107&#39;
1270 #define CHAR_H                      &#39;\110&#39;
1271 #define CHAR_I                      &#39;\111&#39;
1272 #define CHAR_J                      &#39;\112&#39;
1273 #define CHAR_K                      &#39;\113&#39;
1274 #define CHAR_L                      &#39;\114&#39;
1275 #define CHAR_M                      &#39;\115&#39;
1276 #define CHAR_N                      &#39;\116&#39;
1277 #define CHAR_O                      &#39;\117&#39;
1278 #define CHAR_P                      &#39;\120&#39;
1279 #define CHAR_Q                      &#39;\121&#39;
1280 #define CHAR_R                      &#39;\122&#39;
1281 #define CHAR_S                      &#39;\123&#39;
1282 #define CHAR_T                      &#39;\124&#39;
1283 #define CHAR_U                      &#39;\125&#39;
1284 #define CHAR_V                      &#39;\126&#39;
1285 #define CHAR_W                      &#39;\127&#39;
1286 #define CHAR_X                      &#39;\130&#39;
1287 #define CHAR_Y                      &#39;\131&#39;
1288 #define CHAR_Z                      &#39;\132&#39;
1289 #define CHAR_LEFT_SQUARE_BRACKET    &#39;\133&#39;
1290 #define CHAR_BACKSLASH              &#39;\134&#39;
1291 #define CHAR_RIGHT_SQUARE_BRACKET   &#39;\135&#39;
1292 #define CHAR_CIRCUMFLEX_ACCENT      &#39;\136&#39;
1293 #define CHAR_UNDERSCORE             &#39;\137&#39;
1294 #define CHAR_GRAVE_ACCENT           &#39;\140&#39;
1295 #define CHAR_a                      &#39;\141&#39;
1296 #define CHAR_b                      &#39;\142&#39;
1297 #define CHAR_c                      &#39;\143&#39;
1298 #define CHAR_d                      &#39;\144&#39;
1299 #define CHAR_e                      &#39;\145&#39;
1300 #define CHAR_f                      &#39;\146&#39;
1301 #define CHAR_g                      &#39;\147&#39;
1302 #define CHAR_h                      &#39;\150&#39;
1303 #define CHAR_i                      &#39;\151&#39;
1304 #define CHAR_j                      &#39;\152&#39;
1305 #define CHAR_k                      &#39;\153&#39;
1306 #define CHAR_l                      &#39;\154&#39;
1307 #define CHAR_m                      &#39;\155&#39;
1308 #define CHAR_n                      &#39;\156&#39;
1309 #define CHAR_o                      &#39;\157&#39;
1310 #define CHAR_p                      &#39;\160&#39;
1311 #define CHAR_q                      &#39;\161&#39;
1312 #define CHAR_r                      &#39;\162&#39;
1313 #define CHAR_s                      &#39;\163&#39;
1314 #define CHAR_t                      &#39;\164&#39;
1315 #define CHAR_u                      &#39;\165&#39;
1316 #define CHAR_v                      &#39;\166&#39;
1317 #define CHAR_w                      &#39;\167&#39;
1318 #define CHAR_x                      &#39;\170&#39;
1319 #define CHAR_y                      &#39;\171&#39;
1320 #define CHAR_z                      &#39;\172&#39;
1321 #define CHAR_LEFT_CURLY_BRACKET     &#39;\173&#39;
1322 #define CHAR_VERTICAL_LINE          &#39;\174&#39;
1323 #define CHAR_RIGHT_CURLY_BRACKET    &#39;\175&#39;
1324 #define CHAR_TILDE                  &#39;\176&#39;
1325 
1326 #define STR_HT                      &quot;\011&quot;
1327 #define STR_VT                      &quot;\013&quot;
1328 #define STR_FF                      &quot;\014&quot;
1329 #define STR_CR                      &quot;\015&quot;
1330 #define STR_NL                      &quot;\012&quot;
1331 #define STR_BS                      &quot;\010&quot;
1332 #define STR_BEL                     &quot;\007&quot;
1333 #define STR_ESC                     &quot;\033&quot;
1334 #define STR_DEL                     &quot;\177&quot;
1335 
1336 #define STR_SPACE                   &quot;\040&quot;
1337 #define STR_EXCLAMATION_MARK        &quot;\041&quot;
1338 #define STR_QUOTATION_MARK          &quot;\042&quot;
1339 #define STR_NUMBER_SIGN             &quot;\043&quot;
1340 #define STR_DOLLAR_SIGN             &quot;\044&quot;
1341 #define STR_PERCENT_SIGN            &quot;\045&quot;
1342 #define STR_AMPERSAND               &quot;\046&quot;
1343 #define STR_APOSTROPHE              &quot;\047&quot;
1344 #define STR_LEFT_PARENTHESIS        &quot;\050&quot;
1345 #define STR_RIGHT_PARENTHESIS       &quot;\051&quot;
1346 #define STR_ASTERISK                &quot;\052&quot;
1347 #define STR_PLUS                    &quot;\053&quot;
1348 #define STR_COMMA                   &quot;\054&quot;
1349 #define STR_MINUS                   &quot;\055&quot;
1350 #define STR_DOT                     &quot;\056&quot;
1351 #define STR_SLASH                   &quot;\057&quot;
1352 #define STR_0                       &quot;\060&quot;
1353 #define STR_1                       &quot;\061&quot;
1354 #define STR_2                       &quot;\062&quot;
1355 #define STR_3                       &quot;\063&quot;
1356 #define STR_4                       &quot;\064&quot;
1357 #define STR_5                       &quot;\065&quot;
1358 #define STR_6                       &quot;\066&quot;
1359 #define STR_7                       &quot;\067&quot;
1360 #define STR_8                       &quot;\070&quot;
1361 #define STR_9                       &quot;\071&quot;
1362 #define STR_COLON                   &quot;\072&quot;
1363 #define STR_SEMICOLON               &quot;\073&quot;
1364 #define STR_LESS_THAN_SIGN          &quot;\074&quot;
1365 #define STR_EQUALS_SIGN             &quot;\075&quot;
1366 #define STR_GREATER_THAN_SIGN       &quot;\076&quot;
1367 #define STR_QUESTION_MARK           &quot;\077&quot;
1368 #define STR_COMMERCIAL_AT           &quot;\100&quot;
1369 #define STR_A                       &quot;\101&quot;
1370 #define STR_B                       &quot;\102&quot;
1371 #define STR_C                       &quot;\103&quot;
1372 #define STR_D                       &quot;\104&quot;
1373 #define STR_E                       &quot;\105&quot;
1374 #define STR_F                       &quot;\106&quot;
1375 #define STR_G                       &quot;\107&quot;
1376 #define STR_H                       &quot;\110&quot;
1377 #define STR_I                       &quot;\111&quot;
1378 #define STR_J                       &quot;\112&quot;
1379 #define STR_K                       &quot;\113&quot;
1380 #define STR_L                       &quot;\114&quot;
1381 #define STR_M                       &quot;\115&quot;
1382 #define STR_N                       &quot;\116&quot;
1383 #define STR_O                       &quot;\117&quot;
1384 #define STR_P                       &quot;\120&quot;
1385 #define STR_Q                       &quot;\121&quot;
1386 #define STR_R                       &quot;\122&quot;
1387 #define STR_S                       &quot;\123&quot;
1388 #define STR_T                       &quot;\124&quot;
1389 #define STR_U                       &quot;\125&quot;
1390 #define STR_V                       &quot;\126&quot;
1391 #define STR_W                       &quot;\127&quot;
1392 #define STR_X                       &quot;\130&quot;
1393 #define STR_Y                       &quot;\131&quot;
1394 #define STR_Z                       &quot;\132&quot;
1395 #define STR_LEFT_SQUARE_BRACKET     &quot;\133&quot;
1396 #define STR_BACKSLASH               &quot;\134&quot;
1397 #define STR_RIGHT_SQUARE_BRACKET    &quot;\135&quot;
1398 #define STR_CIRCUMFLEX_ACCENT       &quot;\136&quot;
1399 #define STR_UNDERSCORE              &quot;\137&quot;
1400 #define STR_GRAVE_ACCENT            &quot;\140&quot;
1401 #define STR_a                       &quot;\141&quot;
1402 #define STR_b                       &quot;\142&quot;
1403 #define STR_c                       &quot;\143&quot;
1404 #define STR_d                       &quot;\144&quot;
1405 #define STR_e                       &quot;\145&quot;
1406 #define STR_f                       &quot;\146&quot;
1407 #define STR_g                       &quot;\147&quot;
1408 #define STR_h                       &quot;\150&quot;
1409 #define STR_i                       &quot;\151&quot;
1410 #define STR_j                       &quot;\152&quot;
1411 #define STR_k                       &quot;\153&quot;
1412 #define STR_l                       &quot;\154&quot;
1413 #define STR_m                       &quot;\155&quot;
1414 #define STR_n                       &quot;\156&quot;
1415 #define STR_o                       &quot;\157&quot;
1416 #define STR_p                       &quot;\160&quot;
1417 #define STR_q                       &quot;\161&quot;
1418 #define STR_r                       &quot;\162&quot;
1419 #define STR_s                       &quot;\163&quot;
1420 #define STR_t                       &quot;\164&quot;
1421 #define STR_u                       &quot;\165&quot;
1422 #define STR_v                       &quot;\166&quot;
1423 #define STR_w                       &quot;\167&quot;
1424 #define STR_x                       &quot;\170&quot;
1425 #define STR_y                       &quot;\171&quot;
1426 #define STR_z                       &quot;\172&quot;
1427 #define STR_LEFT_CURLY_BRACKET      &quot;\173&quot;
1428 #define STR_VERTICAL_LINE           &quot;\174&quot;
1429 #define STR_RIGHT_CURLY_BRACKET     &quot;\175&quot;
1430 #define STR_TILDE                   &quot;\176&quot;
1431 
1432 #define STRING_ACCEPT0              STR_A STR_C STR_C STR_E STR_P STR_T &quot;\0&quot;
1433 #define STRING_COMMIT0              STR_C STR_O STR_M STR_M STR_I STR_T &quot;\0&quot;
1434 #define STRING_F0                   STR_F &quot;\0&quot;
1435 #define STRING_FAIL0                STR_F STR_A STR_I STR_L &quot;\0&quot;
1436 #define STRING_MARK0                STR_M STR_A STR_R STR_K &quot;\0&quot;
1437 #define STRING_PRUNE0               STR_P STR_R STR_U STR_N STR_E &quot;\0&quot;
1438 #define STRING_SKIP0                STR_S STR_K STR_I STR_P &quot;\0&quot;
1439 #define STRING_THEN                 STR_T STR_H STR_E STR_N
1440 
1441 #define STRING_alpha0               STR_a STR_l STR_p STR_h STR_a &quot;\0&quot;
1442 #define STRING_lower0               STR_l STR_o STR_w STR_e STR_r &quot;\0&quot;
1443 #define STRING_upper0               STR_u STR_p STR_p STR_e STR_r &quot;\0&quot;
1444 #define STRING_alnum0               STR_a STR_l STR_n STR_u STR_m &quot;\0&quot;
1445 #define STRING_ascii0               STR_a STR_s STR_c STR_i STR_i &quot;\0&quot;
1446 #define STRING_blank0               STR_b STR_l STR_a STR_n STR_k &quot;\0&quot;
1447 #define STRING_cntrl0               STR_c STR_n STR_t STR_r STR_l &quot;\0&quot;
1448 #define STRING_digit0               STR_d STR_i STR_g STR_i STR_t &quot;\0&quot;
1449 #define STRING_graph0               STR_g STR_r STR_a STR_p STR_h &quot;\0&quot;
1450 #define STRING_print0               STR_p STR_r STR_i STR_n STR_t &quot;\0&quot;
1451 #define STRING_punct0               STR_p STR_u STR_n STR_c STR_t &quot;\0&quot;
1452 #define STRING_space0               STR_s STR_p STR_a STR_c STR_e &quot;\0&quot;
1453 #define STRING_word0                STR_w STR_o STR_r STR_d       &quot;\0&quot;
1454 #define STRING_xdigit               STR_x STR_d STR_i STR_g STR_i STR_t
1455 
1456 #define STRING_DEFINE               STR_D STR_E STR_F STR_I STR_N STR_E
1457 
1458 #define STRING_CR_RIGHTPAR             STR_C STR_R STR_RIGHT_PARENTHESIS
1459 #define STRING_LF_RIGHTPAR             STR_L STR_F STR_RIGHT_PARENTHESIS
1460 #define STRING_CRLF_RIGHTPAR           STR_C STR_R STR_L STR_F STR_RIGHT_PARENTHESIS
1461 #define STRING_ANY_RIGHTPAR            STR_A STR_N STR_Y STR_RIGHT_PARENTHESIS
1462 #define STRING_ANYCRLF_RIGHTPAR        STR_A STR_N STR_Y STR_C STR_R STR_L STR_F STR_RIGHT_PARENTHESIS
1463 #define STRING_BSR_ANYCRLF_RIGHTPAR    STR_B STR_S STR_R STR_UNDERSCORE STR_A STR_N STR_Y STR_C STR_R STR_L STR_F STR_RIGHT_PARENTHESIS
1464 #define STRING_BSR_UNICODE_RIGHTPAR    STR_B STR_S STR_R STR_UNDERSCORE STR_U STR_N STR_I STR_C STR_O STR_D STR_E STR_RIGHT_PARENTHESIS
1465 #ifdef COMPILE_PCRE8
1466 #define STRING_UTF_RIGHTPAR            STR_U STR_T STR_F STR_8 STR_RIGHT_PARENTHESIS
1467 #endif
1468 #ifdef COMPILE_PCRE16
1469 #define STRING_UTF_RIGHTPAR            STR_U STR_T STR_F STR_1 STR_6 STR_RIGHT_PARENTHESIS
1470 #endif
1471 #define STRING_UCP_RIGHTPAR            STR_U STR_C STR_P STR_RIGHT_PARENTHESIS
1472 #define STRING_NO_START_OPT_RIGHTPAR   STR_N STR_O STR_UNDERSCORE STR_S STR_T STR_A STR_R STR_T STR_UNDERSCORE STR_O STR_P STR_T STR_RIGHT_PARENTHESIS
1473 
1474 #endif  /* SUPPORT_UTF */
1475 
1476 /* Escape items that are just an encoding of a particular data value. */
1477 
1478 #ifndef ESC_e
1479 #define ESC_e CHAR_ESC
1480 #endif
1481 
1482 #ifndef ESC_f
1483 #define ESC_f CHAR_FF
1484 #endif
1485 
1486 #ifndef ESC_n
1487 #define ESC_n CHAR_NL
1488 #endif
1489 
1490 #ifndef ESC_r
1491 #define ESC_r CHAR_CR
1492 #endif
1493 
1494 /* We can&#39;t officially use ESC_t because it is a POSIX reserved identifier
1495 (presumably because of all the others like size_t). */
1496 
1497 #ifndef ESC_tee
1498 #define ESC_tee CHAR_HT
1499 #endif
1500 
1501 /* Codes for different types of Unicode property */
1502 
1503 #define PT_ANY        0    /* Any property - matches all chars */
1504 #define PT_LAMP       1    /* L&amp; - the union of Lu, Ll, Lt */
1505 #define PT_GC         2    /* Specified general characteristic (e.g. L) */
1506 #define PT_PC         3    /* Specified particular characteristic (e.g. Lu) */
1507 #define PT_SC         4    /* Script (e.g. Han) */
1508 #define PT_ALNUM      5    /* Alphanumeric - the union of L and N */
1509 #define PT_SPACE      6    /* Perl space - Z plus 9,10,12,13 */
1510 #define PT_PXSPACE    7    /* POSIX space - Z plus 9,10,11,12,13 */
1511 #define PT_WORD       8    /* Word - L plus N plus underscore */
1512 
1513 /* Flag bits and data types for the extended class (OP_XCLASS) for classes that
1514 contain characters with values greater than 255. */
1515 
1516 #define XCL_NOT    0x01    /* Flag: this is a negative class */
1517 #define XCL_MAP    0x02    /* Flag: a 32-byte map is present */
1518 
1519 #define XCL_END       0    /* Marks end of individual items */
1520 #define XCL_SINGLE    1    /* Single item (one multibyte char) follows */
1521 #define XCL_RANGE     2    /* A range (two multibyte chars) follows */
1522 #define XCL_PROP      3    /* Unicode property (2-byte property code follows) */
1523 #define XCL_NOTPROP   4    /* Unicode inverted property (ditto) */
1524 
1525 /* These are escaped items that aren&#39;t just an encoding of a particular data
1526 value such as \n. They must have non-zero values, as check_escape() returns
1527 their negation. Also, they must appear in the same order as in the opcode
1528 definitions below, up to ESC_z. There&#39;s a dummy for OP_ALLANY because it
1529 corresponds to &quot;.&quot; in DOTALL mode rather than an escape sequence. It is also
1530 used for [^] in JavaScript compatibility mode, and for \C in non-utf mode. In
1531 non-DOTALL mode, &quot;.&quot; behaves like \N.
1532 
1533 The special values ESC_DU, ESC_du, etc. are used instead of ESC_D, ESC_d, etc.
1534 when PCRE_UCP is set, when replacement of \d etc by \p sequences is required.
1535 They must be contiguous, and remain in order so that the replacements can be
1536 looked up from a table.
1537 
1538 The final escape must be ESC_REF as subsequent values are used for
1539 backreferences (\1, \2, \3, etc). There are two tests in the code for an escape
1540 greater than ESC_b and less than ESC_Z to detect the types that may be
1541 repeated. These are the types that consume characters. If any new escapes are
1542 put in between that don&#39;t consume a character, that code will have to change.
1543 */
1544 
1545 enum { ESC_A = 1, ESC_G, ESC_K, ESC_B, ESC_b, ESC_D, ESC_d, ESC_S, ESC_s,
1546        ESC_W, ESC_w, ESC_N, ESC_dum, ESC_C, ESC_P, ESC_p, ESC_R, ESC_H,
1547        ESC_h, ESC_V, ESC_v, ESC_X, ESC_Z, ESC_z,
1548        ESC_E, ESC_Q, ESC_g, ESC_k,
1549        ESC_DU, ESC_du, ESC_SU, ESC_su, ESC_WU, ESC_wu,
1550        ESC_REF };
1551 
1552 /* Opcode table: Starting from 1 (i.e. after OP_END), the values up to
1553 OP_EOD must correspond in order to the list of escapes immediately above.
1554 
1555 *** NOTE NOTE NOTE *** Whenever this list is updated, the two macro definitions
1556 that follow must also be updated to match. There are also tables called
1557 &quot;coptable&quot; and &quot;poptable&quot; in pcre_dfa_exec.c that must be updated. */
1558 
1559 enum {
1560   OP_END,            /* 0 End of pattern */
1561 
1562   /* Values corresponding to backslashed metacharacters */
1563 
1564   OP_SOD,            /* 1 Start of data: \A */
1565   OP_SOM,            /* 2 Start of match (subject + offset): \G */
1566   OP_SET_SOM,        /* 3 Set start of match (\K) */
1567   OP_NOT_WORD_BOUNDARY,  /*  4 \B */
1568   OP_WORD_BOUNDARY,      /*  5 \b */
1569   OP_NOT_DIGIT,          /*  6 \D */
1570   OP_DIGIT,              /*  7 \d */
1571   OP_NOT_WHITESPACE,     /*  8 \S */
1572   OP_WHITESPACE,         /*  9 \s */
1573   OP_NOT_WORDCHAR,       /* 10 \W */
1574   OP_WORDCHAR,           /* 11 \w */
1575 
1576   OP_ANY,            /* 12 Match any character except newline */
1577   OP_ALLANY,         /* 13 Match any character */
1578   OP_ANYBYTE,        /* 14 Match any byte (\C); different to OP_ANY for UTF-8 */
1579   OP_NOTPROP,        /* 15 \P (not Unicode property) */
1580   OP_PROP,           /* 16 \p (Unicode property) */
1581   OP_ANYNL,          /* 17 \R (any newline sequence) */
1582   OP_NOT_HSPACE,     /* 18 \H (not horizontal whitespace) */
1583   OP_HSPACE,         /* 19 \h (horizontal whitespace) */
1584   OP_NOT_VSPACE,     /* 20 \V (not vertical whitespace) */
1585   OP_VSPACE,         /* 21 \v (vertical whitespace) */
1586   OP_EXTUNI,         /* 22 \X (extended Unicode sequence */
1587   OP_EODN,           /* 23 End of data or \n at end of data: \Z. */
1588   OP_EOD,            /* 24 End of data: \z */
1589 
1590   OP_CIRC,           /* 25 Start of line - not multiline */
1591   OP_CIRCM,          /* 26 Start of line - multiline */
1592   OP_DOLL,           /* 27 End of line - not multiline */
1593   OP_DOLLM,          /* 28 End of line - multiline */
1594   OP_CHAR,           /* 29 Match one character, casefully */
1595   OP_CHARI,          /* 30 Match one character, caselessly */
1596   OP_NOT,            /* 31 Match one character, not the given one, casefully */
1597   OP_NOTI,           /* 32 Match one character, not the given one, caselessly */
1598 
1599   /* The following sets of 13 opcodes must always be kept in step because
1600   the offset from the first one is used to generate the others. */
1601 
1602   /**** Single characters, caseful, must precede the caseless ones ****/
1603 
1604   OP_STAR,           /* 33 The maximizing and minimizing versions of */
1605   OP_MINSTAR,        /* 34 these six opcodes must come in pairs, with */
1606   OP_PLUS,           /* 35 the minimizing one second. */
1607   OP_MINPLUS,        /* 36 */
1608   OP_QUERY,          /* 37 */
1609   OP_MINQUERY,       /* 38 */
1610 
1611   OP_UPTO,           /* 39 From 0 to n matches of one character, caseful*/
1612   OP_MINUPTO,        /* 40 */
1613   OP_EXACT,          /* 41 Exactly n matches */
1614 
1615   OP_POSSTAR,        /* 42 Possessified star, caseful */
1616   OP_POSPLUS,        /* 43 Possessified plus, caseful */
1617   OP_POSQUERY,       /* 44 Posesssified query, caseful */
1618   OP_POSUPTO,        /* 45 Possessified upto, caseful */
1619 
1620   /**** Single characters, caseless, must follow the caseful ones */
1621 
1622   OP_STARI,          /* 46 */
1623   OP_MINSTARI,       /* 47 */
1624   OP_PLUSI,          /* 48 */
1625   OP_MINPLUSI,       /* 49 */
1626   OP_QUERYI,         /* 50 */
1627   OP_MINQUERYI,      /* 51 */
1628 
1629   OP_UPTOI,          /* 52 From 0 to n matches of one character, caseless */
1630   OP_MINUPTOI,       /* 53 */
1631   OP_EXACTI,         /* 54 */
1632 
1633   OP_POSSTARI,       /* 55 Possessified star, caseless */
1634   OP_POSPLUSI,       /* 56 Possessified plus, caseless */
1635   OP_POSQUERYI,      /* 57 Posesssified query, caseless */
1636   OP_POSUPTOI,       /* 58 Possessified upto, caseless */
1637 
1638   /**** The negated ones must follow the non-negated ones, and match them ****/
1639   /**** Negated single character, caseful; must precede the caseless ones ****/
1640 
1641   OP_NOTSTAR,        /* 59 The maximizing and minimizing versions of */
1642   OP_NOTMINSTAR,     /* 60 these six opcodes must come in pairs, with */
1643   OP_NOTPLUS,        /* 61 the minimizing one second. They must be in */
1644   OP_NOTMINPLUS,     /* 62 exactly the same order as those above. */
1645   OP_NOTQUERY,       /* 63 */
1646   OP_NOTMINQUERY,    /* 64 */
1647 
1648   OP_NOTUPTO,        /* 65 From 0 to n matches, caseful */
1649   OP_NOTMINUPTO,     /* 66 */
1650   OP_NOTEXACT,       /* 67 Exactly n matches */
1651 
1652   OP_NOTPOSSTAR,     /* 68 Possessified versions, caseful */
1653   OP_NOTPOSPLUS,     /* 69 */
1654   OP_NOTPOSQUERY,    /* 70 */
1655   OP_NOTPOSUPTO,     /* 71 */
1656 
1657   /**** Negated single character, caseless; must follow the caseful ones ****/
1658 
1659   OP_NOTSTARI,       /* 72 */
1660   OP_NOTMINSTARI,    /* 73 */
1661   OP_NOTPLUSI,       /* 74 */
1662   OP_NOTMINPLUSI,    /* 75 */
1663   OP_NOTQUERYI,      /* 76 */
1664   OP_NOTMINQUERYI,   /* 77 */
1665 
1666   OP_NOTUPTOI,       /* 78 From 0 to n matches, caseless */
1667   OP_NOTMINUPTOI,    /* 79 */
1668   OP_NOTEXACTI,      /* 80 Exactly n matches */
1669 
1670   OP_NOTPOSSTARI,    /* 81 Possessified versions, caseless */
1671   OP_NOTPOSPLUSI,    /* 82 */
1672   OP_NOTPOSQUERYI,   /* 83 */
1673   OP_NOTPOSUPTOI,    /* 84 */
1674 
1675   /**** Character types ****/
1676 
1677   OP_TYPESTAR,       /* 85 The maximizing and minimizing versions of */
1678   OP_TYPEMINSTAR,    /* 86 these six opcodes must come in pairs, with */
1679   OP_TYPEPLUS,       /* 87 the minimizing one second. These codes must */
1680   OP_TYPEMINPLUS,    /* 88 be in exactly the same order as those above. */
1681   OP_TYPEQUERY,      /* 89 */
1682   OP_TYPEMINQUERY,   /* 90 */
1683 
1684   OP_TYPEUPTO,       /* 91 From 0 to n matches */
1685   OP_TYPEMINUPTO,    /* 92 */
1686   OP_TYPEEXACT,      /* 93 Exactly n matches */
1687 
1688   OP_TYPEPOSSTAR,    /* 94 Possessified versions */
1689   OP_TYPEPOSPLUS,    /* 95 */
1690   OP_TYPEPOSQUERY,   /* 96 */
1691   OP_TYPEPOSUPTO,    /* 97 */
1692 
1693   /* These are used for character classes and back references; only the
1694   first six are the same as the sets above. */
1695 
1696   OP_CRSTAR,         /* 98 The maximizing and minimizing versions of */
1697   OP_CRMINSTAR,      /* 99 all these opcodes must come in pairs, with */
1698   OP_CRPLUS,         /* 100 the minimizing one second. These codes must */
1699   OP_CRMINPLUS,      /* 101 be in exactly the same order as those above. */
1700   OP_CRQUERY,        /* 102 */
1701   OP_CRMINQUERY,     /* 103 */
1702 
1703   OP_CRRANGE,        /* 104 These are different to the three sets above. */
1704   OP_CRMINRANGE,     /* 105 */
1705 
1706   /* End of quantifier opcodes */
1707 
1708   OP_CLASS,          /* 106 Match a character class, chars &lt; 256 only */
1709   OP_NCLASS,         /* 107 Same, but the bitmap was created from a negative
1710                               class - the difference is relevant only when a
1711                               character &gt; 255 is encountered. */
1712   OP_XCLASS,         /* 108 Extended class for handling &gt; 255 chars within the
1713                               class. This does both positive and negative. */
1714   OP_REF,            /* 109 Match a back reference, casefully */
1715   OP_REFI,           /* 110 Match a back reference, caselessly */
1716   OP_RECURSE,        /* 111 Match a numbered subpattern (possibly recursive) */
1717   OP_CALLOUT,        /* 112 Call out to external function if provided */
1718 
1719   OP_ALT,            /* 113 Start of alternation */
1720   OP_KET,            /* 114 End of group that doesn&#39;t have an unbounded repeat */
1721   OP_KETRMAX,        /* 115 These two must remain together and in this */
1722   OP_KETRMIN,        /* 116 order. They are for groups the repeat for ever. */
1723   OP_KETRPOS,        /* 117 Possessive unlimited repeat. */
1724 
1725   /* The assertions must come before BRA, CBRA, ONCE, and COND, and the four
1726   asserts must remain in order. */
1727 
1728   OP_REVERSE,        /* 118 Move pointer back - used in lookbehind assertions */
1729   OP_ASSERT,         /* 119 Positive lookahead */
1730   OP_ASSERT_NOT,     /* 120 Negative lookahead */
1731   OP_ASSERTBACK,     /* 121 Positive lookbehind */
1732   OP_ASSERTBACK_NOT, /* 122 Negative lookbehind */
1733 
1734   /* ONCE, ONCE_NC, BRA, BRAPOS, CBRA, CBRAPOS, and COND must come immediately
1735   after the assertions, with ONCE first, as there&#39;s a test for &gt;= ONCE for a
1736   subpattern that isn&#39;t an assertion. The POS versions must immediately follow
1737   the non-POS versions in each case. */
1738 
1739   OP_ONCE,           /* 123 Atomic group, contains captures */
1740   OP_ONCE_NC,        /* 124 Atomic group containing no captures */
1741   OP_BRA,            /* 125 Start of non-capturing bracket */
1742   OP_BRAPOS,         /* 126 Ditto, with unlimited, possessive repeat */
1743   OP_CBRA,           /* 127 Start of capturing bracket */
1744   OP_CBRAPOS,        /* 128 Ditto, with unlimited, possessive repeat */
1745   OP_COND,           /* 129 Conditional group */
1746 
1747   /* These five must follow the previous five, in the same order. There&#39;s a
1748   check for &gt;= SBRA to distinguish the two sets. */
1749 
1750   OP_SBRA,           /* 130 Start of non-capturing bracket, check empty  */
1751   OP_SBRAPOS,        /* 131 Ditto, with unlimited, possessive repeat */
1752   OP_SCBRA,          /* 132 Start of capturing bracket, check empty */
1753   OP_SCBRAPOS,       /* 133 Ditto, with unlimited, possessive repeat */
1754   OP_SCOND,          /* 134 Conditional group, check empty */
1755 
1756   /* The next two pairs must (respectively) be kept together. */
1757 
1758   OP_CREF,           /* 135 Used to hold a capture number as condition */
1759   OP_NCREF,          /* 136 Same, but generated by a name reference*/
1760   OP_RREF,           /* 137 Used to hold a recursion number as condition */
1761   OP_NRREF,          /* 138 Same, but generated by a name reference*/
1762   OP_DEF,            /* 139 The DEFINE condition */
1763 
1764   OP_BRAZERO,        /* 140 These two must remain together and in this */
1765   OP_BRAMINZERO,     /* 141 order. */
1766   OP_BRAPOSZERO,     /* 142 */
1767 
1768   /* These are backtracking control verbs */
1769 
1770   OP_MARK,           /* 143 always has an argument */
1771   OP_PRUNE,          /* 144 */
1772   OP_PRUNE_ARG,      /* 145 same, but with argument */
1773   OP_SKIP,           /* 146 */
1774   OP_SKIP_ARG,       /* 147 same, but with argument */
1775   OP_THEN,           /* 148 */
1776   OP_THEN_ARG,       /* 149 same, but with argument */
1777   OP_COMMIT,         /* 150 */
1778 
1779   /* These are forced failure and success verbs */
1780 
1781   OP_FAIL,           /* 151 */
1782   OP_ACCEPT,         /* 152 */
1783   OP_ASSERT_ACCEPT,  /* 153 Used inside assertions */
1784   OP_CLOSE,          /* 154 Used before OP_ACCEPT to close open captures */
1785 
1786   /* This is used to skip a subpattern with a {0} quantifier */
1787 
1788   OP_SKIPZERO,       /* 155 */
1789 
1790   /* This is not an opcode, but is used to check that tables indexed by opcode
1791   are the correct length, in order to catch updating errors - there have been
1792   some in the past. */
1793 
1794   OP_TABLE_LENGTH
1795 };
1796 
1797 /* *** NOTE NOTE NOTE *** Whenever the list above is updated, the two macro
1798 definitions that follow must also be updated to match. There are also tables
1799 called &quot;coptable&quot; and &quot;poptable&quot; in pcre_dfa_exec.c that must be updated. */
1800 
1801 
1802 /* This macro defines textual names for all the opcodes. These are used only
1803 for debugging, and some of them are only partial names. The macro is referenced
1804 only in pcre_printint.c, which fills out the full names in many cases (and in
1805 some cases doesn&#39;t actually use these names at all). */
1806 
1807 #define OP_NAME_LIST \
1808   &quot;End&quot;, &quot;\\A&quot;, &quot;\\G&quot;, &quot;\\K&quot;, &quot;\\B&quot;, &quot;\\b&quot;, &quot;\\D&quot;, &quot;\\d&quot;,         \
1809   &quot;\\S&quot;, &quot;\\s&quot;, &quot;\\W&quot;, &quot;\\w&quot;, &quot;Any&quot;, &quot;AllAny&quot;, &quot;Anybyte&quot;,         \
1810   &quot;notprop&quot;, &quot;prop&quot;, &quot;\\R&quot;, &quot;\\H&quot;, &quot;\\h&quot;, &quot;\\V&quot;, &quot;\\v&quot;,           \
1811   &quot;extuni&quot;,  &quot;\\Z&quot;, &quot;\\z&quot;,                                        \
1812   &quot;^&quot;, &quot;^&quot;, &quot;$&quot;, &quot;$&quot;, &quot;char&quot;, &quot;chari&quot;, &quot;not&quot;, &quot;noti&quot;,             \
1813   &quot;*&quot;, &quot;*?&quot;, &quot;+&quot;, &quot;+?&quot;, &quot;?&quot;, &quot;??&quot;,                                \
1814   &quot;{&quot;, &quot;{&quot;, &quot;{&quot;,                                                  \
1815   &quot;*+&quot;,&quot;++&quot;, &quot;?+&quot;, &quot;{&quot;,                                           \
1816   &quot;*&quot;, &quot;*?&quot;, &quot;+&quot;, &quot;+?&quot;, &quot;?&quot;, &quot;??&quot;,                                \
1817   &quot;{&quot;, &quot;{&quot;, &quot;{&quot;,                                                  \
1818   &quot;*+&quot;,&quot;++&quot;, &quot;?+&quot;, &quot;{&quot;,                                           \
1819   &quot;*&quot;, &quot;*?&quot;, &quot;+&quot;, &quot;+?&quot;, &quot;?&quot;, &quot;??&quot;,                                \
1820   &quot;{&quot;, &quot;{&quot;, &quot;{&quot;,                                                  \
1821   &quot;*+&quot;,&quot;++&quot;, &quot;?+&quot;, &quot;{&quot;,                                           \
1822   &quot;*&quot;, &quot;*?&quot;, &quot;+&quot;, &quot;+?&quot;, &quot;?&quot;, &quot;??&quot;,                                \
1823   &quot;{&quot;, &quot;{&quot;, &quot;{&quot;,                                                  \
1824   &quot;*+&quot;,&quot;++&quot;, &quot;?+&quot;, &quot;{&quot;,                                           \
1825   &quot;*&quot;, &quot;*?&quot;, &quot;+&quot;, &quot;+?&quot;, &quot;?&quot;, &quot;??&quot;, &quot;{&quot;, &quot;{&quot;, &quot;{&quot;,                 \
1826   &quot;*+&quot;,&quot;++&quot;, &quot;?+&quot;, &quot;{&quot;,                                           \
1827   &quot;*&quot;, &quot;*?&quot;, &quot;+&quot;, &quot;+?&quot;, &quot;?&quot;, &quot;??&quot;, &quot;{&quot;, &quot;{&quot;,                      \
1828   &quot;class&quot;, &quot;nclass&quot;, &quot;xclass&quot;, &quot;Ref&quot;, &quot;Refi&quot;,                     \
1829   &quot;Recurse&quot;, &quot;Callout&quot;,                                           \
1830   &quot;Alt&quot;, &quot;Ket&quot;, &quot;KetRmax&quot;, &quot;KetRmin&quot;, &quot;KetRpos&quot;,                  \
1831   &quot;Reverse&quot;, &quot;Assert&quot;, &quot;Assert not&quot;, &quot;AssertB&quot;, &quot;AssertB not&quot;,    \
1832   &quot;Once&quot;, &quot;Once_NC&quot;,                                              \
1833   &quot;Bra&quot;, &quot;BraPos&quot;, &quot;CBra&quot;, &quot;CBraPos&quot;,                             \
1834   &quot;Cond&quot;,                                                         \
1835   &quot;SBra&quot;, &quot;SBraPos&quot;, &quot;SCBra&quot;, &quot;SCBraPos&quot;,                         \
1836   &quot;SCond&quot;,                                                        \
1837   &quot;Cond ref&quot;, &quot;Cond nref&quot;, &quot;Cond rec&quot;, &quot;Cond nrec&quot;, &quot;Cond def&quot;,   \
1838   &quot;Brazero&quot;, &quot;Braminzero&quot;, &quot;Braposzero&quot;,                          \
1839   &quot;*MARK&quot;, &quot;*PRUNE&quot;, &quot;*PRUNE&quot;, &quot;*SKIP&quot;, &quot;*SKIP&quot;,                  \
1840   &quot;*THEN&quot;, &quot;*THEN&quot;, &quot;*COMMIT&quot;, &quot;*FAIL&quot;,                           \
1841   &quot;*ACCEPT&quot;, &quot;*ASSERT_ACCEPT&quot;,                                    \
1842   &quot;Close&quot;, &quot;Skip zero&quot;
1843 
1844 
1845 /* This macro defines the length of fixed length operations in the compiled
1846 regex. The lengths are used when searching for specific things, and also in the
1847 debugging printing of a compiled regex. We use a macro so that it can be
1848 defined close to the definitions of the opcodes themselves.
1849 
1850 As things have been extended, some of these are no longer fixed lenths, but are
1851 minima instead. For example, the length of a single-character repeat may vary
1852 in UTF-8 mode. The code that uses this table must know about such things. */
1853 
1854 #define OP_LENGTHS \
1855   1,                             /* End                                    */ \
1856   1, 1, 1, 1, 1,                 /* \A, \G, \K, \B, \b                     */ \
1857   1, 1, 1, 1, 1, 1,              /* \D, \d, \S, \s, \W, \w                 */ \
1858   1, 1, 1,                       /* Any, AllAny, Anybyte                   */ \
1859   3, 3,                          /* \P, \p                                 */ \
1860   1, 1, 1, 1, 1,                 /* \R, \H, \h, \V, \v                     */ \
1861   1,                             /* \X                                     */ \
1862   1, 1, 1, 1, 1, 1,              /* \Z, \z, ^, ^M, $, $M                   */ \
1863   2,                             /* Char  - the minimum length             */ \
1864   2,                             /* Chari  - the minimum length            */ \
1865   2,                             /* not                                    */ \
1866   2,                             /* noti                                   */ \
1867   /* Positive single-char repeats                             ** These are */ \
1868   2, 2, 2, 2, 2, 2,              /* *, *?, +, +?, ?, ??       ** minima in */ \
1869   2+IMM2_SIZE, 2+IMM2_SIZE,      /* upto, minupto             ** mode      */ \
1870   2+IMM2_SIZE,                   /* exact                                  */ \
1871   2, 2, 2, 2+IMM2_SIZE,          /* *+, ++, ?+, upto+                      */ \
1872   2, 2, 2, 2, 2, 2,              /* *I, *?I, +I, +?I, ?I, ??I ** UTF-8     */ \
1873   2+IMM2_SIZE, 2+IMM2_SIZE,      /* upto I, minupto I                      */ \
1874   2+IMM2_SIZE,                   /* exact I                                */ \
1875   2, 2, 2, 2+IMM2_SIZE,          /* *+I, ++I, ?+I, upto+I                  */ \
1876   /* Negative single-char repeats - only for chars &lt; 256                   */ \
1877   2, 2, 2, 2, 2, 2,              /* NOT *, *?, +, +?, ?, ??                */ \
1878   2+IMM2_SIZE, 2+IMM2_SIZE,      /* NOT upto, minupto                      */ \
1879   2+IMM2_SIZE,                   /* NOT exact                              */ \
1880   2, 2, 2, 2+IMM2_SIZE,          /* Possessive NOT *, +, ?, upto           */ \
1881   2, 2, 2, 2, 2, 2,              /* NOT *I, *?I, +I, +?I, ?I, ??I          */ \
1882   2+IMM2_SIZE, 2+IMM2_SIZE,      /* NOT upto I, minupto I                  */ \
1883   2+IMM2_SIZE,                   /* NOT exact I                            */ \
1884   2, 2, 2, 2+IMM2_SIZE,          /* Possessive NOT *I, +I, ?I, upto I      */ \
1885   /* Positive type repeats                                                 */ \
1886   2, 2, 2, 2, 2, 2,              /* Type *, *?, +, +?, ?, ??               */ \
1887   2+IMM2_SIZE, 2+IMM2_SIZE,      /* Type upto, minupto                     */ \
1888   2+IMM2_SIZE,                   /* Type exact                             */ \
1889   2, 2, 2, 2+IMM2_SIZE,          /* Possessive *+, ++, ?+, upto+           */ \
1890   /* Character class &amp; ref repeats                                         */ \
1891   1, 1, 1, 1, 1, 1,              /* *, *?, +, +?, ?, ??                    */ \
1892   1+2*IMM2_SIZE, 1+2*IMM2_SIZE,  /* CRRANGE, CRMINRANGE                    */ \
1893   1+(32/sizeof(pcre_uchar)),     /* CLASS                                  */ \
1894   1+(32/sizeof(pcre_uchar)),     /* NCLASS                                 */ \
1895   0,                             /* XCLASS - variable length               */ \
1896   1+IMM2_SIZE,                   /* REF                                    */ \
1897   1+IMM2_SIZE,                   /* REFI                                   */ \
1898   1+LINK_SIZE,                   /* RECURSE                                */ \
1899   2+2*LINK_SIZE,                 /* CALLOUT                                */ \
1900   1+LINK_SIZE,                   /* Alt                                    */ \
1901   1+LINK_SIZE,                   /* Ket                                    */ \
1902   1+LINK_SIZE,                   /* KetRmax                                */ \
1903   1+LINK_SIZE,                   /* KetRmin                                */ \
1904   1+LINK_SIZE,                   /* KetRpos                                */ \
1905   1+LINK_SIZE,                   /* Reverse                                */ \
1906   1+LINK_SIZE,                   /* Assert                                 */ \
1907   1+LINK_SIZE,                   /* Assert not                             */ \
1908   1+LINK_SIZE,                   /* Assert behind                          */ \
1909   1+LINK_SIZE,                   /* Assert behind not                      */ \
1910   1+LINK_SIZE,                   /* ONCE                                   */ \
1911   1+LINK_SIZE,                   /* ONCE_NC                                */ \
1912   1+LINK_SIZE,                   /* BRA                                    */ \
1913   1+LINK_SIZE,                   /* BRAPOS                                 */ \
1914   1+LINK_SIZE+IMM2_SIZE,         /* CBRA                                   */ \
1915   1+LINK_SIZE+IMM2_SIZE,         /* CBRAPOS                                */ \
1916   1+LINK_SIZE,                   /* COND                                   */ \
1917   1+LINK_SIZE,                   /* SBRA                                   */ \
1918   1+LINK_SIZE,                   /* SBRAPOS                                */ \
1919   1+LINK_SIZE+IMM2_SIZE,         /* SCBRA                                  */ \
1920   1+LINK_SIZE+IMM2_SIZE,         /* SCBRAPOS                               */ \
1921   1+LINK_SIZE,                   /* SCOND                                  */ \
1922   1+IMM2_SIZE, 1+IMM2_SIZE,      /* CREF, NCREF                            */ \
1923   1+IMM2_SIZE, 1+IMM2_SIZE,      /* RREF, NRREF                            */ \
1924   1,                             /* DEF                                    */ \
1925   1, 1, 1,                       /* BRAZERO, BRAMINZERO, BRAPOSZERO        */ \
1926   3, 1, 3,                       /* MARK, PRUNE, PRUNE_ARG                 */ \
1927   1, 3,                          /* SKIP, SKIP_ARG                         */ \
1928   1, 3,                          /* THEN, THEN_ARG                         */ \
1929   1, 1, 1, 1,                    /* COMMIT, FAIL, ACCEPT, ASSERT_ACCEPT    */ \
1930   1+IMM2_SIZE, 1                 /* CLOSE, SKIPZERO                        */
1931 
1932 /* A magic value for OP_RREF and OP_NRREF to indicate the &quot;any recursion&quot;
1933 condition. */
1934 
1935 #define RREF_ANY  0xffff
1936 
1937 /* Compile time error code numbers. They are given names so that they can more
1938 easily be tracked. When a new number is added, the table called eint in
1939 pcreposix.c must be updated. */
1940 
1941 enum { ERR0,  ERR1,  ERR2,  ERR3,  ERR4,  ERR5,  ERR6,  ERR7,  ERR8,  ERR9,
1942        ERR10, ERR11, ERR12, ERR13, ERR14, ERR15, ERR16, ERR17, ERR18, ERR19,
1943        ERR20, ERR21, ERR22, ERR23, ERR24, ERR25, ERR26, ERR27, ERR28, ERR29,
1944        ERR30, ERR31, ERR32, ERR33, ERR34, ERR35, ERR36, ERR37, ERR38, ERR39,
1945        ERR40, ERR41, ERR42, ERR43, ERR44, ERR45, ERR46, ERR47, ERR48, ERR49,
1946        ERR50, ERR51, ERR52, ERR53, ERR54, ERR55, ERR56, ERR57, ERR58, ERR59,
1947        ERR60, ERR61, ERR62, ERR63, ERR64, ERR65, ERR66, ERR67, ERR68, ERR69,
1948        ERR70, ERR71, ERR72, ERR73, ERR74, ERR75, ERR76, ERRCOUNT };
1949 
1950 /* JIT compiling modes. The function list is indexed by them. */
1951 enum { JIT_COMPILE, JIT_PARTIAL_SOFT_COMPILE, JIT_PARTIAL_HARD_COMPILE,
1952        JIT_NUMBER_OF_COMPILE_MODES };
1953 
1954 /* The real format of the start of the pcre block; the index of names and the
1955 code vector run on as long as necessary after the end. We store an explicit
1956 offset to the name table so that if a regex is compiled on one host, saved, and
1957 then run on another where the size of pointers is different, all might still
1958 be well. For the case of compiled-on-4 and run-on-8, we include an extra
1959 pointer that is always NULL. For future-proofing, a few dummy fields were
1960 originally included - even though you can never get this planning right - but
1961 there is only one left now.
1962 
1963 NOTE NOTE NOTE:
1964 Because people can now save and re-use compiled patterns, any additions to this
1965 structure should be made at the end, and something earlier (e.g. a new
1966 flag in the options or one of the dummy fields) should indicate that the new
1967 fields are present. Currently PCRE always sets the dummy fields to zero.
1968 NOTE NOTE NOTE
1969 */
1970 
1971 #ifdef COMPILE_PCRE8
1972 #define REAL_PCRE real_pcre
1973 #else
1974 #define REAL_PCRE real_pcre16
1975 #endif
1976 
1977 typedef struct REAL_PCRE {
1978   pcre_uint32 magic_number;
1979   pcre_uint32 size;               /* Total that was malloced */
1980   pcre_uint32 options;            /* Public options */
1981   pcre_uint16 flags;              /* Private flags */
1982   pcre_uint16 max_lookbehind;     /* Longest lookbehind (characters) */
1983   pcre_uint16 top_bracket;        /* Highest numbered group */
1984   pcre_uint16 top_backref;        /* Highest numbered back reference */
1985   pcre_uint16 first_char;         /* Starting character */
1986   pcre_uint16 req_char;           /* This character must be seen */
1987   pcre_uint16 name_table_offset;  /* Offset to name table that follows */
1988   pcre_uint16 name_entry_size;    /* Size of any name items */
1989   pcre_uint16 name_count;         /* Number of name items */
1990   pcre_uint16 ref_count;          /* Reference count */
1991   const pcre_uint8 *tables;       /* Pointer to tables or NULL for std */
1992   const pcre_uint8 *nullpad;      /* NULL padding */
1993 } REAL_PCRE;
1994 
1995 /* The format of the block used to store data from pcre_study(). The same
1996 remark (see NOTE above) about extending this structure applies. */
1997 
1998 typedef struct pcre_study_data {
1999   pcre_uint32 size;               /* Total that was malloced */
2000   pcre_uint32 flags;              /* Private flags */
2001   pcre_uint8 start_bits[32];      /* Starting char bits */
2002   pcre_uint32 minlength;          /* Minimum subject length */
2003 } pcre_study_data;
2004 
2005 /* Structure for building a chain of open capturing subpatterns during
2006 compiling, so that instructions to close them can be compiled when (*ACCEPT) is
2007 encountered. This is also used to identify subpatterns that contain recursive
2008 back references to themselves, so that they can be made atomic. */
2009 
2010 typedef struct open_capitem {
2011   struct open_capitem *next;    /* Chain link */
2012   pcre_uint16 number;           /* Capture number */
2013   pcre_uint16 flag;             /* Set TRUE if recursive back ref */
2014 } open_capitem;
2015 
2016 /* Structure for passing &quot;static&quot; information around between the functions
2017 doing the compiling, so that they are thread-safe. */
2018 
2019 typedef struct compile_data {
2020   const pcre_uint8 *lcc;            /* Points to lower casing table */
2021   const pcre_uint8 *fcc;            /* Points to case-flipping table */
2022   const pcre_uint8 *cbits;          /* Points to character type table */
2023   const pcre_uint8 *ctypes;         /* Points to table of type maps */
2024   const pcre_uchar *start_workspace;/* The start of working space */
2025   const pcre_uchar *start_code;     /* The start of the compiled code */
2026   const pcre_uchar *start_pattern;  /* The start of the pattern */
2027   const pcre_uchar *end_pattern;    /* The end of the pattern */
2028   open_capitem *open_caps;          /* Chain of open capture items */
2029   pcre_uchar *hwm;                  /* High watermark of workspace */
2030   pcre_uchar *name_table;           /* The name/number table */
2031   int  names_found;                 /* Number of entries so far */
2032   int  name_entry_size;             /* Size of each entry */
2033   int  workspace_size;              /* Size of workspace */
2034   int  bracount;                    /* Count of capturing parens as we compile */
2035   int  final_bracount;              /* Saved value after first pass */
2036   int  max_lookbehind;              /* Maximum lookbehind (characters) */
2037   int  top_backref;                 /* Maximum back reference */
2038   unsigned int backref_map;         /* Bitmap of low back refs */
2039   int  assert_depth;                /* Depth of nested assertions */
2040   int  external_options;            /* External (initial) options */
2041   int  external_flags;              /* External flag bits to be set */
2042   int  req_varyopt;                 /* &quot;After variable item&quot; flag for reqbyte */
2043   BOOL had_accept;                  /* (*ACCEPT) encountered */
2044   BOOL check_lookbehind;            /* Lookbehinds need later checking */
2045   int  nltype;                      /* Newline type */
2046   int  nllen;                       /* Newline string length */
2047   pcre_uchar nl[4];                 /* Newline string when fixed length */
2048 } compile_data;
2049 
2050 /* Structure for maintaining a chain of pointers to the currently incomplete
2051 branches, for testing for left recursion while compiling. */
2052 
2053 typedef struct branch_chain {
2054   struct branch_chain *outer;
2055   pcre_uchar *current_branch;
2056 } branch_chain;
2057 
2058 /* Structure for items in a linked list that represents an explicit recursive
2059 call within the pattern; used by pcre_exec(). */
2060 
2061 typedef struct recursion_info {
2062   struct recursion_info *prevrec; /* Previous recursion record (or NULL) */
2063   int group_num;                  /* Number of group that was called */
2064   int *offset_save;               /* Pointer to start of saved offsets */
2065   int saved_max;                  /* Number of saved offsets */
2066   PCRE_PUCHAR subject_position;   /* Position at start of recursion */
2067 } recursion_info;
2068 
2069 /* A similar structure for pcre_dfa_exec(). */
2070 
2071 typedef struct dfa_recursion_info {
2072   struct dfa_recursion_info *prevrec;
2073   int group_num;
2074   PCRE_PUCHAR subject_position;
2075 } dfa_recursion_info;
2076 
2077 /* Structure for building a chain of data for holding the values of the subject
2078 pointer at the start of each subpattern, so as to detect when an empty string
2079 has been matched by a subpattern - to break infinite loops; used by
2080 pcre_exec(). */
2081 
2082 typedef struct eptrblock {
2083   struct eptrblock *epb_prev;
2084   PCRE_PUCHAR epb_saved_eptr;
2085 } eptrblock;
2086 
2087 
2088 /* Structure for passing &quot;static&quot; information around between the functions
2089 doing traditional NFA matching, so that they are thread-safe. */
2090 
2091 typedef struct match_data {
2092   unsigned long int match_call_count;      /* As it says */
2093   unsigned long int match_limit;           /* As it says */
2094   unsigned long int match_limit_recursion; /* As it says */
2095   int   *offset_vector;           /* Offset vector */
2096   int    offset_end;              /* One past the end */
2097   int    offset_max;              /* The maximum usable for return data */
2098   int    nltype;                  /* Newline type */
2099   int    nllen;                   /* Newline string length */
2100   int    name_count;              /* Number of names in name table */
2101   int    name_entry_size;         /* Size of entry in names table */
2102   pcre_uchar *name_table;         /* Table of names */
2103   pcre_uchar nl[4];               /* Newline string when fixed */
2104   const  pcre_uint8 *lcc;         /* Points to lower casing table */
2105   const  pcre_uint8 *fcc;         /* Points to case-flipping table */
2106   const  pcre_uint8 *ctypes;      /* Points to table of type maps */
2107   BOOL   offset_overflow;         /* Set if too many extractions */
2108   BOOL   notbol;                  /* NOTBOL flag */
2109   BOOL   noteol;                  /* NOTEOL flag */
2110   BOOL   utf;                     /* UTF-8 / UTF-16 flag */
2111   BOOL   jscript_compat;          /* JAVASCRIPT_COMPAT flag */
2112   BOOL   use_ucp;                 /* PCRE_UCP flag */
2113   BOOL   endonly;                 /* Dollar not before final \n */
2114   BOOL   notempty;                /* Empty string match not wanted */
2115   BOOL   notempty_atstart;        /* Empty string match at start not wanted */
2116   BOOL   hitend;                  /* Hit the end of the subject at some point */
2117   BOOL   bsr_anycrlf;             /* \R is just any CRLF, not full Unicode */
2118   BOOL   hasthen;                 /* Pattern contains (*THEN) */
2119   BOOL   ignore_skip_arg;         /* For re-run when SKIP name not found */
2120   const  pcre_uchar *start_code;  /* For use when recursing */
2121   PCRE_PUCHAR start_subject;      /* Start of the subject string */
2122   PCRE_PUCHAR end_subject;        /* End of the subject string */
2123   PCRE_PUCHAR start_match_ptr;    /* Start of matched string */
2124   PCRE_PUCHAR end_match_ptr;      /* Subject position at end match */
2125   PCRE_PUCHAR start_used_ptr;     /* Earliest consulted character */
2126   int    partial;                 /* PARTIAL options */
2127   int    end_offset_top;          /* Highwater mark at end of match */
2128   int    capture_last;            /* Most recent capture number */
2129   int    start_offset;            /* The start offset value */
2130   int    match_function_type;     /* Set for certain special calls of MATCH() */
2131   eptrblock *eptrchain;           /* Chain of eptrblocks for tail recursions */
2132   int    eptrn;                   /* Next free eptrblock */
2133   recursion_info *recursive;      /* Linked list of recursion data */
2134   void  *callout_data;            /* To pass back to callouts */
2135   const  pcre_uchar *mark;        /* Mark pointer to pass back on success */
2136   const  pcre_uchar *nomatch_mark;/* Mark pointer to pass back on failure */
2137   const  pcre_uchar *once_target; /* Where to back up to for atomic groups */
2138 #ifdef NO_RECURSE
2139   void  *match_frames_base;       /* For remembering malloc&#39;d frames */
2140 #endif
2141 } match_data;
2142 
2143 /* A similar structure is used for the same purpose by the DFA matching
2144 functions. */
2145 
2146 typedef struct dfa_match_data {
2147   const pcre_uchar *start_code;     /* Start of the compiled pattern */
2148   const pcre_uchar *start_subject ; /* Start of the subject string */
2149   const pcre_uchar *end_subject;    /* End of subject string */
2150   const pcre_uchar *start_used_ptr; /* Earliest consulted character */
2151   const pcre_uint8 *tables;         /* Character tables */
2152   int   start_offset;               /* The start offset value */
2153   int   moptions;                   /* Match options */
2154   int   poptions;                   /* Pattern options */
2155   int   nltype;                     /* Newline type */
2156   int   nllen;                      /* Newline string length */
2157   pcre_uchar nl[4];                 /* Newline string when fixed */
2158   void *callout_data;               /* To pass back to callouts */
2159   dfa_recursion_info *recursive;    /* Linked list of recursion data */
2160 } dfa_match_data;
2161 
2162 /* Bit definitions for entries in the pcre_ctypes table. */
2163 
2164 #define ctype_space   0x01
2165 #define ctype_letter  0x02
2166 #define ctype_digit   0x04
2167 #define ctype_xdigit  0x08
2168 #define ctype_word    0x10   /* alphanumeric or &#39;_&#39; */
2169 #define ctype_meta    0x80   /* regexp meta char or zero (end pattern) */
2170 
2171 /* Offsets for the bitmap tables in pcre_cbits. Each table contains a set
2172 of bits for a class map. Some classes are built by combining these tables. */
2173 
2174 #define cbit_space     0      /* [:space:] or \s */
2175 #define cbit_xdigit   32      /* [:xdigit:] */
2176 #define cbit_digit    64      /* [:digit:] or \d */
2177 #define cbit_upper    96      /* [:upper:] */
2178 #define cbit_lower   128      /* [:lower:] */
2179 #define cbit_word    160      /* [:word:] or \w */
2180 #define cbit_graph   192      /* [:graph:] */
2181 #define cbit_print   224      /* [:print:] */
2182 #define cbit_punct   256      /* [:punct:] */
2183 #define cbit_cntrl   288      /* [:cntrl:] */
2184 #define cbit_length  320      /* Length of the cbits table */
2185 
2186 /* Offsets of the various tables from the base tables pointer, and
2187 total length. */
2188 
2189 #define lcc_offset      0
2190 #define fcc_offset    256
2191 #define cbits_offset  512
2192 #define ctypes_offset (cbits_offset + cbit_length)
2193 #define tables_length (ctypes_offset + 256)
2194 
2195 /* Internal function and data prefixes. */
2196 
2197 #ifdef COMPILE_PCRE8
2198 #ifndef PUBL
2199 #define PUBL(name) pcre_##name
2200 #endif
2201 #ifndef PRIV
2202 #define PRIV(name) _pcre_##name
2203 #endif
2204 #else /* COMPILE_PCRE8 */
2205 #ifdef COMPILE_PCRE16
2206 #ifndef PUBL
2207 #define PUBL(name) pcre16_##name
2208 #endif
2209 #ifndef PRIV
2210 #define PRIV(name) _pcre16_##name
2211 #endif
2212 #else
2213 #error Unsupported compiling mode
2214 #endif /* COMPILE_PCRE16 */
2215 #endif /* COMPILE_PCRE8 */
2216 
2217 /* Layout of the UCP type table that translates property names into types and
2218 codes. Each entry used to point directly to a name, but to reduce the number of
2219 relocations in shared libraries, it now has an offset into a single string
2220 instead. */
2221 
2222 typedef struct {
2223   pcre_uint16 name_offset;
2224   pcre_uint16 type;
2225   pcre_uint16 value;
2226 } ucp_type_table;
2227 
2228 
2229 /* Internal shared data tables. These are tables that are used by more than one
2230 of the exported public functions. They have to be &quot;external&quot; in the C sense,
2231 but are not part of the PCRE public API. The data for these tables is in the
2232 pcre_tables.c module. */
2233 
2234 #ifdef COMPILE_PCRE8
2235 
2236 extern const int            PRIV(utf8_table1)[];
2237 extern const int            PRIV(utf8_table1_size);
2238 extern const int            PRIV(utf8_table2)[];
2239 extern const int            PRIV(utf8_table3)[];
2240 extern const pcre_uint8     PRIV(utf8_table4)[];
2241 
2242 #endif /* COMPILE_PCRE8 */
2243 
2244 extern const char           PRIV(utt_names)[];
2245 extern const ucp_type_table PRIV(utt)[];
2246 extern const int            PRIV(utt_size);
2247 
2248 extern const pcre_uint8     PRIV(default_tables)[];
2249 
2250 extern const pcre_uint8     PRIV(OP_lengths)[];
2251 
2252 
2253 /* Internal shared functions. These are functions that are used by more than
2254 one of the exported public functions. They have to be &quot;external&quot; in the C
2255 sense, but are not part of the PCRE public API. */
2256 
2257 /* String comparison functions. */
2258 #ifdef COMPILE_PCRE8
2259 
2260 #define STRCMP_UC_UC(str1, str2) \
2261   strcmp((char *)(str1), (char *)(str2))
2262 #define STRCMP_UC_C8(str1, str2) \
2263   strcmp((char *)(str1), (str2))
2264 #define STRNCMP_UC_UC(str1, str2, num) \
2265   strncmp((char *)(str1), (char *)(str2), (num))
2266 #define STRNCMP_UC_C8(str1, str2, num) \
2267   strncmp((char *)(str1), (str2), (num))
2268 #define STRLEN_UC(str) strlen((const char *)str)
2269 
2270 #else
2271 
2272 extern int               PRIV(strcmp_uc_uc)(const pcre_uchar *,
2273                            const pcre_uchar *);
2274 extern int               PRIV(strcmp_uc_c8)(const pcre_uchar *,
2275                            const char *);
2276 extern int               PRIV(strncmp_uc_uc)(const pcre_uchar *,
2277                            const pcre_uchar *, unsigned int num);
2278 extern int               PRIV(strncmp_uc_c8)(const pcre_uchar *,
2279                            const char *, unsigned int num);
2280 extern unsigned int      PRIV(strlen_uc)(const pcre_uchar *str);
2281 
2282 #define STRCMP_UC_UC(str1, str2) \
2283   PRIV(strcmp_uc_uc)((str1), (str2))
2284 #define STRCMP_UC_C8(str1, str2) \
2285   PRIV(strcmp_uc_c8)((str1), (str2))
2286 #define STRNCMP_UC_UC(str1, str2, num) \
2287   PRIV(strncmp_uc_uc)((str1), (str2), (num))
2288 #define STRNCMP_UC_C8(str1, str2, num) \
2289   PRIV(strncmp_uc_c8)((str1), (str2), (num))
2290 #define STRLEN_UC(str) PRIV(strlen_uc)(str)
2291 
2292 #endif /* COMPILE_PCRE8 */
2293 
2294 extern const pcre_uchar *PRIV(find_bracket)(const pcre_uchar *, BOOL, int);
2295 extern BOOL              PRIV(is_newline)(PCRE_PUCHAR, int, PCRE_PUCHAR,
2296                            int *, BOOL);
2297 extern int               PRIV(ord2utf)(pcre_uint32, pcre_uchar *);
2298 extern int               PRIV(valid_utf)(PCRE_PUCHAR, int, int *);
2299 extern BOOL              PRIV(was_newline)(PCRE_PUCHAR, int, PCRE_PUCHAR,
2300                            int *, BOOL);
2301 extern BOOL              PRIV(xclass)(int, const pcre_uchar *, BOOL);
2302 
2303 #ifdef SUPPORT_JIT
2304 extern void              PRIV(jit_compile)(const REAL_PCRE *,
2305                            PUBL(extra) *, int);
2306 extern int               PRIV(jit_exec)(const REAL_PCRE *, const PUBL(extra) *,
2307                            const pcre_uchar *, int, int, int, int *, int);
2308 extern void              PRIV(jit_free)(void *);
2309 extern int               PRIV(jit_get_size)(void *);
2310 extern const char*       PRIV(jit_get_target)(void);
2311 #endif
2312 
2313 /* Unicode character database (UCD) */
2314 
2315 extern const int         PRIV(ucp_gentype)[];
2316 #ifdef SUPPORT_JIT
2317 extern const int         PRIV(ucp_typerange)[];
2318 #endif
2319 
2320 #ifdef SUPPORT_UCP
2321 /* UCD access macros */
2322 
2323 unsigned int _pcre_ucp_othercase(const unsigned int c);
2324 
2325 #define UCD_CHARTYPE(ch)  (pcre_uint8)g_unichar_type((gunichar)(ch))
2326 #define UCD_SCRIPT(ch)    (pcre_uint8)g_unichar_get_script((gunichar)(ch))
2327 #define UCD_CATEGORY(ch)  PRIV(ucp_gentype)[UCD_CHARTYPE(ch)]
2328 #define UCD_OTHERCASE(ch) (_pcre_ucp_othercase(ch))
2329 
2330 #endif /* SUPPORT_UCP */
2331 
2332 #endif
2333 
2334 /* End of pcre_internal.h */
    </pre>
  </body>
</html>