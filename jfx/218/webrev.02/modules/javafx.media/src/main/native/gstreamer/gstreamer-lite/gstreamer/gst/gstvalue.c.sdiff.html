<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gstreamer/gst/gstvalue.c</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../3rd_party/libffi/src/x86/win64.S.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../../projects/mac/glib-lite/Makefile.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gstreamer/gst/gstvalue.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
7093       }
7094 
7095       tmp = g_strconcat (result,
7096           first ? &quot;:&quot; : &quot;&quot;,
7097           (flags &amp; fl-&gt;value) ? &quot;+&quot; : &quot;/&quot;, fl-&gt;value_nick, NULL);
7098       g_free (result);
7099       result = tmp;
7100       first = FALSE;
7101 
7102       /* clear flag */
7103       mask &amp;= ~fl-&gt;value;
7104     }
7105     g_type_class_unref (flags_klass);
7106 
7107   }
7108   g_type_class_unref (set_klass);
7109 
7110   return result;
7111 }
7112 

7113 static gboolean
7114 is_valid_flags_string (const gchar * s)
7115 {
7116   /* We&#39;re looking to match +this/that+other-thing/not-this-thing type strings */
7117   return g_regex_match_simple (&quot;^([\\+\\/][\\w\\d-]+)+$&quot;, s, G_REGEX_CASELESS,
7118       0);
7119 }
7120 
7121 static gboolean
7122 gst_value_deserialize_flagset (GValue * dest, const gchar * s)
7123 {
7124   gboolean res = FALSE;
7125   guint flags, mask;
7126   gchar *cur, *next;
7127 
7128   if (G_UNLIKELY (s == NULL))
7129     return FALSE;
7130 
7131   if (G_UNLIKELY (dest == NULL || !GST_VALUE_HOLDS_FLAG_SET (dest)))
7132     return FALSE;
</pre>
<hr />
<pre>
7223 
7224 }
7225 
7226 static void
7227 gst_value_transform_flagset_string (const GValue * src_value,
7228     GValue * dest_value)
7229 {
7230   dest_value-&gt;data[0].v_pointer = gst_value_serialize_flagset (src_value);
7231 }
7232 
7233 static void
7234 gst_value_transform_string_flagset (const GValue * src_value,
7235     GValue * dest_value)
7236 {
7237   if (!gst_value_deserialize_flagset (dest_value, src_value-&gt;data[0].v_pointer)) {
7238     /* If the deserialize fails, ensure we leave the flags in a
7239      * valid, if incorrect, state */
7240     gst_value_set_flagset (dest_value, 0, 0);
7241   }
7242 }

7243 
7244 static gint
7245 gst_value_compare_flagset (const GValue * value1, const GValue * value2)
7246 {
7247   guint v1, v2;
7248   guint m1, m2;
7249 
7250   v1 = value1-&gt;data[0].v_uint;
7251   v2 = value2-&gt;data[0].v_uint;
7252 
7253   m1 = value1-&gt;data[1].v_uint;
7254   m2 = value2-&gt;data[1].v_uint;
7255 
7256   if (v1 == v2 &amp;&amp; m1 == m2)
7257     return GST_VALUE_EQUAL;
7258 
7259   return GST_VALUE_UNORDERED;
7260 }
7261 
7262 /***********************
</pre>
<hr />
<pre>
7524       sizeof (GstValueIntersectInfo), GST_VALUE_INTERSECT_TABLE_DEFAULT_SIZE);
7525   gst_value_subtract_funcs = g_array_sized_new (FALSE, FALSE,
7526       sizeof (GstValueSubtractInfo), GST_VALUE_SUBTRACT_TABLE_DEFAULT_SIZE);
7527 
7528   REGISTER_SERIALIZATION (gst_int_range_get_type (), int_range);
7529   REGISTER_SERIALIZATION (gst_int64_range_get_type (), int64_range);
7530   REGISTER_SERIALIZATION (gst_double_range_get_type (), double_range);
7531   REGISTER_SERIALIZATION (gst_fraction_range_get_type (), fraction_range);
7532   REGISTER_SERIALIZATION (gst_value_list_get_type (), value_list);
7533   REGISTER_SERIALIZATION (gst_value_array_get_type (), value_array);
7534   REGISTER_SERIALIZATION (g_value_array_get_type (), g_value_array);
7535   REGISTER_SERIALIZATION (gst_buffer_get_type (), buffer);
7536   REGISTER_SERIALIZATION (gst_sample_get_type (), sample);
7537   REGISTER_SERIALIZATION (gst_fraction_get_type (), fraction);
7538   REGISTER_SERIALIZATION (gst_caps_get_type (), caps);
7539   REGISTER_SERIALIZATION (gst_tag_list_get_type (), tag_list);
7540   REGISTER_SERIALIZATION (G_TYPE_DATE, date);
7541   REGISTER_SERIALIZATION (gst_date_time_get_type (), date_time);
7542   REGISTER_SERIALIZATION (gst_bitmask_get_type (), bitmask);
7543   REGISTER_SERIALIZATION (gst_structure_get_type (), structure);

7544   REGISTER_SERIALIZATION (gst_flagset_get_type (), flagset);

7545 
7546   REGISTER_SERIALIZATION_NO_COMPARE (gst_segment_get_type (), segment);
7547   REGISTER_SERIALIZATION_NO_COMPARE (gst_caps_features_get_type (),
7548       caps_features);
7549 
7550   REGISTER_SERIALIZATION_COMPARE_ONLY (gst_allocation_params_get_type (),
7551       allocation_params);
7552   REGISTER_SERIALIZATION_COMPARE_ONLY (G_TYPE_OBJECT, object);
7553 
7554   REGISTER_SERIALIZATION_CONST (G_TYPE_DOUBLE, double);
7555   REGISTER_SERIALIZATION_CONST (G_TYPE_FLOAT, float);
7556 
7557   REGISTER_SERIALIZATION_CONST (G_TYPE_STRING, string);
7558   REGISTER_SERIALIZATION_CONST (G_TYPE_BOOLEAN, boolean);
7559   REGISTER_SERIALIZATION_CONST (G_TYPE_ENUM, enum);
7560 
7561   REGISTER_SERIALIZATION_CONST (G_TYPE_FLAGS, gflags);
7562 
7563   REGISTER_SERIALIZATION_CONST (G_TYPE_INT, int);
7564 
</pre>
<hr />
<pre>
7605       gst_value_transform_fraction_float);
7606   g_value_register_transform_func (G_TYPE_DOUBLE, GST_TYPE_FRACTION,
7607       gst_value_transform_double_fraction);
7608   g_value_register_transform_func (G_TYPE_FLOAT, GST_TYPE_FRACTION,
7609       gst_value_transform_float_fraction);
7610   g_value_register_transform_func (G_TYPE_DATE, G_TYPE_STRING,
7611       gst_value_transform_date_string);
7612   g_value_register_transform_func (G_TYPE_STRING, G_TYPE_DATE,
7613       gst_value_transform_string_date);
7614   g_value_register_transform_func (GST_TYPE_OBJECT, G_TYPE_STRING,
7615       gst_value_transform_object_string);
7616   g_value_register_transform_func (GST_TYPE_BITMASK, G_TYPE_UINT64,
7617       gst_value_transform_bitmask_uint64);
7618   g_value_register_transform_func (GST_TYPE_BITMASK, G_TYPE_STRING,
7619       gst_value_transform_bitmask_string);
7620   g_value_register_transform_func (G_TYPE_UINT64, GST_TYPE_BITMASK,
7621       gst_value_transform_uint64_bitmask);
7622   g_value_register_transform_func (G_TYPE_STRING, GST_TYPE_BITMASK,
7623       gst_value_transform_string_bitmask);
7624 

7625   g_value_register_transform_func (GST_TYPE_FLAG_SET, G_TYPE_STRING,
7626       gst_value_transform_flagset_string);
7627   g_value_register_transform_func (G_TYPE_STRING, GST_TYPE_FLAG_SET,
7628       gst_value_transform_string_flagset);

7629 
7630   gst_value_register_intersect_func (G_TYPE_INT, GST_TYPE_INT_RANGE,
7631       gst_value_intersect_int_int_range);
7632   gst_value_register_intersect_func (GST_TYPE_INT_RANGE, GST_TYPE_INT_RANGE,
7633       gst_value_intersect_int_range_int_range);
7634   gst_value_register_intersect_func (G_TYPE_INT64, GST_TYPE_INT64_RANGE,
7635       gst_value_intersect_int64_int64_range);
7636   gst_value_register_intersect_func (GST_TYPE_INT64_RANGE,
7637       GST_TYPE_INT64_RANGE, gst_value_intersect_int64_range_int64_range);
7638   gst_value_register_intersect_func (G_TYPE_DOUBLE, GST_TYPE_DOUBLE_RANGE,
7639       gst_value_intersect_double_double_range);
7640   gst_value_register_intersect_func (GST_TYPE_DOUBLE_RANGE,
7641       GST_TYPE_DOUBLE_RANGE, gst_value_intersect_double_range_double_range);
7642   gst_value_register_intersect_func (GST_TYPE_ARRAY, GST_TYPE_ARRAY,
7643       gst_value_intersect_array);
7644   gst_value_register_intersect_func (GST_TYPE_FRACTION,
7645       GST_TYPE_FRACTION_RANGE, gst_value_intersect_fraction_fraction_range);
7646   gst_value_register_intersect_func (GST_TYPE_FRACTION_RANGE,
7647       GST_TYPE_FRACTION_RANGE,
7648       gst_value_intersect_fraction_range_fraction_range);
</pre>
</td>
<td>
<hr />
<pre>
7093       }
7094 
7095       tmp = g_strconcat (result,
7096           first ? &quot;:&quot; : &quot;&quot;,
7097           (flags &amp; fl-&gt;value) ? &quot;+&quot; : &quot;/&quot;, fl-&gt;value_nick, NULL);
7098       g_free (result);
7099       result = tmp;
7100       first = FALSE;
7101 
7102       /* clear flag */
7103       mask &amp;= ~fl-&gt;value;
7104     }
7105     g_type_class_unref (flags_klass);
7106 
7107   }
7108   g_type_class_unref (set_klass);
7109 
7110   return result;
7111 }
7112 
<span class="line-added">7113 #ifndef GSTREAMER_LITE</span>
7114 static gboolean
7115 is_valid_flags_string (const gchar * s)
7116 {
7117   /* We&#39;re looking to match +this/that+other-thing/not-this-thing type strings */
7118   return g_regex_match_simple (&quot;^([\\+\\/][\\w\\d-]+)+$&quot;, s, G_REGEX_CASELESS,
7119       0);
7120 }
7121 
7122 static gboolean
7123 gst_value_deserialize_flagset (GValue * dest, const gchar * s)
7124 {
7125   gboolean res = FALSE;
7126   guint flags, mask;
7127   gchar *cur, *next;
7128 
7129   if (G_UNLIKELY (s == NULL))
7130     return FALSE;
7131 
7132   if (G_UNLIKELY (dest == NULL || !GST_VALUE_HOLDS_FLAG_SET (dest)))
7133     return FALSE;
</pre>
<hr />
<pre>
7224 
7225 }
7226 
7227 static void
7228 gst_value_transform_flagset_string (const GValue * src_value,
7229     GValue * dest_value)
7230 {
7231   dest_value-&gt;data[0].v_pointer = gst_value_serialize_flagset (src_value);
7232 }
7233 
7234 static void
7235 gst_value_transform_string_flagset (const GValue * src_value,
7236     GValue * dest_value)
7237 {
7238   if (!gst_value_deserialize_flagset (dest_value, src_value-&gt;data[0].v_pointer)) {
7239     /* If the deserialize fails, ensure we leave the flags in a
7240      * valid, if incorrect, state */
7241     gst_value_set_flagset (dest_value, 0, 0);
7242   }
7243 }
<span class="line-added">7244 #endif // GSTREAMER_LITE</span>
7245 
7246 static gint
7247 gst_value_compare_flagset (const GValue * value1, const GValue * value2)
7248 {
7249   guint v1, v2;
7250   guint m1, m2;
7251 
7252   v1 = value1-&gt;data[0].v_uint;
7253   v2 = value2-&gt;data[0].v_uint;
7254 
7255   m1 = value1-&gt;data[1].v_uint;
7256   m2 = value2-&gt;data[1].v_uint;
7257 
7258   if (v1 == v2 &amp;&amp; m1 == m2)
7259     return GST_VALUE_EQUAL;
7260 
7261   return GST_VALUE_UNORDERED;
7262 }
7263 
7264 /***********************
</pre>
<hr />
<pre>
7526       sizeof (GstValueIntersectInfo), GST_VALUE_INTERSECT_TABLE_DEFAULT_SIZE);
7527   gst_value_subtract_funcs = g_array_sized_new (FALSE, FALSE,
7528       sizeof (GstValueSubtractInfo), GST_VALUE_SUBTRACT_TABLE_DEFAULT_SIZE);
7529 
7530   REGISTER_SERIALIZATION (gst_int_range_get_type (), int_range);
7531   REGISTER_SERIALIZATION (gst_int64_range_get_type (), int64_range);
7532   REGISTER_SERIALIZATION (gst_double_range_get_type (), double_range);
7533   REGISTER_SERIALIZATION (gst_fraction_range_get_type (), fraction_range);
7534   REGISTER_SERIALIZATION (gst_value_list_get_type (), value_list);
7535   REGISTER_SERIALIZATION (gst_value_array_get_type (), value_array);
7536   REGISTER_SERIALIZATION (g_value_array_get_type (), g_value_array);
7537   REGISTER_SERIALIZATION (gst_buffer_get_type (), buffer);
7538   REGISTER_SERIALIZATION (gst_sample_get_type (), sample);
7539   REGISTER_SERIALIZATION (gst_fraction_get_type (), fraction);
7540   REGISTER_SERIALIZATION (gst_caps_get_type (), caps);
7541   REGISTER_SERIALIZATION (gst_tag_list_get_type (), tag_list);
7542   REGISTER_SERIALIZATION (G_TYPE_DATE, date);
7543   REGISTER_SERIALIZATION (gst_date_time_get_type (), date_time);
7544   REGISTER_SERIALIZATION (gst_bitmask_get_type (), bitmask);
7545   REGISTER_SERIALIZATION (gst_structure_get_type (), structure);
<span class="line-added">7546 #ifndef GSTREAMER_LITE</span>
7547   REGISTER_SERIALIZATION (gst_flagset_get_type (), flagset);
<span class="line-added">7548 #endif // GSTREAMER_LITE</span>
7549 
7550   REGISTER_SERIALIZATION_NO_COMPARE (gst_segment_get_type (), segment);
7551   REGISTER_SERIALIZATION_NO_COMPARE (gst_caps_features_get_type (),
7552       caps_features);
7553 
7554   REGISTER_SERIALIZATION_COMPARE_ONLY (gst_allocation_params_get_type (),
7555       allocation_params);
7556   REGISTER_SERIALIZATION_COMPARE_ONLY (G_TYPE_OBJECT, object);
7557 
7558   REGISTER_SERIALIZATION_CONST (G_TYPE_DOUBLE, double);
7559   REGISTER_SERIALIZATION_CONST (G_TYPE_FLOAT, float);
7560 
7561   REGISTER_SERIALIZATION_CONST (G_TYPE_STRING, string);
7562   REGISTER_SERIALIZATION_CONST (G_TYPE_BOOLEAN, boolean);
7563   REGISTER_SERIALIZATION_CONST (G_TYPE_ENUM, enum);
7564 
7565   REGISTER_SERIALIZATION_CONST (G_TYPE_FLAGS, gflags);
7566 
7567   REGISTER_SERIALIZATION_CONST (G_TYPE_INT, int);
7568 
</pre>
<hr />
<pre>
7609       gst_value_transform_fraction_float);
7610   g_value_register_transform_func (G_TYPE_DOUBLE, GST_TYPE_FRACTION,
7611       gst_value_transform_double_fraction);
7612   g_value_register_transform_func (G_TYPE_FLOAT, GST_TYPE_FRACTION,
7613       gst_value_transform_float_fraction);
7614   g_value_register_transform_func (G_TYPE_DATE, G_TYPE_STRING,
7615       gst_value_transform_date_string);
7616   g_value_register_transform_func (G_TYPE_STRING, G_TYPE_DATE,
7617       gst_value_transform_string_date);
7618   g_value_register_transform_func (GST_TYPE_OBJECT, G_TYPE_STRING,
7619       gst_value_transform_object_string);
7620   g_value_register_transform_func (GST_TYPE_BITMASK, G_TYPE_UINT64,
7621       gst_value_transform_bitmask_uint64);
7622   g_value_register_transform_func (GST_TYPE_BITMASK, G_TYPE_STRING,
7623       gst_value_transform_bitmask_string);
7624   g_value_register_transform_func (G_TYPE_UINT64, GST_TYPE_BITMASK,
7625       gst_value_transform_uint64_bitmask);
7626   g_value_register_transform_func (G_TYPE_STRING, GST_TYPE_BITMASK,
7627       gst_value_transform_string_bitmask);
7628 
<span class="line-added">7629 #ifndef GSTREAMER_LITE</span>
7630   g_value_register_transform_func (GST_TYPE_FLAG_SET, G_TYPE_STRING,
7631       gst_value_transform_flagset_string);
7632   g_value_register_transform_func (G_TYPE_STRING, GST_TYPE_FLAG_SET,
7633       gst_value_transform_string_flagset);
<span class="line-added">7634 #endif // GSTREAMER_LITE</span>
7635 
7636   gst_value_register_intersect_func (G_TYPE_INT, GST_TYPE_INT_RANGE,
7637       gst_value_intersect_int_int_range);
7638   gst_value_register_intersect_func (GST_TYPE_INT_RANGE, GST_TYPE_INT_RANGE,
7639       gst_value_intersect_int_range_int_range);
7640   gst_value_register_intersect_func (G_TYPE_INT64, GST_TYPE_INT64_RANGE,
7641       gst_value_intersect_int64_int64_range);
7642   gst_value_register_intersect_func (GST_TYPE_INT64_RANGE,
7643       GST_TYPE_INT64_RANGE, gst_value_intersect_int64_range_int64_range);
7644   gst_value_register_intersect_func (G_TYPE_DOUBLE, GST_TYPE_DOUBLE_RANGE,
7645       gst_value_intersect_double_double_range);
7646   gst_value_register_intersect_func (GST_TYPE_DOUBLE_RANGE,
7647       GST_TYPE_DOUBLE_RANGE, gst_value_intersect_double_range_double_range);
7648   gst_value_register_intersect_func (GST_TYPE_ARRAY, GST_TYPE_ARRAY,
7649       gst_value_intersect_array);
7650   gst_value_register_intersect_func (GST_TYPE_FRACTION,
7651       GST_TYPE_FRACTION_RANGE, gst_value_intersect_fraction_fraction_range);
7652   gst_value_register_intersect_func (GST_TYPE_FRACTION_RANGE,
7653       GST_TYPE_FRACTION_RANGE,
7654       gst_value_intersect_fraction_range_fraction_range);
</pre>
</td>
</tr>
</table>
<center><a href="../../../3rd_party/libffi/src/x86/win64.S.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../../projects/mac/glib-lite/Makefile.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>