<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.controls/src/main/java/javafx/scene/control/skin/ToolBarSkin.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ChoiceBoxSkin.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../test/java/test/javafx/scene/control/skin/SkinMemoryLeakTest.java.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.controls/src/main/java/javafx/scene/control/skin/ToolBarSkin.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -103,11 +103,11 @@</span>
      private ObservableList&lt;MenuItem&gt; overflowMenuItems;
      private boolean needsUpdate = false;
      private final ParentTraversalEngine engine;
      private final BehaviorBase&lt;ToolBar&gt; behavior;
  
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-added">+     private ListChangeListener&lt;Node&gt; itemsListener;</span>
  
      /***************************************************************************
       *                                                                         *
       * Constructors                                                            *
       *                                                                         *
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -226,12 +226,12 @@</span>
                  return selectPrev(box.getChildren().size() - 1, context);
              }
          });
          ParentHelper.setTraversalEngine(getSkinnable(), engine);
  
<span class="udiff-line-modified-removed">-         control.focusedProperty().addListener((observable, oldValue, newValue) -&gt; {</span>
<span class="udiff-line-modified-removed">-             if (newValue) {</span>
<span class="udiff-line-modified-added">+         registerChangeListener(control.focusedProperty(), ov -&gt; {</span>
<span class="udiff-line-modified-added">+             if (getSkinnable().isFocused()) {</span>
                  // TODO need to detect the focus direction
                  // to selected the first control in the toolbar when TAB is pressed
                  // or select the last control in the toolbar when SHIFT TAB is pressed.
                  if (!box.getChildren().isEmpty()) {
                      box.getChildren().get(0).requestFocus();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -239,20 +239,21 @@</span>
                      overflowMenu.requestFocus();
                  }
              }
          });
  
<span class="udiff-line-modified-removed">-         control.getItems().addListener((ListChangeListener&lt;Node&gt;) c -&gt; {</span>
<span class="udiff-line-modified-added">+         itemsListener = (ListChangeListener&lt;Node&gt;) c -&gt; {</span>
              while (c.next()) {
                  for (Node n: c.getRemoved()) {
                      box.getChildren().remove(n);
                  }
                  box.getChildren().addAll(c.getAddedSubList());
              }
              needsUpdate = true;
              getSkinnable().requestLayout();
<span class="udiff-line-modified-removed">-         });</span>
<span class="udiff-line-modified-added">+         };</span>
<span class="udiff-line-added">+         control.getItems().addListener(itemsListener);</span>
      }
  
  
  
      /***************************************************************************
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -363,10 +364,12 @@</span>
       *                                                                         *
       **************************************************************************/
  
      /** {@inheritDoc} */
      @Override public void dispose() {
<span class="udiff-line-added">+         if (getSkinnable() == null) return;</span>
<span class="udiff-line-added">+         getSkinnable().getItems().removeListener(itemsListener);</span>
          super.dispose();
  
          if (behavior != null) {
              behavior.dispose();
          }
</pre>
<center><a href="ChoiceBoxSkin.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../test/java/test/javafx/scene/control/skin/SkinMemoryLeakTest.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>