<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff tests/system/src/test/java/test/javafx/scene/web/SVGTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>tests/system/src/test/java/test/javafx/scene/web/SVGTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 96      * @bug 8223298
 97      * summary Checks if svg pattern is displayed properly
 98      */
 99     @Test public void testSVGRenderingWithPattern() {
100         final CountDownLatch webViewStateLatch = new CountDownLatch(1);
101         final String htmlSVGContent = &quot;\n&quot;
102             + &quot;&lt;html&gt;\n&quot;
103             + &quot;&lt;body style=&#39;margin: 0px 0px;&#39;&gt;\n&quot;
104             + &quot;&lt;svg width=&#39;400&#39; height=&#39;150&#39;&gt;\n&quot;
105             + &quot;&lt;defs&gt;\n&quot;
106             + &quot;&lt;pattern id=&#39;pattern1&#39; x=&#39;0&#39; y=&#39;0&#39; width=&#39;30&#39; height=&#39;30&#39; patternUnits=&#39;userSpaceOnUse&#39;&gt;\n&quot;
107             + &quot;&lt;rect width=&#39;20&#39; height=&#39;20&#39; fill=&#39;red&#39; /&gt;\n&quot;
108             + &quot;&lt;/pattern&gt;\n&quot;
109             + &quot;&lt;/defs&gt;\n&quot;
110             + &quot;&lt;rect width=&#39;400&#39; height=&#39;150&#39; fill=&#39;url(#pattern1)&#39; /&gt;\n&quot;
111             + &quot;&lt;/svg&gt;\n&quot;
112             + &quot;&lt;/body&gt;\n&quot;
113             + &quot;&lt;/html&gt;&quot;;
114 
115         Util.runAndWait(() -&gt; {

116             webView.getEngine().getLoadWorker().stateProperty().
117                 addListener((observable, oldValue, newValue) -&gt; {
118                 if (newValue == SUCCEEDED) {
119                     webView.requestFocus();
120                 }
121             });
122 
<span class="line-removed">123             assertNotNull(webView);</span>
<span class="line-removed">124             webView.getEngine().loadContent(htmlSVGContent);</span>
<span class="line-removed">125 </span>
126             webView.focusedProperty().
127                 addListener((observable, oldValue, newValue) -&gt; {
128                 if (newValue) {
129                     webViewStateLatch.countDown();
130                 }
131             });


132         });
133 
134         assertTrue(&quot;Timeout when waiting for focus change &quot;, Util.await(webViewStateLatch));
135         Util.sleep(1000);
136 
137         Util.runAndWait(() -&gt; {
138             WritableImage snapshot = svgTestApp.primaryStage.getScene().snapshot(null);
139             PixelReader pr = snapshot.getPixelReader();
140 
141             Color redColor = Color.color(1, 0, 0);
142             assertEquals(&quot;Color should be opaque red:&quot;, redColor, pr.getColor(0, 0));
143             assertEquals(&quot;Color should be opaque red:&quot;, redColor, pr.getColor(30, 30));
144             assertEquals(&quot;Color should be opaque red:&quot;, redColor, pr.getColor(49, 49));
145         });
146     }
147 }
</pre>
</td>
<td>
<hr />
<pre>
 96      * @bug 8223298
 97      * summary Checks if svg pattern is displayed properly
 98      */
 99     @Test public void testSVGRenderingWithPattern() {
100         final CountDownLatch webViewStateLatch = new CountDownLatch(1);
101         final String htmlSVGContent = &quot;\n&quot;
102             + &quot;&lt;html&gt;\n&quot;
103             + &quot;&lt;body style=&#39;margin: 0px 0px;&#39;&gt;\n&quot;
104             + &quot;&lt;svg width=&#39;400&#39; height=&#39;150&#39;&gt;\n&quot;
105             + &quot;&lt;defs&gt;\n&quot;
106             + &quot;&lt;pattern id=&#39;pattern1&#39; x=&#39;0&#39; y=&#39;0&#39; width=&#39;30&#39; height=&#39;30&#39; patternUnits=&#39;userSpaceOnUse&#39;&gt;\n&quot;
107             + &quot;&lt;rect width=&#39;20&#39; height=&#39;20&#39; fill=&#39;red&#39; /&gt;\n&quot;
108             + &quot;&lt;/pattern&gt;\n&quot;
109             + &quot;&lt;/defs&gt;\n&quot;
110             + &quot;&lt;rect width=&#39;400&#39; height=&#39;150&#39; fill=&#39;url(#pattern1)&#39; /&gt;\n&quot;
111             + &quot;&lt;/svg&gt;\n&quot;
112             + &quot;&lt;/body&gt;\n&quot;
113             + &quot;&lt;/html&gt;&quot;;
114 
115         Util.runAndWait(() -&gt; {
<span class="line-added">116             assertNotNull(webView);</span>
117             webView.getEngine().getLoadWorker().stateProperty().
118                 addListener((observable, oldValue, newValue) -&gt; {
119                 if (newValue == SUCCEEDED) {
120                     webView.requestFocus();
121                 }
122             });
123 



124             webView.focusedProperty().
125                 addListener((observable, oldValue, newValue) -&gt; {
126                 if (newValue) {
127                     webViewStateLatch.countDown();
128                 }
129             });
<span class="line-added">130 </span>
<span class="line-added">131             webView.getEngine().loadContent(htmlSVGContent);</span>
132         });
133 
134         assertTrue(&quot;Timeout when waiting for focus change &quot;, Util.await(webViewStateLatch));
135         Util.sleep(1000);
136 
137         Util.runAndWait(() -&gt; {
138             WritableImage snapshot = svgTestApp.primaryStage.getScene().snapshot(null);
139             PixelReader pr = snapshot.getPixelReader();
140 
141             Color redColor = Color.color(1, 0, 0);
142             assertEquals(&quot;Color should be opaque red:&quot;, redColor, pr.getColor(0, 0));
143             assertEquals(&quot;Color should be opaque red:&quot;, redColor, pr.getColor(30, 30));
144             assertEquals(&quot;Color should be opaque red:&quot;, redColor, pr.getColor(49, 49));
145         });
146     }
147 }
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>