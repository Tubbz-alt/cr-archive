<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff buildSrc/linux.gradle</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../index.html" target="_top">index</a> <a href="../modules/javafx.graphics/src/main/native-glass/gtk_new/GlassApplication.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>buildSrc/linux.gradle</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 64                  &quot;-z&quot;, &quot;relro&quot;,
 65                  &quot;-Wl,--gc-sections&quot;].flatten()
 66 
 67 def staticLinkFlags = [].flatten()
 68 
 69 def linkFlags = IS_STATIC_BUILD ? staticLinkFlags : dynamicLinkFlags;
 70 
 71 if (IS_DEBUG_NATIVE) {
 72     linkFlags += &quot;-g&quot;
 73 }
 74 
 75 def toolchainDir
 76 if (hasProperty(&#39;toolchainDir&#39;)) {
 77     toolchainDir = ext.toolchainDir + &quot;/&quot;
 78 } else {
 79     toolchainDir = &quot;&quot;
 80 }
 81 
 82 def gtk2CCFlags = [ &quot;-Wno-deprecated-declarations&quot; ];
 83 def gtk3CCFlags = [ &quot;-Wno-deprecated-declarations&quot; ];

 84 def gtk2LinkFlags = [ ];
 85 def gtk3LinkFlags = [ ];
 86 
 87 // Create $buildDir/linux_tools.properties file and load props from it
 88 setupTools(&quot;linux_gtk2&quot;,
 89     { propFile -&gt;
 90         ByteArrayOutputStream results1 = new ByteArrayOutputStream();
 91         exec {
 92             commandLine(&quot;${toolchainDir}pkg-config&quot;, &quot;--cflags&quot;, &quot;gtk+-2.0&quot;, &quot;gthread-2.0&quot;, &quot;xtst&quot;)
 93             setStandardOutput(results1);
 94         }
 95         propFile &lt;&lt; &quot;cflagsGTK2=&quot; &lt;&lt; results1.toString().trim() &lt;&lt; &quot;\n&quot;;
 96 
 97         ByteArrayOutputStream results3 = new ByteArrayOutputStream();
 98         exec {
 99             commandLine(&quot;${toolchainDir}pkg-config&quot;, &quot;--libs&quot;, &quot;gtk+-2.0&quot;, &quot;gthread-2.0&quot;, &quot;xtst&quot;)
100             setStandardOutput(results3);
101         }
102         propFile &lt;&lt; &quot;libsGTK2=&quot; &lt;&lt; results3.toString().trim()  &lt;&lt; &quot;\n&quot;;
103     },
</pre>
<hr />
<pre>
118         ByteArrayOutputStream results2 = new ByteArrayOutputStream();
119         exec {
120             commandLine(&quot;${toolchainDir}pkg-config&quot;, &quot;--cflags&quot;, &quot;gtk+-3.0&quot;, &quot;gthread-2.0&quot;, &quot;xtst&quot;)
121             setStandardOutput(results2);
122         }
123         propFile &lt;&lt; &quot;cflagsGTK3=&quot; &lt;&lt; results2.toString().trim() &lt;&lt; &quot;\n&quot;;
124 
125         ByteArrayOutputStream results4 = new ByteArrayOutputStream();
126         exec {
127             commandLine(&quot;${toolchainDir}pkg-config&quot;, &quot;--libs&quot;, &quot;gtk+-3.0&quot;, &quot;gthread-2.0&quot;, &quot;xtst&quot;)
128             setStandardOutput(results4);
129         }
130         propFile &lt;&lt; &quot;libsGTK3=&quot; &lt;&lt; results4.toString().trim()  &lt;&lt; &quot;\n&quot;;
131 
132     },
133     { properties -&gt;
134         def cflagsGTK3 = properties.getProperty(&quot;cflagsGTK3&quot;)
135         def libsGTK3 = properties.getProperty(&quot;libsGTK3&quot;)
136         if (cflagsGTK3 &amp;&amp; libsGTK3) {
137             gtk3CCFlags.addAll(cflagsGTK3.split(&quot; &quot;))

138             gtk3LinkFlags.addAll(libsGTK3.split(&quot; &quot;))
139         } else {
140             throw new IllegalStateException(&quot;GTK3 development packages not found. If GTK3 packages are installed, please remove the build directory and try again.&quot;)
141         }
142     }
143 )
144 
145 def pangoCCFlags = [&quot;-D_ENABLE_PANGO&quot;];
146 def pangoLinkFlags = [];
147 setupTools(&quot;linux_pango_tools&quot;,
148     { propFile -&gt;
149         ByteArrayOutputStream results = new ByteArrayOutputStream();
150         exec {
151             commandLine &quot;${toolchainDir}pkg-config&quot;, &quot;--cflags&quot;, &quot;pangoft2&quot;
152             standardOutput = results
153         }
154         propFile &lt;&lt; &quot;cflags=&quot; &lt;&lt; results.toString().trim() &lt;&lt; &quot;\n&quot;;
155 
156         results = new ByteArrayOutputStream();
157         exec {
</pre>
<hr />
<pre>
249         [&quot;-fno-threadsafe-statics&quot;, ccFlags, gtk3CCFlags].flatten() :
250         [ccFlags, gtk3CCFlags, &quot;-Werror&quot;].flatten()
251 LINUX.glass.glassgtk3.linker = linker
252 LINUX.glass.glassgtk3.linkFlags = IS_STATIC_BUILD ? linkFlags : [linkFlags, gtk3LinkFlags].flatten()
253 LINUX.glass.glassgtk3.lib = &quot;glassgtk3&quot;
254 
255 LINUX.glass.glassgtkn2 = [:]
256 LINUX.glass.glassgtkn2.nativeSource =  ft_gtkn.getFiles()
257 LINUX.glass.glassgtkn2.compiler = compiler
258 LINUX.glass.glassgtkn2.ccFlags = IS_STATIC_BUILD ?
259         [&quot;-fno-threadsafe-statics&quot;, ccFlags, gtk2CCFlags].flatten() :
260         [ccFlags, gtk2CCFlags, &quot;-Werror&quot;].flatten()
261 LINUX.glass.glassgtkn2.linker = linker
262 LINUX.glass.glassgtkn2.linkFlags = IS_STATIC_BUILD ? linkFlags : [linkFlags, gtk2LinkFlags].flatten()
263 LINUX.glass.glassgtkn2.lib = &quot;glassgtkn2&quot;
264 
265 LINUX.glass.glassgtkn3 = [:]
266 LINUX.glass.glassgtkn3.nativeSource =  ft_gtkn.getFiles()
267 LINUX.glass.glassgtkn3.compiler = compiler
268 LINUX.glass.glassgtkn3.ccFlags = IS_STATIC_BUILD ?
<span class="line-modified">269         [&quot;-fno-threadsafe-statics&quot;, ccFlags, gtk3CCFlags].flatten() :</span>
<span class="line-modified">270         [ccFlags, gtk3CCFlags, &quot;-Werror&quot;].flatten()</span>
271 LINUX.glass.glassgtkn3.linker = linker
272 LINUX.glass.glassgtkn3.linkFlags = IS_STATIC_BUILD ? linkFlags : [linkFlags, gtk3LinkFlags].flatten()
273 LINUX.glass.glassgtkn3.lib = &quot;glassgtkn3&quot;
274 
275 LINUX.decora = [:]
276 LINUX.decora.compiler = compiler
277 LINUX.decora.ccFlags = [ccFlags, &quot;-ffast-math&quot;].flatten()
278 LINUX.decora.linker = linker
279 LINUX.decora.linkFlags = [linkFlags].flatten()
280 LINUX.decora.lib = &quot;decora_sse&quot;
281 
282 LINUX.prism = [:]
283 LINUX.prism.nativeSource = file(&quot;${project(&quot;:graphics&quot;).projectDir}/src/main/native-prism&quot;)
284 LINUX.prism.compiler = compiler
285 LINUX.prism.ccFlags = [ccFlags, &quot;-DINLINE=inline&quot;].flatten()
286 LINUX.prism.linker = linker
287 LINUX.prism.linkFlags = [linkFlags].flatten()
288 LINUX.prism.lib = &quot;prism_common&quot;
289 
290 LINUX.prismSW = [:]
</pre>
</td>
<td>
<hr />
<pre>
 64                  &quot;-z&quot;, &quot;relro&quot;,
 65                  &quot;-Wl,--gc-sections&quot;].flatten()
 66 
 67 def staticLinkFlags = [].flatten()
 68 
 69 def linkFlags = IS_STATIC_BUILD ? staticLinkFlags : dynamicLinkFlags;
 70 
 71 if (IS_DEBUG_NATIVE) {
 72     linkFlags += &quot;-g&quot;
 73 }
 74 
 75 def toolchainDir
 76 if (hasProperty(&#39;toolchainDir&#39;)) {
 77     toolchainDir = ext.toolchainDir + &quot;/&quot;
 78 } else {
 79     toolchainDir = &quot;&quot;
 80 }
 81 
 82 def gtk2CCFlags = [ &quot;-Wno-deprecated-declarations&quot; ];
 83 def gtk3CCFlags = [ &quot;-Wno-deprecated-declarations&quot; ];
<span class="line-added"> 84 def gtkn3CCFlags = [ ];</span>
 85 def gtk2LinkFlags = [ ];
 86 def gtk3LinkFlags = [ ];
 87 
 88 // Create $buildDir/linux_tools.properties file and load props from it
 89 setupTools(&quot;linux_gtk2&quot;,
 90     { propFile -&gt;
 91         ByteArrayOutputStream results1 = new ByteArrayOutputStream();
 92         exec {
 93             commandLine(&quot;${toolchainDir}pkg-config&quot;, &quot;--cflags&quot;, &quot;gtk+-2.0&quot;, &quot;gthread-2.0&quot;, &quot;xtst&quot;)
 94             setStandardOutput(results1);
 95         }
 96         propFile &lt;&lt; &quot;cflagsGTK2=&quot; &lt;&lt; results1.toString().trim() &lt;&lt; &quot;\n&quot;;
 97 
 98         ByteArrayOutputStream results3 = new ByteArrayOutputStream();
 99         exec {
100             commandLine(&quot;${toolchainDir}pkg-config&quot;, &quot;--libs&quot;, &quot;gtk+-2.0&quot;, &quot;gthread-2.0&quot;, &quot;xtst&quot;)
101             setStandardOutput(results3);
102         }
103         propFile &lt;&lt; &quot;libsGTK2=&quot; &lt;&lt; results3.toString().trim()  &lt;&lt; &quot;\n&quot;;
104     },
</pre>
<hr />
<pre>
119         ByteArrayOutputStream results2 = new ByteArrayOutputStream();
120         exec {
121             commandLine(&quot;${toolchainDir}pkg-config&quot;, &quot;--cflags&quot;, &quot;gtk+-3.0&quot;, &quot;gthread-2.0&quot;, &quot;xtst&quot;)
122             setStandardOutput(results2);
123         }
124         propFile &lt;&lt; &quot;cflagsGTK3=&quot; &lt;&lt; results2.toString().trim() &lt;&lt; &quot;\n&quot;;
125 
126         ByteArrayOutputStream results4 = new ByteArrayOutputStream();
127         exec {
128             commandLine(&quot;${toolchainDir}pkg-config&quot;, &quot;--libs&quot;, &quot;gtk+-3.0&quot;, &quot;gthread-2.0&quot;, &quot;xtst&quot;)
129             setStandardOutput(results4);
130         }
131         propFile &lt;&lt; &quot;libsGTK3=&quot; &lt;&lt; results4.toString().trim()  &lt;&lt; &quot;\n&quot;;
132 
133     },
134     { properties -&gt;
135         def cflagsGTK3 = properties.getProperty(&quot;cflagsGTK3&quot;)
136         def libsGTK3 = properties.getProperty(&quot;libsGTK3&quot;)
137         if (cflagsGTK3 &amp;&amp; libsGTK3) {
138             gtk3CCFlags.addAll(cflagsGTK3.split(&quot; &quot;))
<span class="line-added">139             gtkn3CCFlags.addAll(cflagsGTK3.split(&quot; &quot;))</span>
140             gtk3LinkFlags.addAll(libsGTK3.split(&quot; &quot;))
141         } else {
142             throw new IllegalStateException(&quot;GTK3 development packages not found. If GTK3 packages are installed, please remove the build directory and try again.&quot;)
143         }
144     }
145 )
146 
147 def pangoCCFlags = [&quot;-D_ENABLE_PANGO&quot;];
148 def pangoLinkFlags = [];
149 setupTools(&quot;linux_pango_tools&quot;,
150     { propFile -&gt;
151         ByteArrayOutputStream results = new ByteArrayOutputStream();
152         exec {
153             commandLine &quot;${toolchainDir}pkg-config&quot;, &quot;--cflags&quot;, &quot;pangoft2&quot;
154             standardOutput = results
155         }
156         propFile &lt;&lt; &quot;cflags=&quot; &lt;&lt; results.toString().trim() &lt;&lt; &quot;\n&quot;;
157 
158         results = new ByteArrayOutputStream();
159         exec {
</pre>
<hr />
<pre>
251         [&quot;-fno-threadsafe-statics&quot;, ccFlags, gtk3CCFlags].flatten() :
252         [ccFlags, gtk3CCFlags, &quot;-Werror&quot;].flatten()
253 LINUX.glass.glassgtk3.linker = linker
254 LINUX.glass.glassgtk3.linkFlags = IS_STATIC_BUILD ? linkFlags : [linkFlags, gtk3LinkFlags].flatten()
255 LINUX.glass.glassgtk3.lib = &quot;glassgtk3&quot;
256 
257 LINUX.glass.glassgtkn2 = [:]
258 LINUX.glass.glassgtkn2.nativeSource =  ft_gtkn.getFiles()
259 LINUX.glass.glassgtkn2.compiler = compiler
260 LINUX.glass.glassgtkn2.ccFlags = IS_STATIC_BUILD ?
261         [&quot;-fno-threadsafe-statics&quot;, ccFlags, gtk2CCFlags].flatten() :
262         [ccFlags, gtk2CCFlags, &quot;-Werror&quot;].flatten()
263 LINUX.glass.glassgtkn2.linker = linker
264 LINUX.glass.glassgtkn2.linkFlags = IS_STATIC_BUILD ? linkFlags : [linkFlags, gtk2LinkFlags].flatten()
265 LINUX.glass.glassgtkn2.lib = &quot;glassgtkn2&quot;
266 
267 LINUX.glass.glassgtkn3 = [:]
268 LINUX.glass.glassgtkn3.nativeSource =  ft_gtkn.getFiles()
269 LINUX.glass.glassgtkn3.compiler = compiler
270 LINUX.glass.glassgtkn3.ccFlags = IS_STATIC_BUILD ?
<span class="line-modified">271         [&quot;-fno-threadsafe-statics&quot;, ccFlags, gtkn3CCFlags].flatten() :</span>
<span class="line-modified">272         [ccFlags, gtkn3CCFlags, &quot;-Werror&quot;].flatten()</span>
273 LINUX.glass.glassgtkn3.linker = linker
274 LINUX.glass.glassgtkn3.linkFlags = IS_STATIC_BUILD ? linkFlags : [linkFlags, gtk3LinkFlags].flatten()
275 LINUX.glass.glassgtkn3.lib = &quot;glassgtkn3&quot;
276 
277 LINUX.decora = [:]
278 LINUX.decora.compiler = compiler
279 LINUX.decora.ccFlags = [ccFlags, &quot;-ffast-math&quot;].flatten()
280 LINUX.decora.linker = linker
281 LINUX.decora.linkFlags = [linkFlags].flatten()
282 LINUX.decora.lib = &quot;decora_sse&quot;
283 
284 LINUX.prism = [:]
285 LINUX.prism.nativeSource = file(&quot;${project(&quot;:graphics&quot;).projectDir}/src/main/native-prism&quot;)
286 LINUX.prism.compiler = compiler
287 LINUX.prism.ccFlags = [ccFlags, &quot;-DINLINE=inline&quot;].flatten()
288 LINUX.prism.linker = linker
289 LINUX.prism.linkFlags = [linkFlags].flatten()
290 LINUX.prism.lib = &quot;prism_common&quot;
291 
292 LINUX.prismSW = [:]
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../index.html" target="_top">index</a> <a href="../modules/javafx.graphics/src/main/native-glass/gtk_new/GlassApplication.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>