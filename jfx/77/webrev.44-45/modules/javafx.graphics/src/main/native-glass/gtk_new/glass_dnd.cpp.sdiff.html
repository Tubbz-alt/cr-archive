<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.graphics/src/main/native-glass/gtk_new/glass_dnd.cpp</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="GlassRobot.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="glass_general.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.graphics/src/main/native-glass/gtk_new/glass_dnd.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
911 
912     gtk_widget_show_all(widget);
913     gtk_drag_set_icon_widget(context, widget, offset_x, offset_y);
914 #endif
915 }
916 
917 void DragView::View::screen_changed() {
918     GdkScreen *screen = gtk_widget_get_screen(widget);
919 
920     glass_configure_window_transparency(widget, true);
921 
922     if (!gdk_screen_is_composited(screen)) {
923         if (!is_offset_set) {
924             offset_x = 1;
925             offset_y = 1;
926         }
927     }
928 }
929 
930 void DragView::View::expose() {

931     cairo_t *context = gdk_cairo_create(gtk_widget_get_window(widget));
932 
933     cairo_surface_t *cairo_surface;
934 
935     guchar *pixels = is_raw_image
936                      ? (guchar *) convert_BGRA_to_RGBA((const int *) gdk_pixbuf_get_pixels(pixbuf),
937                                                        gdk_pixbuf_get_rowstride(pixbuf),
938                                                        height)
939                      : gdk_pixbuf_get_pixels(pixbuf);
940 
941     cairo_surface = cairo_image_surface_create_for_data(
942             pixels,
943             CAIRO_FORMAT_ARGB32,
944             width, height, width * 4);
945 
946     cairo_set_source_surface(context, cairo_surface, 0, 0);
947     cairo_set_operator(context, CAIRO_OPERATOR_SOURCE);
948     cairo_paint(context);
949 
950     if (is_raw_image) {
951         g_free(pixels);
952     }
953     cairo_destroy(context);
954     cairo_surface_destroy(cairo_surface);

955 }
</pre>
</td>
<td>
<hr />
<pre>
911 
912     gtk_widget_show_all(widget);
913     gtk_drag_set_icon_widget(context, widget, offset_x, offset_y);
914 #endif
915 }
916 
917 void DragView::View::screen_changed() {
918     GdkScreen *screen = gtk_widget_get_screen(widget);
919 
920     glass_configure_window_transparency(widget, true);
921 
922     if (!gdk_screen_is_composited(screen)) {
923         if (!is_offset_set) {
924             offset_x = 1;
925             offset_y = 1;
926         }
927     }
928 }
929 
930 void DragView::View::expose() {
<span class="line-added">931 #ifdef GLASS_GTK2</span>
932     cairo_t *context = gdk_cairo_create(gtk_widget_get_window(widget));
933 
934     cairo_surface_t *cairo_surface;
935 
936     guchar *pixels = is_raw_image
937                      ? (guchar *) convert_BGRA_to_RGBA((const int *) gdk_pixbuf_get_pixels(pixbuf),
938                                                        gdk_pixbuf_get_rowstride(pixbuf),
939                                                        height)
940                      : gdk_pixbuf_get_pixels(pixbuf);
941 
942     cairo_surface = cairo_image_surface_create_for_data(
943             pixels,
944             CAIRO_FORMAT_ARGB32,
945             width, height, width * 4);
946 
947     cairo_set_source_surface(context, cairo_surface, 0, 0);
948     cairo_set_operator(context, CAIRO_OPERATOR_SOURCE);
949     cairo_paint(context);
950 
951     if (is_raw_image) {
952         g_free(pixels);
953     }
954     cairo_destroy(context);
955     cairo_surface_destroy(cairo_surface);
<span class="line-added">956 #endif</span>
957 }
</pre>
</td>
</tr>
</table>
<center><a href="GlassRobot.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="glass_general.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>