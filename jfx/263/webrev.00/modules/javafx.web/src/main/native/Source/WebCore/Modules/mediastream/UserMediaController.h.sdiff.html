<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/Modules/mediastream/UserMediaController.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="UserMediaController.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="UserMediaRequest.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/Modules/mediastream/UserMediaController.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 10  * 2.  Redistributions in binary form must reproduce the above copyright
 11  *     notice, this list of conditions and the following disclaimer in the
 12  *     documentation and/or other materials provided with the distribution.
 13  *
 14  * THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39; AND ANY
 15  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 16  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 17  * DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 18  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 19  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 20  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 21  * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 23  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #if ENABLE(MEDIA_STREAM)
 29 

 30 #include &quot;Page.h&quot;
 31 #include &quot;UserMediaClient.h&quot;
 32 #include &lt;wtf/CompletionHandler.h&gt;
 33 
 34 namespace WebCore {
 35 
 36 class UserMediaRequest;
 37 
 38 class UserMediaController : public Supplement&lt;Page&gt; {
 39     WTF_MAKE_FAST_ALLOCATED;
 40 public:
 41     explicit UserMediaController(UserMediaClient*);
 42     ~UserMediaController();
 43 
 44     UserMediaClient* client() const { return m_client; }
 45 
 46     void requestUserMediaAccess(UserMediaRequest&amp;);
 47     void cancelUserMediaAccessRequest(UserMediaRequest&amp;);
 48 
 49     void enumerateMediaDevices(Document&amp;, CompletionHandler&lt;void(const Vector&lt;CaptureDevice&gt;&amp;, const String&amp;)&gt;&amp;&amp;);
 50 
 51     UserMediaClient::DeviceChangeObserverToken addDeviceChangeObserver(WTF::Function&lt;void()&gt;&amp;&amp;);
 52     void removeDeviceChangeObserver(UserMediaClient::DeviceChangeObserverToken);
 53 
<span class="line-modified"> 54     enum class GetUserMediaAccess {</span>
<span class="line-modified"> 55         CanCall,</span>
<span class="line-modified"> 56         InsecureDocument,</span>
<span class="line-removed"> 57         InsecureParent,</span>
<span class="line-removed"> 58         BlockedByParent,</span>
<span class="line-removed"> 59         BlockedByFeaturePolicy,</span>
<span class="line-removed"> 60     };</span>
<span class="line-removed"> 61     enum class CaptureType {</span>
<span class="line-removed"> 62         Microphone = 1 &lt;&lt; 0,</span>
<span class="line-removed"> 63         Camera = 1 &lt;&lt; 1,</span>
<span class="line-removed"> 64         Display = 1 &lt;&lt; 3</span>
<span class="line-removed"> 65     };</span>
<span class="line-removed"> 66     GetUserMediaAccess canCallGetUserMedia(const Document&amp;, OptionSet&lt;CaptureType&gt;) const;</span>
<span class="line-removed"> 67 </span>
<span class="line-removed"> 68     enum class BlockedCaller {</span>
<span class="line-removed"> 69         GetUserMedia,</span>
<span class="line-removed"> 70         GetDisplayMedia,</span>
<span class="line-removed"> 71         EnumerateDevices,</span>
<span class="line-removed"> 72     };</span>
<span class="line-removed"> 73     void logGetUserMediaDenial(Document&amp;, GetUserMediaAccess, BlockedCaller);</span>
 74 
 75     WEBCORE_EXPORT static const char* supplementName();
 76     static UserMediaController* from(Page* page) { return static_cast&lt;UserMediaController*&gt;(Supplement&lt;Page&gt;::from(page, supplementName())); }
 77 
 78 private:
 79     UserMediaClient* m_client;
 80 };
 81 
 82 inline void UserMediaController::requestUserMediaAccess(UserMediaRequest&amp; request)
 83 {
 84     m_client-&gt;requestUserMediaAccess(request);
 85 }
 86 
 87 inline void UserMediaController::cancelUserMediaAccessRequest(UserMediaRequest&amp; request)
 88 {
 89     m_client-&gt;cancelUserMediaAccessRequest(request);
 90 }
 91 
 92 inline void UserMediaController::enumerateMediaDevices(Document&amp; document, CompletionHandler&lt;void(const Vector&lt;CaptureDevice&gt;&amp;, const String&amp;)&gt;&amp;&amp; completionHandler)
 93 {
</pre>
</td>
<td>
<hr />
<pre>
 10  * 2.  Redistributions in binary form must reproduce the above copyright
 11  *     notice, this list of conditions and the following disclaimer in the
 12  *     documentation and/or other materials provided with the distribution.
 13  *
 14  * THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39; AND ANY
 15  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 16  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 17  * DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 18  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 19  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 20  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 21  * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 23  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #if ENABLE(MEDIA_STREAM)
 29 
<span class="line-added"> 30 #include &quot;FeaturePolicy.h&quot;</span>
 31 #include &quot;Page.h&quot;
 32 #include &quot;UserMediaClient.h&quot;
 33 #include &lt;wtf/CompletionHandler.h&gt;
 34 
 35 namespace WebCore {
 36 
 37 class UserMediaRequest;
 38 
 39 class UserMediaController : public Supplement&lt;Page&gt; {
 40     WTF_MAKE_FAST_ALLOCATED;
 41 public:
 42     explicit UserMediaController(UserMediaClient*);
 43     ~UserMediaController();
 44 
 45     UserMediaClient* client() const { return m_client; }
 46 
 47     void requestUserMediaAccess(UserMediaRequest&amp;);
 48     void cancelUserMediaAccessRequest(UserMediaRequest&amp;);
 49 
 50     void enumerateMediaDevices(Document&amp;, CompletionHandler&lt;void(const Vector&lt;CaptureDevice&gt;&amp;, const String&amp;)&gt;&amp;&amp;);
 51 
 52     UserMediaClient::DeviceChangeObserverToken addDeviceChangeObserver(WTF::Function&lt;void()&gt;&amp;&amp;);
 53     void removeDeviceChangeObserver(UserMediaClient::DeviceChangeObserverToken);
 54 
<span class="line-modified"> 55     void logGetUserMediaDenial(Document&amp;);</span>
<span class="line-modified"> 56     void logGetDisplayMediaDenial(Document&amp;);</span>
<span class="line-modified"> 57     void logEnumerateDevicesDenial(Document&amp;);</span>

















 58 
 59     WEBCORE_EXPORT static const char* supplementName();
 60     static UserMediaController* from(Page* page) { return static_cast&lt;UserMediaController*&gt;(Supplement&lt;Page&gt;::from(page, supplementName())); }
 61 
 62 private:
 63     UserMediaClient* m_client;
 64 };
 65 
 66 inline void UserMediaController::requestUserMediaAccess(UserMediaRequest&amp; request)
 67 {
 68     m_client-&gt;requestUserMediaAccess(request);
 69 }
 70 
 71 inline void UserMediaController::cancelUserMediaAccessRequest(UserMediaRequest&amp; request)
 72 {
 73     m_client-&gt;cancelUserMediaAccessRequest(request);
 74 }
 75 
 76 inline void UserMediaController::enumerateMediaDevices(Document&amp; document, CompletionHandler&lt;void(const Vector&lt;CaptureDevice&gt;&amp;, const String&amp;)&gt;&amp;&amp; completionHandler)
 77 {
</pre>
</td>
</tr>
</table>
<center><a href="UserMediaController.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="UserMediaRequest.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>