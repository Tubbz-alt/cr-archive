<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/ftl/FTLLink.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="FTLJITFinalizer.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="FTLLocation.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/ftl/FTLLink.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 131,29 ***</span>
          bool requiresArityFixup = codeBlock-&gt;numParameters() != 1;
          if (codeBlock-&gt;codeType() == FunctionCode &amp;&amp; requiresArityFixup) {
              CCallHelpers::JumpList mainPathJumps;
  
              jit.load32(
<span class="line-modified">!                 frame.withOffset(sizeof(Register) * CallFrameSlot::argumentCount),</span>
                  GPRInfo::regT1);
              mainPathJumps.append(jit.branch32(
                                       CCallHelpers::AboveOrEqual, GPRInfo::regT1,
                                       CCallHelpers::TrustedImm32(codeBlock-&gt;numParameters())));
              jit.emitFunctionPrologue();
<span class="line-modified">!             jit.move(GPRInfo::callFrameRegister, GPRInfo::argumentGPR0);</span>
              jit.storePtr(GPRInfo::callFrameRegister, &amp;vm.topCallFrame);
              CCallHelpers::Call callArityCheck = jit.call(OperationPtrTag);
  
              auto noException = jit.branch32(CCallHelpers::GreaterThanOrEqual, GPRInfo::returnValueGPR, CCallHelpers::TrustedImm32(0));
              jit.copyCalleeSavesToEntryFrameCalleeSavesBuffer(vm.topEntryFrame);
              jit.move(CCallHelpers::TrustedImmPtr(&amp;vm), GPRInfo::argumentGPR0);
<span class="line-modified">!             jit.move(GPRInfo::callFrameRegister, GPRInfo::argumentGPR1);</span>
              CCallHelpers::Call callLookupExceptionHandlerFromCallerFrame = jit.call(OperationPtrTag);
              jit.jumpToExceptionHandler(vm);
              noException.link(&amp;jit);
  
<span class="line-modified">!             if (!ASSERT_DISABLED) {</span>
                  jit.load64(vm.addressOfException(), GPRInfo::regT1);
                  jit.jitAssertIsNull(GPRInfo::regT1);
              }
  
              jit.move(GPRInfo::returnValueGPR, GPRInfo::argumentGPR0);
<span class="line-new-header">--- 131,29 ---</span>
          bool requiresArityFixup = codeBlock-&gt;numParameters() != 1;
          if (codeBlock-&gt;codeType() == FunctionCode &amp;&amp; requiresArityFixup) {
              CCallHelpers::JumpList mainPathJumps;
  
              jit.load32(
<span class="line-modified">!                 frame.withOffset(sizeof(Register) * CallFrameSlot::argumentCountIncludingThis),</span>
                  GPRInfo::regT1);
              mainPathJumps.append(jit.branch32(
                                       CCallHelpers::AboveOrEqual, GPRInfo::regT1,
                                       CCallHelpers::TrustedImm32(codeBlock-&gt;numParameters())));
              jit.emitFunctionPrologue();
<span class="line-modified">!             jit.move(CCallHelpers::TrustedImmPtr(codeBlock-&gt;globalObject()), GPRInfo::argumentGPR0);</span>
              jit.storePtr(GPRInfo::callFrameRegister, &amp;vm.topCallFrame);
              CCallHelpers::Call callArityCheck = jit.call(OperationPtrTag);
  
              auto noException = jit.branch32(CCallHelpers::GreaterThanOrEqual, GPRInfo::returnValueGPR, CCallHelpers::TrustedImm32(0));
              jit.copyCalleeSavesToEntryFrameCalleeSavesBuffer(vm.topEntryFrame);
              jit.move(CCallHelpers::TrustedImmPtr(&amp;vm), GPRInfo::argumentGPR0);
<span class="line-modified">!             jit.prepareCallOperation(vm);</span>
              CCallHelpers::Call callLookupExceptionHandlerFromCallerFrame = jit.call(OperationPtrTag);
              jit.jumpToExceptionHandler(vm);
              noException.link(&amp;jit);
  
<span class="line-modified">!             if (ASSERT_ENABLED) {</span>
                  jit.load64(vm.addressOfException(), GPRInfo::regT1);
                  jit.jitAssertIsNull(GPRInfo::regT1);
              }
  
              jit.move(GPRInfo::returnValueGPR, GPRInfo::argumentGPR0);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 170,11 ***</span>
              if (linkBuffer-&gt;didFailToAllocate()) {
                  state.allocationFailed = true;
                  return;
              }
              linkBuffer-&gt;link(callArityCheck, FunctionPtr&lt;OperationPtrTag&gt;(codeBlock-&gt;isConstructor() ? operationConstructArityCheck : operationCallArityCheck));
<span class="line-modified">!             linkBuffer-&gt;link(callLookupExceptionHandlerFromCallerFrame, FunctionPtr&lt;OperationPtrTag&gt;(lookupExceptionHandlerFromCallerFrame));</span>
              linkBuffer-&gt;link(callArityFixup, FunctionPtr&lt;JITThunkPtrTag&gt;(vm.getCTIStub(arityFixupGenerator).code()));
              linkBuffer-&gt;link(mainPathJumps, state.generatedFunction);
          }
  
          state.jitCode-&gt;initializeAddressForCall(state.generatedFunction);
<span class="line-new-header">--- 170,11 ---</span>
              if (linkBuffer-&gt;didFailToAllocate()) {
                  state.allocationFailed = true;
                  return;
              }
              linkBuffer-&gt;link(callArityCheck, FunctionPtr&lt;OperationPtrTag&gt;(codeBlock-&gt;isConstructor() ? operationConstructArityCheck : operationCallArityCheck));
<span class="line-modified">!             linkBuffer-&gt;link(callLookupExceptionHandlerFromCallerFrame, FunctionPtr&lt;OperationPtrTag&gt;(operationLookupExceptionHandlerFromCallerFrame));</span>
              linkBuffer-&gt;link(callArityFixup, FunctionPtr&lt;JITThunkPtrTag&gt;(vm.getCTIStub(arityFixupGenerator).code()));
              linkBuffer-&gt;link(mainPathJumps, state.generatedFunction);
          }
  
          state.jitCode-&gt;initializeAddressForCall(state.generatedFunction);
</pre>
<center><a href="FTLJITFinalizer.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="FTLLocation.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>