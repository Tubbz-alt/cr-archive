<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/loader/EmptyClients.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DocumentWriter.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="EmptyClients.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/loader/EmptyClients.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 33 #include &quot;CacheStorageProvider.h&quot;
 34 #include &quot;ColorChooser.h&quot;
 35 #include &quot;ContextMenuClient.h&quot;
 36 #include &quot;CookieJar.h&quot;
 37 #include &quot;DOMPasteAccess.h&quot;
 38 #include &quot;DataListSuggestionPicker.h&quot;
 39 #include &quot;DatabaseProvider.h&quot;
 40 #include &quot;DiagnosticLoggingClient.h&quot;
 41 #include &quot;DocumentFragment.h&quot;
 42 #include &quot;DocumentLoader.h&quot;
 43 #include &quot;DragClient.h&quot;
 44 #include &quot;EditorClient.h&quot;
 45 #include &quot;EmptyFrameLoaderClient.h&quot;
 46 #include &quot;FileChooser.h&quot;
 47 #include &quot;FormState.h&quot;
 48 #include &quot;Frame.h&quot;
 49 #include &quot;FrameLoaderClient.h&quot;
 50 #include &quot;FrameNetworkingContext.h&quot;
 51 #include &quot;HTMLFormElement.h&quot;
 52 #include &quot;HistoryItem.h&quot;
<span class="line-modified"> 53 #include &quot;InProcessIDBServer.h&quot;</span>
 54 #include &quot;InspectorClient.h&quot;
 55 #include &quot;LibWebRTCProvider.h&quot;


 56 #include &quot;NetworkStorageSession.h&quot;
 57 #include &quot;Page.h&quot;
 58 #include &quot;PageConfiguration.h&quot;
 59 #include &quot;PaymentCoordinatorClient.h&quot;
 60 #include &quot;PluginInfoProvider.h&quot;
 61 #include &quot;ProgressTrackerClient.h&quot;
 62 #include &quot;SecurityOriginData.h&quot;
 63 #include &quot;SocketProvider.h&quot;
 64 #include &quot;StorageArea.h&quot;
 65 #include &quot;StorageNamespace.h&quot;
 66 #include &quot;StorageNamespaceProvider.h&quot;
 67 #include &quot;StorageType.h&quot;
 68 #include &quot;TextCheckerClient.h&quot;
 69 #include &quot;ThreadableWebSocketChannel.h&quot;
 70 #include &quot;UserContentProvider.h&quot;
 71 #include &quot;VisitedLinkStore.h&quot;
 72 #include &lt;JavaScriptCore/HeapInlines.h&gt;

 73 #include &lt;wtf/NeverDestroyed.h&gt;
 74 
 75 #if ENABLE(CONTENT_EXTENSIONS)
 76 #include &quot;CompiledContentExtension.h&quot;
 77 #endif
 78 
 79 #if USE(QUICK_LOOK)
<span class="line-modified"> 80 #include &quot;PreviewLoaderClient.h&quot;</span>
 81 #endif
 82 
 83 namespace WebCore {
 84 
 85 class UserMessageHandlerDescriptor;
 86 
 87 class EmptyBackForwardClient final : public BackForwardClient {
 88     void addItem(Ref&lt;HistoryItem&gt;&amp;&amp;) final { }
 89     void goToItem(HistoryItem&amp;) final { }
 90     RefPtr&lt;HistoryItem&gt; itemAtIndex(int) final { return nullptr; }
 91     unsigned backListCount() const final { return 0; }
 92     unsigned forwardListCount() const final { return 0; }
 93     void close() final { }
 94 };
 95 
 96 #if ENABLE(CONTEXT_MENUS)
 97 
 98 class EmptyContextMenuClient final : public ContextMenuClient {
 99     void contextMenuDestroyed() final { }
100 
</pre>
<hr />
<pre>
105     void speak(const String&amp;) final { }
106     void stopSpeaking() final { }
107 
108 #if PLATFORM(COCOA)
109     void searchWithSpotlight() final { }
110 #endif
111 
112 #if PLATFORM(GTK)
113     void insertEmoji(Frame&amp;) final { }
114 #endif
115 
116 #if USE(ACCESSIBILITY_CONTEXT_MENUS)
117     void showContextMenu() final { }
118 #endif
119 };
120 
121 #endif // ENABLE(CONTEXT_MENUS)
122 
123 class EmptyDatabaseProvider final : public DatabaseProvider {
124 #if ENABLE(INDEXED_DATABASE)
<span class="line-modified">125     IDBClient::IDBConnectionToServer&amp; idbConnectionToServerForSession(const PAL::SessionID&amp; sessionID) final</span>































126     {
<span class="line-modified">127         static auto&amp; sharedConnection = InProcessIDBServer::create(sessionID).leakRef();</span>
<span class="line-modified">128         return sharedConnection.connectionToServer();</span>

129     }
130 #endif
131 };
132 
133 class EmptyDiagnosticLoggingClient final : public DiagnosticLoggingClient {
134     void logDiagnosticMessage(const String&amp;, const String&amp;, ShouldSample) final { }
135     void logDiagnosticMessageWithResult(const String&amp;, const String&amp;, DiagnosticLoggingResultType, ShouldSample) final { }
136     void logDiagnosticMessageWithValue(const String&amp;, const String&amp;, double, unsigned, ShouldSample) final { }
137     void logDiagnosticMessageWithEnhancedPrivacy(const String&amp;, const String&amp;, ShouldSample) final { }
138     void logDiagnosticMessageWithValueDictionary(const String&amp;, const String&amp;, const ValueDictionary&amp;, ShouldSample) final { }
139 };
140 
141 #if ENABLE(DRAG_SUPPORT)
142 
143 class EmptyDragClient final : public DragClient {
144     void willPerformDragDestinationAction(DragDestinationAction, const DragData&amp;) final { }
145     void willPerformDragSourceAction(DragSourceAction, const IntPoint&amp;, DataTransfer&amp;) final { }
146     DragSourceAction dragSourceActionMaskForPoint(const IntPoint&amp;) final { return DragSourceActionNone; }
147     void startDrag(DragItem, DataTransfer&amp;, Frame&amp;) final { }
<span class="line-removed">148     void dragControllerDestroyed() final { }</span>
149 };
150 
151 #endif // ENABLE(DRAG_SUPPORT)
152 
153 class EmptyEditorClient final : public EditorClient {
154     WTF_MAKE_FAST_ALLOCATED;
155 
156 public:
157     EmptyEditorClient() = default;
158 
159 private:
160     bool shouldDeleteRange(Range*) final { return false; }
161     bool smartInsertDeleteEnabled() final { return false; }
162     bool isSelectTrailingWhitespaceEnabled() const final { return false; }
163     bool isContinuousSpellCheckingEnabled() final { return false; }
164     void toggleContinuousSpellChecking() final { }
165     bool isGrammarCheckingEnabled() final { return false; }
166     void toggleGrammarChecking() final { }
167     int spellCheckerDocumentTag() final { return -1; }
168 
</pre>
<hr />
<pre>
198     DOMPasteAccessResponse requestDOMPasteAccess(const String&amp;) final { return DOMPasteAccessResponse::DeniedForGesture; }
199 
200     bool canCopyCut(Frame*, bool defaultValue) const final { return defaultValue; }
201     bool canPaste(Frame*, bool defaultValue) const final { return defaultValue; }
202     bool canUndo() const final { return false; }
203     bool canRedo() const final { return false; }
204 
205     void undo() final { }
206     void redo() final { }
207 
208     void handleKeyboardEvent(KeyboardEvent&amp;) final { }
209     void handleInputMethodKeydown(KeyboardEvent&amp;) final { }
210 
211     void textFieldDidBeginEditing(Element*) final { }
212     void textFieldDidEndEditing(Element*) final { }
213     void textDidChangeInTextField(Element*) final { }
214     bool doTextFieldCommandFromEvent(Element*, KeyboardEvent*) final { return false; }
215     void textWillBeDeletedInTextField(Element*) final { }
216     void textDidChangeInTextArea(Element*) final { }
217     void overflowScrollPositionChanged() final { }

218 
219 #if PLATFORM(IOS_FAMILY)
220     void startDelayingAndCoalescingContentChangeNotifications() final { }
221     void stopDelayingAndCoalescingContentChangeNotifications() final { }
222     bool hasRichlyEditableSelection() final { return false; }
223     int getPasteboardItemsCount() final { return 0; }
224     RefPtr&lt;DocumentFragment&gt; documentFragmentFromDelegate(int) final { return nullptr; }
225     bool performsTwoStepPaste(DocumentFragment*) final { return false; }
226     void updateStringForFind(const String&amp;) final { }
227 #endif
228 
229     bool performTwoStepDrop(DocumentFragment&amp;, Range&amp;, bool) final { return false; }
230 
231 #if PLATFORM(COCOA)
232     void setInsertionPasteboard(const String&amp;) final { };
233 #endif
234 
235 #if USE(APPKIT)
236     void uppercaseWord() final { }
237     void lowercaseWord() final { }
</pre>
<hr />
<pre>
249     bool isAutomaticDashSubstitutionEnabled() final { return false; }
250     void toggleAutomaticDashSubstitution() final { }
251     bool isAutomaticTextReplacementEnabled() final { return false; }
252     void toggleAutomaticTextReplacement() final { }
253     bool isAutomaticSpellingCorrectionEnabled() final { return false; }
254     void toggleAutomaticSpellingCorrection() final { }
255 #endif
256 
257 #if PLATFORM(GTK)
258     bool shouldShowUnicodeMenu() final { return false; }
259 #endif
260 
261     TextCheckerClient* textChecker() final { return &amp;m_textCheckerClient; }
262 
263     void updateSpellingUIWithGrammarString(const String&amp;, const GrammarDetail&amp;) final { }
264     void updateSpellingUIWithMisspelledWord(const String&amp;) final { }
265     void showSpellingUI(bool) final { }
266     bool spellingUIIsShowing() final { return false; }
267 
268     void willSetInputMethodState() final { }
<span class="line-modified">269     void setInputMethodState(bool) final { }</span>
270 
271     bool canShowFontPanel() const final { return false; }
272 
273     class EmptyTextCheckerClient final : public TextCheckerClient {
274         bool shouldEraseMarkersAfterChangeSelection(TextCheckingType) const final { return true; }
275         void ignoreWordInSpellDocument(const String&amp;) final { }
276         void learnWord(const String&amp;) final { }
277         void checkSpellingOfString(StringView, int*, int*) final { }
278         String getAutoCorrectSuggestionForMisspelledWord(const String&amp;) final { return { }; }
279         void checkGrammarOfString(StringView, Vector&lt;GrammarDetail&gt;&amp;, int*, int*) final { }
280 
281 #if USE(UNIFIED_TEXT_CHECKING)
282         Vector&lt;TextCheckingResult&gt; checkTextOfParagraph(StringView, OptionSet&lt;TextCheckingType&gt;, const VisibleSelection&amp;) final { return Vector&lt;TextCheckingResult&gt;(); }
283 #endif
284 
285         void getGuessesForWord(const String&amp;, const String&amp;, const VisibleSelection&amp;, Vector&lt;String&gt;&amp;) final { }
286         void requestCheckingOfString(TextCheckingRequest&amp;, const VisibleSelection&amp;) final;
287     };
288 
289     EmptyTextCheckerClient m_textCheckerClient;
</pre>
<hr />
<pre>
382 class EmptyStorageNamespaceProvider final : public StorageNamespaceProvider {
383     struct EmptyStorageArea : public StorageArea {
384         unsigned length() final { return 0; }
385         String key(unsigned) final { return { }; }
386         String item(const String&amp;) final { return { }; }
387         void setItem(Frame*, const String&amp;, const String&amp;, bool&amp;) final { }
388         void removeItem(Frame*, const String&amp;) final { }
389         void clear(Frame*) final { }
390         bool contains(const String&amp;) final { return false; }
391         StorageType storageType() const final { return StorageType::Local; }
392         size_t memoryBytesUsedByCache() final { return 0; }
393     };
394 
395     struct EmptyStorageNamespace final : public StorageNamespace {
396         explicit EmptyStorageNamespace(PAL::SessionID sessionID)
397             : m_sessionID(sessionID)
398         {
399         }
400     private:
401         Ref&lt;StorageArea&gt; storageArea(const SecurityOriginData&amp;) final { return adoptRef(*new EmptyStorageArea); }
<span class="line-modified">402         Ref&lt;StorageNamespace&gt; copy(Page*) final { return adoptRef(*new EmptyStorageNamespace { m_sessionID }); }</span>
403         PAL::SessionID sessionID() const final { return m_sessionID; }
404         void setSessionIDForTesting(PAL::SessionID sessionID) final { m_sessionID = sessionID; };
405 
406         PAL::SessionID m_sessionID;
407     };
408 
409     Ref&lt;StorageNamespace&gt; createSessionStorageNamespace(Page&amp;, unsigned) final;
410     Ref&lt;StorageNamespace&gt; createLocalStorageNamespace(unsigned, PAL::SessionID) final;
411     Ref&lt;StorageNamespace&gt; createTransientLocalStorageNamespace(SecurityOrigin&amp;, unsigned, PAL::SessionID) final;
412 
413 };
414 
415 class EmptyUserContentProvider final : public UserContentProvider {
416     void forEachUserScript(Function&lt;void(DOMWrapperWorld&amp;, const UserScript&amp;)&gt;&amp;&amp;) const final { }
417     void forEachUserStyleSheet(Function&lt;void(const UserStyleSheet&amp;)&gt;&amp;&amp;) const final { }
418 #if ENABLE(USER_MESSAGE_HANDLERS)
419     void forEachUserMessageHandler(Function&lt;void(const UserMessageHandlerDescriptor&amp;)&gt;&amp;&amp;) const final { }
420 #endif
421 #if ENABLE(CONTENT_EXTENSIONS)
422     ContentExtensions::ContentExtensionsBackend&amp; userContentExtensionBackend() final { static NeverDestroyed&lt;ContentExtensions::ContentExtensionsBackend&gt; backend; return backend.get(); };
</pre>
<hr />
<pre>
447 
448 #endif
449 
450 #if ENABLE(DATALIST_ELEMENT)
451 
452 std::unique_ptr&lt;DataListSuggestionPicker&gt; EmptyChromeClient::createDataListSuggestionPicker(DataListSuggestionsClient&amp;)
453 {
454     return nullptr;
455 }
456 
457 #endif
458 
459 void EmptyChromeClient::runOpenPanel(Frame&amp;, FileChooser&amp;)
460 {
461 }
462 
463 void EmptyChromeClient::showShareSheet(ShareDataWithParsedURL&amp;, CompletionHandler&lt;void(bool)&gt;&amp;&amp;)
464 {
465 }
466 
<span class="line-removed">467 PAL::SessionID EmptyFrameLoaderClient::sessionID() const</span>
<span class="line-removed">468 {</span>
<span class="line-removed">469     return PAL::SessionID::defaultSessionID();</span>
<span class="line-removed">470 }</span>
<span class="line-removed">471 </span>
472 void EmptyFrameLoaderClient::dispatchDecidePolicyForNewWindowAction(const NavigationAction&amp;, const ResourceRequest&amp;, FormState*, const String&amp;, PolicyCheckIdentifier, FramePolicyFunction&amp;&amp;)
473 {
474 }
475 
476 void EmptyFrameLoaderClient::dispatchDecidePolicyForNavigationAction(const NavigationAction&amp;, const ResourceRequest&amp;, const ResourceResponse&amp;, FormState*, PolicyDecisionMode, PolicyCheckIdentifier, FramePolicyFunction&amp;&amp;)
477 {
478 }
479 
480 void EmptyFrameLoaderClient::dispatchWillSendSubmitEvent(Ref&lt;FormState&gt;&amp;&amp;)
481 {
482 }
483 
484 void EmptyFrameLoaderClient::dispatchWillSubmitForm(FormState&amp;, CompletionHandler&lt;void()&gt;&amp;&amp; completionHandler)
485 {
486     completionHandler();
487 }
488 
489 Ref&lt;DocumentLoader&gt; EmptyFrameLoaderClient::createDocumentLoader(const ResourceRequest&amp; request, const SubstituteData&amp; substituteData)
490 {
491     return DocumentLoader::create(request, substituteData);
</pre>
<hr />
<pre>
526 
527 void EmptyEditorClient::registerRedoStep(UndoStep&amp;)
528 {
529 }
530 
531 Ref&lt;StorageNamespace&gt; EmptyStorageNamespaceProvider::createSessionStorageNamespace(Page&amp; page, unsigned)
532 {
533     return adoptRef(*new EmptyStorageNamespace { page.sessionID() });
534 }
535 
536 Ref&lt;StorageNamespace&gt; EmptyStorageNamespaceProvider::createLocalStorageNamespace(unsigned, PAL::SessionID sessionID)
537 {
538     return adoptRef(*new EmptyStorageNamespace { sessionID });
539 }
540 
541 Ref&lt;StorageNamespace&gt; EmptyStorageNamespaceProvider::createTransientLocalStorageNamespace(SecurityOrigin&amp;, unsigned, PAL::SessionID sessionID)
542 {
543     return adoptRef(*new EmptyStorageNamespace { sessionID });
544 }
545 
<span class="line-modified">546 class EmptyStorageSessionProvider : public StorageSessionProvider {</span>
547     NetworkStorageSession* storageSession() const final { return nullptr; }
548 };
549 
<span class="line-modified">550 PageConfiguration pageConfigurationWithEmptyClients()</span>









551 {
552     PageConfiguration pageConfiguration {

553         makeUniqueRef&lt;EmptyEditorClient&gt;(),
554         SocketProvider::create(),
555         LibWebRTCProvider::create(),
556         CacheStorageProvider::create(),
557         adoptRef(*new EmptyBackForwardClient),
<span class="line-modified">558         CookieJar::create(adoptRef(*new EmptyStorageSessionProvider))</span>


559     };
560 
561     static NeverDestroyed&lt;EmptyChromeClient&gt; dummyChromeClient;
562     pageConfiguration.chromeClient = &amp;dummyChromeClient.get();
563 
564 #if ENABLE(APPLE_PAY)
565     static NeverDestroyed&lt;EmptyPaymentCoordinatorClient&gt; dummyPaymentCoordinatorClient;
566     pageConfiguration.paymentCoordinatorClient = &amp;dummyPaymentCoordinatorClient.get();
567 #endif
568 
569 #if ENABLE(CONTEXT_MENUS)
570     static NeverDestroyed&lt;EmptyContextMenuClient&gt; dummyContextMenuClient;
571     pageConfiguration.contextMenuClient = &amp;dummyContextMenuClient.get();
572 #endif
573 
574 #if ENABLE(DRAG_SUPPORT)
<span class="line-modified">575     static NeverDestroyed&lt;EmptyDragClient&gt; dummyDragClient;</span>
<span class="line-removed">576     pageConfiguration.dragClient = &amp;dummyDragClient.get();</span>
577 #endif
578 
579     static NeverDestroyed&lt;EmptyInspectorClient&gt; dummyInspectorClient;
580     pageConfiguration.inspectorClient = &amp;dummyInspectorClient.get();
581 
582     static NeverDestroyed&lt;EmptyFrameLoaderClient&gt; dummyFrameLoaderClient;
583     pageConfiguration.loaderClientForMainFrame = &amp;dummyFrameLoaderClient.get();
584 
<span class="line-removed">585     static NeverDestroyed&lt;EmptyProgressTrackerClient&gt; dummyProgressTrackerClient;</span>
<span class="line-removed">586     pageConfiguration.progressTrackerClient = &amp;dummyProgressTrackerClient.get();</span>
<span class="line-removed">587 </span>
588     pageConfiguration.diagnosticLoggingClient = makeUnique&lt;EmptyDiagnosticLoggingClient&gt;();
589 
590     pageConfiguration.applicationCacheStorage = ApplicationCacheStorage::create({ }, { });
591     pageConfiguration.databaseProvider = adoptRef(*new EmptyDatabaseProvider);
592     pageConfiguration.pluginInfoProvider = adoptRef(*new EmptyPluginInfoProvider);
593     pageConfiguration.storageNamespaceProvider = adoptRef(*new EmptyStorageNamespaceProvider);
594     pageConfiguration.userContentProvider = adoptRef(*new EmptyUserContentProvider);
595     pageConfiguration.visitedLinkStore = adoptRef(*new EmptyVisitedLinkStore);
596 
597     return pageConfiguration;
598 }
599 
600 DiagnosticLoggingClient&amp; emptyDiagnosticLoggingClient()
601 {
602     static NeverDestroyed&lt;EmptyDiagnosticLoggingClient&gt; client;
603     return client;
604 }
605 
606 }
</pre>
</td>
<td>
<hr />
<pre>
 33 #include &quot;CacheStorageProvider.h&quot;
 34 #include &quot;ColorChooser.h&quot;
 35 #include &quot;ContextMenuClient.h&quot;
 36 #include &quot;CookieJar.h&quot;
 37 #include &quot;DOMPasteAccess.h&quot;
 38 #include &quot;DataListSuggestionPicker.h&quot;
 39 #include &quot;DatabaseProvider.h&quot;
 40 #include &quot;DiagnosticLoggingClient.h&quot;
 41 #include &quot;DocumentFragment.h&quot;
 42 #include &quot;DocumentLoader.h&quot;
 43 #include &quot;DragClient.h&quot;
 44 #include &quot;EditorClient.h&quot;
 45 #include &quot;EmptyFrameLoaderClient.h&quot;
 46 #include &quot;FileChooser.h&quot;
 47 #include &quot;FormState.h&quot;
 48 #include &quot;Frame.h&quot;
 49 #include &quot;FrameLoaderClient.h&quot;
 50 #include &quot;FrameNetworkingContext.h&quot;
 51 #include &quot;HTMLFormElement.h&quot;
 52 #include &quot;HistoryItem.h&quot;
<span class="line-modified"> 53 #include &quot;IDBConnectionToServer.h&quot;</span>
 54 #include &quot;InspectorClient.h&quot;
 55 #include &quot;LibWebRTCProvider.h&quot;
<span class="line-added"> 56 #include &quot;MediaRecorderPrivate.h&quot;</span>
<span class="line-added"> 57 #include &quot;MediaRecorderProvider.h&quot;</span>
 58 #include &quot;NetworkStorageSession.h&quot;
 59 #include &quot;Page.h&quot;
 60 #include &quot;PageConfiguration.h&quot;
 61 #include &quot;PaymentCoordinatorClient.h&quot;
 62 #include &quot;PluginInfoProvider.h&quot;
 63 #include &quot;ProgressTrackerClient.h&quot;
 64 #include &quot;SecurityOriginData.h&quot;
 65 #include &quot;SocketProvider.h&quot;
 66 #include &quot;StorageArea.h&quot;
 67 #include &quot;StorageNamespace.h&quot;
 68 #include &quot;StorageNamespaceProvider.h&quot;
 69 #include &quot;StorageType.h&quot;
 70 #include &quot;TextCheckerClient.h&quot;
 71 #include &quot;ThreadableWebSocketChannel.h&quot;
 72 #include &quot;UserContentProvider.h&quot;
 73 #include &quot;VisitedLinkStore.h&quot;
 74 #include &lt;JavaScriptCore/HeapInlines.h&gt;
<span class="line-added"> 75 #include &lt;pal/SessionID.h&gt;</span>
 76 #include &lt;wtf/NeverDestroyed.h&gt;
 77 
 78 #if ENABLE(CONTENT_EXTENSIONS)
 79 #include &quot;CompiledContentExtension.h&quot;
 80 #endif
 81 
 82 #if USE(QUICK_LOOK)
<span class="line-modified"> 83 #include &quot;LegacyPreviewLoaderClient.h&quot;</span>
 84 #endif
 85 
 86 namespace WebCore {
 87 
 88 class UserMessageHandlerDescriptor;
 89 
 90 class EmptyBackForwardClient final : public BackForwardClient {
 91     void addItem(Ref&lt;HistoryItem&gt;&amp;&amp;) final { }
 92     void goToItem(HistoryItem&amp;) final { }
 93     RefPtr&lt;HistoryItem&gt; itemAtIndex(int) final { return nullptr; }
 94     unsigned backListCount() const final { return 0; }
 95     unsigned forwardListCount() const final { return 0; }
 96     void close() final { }
 97 };
 98 
 99 #if ENABLE(CONTEXT_MENUS)
100 
101 class EmptyContextMenuClient final : public ContextMenuClient {
102     void contextMenuDestroyed() final { }
103 
</pre>
<hr />
<pre>
108     void speak(const String&amp;) final { }
109     void stopSpeaking() final { }
110 
111 #if PLATFORM(COCOA)
112     void searchWithSpotlight() final { }
113 #endif
114 
115 #if PLATFORM(GTK)
116     void insertEmoji(Frame&amp;) final { }
117 #endif
118 
119 #if USE(ACCESSIBILITY_CONTEXT_MENUS)
120     void showContextMenu() final { }
121 #endif
122 };
123 
124 #endif // ENABLE(CONTEXT_MENUS)
125 
126 class EmptyDatabaseProvider final : public DatabaseProvider {
127 #if ENABLE(INDEXED_DATABASE)
<span class="line-modified">128     struct EmptyIDBConnectionToServerDeletegate final : public IDBClient::IDBConnectionToServerDelegate {</span>
<span class="line-added">129         IDBConnectionIdentifier identifier() const final { return { }; }</span>
<span class="line-added">130         void deleteDatabase(const IDBRequestData&amp;) final { }</span>
<span class="line-added">131         void openDatabase(const IDBRequestData&amp;) final { }</span>
<span class="line-added">132         void abortTransaction(const IDBResourceIdentifier&amp;) final { }</span>
<span class="line-added">133         void commitTransaction(const IDBResourceIdentifier&amp;) final { }</span>
<span class="line-added">134         void didFinishHandlingVersionChangeTransaction(uint64_t, const IDBResourceIdentifier&amp;) final { }</span>
<span class="line-added">135         void createObjectStore(const IDBRequestData&amp;, const IDBObjectStoreInfo&amp;) final { }</span>
<span class="line-added">136         void deleteObjectStore(const IDBRequestData&amp;, const String&amp;) final { }</span>
<span class="line-added">137         void renameObjectStore(const IDBRequestData&amp;, uint64_t, const String&amp;) final { }</span>
<span class="line-added">138         void clearObjectStore(const IDBRequestData&amp;, uint64_t) final { }</span>
<span class="line-added">139         void createIndex(const IDBRequestData&amp;, const IDBIndexInfo&amp;) final { }</span>
<span class="line-added">140         void deleteIndex(const IDBRequestData&amp;, uint64_t, const String&amp;) final { }</span>
<span class="line-added">141         void renameIndex(const IDBRequestData&amp;, uint64_t, uint64_t, const String&amp;) final { }</span>
<span class="line-added">142         void putOrAdd(const IDBRequestData&amp;, const IDBKeyData&amp;, const IDBValue&amp;, const IndexedDB::ObjectStoreOverwriteMode) final { }</span>
<span class="line-added">143         void getRecord(const IDBRequestData&amp;, const IDBGetRecordData&amp;) final { }</span>
<span class="line-added">144         void getAllRecords(const IDBRequestData&amp;, const IDBGetAllRecordsData&amp;) final { }</span>
<span class="line-added">145         void getCount(const IDBRequestData&amp;, const IDBKeyRangeData&amp;) final { }</span>
<span class="line-added">146         void deleteRecord(const IDBRequestData&amp;, const IDBKeyRangeData&amp;) final { }</span>
<span class="line-added">147         void openCursor(const IDBRequestData&amp;, const IDBCursorInfo&amp;) final { }</span>
<span class="line-added">148         void iterateCursor(const IDBRequestData&amp;, const IDBIterateCursorData&amp;) final { }</span>
<span class="line-added">149         void establishTransaction(uint64_t, const IDBTransactionInfo&amp;) final { }</span>
<span class="line-added">150         void databaseConnectionPendingClose(uint64_t) final { }</span>
<span class="line-added">151         void databaseConnectionClosed(uint64_t) final { }</span>
<span class="line-added">152         void abortOpenAndUpgradeNeeded(uint64_t, const IDBResourceIdentifier&amp;) final { }</span>
<span class="line-added">153         void didFireVersionChangeEvent(uint64_t, const IDBResourceIdentifier&amp;, const IndexedDB::ConnectionClosedOnBehalfOfServer) final { }</span>
<span class="line-added">154         void openDBRequestCancelled(const IDBRequestData&amp;) final { }</span>
<span class="line-added">155         void getAllDatabaseNames(const SecurityOriginData&amp;, const SecurityOriginData&amp;, uint64_t) final { }</span>
<span class="line-added">156         ~EmptyIDBConnectionToServerDeletegate() { }</span>
<span class="line-added">157     };</span>
<span class="line-added">158 </span>
<span class="line-added">159     IDBClient::IDBConnectionToServer&amp; idbConnectionToServerForSession(const PAL::SessionID&amp;) final</span>
160     {
<span class="line-modified">161         static NeverDestroyed&lt;EmptyIDBConnectionToServerDeletegate&gt; emptyDelegate;</span>
<span class="line-modified">162         static auto&amp; emptyConnection = IDBClient::IDBConnectionToServer::create(emptyDelegate.get()).leakRef();</span>
<span class="line-added">163         return emptyConnection;</span>
164     }
165 #endif
166 };
167 
168 class EmptyDiagnosticLoggingClient final : public DiagnosticLoggingClient {
169     void logDiagnosticMessage(const String&amp;, const String&amp;, ShouldSample) final { }
170     void logDiagnosticMessageWithResult(const String&amp;, const String&amp;, DiagnosticLoggingResultType, ShouldSample) final { }
171     void logDiagnosticMessageWithValue(const String&amp;, const String&amp;, double, unsigned, ShouldSample) final { }
172     void logDiagnosticMessageWithEnhancedPrivacy(const String&amp;, const String&amp;, ShouldSample) final { }
173     void logDiagnosticMessageWithValueDictionary(const String&amp;, const String&amp;, const ValueDictionary&amp;, ShouldSample) final { }
174 };
175 
176 #if ENABLE(DRAG_SUPPORT)
177 
178 class EmptyDragClient final : public DragClient {
179     void willPerformDragDestinationAction(DragDestinationAction, const DragData&amp;) final { }
180     void willPerformDragSourceAction(DragSourceAction, const IntPoint&amp;, DataTransfer&amp;) final { }
181     DragSourceAction dragSourceActionMaskForPoint(const IntPoint&amp;) final { return DragSourceActionNone; }
182     void startDrag(DragItem, DataTransfer&amp;, Frame&amp;) final { }

183 };
184 
185 #endif // ENABLE(DRAG_SUPPORT)
186 
187 class EmptyEditorClient final : public EditorClient {
188     WTF_MAKE_FAST_ALLOCATED;
189 
190 public:
191     EmptyEditorClient() = default;
192 
193 private:
194     bool shouldDeleteRange(Range*) final { return false; }
195     bool smartInsertDeleteEnabled() final { return false; }
196     bool isSelectTrailingWhitespaceEnabled() const final { return false; }
197     bool isContinuousSpellCheckingEnabled() final { return false; }
198     void toggleContinuousSpellChecking() final { }
199     bool isGrammarCheckingEnabled() final { return false; }
200     void toggleGrammarChecking() final { }
201     int spellCheckerDocumentTag() final { return -1; }
202 
</pre>
<hr />
<pre>
232     DOMPasteAccessResponse requestDOMPasteAccess(const String&amp;) final { return DOMPasteAccessResponse::DeniedForGesture; }
233 
234     bool canCopyCut(Frame*, bool defaultValue) const final { return defaultValue; }
235     bool canPaste(Frame*, bool defaultValue) const final { return defaultValue; }
236     bool canUndo() const final { return false; }
237     bool canRedo() const final { return false; }
238 
239     void undo() final { }
240     void redo() final { }
241 
242     void handleKeyboardEvent(KeyboardEvent&amp;) final { }
243     void handleInputMethodKeydown(KeyboardEvent&amp;) final { }
244 
245     void textFieldDidBeginEditing(Element*) final { }
246     void textFieldDidEndEditing(Element*) final { }
247     void textDidChangeInTextField(Element*) final { }
248     bool doTextFieldCommandFromEvent(Element*, KeyboardEvent*) final { return false; }
249     void textWillBeDeletedInTextField(Element*) final { }
250     void textDidChangeInTextArea(Element*) final { }
251     void overflowScrollPositionChanged() final { }
<span class="line-added">252     void subFrameScrollPositionChanged() final { }</span>
253 
254 #if PLATFORM(IOS_FAMILY)
255     void startDelayingAndCoalescingContentChangeNotifications() final { }
256     void stopDelayingAndCoalescingContentChangeNotifications() final { }
257     bool hasRichlyEditableSelection() final { return false; }
258     int getPasteboardItemsCount() final { return 0; }
259     RefPtr&lt;DocumentFragment&gt; documentFragmentFromDelegate(int) final { return nullptr; }
260     bool performsTwoStepPaste(DocumentFragment*) final { return false; }
261     void updateStringForFind(const String&amp;) final { }
262 #endif
263 
264     bool performTwoStepDrop(DocumentFragment&amp;, Range&amp;, bool) final { return false; }
265 
266 #if PLATFORM(COCOA)
267     void setInsertionPasteboard(const String&amp;) final { };
268 #endif
269 
270 #if USE(APPKIT)
271     void uppercaseWord() final { }
272     void lowercaseWord() final { }
</pre>
<hr />
<pre>
284     bool isAutomaticDashSubstitutionEnabled() final { return false; }
285     void toggleAutomaticDashSubstitution() final { }
286     bool isAutomaticTextReplacementEnabled() final { return false; }
287     void toggleAutomaticTextReplacement() final { }
288     bool isAutomaticSpellingCorrectionEnabled() final { return false; }
289     void toggleAutomaticSpellingCorrection() final { }
290 #endif
291 
292 #if PLATFORM(GTK)
293     bool shouldShowUnicodeMenu() final { return false; }
294 #endif
295 
296     TextCheckerClient* textChecker() final { return &amp;m_textCheckerClient; }
297 
298     void updateSpellingUIWithGrammarString(const String&amp;, const GrammarDetail&amp;) final { }
299     void updateSpellingUIWithMisspelledWord(const String&amp;) final { }
300     void showSpellingUI(bool) final { }
301     bool spellingUIIsShowing() final { return false; }
302 
303     void willSetInputMethodState() final { }
<span class="line-modified">304     void setInputMethodState(Element*) final { }</span>
305 
306     bool canShowFontPanel() const final { return false; }
307 
308     class EmptyTextCheckerClient final : public TextCheckerClient {
309         bool shouldEraseMarkersAfterChangeSelection(TextCheckingType) const final { return true; }
310         void ignoreWordInSpellDocument(const String&amp;) final { }
311         void learnWord(const String&amp;) final { }
312         void checkSpellingOfString(StringView, int*, int*) final { }
313         String getAutoCorrectSuggestionForMisspelledWord(const String&amp;) final { return { }; }
314         void checkGrammarOfString(StringView, Vector&lt;GrammarDetail&gt;&amp;, int*, int*) final { }
315 
316 #if USE(UNIFIED_TEXT_CHECKING)
317         Vector&lt;TextCheckingResult&gt; checkTextOfParagraph(StringView, OptionSet&lt;TextCheckingType&gt;, const VisibleSelection&amp;) final { return Vector&lt;TextCheckingResult&gt;(); }
318 #endif
319 
320         void getGuessesForWord(const String&amp;, const String&amp;, const VisibleSelection&amp;, Vector&lt;String&gt;&amp;) final { }
321         void requestCheckingOfString(TextCheckingRequest&amp;, const VisibleSelection&amp;) final;
322     };
323 
324     EmptyTextCheckerClient m_textCheckerClient;
</pre>
<hr />
<pre>
417 class EmptyStorageNamespaceProvider final : public StorageNamespaceProvider {
418     struct EmptyStorageArea : public StorageArea {
419         unsigned length() final { return 0; }
420         String key(unsigned) final { return { }; }
421         String item(const String&amp;) final { return { }; }
422         void setItem(Frame*, const String&amp;, const String&amp;, bool&amp;) final { }
423         void removeItem(Frame*, const String&amp;) final { }
424         void clear(Frame*) final { }
425         bool contains(const String&amp;) final { return false; }
426         StorageType storageType() const final { return StorageType::Local; }
427         size_t memoryBytesUsedByCache() final { return 0; }
428     };
429 
430     struct EmptyStorageNamespace final : public StorageNamespace {
431         explicit EmptyStorageNamespace(PAL::SessionID sessionID)
432             : m_sessionID(sessionID)
433         {
434         }
435     private:
436         Ref&lt;StorageArea&gt; storageArea(const SecurityOriginData&amp;) final { return adoptRef(*new EmptyStorageArea); }
<span class="line-modified">437         Ref&lt;StorageNamespace&gt; copy(Page&amp;) final { return adoptRef(*new EmptyStorageNamespace { m_sessionID }); }</span>
438         PAL::SessionID sessionID() const final { return m_sessionID; }
439         void setSessionIDForTesting(PAL::SessionID sessionID) final { m_sessionID = sessionID; };
440 
441         PAL::SessionID m_sessionID;
442     };
443 
444     Ref&lt;StorageNamespace&gt; createSessionStorageNamespace(Page&amp;, unsigned) final;
445     Ref&lt;StorageNamespace&gt; createLocalStorageNamespace(unsigned, PAL::SessionID) final;
446     Ref&lt;StorageNamespace&gt; createTransientLocalStorageNamespace(SecurityOrigin&amp;, unsigned, PAL::SessionID) final;
447 
448 };
449 
450 class EmptyUserContentProvider final : public UserContentProvider {
451     void forEachUserScript(Function&lt;void(DOMWrapperWorld&amp;, const UserScript&amp;)&gt;&amp;&amp;) const final { }
452     void forEachUserStyleSheet(Function&lt;void(const UserStyleSheet&amp;)&gt;&amp;&amp;) const final { }
453 #if ENABLE(USER_MESSAGE_HANDLERS)
454     void forEachUserMessageHandler(Function&lt;void(const UserMessageHandlerDescriptor&amp;)&gt;&amp;&amp;) const final { }
455 #endif
456 #if ENABLE(CONTENT_EXTENSIONS)
457     ContentExtensions::ContentExtensionsBackend&amp; userContentExtensionBackend() final { static NeverDestroyed&lt;ContentExtensions::ContentExtensionsBackend&gt; backend; return backend.get(); };
</pre>
<hr />
<pre>
482 
483 #endif
484 
485 #if ENABLE(DATALIST_ELEMENT)
486 
487 std::unique_ptr&lt;DataListSuggestionPicker&gt; EmptyChromeClient::createDataListSuggestionPicker(DataListSuggestionsClient&amp;)
488 {
489     return nullptr;
490 }
491 
492 #endif
493 
494 void EmptyChromeClient::runOpenPanel(Frame&amp;, FileChooser&amp;)
495 {
496 }
497 
498 void EmptyChromeClient::showShareSheet(ShareDataWithParsedURL&amp;, CompletionHandler&lt;void(bool)&gt;&amp;&amp;)
499 {
500 }
501 





502 void EmptyFrameLoaderClient::dispatchDecidePolicyForNewWindowAction(const NavigationAction&amp;, const ResourceRequest&amp;, FormState*, const String&amp;, PolicyCheckIdentifier, FramePolicyFunction&amp;&amp;)
503 {
504 }
505 
506 void EmptyFrameLoaderClient::dispatchDecidePolicyForNavigationAction(const NavigationAction&amp;, const ResourceRequest&amp;, const ResourceResponse&amp;, FormState*, PolicyDecisionMode, PolicyCheckIdentifier, FramePolicyFunction&amp;&amp;)
507 {
508 }
509 
510 void EmptyFrameLoaderClient::dispatchWillSendSubmitEvent(Ref&lt;FormState&gt;&amp;&amp;)
511 {
512 }
513 
514 void EmptyFrameLoaderClient::dispatchWillSubmitForm(FormState&amp;, CompletionHandler&lt;void()&gt;&amp;&amp; completionHandler)
515 {
516     completionHandler();
517 }
518 
519 Ref&lt;DocumentLoader&gt; EmptyFrameLoaderClient::createDocumentLoader(const ResourceRequest&amp; request, const SubstituteData&amp; substituteData)
520 {
521     return DocumentLoader::create(request, substituteData);
</pre>
<hr />
<pre>
556 
557 void EmptyEditorClient::registerRedoStep(UndoStep&amp;)
558 {
559 }
560 
561 Ref&lt;StorageNamespace&gt; EmptyStorageNamespaceProvider::createSessionStorageNamespace(Page&amp; page, unsigned)
562 {
563     return adoptRef(*new EmptyStorageNamespace { page.sessionID() });
564 }
565 
566 Ref&lt;StorageNamespace&gt; EmptyStorageNamespaceProvider::createLocalStorageNamespace(unsigned, PAL::SessionID sessionID)
567 {
568     return adoptRef(*new EmptyStorageNamespace { sessionID });
569 }
570 
571 Ref&lt;StorageNamespace&gt; EmptyStorageNamespaceProvider::createTransientLocalStorageNamespace(SecurityOrigin&amp;, unsigned, PAL::SessionID sessionID)
572 {
573     return adoptRef(*new EmptyStorageNamespace { sessionID });
574 }
575 
<span class="line-modified">576 class EmptyStorageSessionProvider final : public StorageSessionProvider {</span>
577     NetworkStorageSession* storageSession() const final { return nullptr; }
578 };
579 
<span class="line-modified">580 class EmptyMediaRecorderProvider final : public MediaRecorderProvider {</span>
<span class="line-added">581 public:</span>
<span class="line-added">582     EmptyMediaRecorderProvider() = default;</span>
<span class="line-added">583 private:</span>
<span class="line-added">584 #if ENABLE(MEDIA_STREAM) &amp;&amp; PLATFORM(COCOA)</span>
<span class="line-added">585     std::unique_ptr&lt;MediaRecorderPrivate&gt; createMediaRecorderPrivate(const MediaStreamPrivate&amp;) final { return nullptr; }</span>
<span class="line-added">586 #endif</span>
<span class="line-added">587 };</span>
<span class="line-added">588 </span>
<span class="line-added">589 PageConfiguration pageConfigurationWithEmptyClients(PAL::SessionID sessionID)</span>
590 {
591     PageConfiguration pageConfiguration {
<span class="line-added">592         sessionID,</span>
593         makeUniqueRef&lt;EmptyEditorClient&gt;(),
594         SocketProvider::create(),
595         LibWebRTCProvider::create(),
596         CacheStorageProvider::create(),
597         adoptRef(*new EmptyBackForwardClient),
<span class="line-modified">598         CookieJar::create(adoptRef(*new EmptyStorageSessionProvider)),</span>
<span class="line-added">599         makeUniqueRef&lt;EmptyProgressTrackerClient&gt;(),</span>
<span class="line-added">600         makeUniqueRef&lt;EmptyMediaRecorderProvider&gt;()</span>
601     };
602 
603     static NeverDestroyed&lt;EmptyChromeClient&gt; dummyChromeClient;
604     pageConfiguration.chromeClient = &amp;dummyChromeClient.get();
605 
606 #if ENABLE(APPLE_PAY)
607     static NeverDestroyed&lt;EmptyPaymentCoordinatorClient&gt; dummyPaymentCoordinatorClient;
608     pageConfiguration.paymentCoordinatorClient = &amp;dummyPaymentCoordinatorClient.get();
609 #endif
610 
611 #if ENABLE(CONTEXT_MENUS)
612     static NeverDestroyed&lt;EmptyContextMenuClient&gt; dummyContextMenuClient;
613     pageConfiguration.contextMenuClient = &amp;dummyContextMenuClient.get();
614 #endif
615 
616 #if ENABLE(DRAG_SUPPORT)
<span class="line-modified">617     pageConfiguration.dragClient = makeUnique&lt;EmptyDragClient&gt;();</span>

618 #endif
619 
620     static NeverDestroyed&lt;EmptyInspectorClient&gt; dummyInspectorClient;
621     pageConfiguration.inspectorClient = &amp;dummyInspectorClient.get();
622 
623     static NeverDestroyed&lt;EmptyFrameLoaderClient&gt; dummyFrameLoaderClient;
624     pageConfiguration.loaderClientForMainFrame = &amp;dummyFrameLoaderClient.get();
625 



626     pageConfiguration.diagnosticLoggingClient = makeUnique&lt;EmptyDiagnosticLoggingClient&gt;();
627 
628     pageConfiguration.applicationCacheStorage = ApplicationCacheStorage::create({ }, { });
629     pageConfiguration.databaseProvider = adoptRef(*new EmptyDatabaseProvider);
630     pageConfiguration.pluginInfoProvider = adoptRef(*new EmptyPluginInfoProvider);
631     pageConfiguration.storageNamespaceProvider = adoptRef(*new EmptyStorageNamespaceProvider);
632     pageConfiguration.userContentProvider = adoptRef(*new EmptyUserContentProvider);
633     pageConfiguration.visitedLinkStore = adoptRef(*new EmptyVisitedLinkStore);
634 
635     return pageConfiguration;
636 }
637 
638 DiagnosticLoggingClient&amp; emptyDiagnosticLoggingClient()
639 {
640     static NeverDestroyed&lt;EmptyDiagnosticLoggingClient&gt; client;
641     return client;
642 }
643 
644 }
</pre>
</td>
</tr>
</table>
<center><a href="DocumentWriter.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="EmptyClients.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>