<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/JavaScriptCore/Scripts/generate-combined-inspector-json.py</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre> 1 #!/usr/bin/env python
 2 
 3 # Copyright (C) 2013 Apple Inc. All rights reserved.
 4 #
 5 # Redistribution and use in source and binary forms, with or without
 6 # modification, are permitted provided that the following conditions
 7 # are met:
 8 # 1. Redistributions of source code must retain the above copyright
 9 #    notice, this list of conditions and the following disclaimer.
10 # 2. Redistributions in binary form must reproduce the above copyright
11 #    notice, this list of conditions and the following disclaimer in the
12 #    documentation and/or other materials provided with the distribution.
13 #
14 # THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39;
15 # AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
16 # THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
17 # PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
18 # BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
19 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
20 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
21 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
22 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
23 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
24 # THE POSSIBILITY OF SUCH DAMAGE.
25 
26 import glob
27 import json
28 import os
<a name="1" id="anc1"></a><span class="line-added">29 import re</span>
30 import sys
31 
32 if len(sys.argv) &lt; 2:
33     print(&quot;usage: %s [json files or directory of json files ...]&quot; % os.path.basename(sys.argv[0]))
34     sys.exit(1)
35 
36 files = []
37 for arg in sys.argv[1:]:
38     if not os.access(arg, os.F_OK):
39         raise Exception(&quot;File \&quot;%s\&quot; not found&quot; % arg)
40     elif os.path.isdir(arg):
41         files.extend(glob.glob(os.path.join(arg, &quot;*.json&quot;)))
42     else:
43         files.append(arg)
44 files.sort()
45 
46 # To keep as close to the original JSON formatting as possible, just
47 # dump each JSON input file unmodified into an array of &quot;domains&quot;.
48 # Validate each file is valid JSON and that there is a &quot;domain&quot; key.
49 
50 first = True
51 print(&quot;{\&quot;domains\&quot;:[&quot;)
52 for file in files:
53     if first:
54         first = False
55     else:
56         print(&quot;,&quot;)
57 
58     string = open(file).read()
59 
60     try:
<a name="2" id="anc2"></a><span class="line-modified">61         regex = re.compile(r&quot;\/\*.*?\*\/&quot;, re.DOTALL)</span>
<span class="line-added">62         dictionary = json.loads(re.sub(regex, &quot;&quot;, string))</span>
63         if not &quot;domain&quot; in dictionary:
64             raise Exception(&quot;File \&quot;%s\&quot; does not contains a \&quot;domain\&quot; key.&quot; % file)
65     except ValueError:
66         sys.stderr.write(&quot;File \&quot;%s\&quot; does not contain valid JSON:\n&quot; % file)
67         raise
68 
69     print(string.rstrip())
70 print(&quot;]}&quot;)
71 
<a name="3" id="anc3"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="3" type="hidden" />
</body>
</html>