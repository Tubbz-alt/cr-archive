<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/FontDescription.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) 2000 Lars Knoll (knoll@kde.org)
  3  *           (C) 2000 Antti Koivisto (koivisto@kde.org)
  4  *           (C) 2000 Dirk Mueller (mueller@kde.org)
  5  * Copyright (C) 2003, 2004, 2005, 2006, 2007, 2008, 2013 Apple Inc. All rights reserved.
  6  * Copyright (C) 2007 Nicholas Shanks &lt;webkit@nickshanks.com&gt;
  7  *
  8  * This library is free software; you can redistribute it and/or
  9  * modify it under the terms of the GNU Library General Public
 10  * License as published by the Free Software Foundation; either
 11  * version 2 of the License, or (at your option) any later version.
 12  *
 13  * This library is distributed in the hope that it will be useful,
 14  * but WITHOUT ANY WARRANTY; without even the implied warranty of
 15  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 16  * Library General Public License for more details.
 17  *
 18  * You should have received a copy of the GNU Library General Public License
 19  * along with this library; see the file COPYING.LIother.m_  If not, write to
 20  * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 21  * Boston, MA 02110-1301, USm_
 22  *
 23  */
 24 
 25 #pragma once
 26 
 27 #include &quot;FontSelectionAlgorithm.h&quot;
 28 #include &quot;FontTaggedSettings.h&quot;
 29 #include &quot;TextFlags.h&quot;
 30 #include &quot;WebKitFontFamilyNames.h&quot;
 31 #include &lt;unicode/uscript.h&gt;
 32 #include &lt;wtf/MathExtras.h&gt;
 33 
 34 namespace WebCore {
 35 
 36 using namespace WebKitFontFamilyNames;
 37 
 38 class FontDescription {
 39 public:
 40     WEBCORE_EXPORT FontDescription();
 41 
 42     bool operator==(const FontDescription&amp;) const;
 43     bool operator!=(const FontDescription&amp; other) const { return !(*this == other); }
 44 
 45     float computedSize() const { return m_computedSize; }
 46     unsigned computedPixelSize() const { return unsigned(m_computedSize + 0.5f); }
 47     Optional&lt;FontSelectionValue&gt; italic() const { return m_fontSelectionRequest.slope; }
 48     FontSelectionValue stretch() const { return m_fontSelectionRequest.width; }
 49     FontSelectionValue weight() const { return m_fontSelectionRequest.weight; }
 50     FontSelectionRequest fontSelectionRequest() const { return m_fontSelectionRequest; }
 51     FontRenderingMode renderingMode() const { return static_cast&lt;FontRenderingMode&gt;(m_renderingMode); }
 52     TextRenderingMode textRenderingMode() const { return static_cast&lt;TextRenderingMode&gt;(m_textRendering); }
 53     UScriptCode script() const { return static_cast&lt;UScriptCode&gt;(m_script); }
 54     const AtomString&amp; locale() const { return m_locale; }
 55 
 56     FontOrientation orientation() const { return static_cast&lt;FontOrientation&gt;(m_orientation); }
 57     NonCJKGlyphOrientation nonCJKGlyphOrientation() const { return static_cast&lt;NonCJKGlyphOrientation&gt;(m_nonCJKGlyphOrientation); }
 58     FontWidthVariant widthVariant() const { return static_cast&lt;FontWidthVariant&gt;(m_widthVariant); }
 59     const FontFeatureSettings&amp; featureSettings() const { return m_featureSettings; }
 60     const FontVariationSettings&amp; variationSettings() const { return m_variationSettings; }
 61     FontSynthesis fontSynthesis() const { return static_cast&lt;FontSynthesis&gt;(m_fontSynthesis); }
 62     FontVariantLigatures variantCommonLigatures() const { return static_cast&lt;FontVariantLigatures&gt;(m_variantCommonLigatures); }
 63     FontVariantLigatures variantDiscretionaryLigatures() const { return static_cast&lt;FontVariantLigatures&gt;(m_variantDiscretionaryLigatures); }
 64     FontVariantLigatures variantHistoricalLigatures() const { return static_cast&lt;FontVariantLigatures&gt;(m_variantHistoricalLigatures); }
 65     FontVariantLigatures variantContextualAlternates() const { return static_cast&lt;FontVariantLigatures&gt;(m_variantContextualAlternates); }
 66     FontVariantPosition variantPosition() const { return static_cast&lt;FontVariantPosition&gt;(m_variantPosition); }
 67     FontVariantCaps variantCaps() const { return static_cast&lt;FontVariantCaps&gt;(m_variantCaps); }
 68     FontVariantNumericFigure variantNumericFigure() const { return static_cast&lt;FontVariantNumericFigure&gt;(m_variantNumericFigure); }
 69     FontVariantNumericSpacing variantNumericSpacing() const { return static_cast&lt;FontVariantNumericSpacing&gt;(m_variantNumericSpacing); }
 70     FontVariantNumericFraction variantNumericFraction() const { return static_cast&lt;FontVariantNumericFraction&gt;(m_variantNumericFraction); }
 71     FontVariantNumericOrdinal variantNumericOrdinal() const { return static_cast&lt;FontVariantNumericOrdinal&gt;(m_variantNumericOrdinal); }
 72     FontVariantNumericSlashedZero variantNumericSlashedZero() const { return static_cast&lt;FontVariantNumericSlashedZero&gt;(m_variantNumericSlashedZero); }
 73     FontVariantAlternates variantAlternates() const { return static_cast&lt;FontVariantAlternates&gt;(m_variantAlternates); }
 74     FontVariantEastAsianVariant variantEastAsianVariant() const { return static_cast&lt;FontVariantEastAsianVariant&gt;(m_variantEastAsianVariant); }
 75     FontVariantEastAsianWidth variantEastAsianWidth() const { return static_cast&lt;FontVariantEastAsianWidth&gt;(m_variantEastAsianWidth); }
 76     FontVariantEastAsianRuby variantEastAsianRuby() const { return static_cast&lt;FontVariantEastAsianRuby&gt;(m_variantEastAsianRuby); }
 77     FontVariantSettings variantSettings() const
 78     {
 79         return { variantCommonLigatures(),
 80             variantDiscretionaryLigatures(),
 81             variantHistoricalLigatures(),
 82             variantContextualAlternates(),
 83             variantPosition(),
 84             variantCaps(),
 85             variantNumericFigure(),
 86             variantNumericSpacing(),
 87             variantNumericFraction(),
 88             variantNumericOrdinal(),
 89             variantNumericSlashedZero(),
 90             variantAlternates(),
 91             variantEastAsianVariant(),
 92             variantEastAsianWidth(),
 93             variantEastAsianRuby() };
 94     }
 95     FontOpticalSizing opticalSizing() const { return static_cast&lt;FontOpticalSizing&gt;(m_opticalSizing); }
 96     FontStyleAxis fontStyleAxis() const { return m_fontStyleAxis ? FontStyleAxis::ital : FontStyleAxis::slnt; }
 97     AllowUserInstalledFonts shouldAllowUserInstalledFonts() const { return static_cast&lt;AllowUserInstalledFonts&gt;(m_shouldAllowUserInstalledFonts); }
 98 
 99     void setComputedSize(float s) { m_computedSize = clampToFloat(s); }
100     void setItalic(Optional&lt;FontSelectionValue&gt; italic) { m_fontSelectionRequest.slope = italic; }
101     void setStretch(FontSelectionValue stretch) { m_fontSelectionRequest.width = stretch; }
102     void setIsItalic(bool isItalic) { setItalic(isItalic ? Optional&lt;FontSelectionValue&gt; { italicValue() } : Optional&lt;FontSelectionValue&gt; { }); }
103     void setWeight(FontSelectionValue weight) { m_fontSelectionRequest.weight = weight; }
104     void setRenderingMode(FontRenderingMode mode) { m_renderingMode = static_cast&lt;unsigned&gt;(mode); }
105     void setTextRenderingMode(TextRenderingMode rendering) { m_textRendering = static_cast&lt;unsigned&gt;(rendering); }
106     void setOrientation(FontOrientation orientation) { m_orientation = static_cast&lt;unsigned&gt;(orientation); }
107     void setNonCJKGlyphOrientation(NonCJKGlyphOrientation orientation) { m_nonCJKGlyphOrientation = static_cast&lt;unsigned&gt;(orientation); }
108     void setWidthVariant(FontWidthVariant widthVariant) { m_widthVariant = static_cast&lt;unsigned&gt;(widthVariant); } // Make sure new callers of this sync with FontPlatformData::isForTextCombine()!
109     WEBCORE_EXPORT void setLocale(const AtomString&amp;);
110     void setFeatureSettings(FontFeatureSettings&amp;&amp; settings) { m_featureSettings = WTFMove(settings); }
111 #if ENABLE(VARIATION_FONTS)
112     void setVariationSettings(FontVariationSettings&amp;&amp; settings) { m_variationSettings = WTFMove(settings); }
113 #endif
114     void setFontSynthesis(FontSynthesis fontSynthesis) { m_fontSynthesis = fontSynthesis; }
115     void setVariantCommonLigatures(FontVariantLigatures variant) { m_variantCommonLigatures = static_cast&lt;unsigned&gt;(variant); }
116     void setVariantDiscretionaryLigatures(FontVariantLigatures variant) { m_variantDiscretionaryLigatures = static_cast&lt;unsigned&gt;(variant); }
117     void setVariantHistoricalLigatures(FontVariantLigatures variant) { m_variantHistoricalLigatures = static_cast&lt;unsigned&gt;(variant); }
118     void setVariantContextualAlternates(FontVariantLigatures variant) { m_variantContextualAlternates = static_cast&lt;unsigned&gt;(variant); }
119     void setVariantPosition(FontVariantPosition variant) { m_variantPosition = static_cast&lt;unsigned&gt;(variant); }
120     void setVariantCaps(FontVariantCaps variant) { m_variantCaps = static_cast&lt;unsigned&gt;(variant); }
121     void setVariantNumericFigure(FontVariantNumericFigure variant) { m_variantNumericFigure = static_cast&lt;unsigned&gt;(variant); }
122     void setVariantNumericSpacing(FontVariantNumericSpacing variant) { m_variantNumericSpacing = static_cast&lt;unsigned&gt;(variant); }
123     void setVariantNumericFraction(FontVariantNumericFraction variant) { m_variantNumericFraction = static_cast&lt;unsigned&gt;(variant); }
124     void setVariantNumericOrdinal(FontVariantNumericOrdinal variant) { m_variantNumericOrdinal = static_cast&lt;unsigned&gt;(variant); }
125     void setVariantNumericSlashedZero(FontVariantNumericSlashedZero variant) { m_variantNumericSlashedZero = static_cast&lt;unsigned&gt;(variant); }
126     void setVariantAlternates(FontVariantAlternates variant) { m_variantAlternates = static_cast&lt;unsigned&gt;(variant); }
127     void setVariantEastAsianVariant(FontVariantEastAsianVariant variant) { m_variantEastAsianVariant = static_cast&lt;unsigned&gt;(variant); }
128     void setVariantEastAsianWidth(FontVariantEastAsianWidth variant) { m_variantEastAsianWidth = static_cast&lt;unsigned&gt;(variant); }
129     void setVariantEastAsianRuby(FontVariantEastAsianRuby variant) { m_variantEastAsianRuby = static_cast&lt;unsigned&gt;(variant); }
130     void setOpticalSizing(FontOpticalSizing sizing) { m_opticalSizing = static_cast&lt;unsigned&gt;(sizing); }
131     void setFontStyleAxis(FontStyleAxis axis) { m_fontStyleAxis = axis == FontStyleAxis::ital; }
132     void setShouldAllowUserInstalledFonts(AllowUserInstalledFonts shouldAllowUserInstalledFonts) { m_shouldAllowUserInstalledFonts = static_cast&lt;unsigned&gt;(shouldAllowUserInstalledFonts); }
133 
134     static AtomString platformResolveGenericFamily(UScriptCode, const AtomString&amp; locale, const AtomString&amp; familyName);
135 
136     template&lt;class Encoder&gt;
137     void encode(Encoder&amp;) const;
138 
139     template&lt;class Decoder&gt;
140     static Optional&lt;FontDescription&gt; decode(Decoder&amp;);
141 
142 private:
143     // FIXME: Investigate moving these into their own object on the heap (to save memory).
144     FontFeatureSettings m_featureSettings;
145     FontVariationSettings m_variationSettings;
146     AtomString m_locale;
147 
148     FontSelectionRequest m_fontSelectionRequest;
149     float m_computedSize { 0 }; // Computed size adjusted for the minimum font size and the zoom factor.
150     unsigned m_orientation : 1; // FontOrientation - Whether the font is rendering on a horizontal line or a vertical line.
151     unsigned m_nonCJKGlyphOrientation : 1; // NonCJKGlyphOrientation - Only used by vertical text. Determines the default orientation for non-ideograph glyphs.
152     unsigned m_widthVariant : 2; // FontWidthVariant
153     unsigned m_renderingMode : 1; // Used to switch between CG and GDI text on Windows.
154     unsigned m_textRendering : 2; // TextRenderingMode
155     unsigned m_script : 7; // Used to help choose an appropriate font for generic font families.
156     unsigned m_fontSynthesis : 3; // FontSynthesis type
157     unsigned m_variantCommonLigatures : 2; // FontVariantLigatures
158     unsigned m_variantDiscretionaryLigatures : 2; // FontVariantLigatures
159     unsigned m_variantHistoricalLigatures : 2; // FontVariantLigatures
160     unsigned m_variantContextualAlternates : 2; // FontVariantLigatures
161     unsigned m_variantPosition : 2; // FontVariantPosition
162     unsigned m_variantCaps : 3; // FontVariantCaps
163     unsigned m_variantNumericFigure : 2; // FontVariantNumericFigure
164     unsigned m_variantNumericSpacing : 2; // FontVariantNumericSpacing
165     unsigned m_variantNumericFraction : 2; // FontVariantNumericFraction
166     unsigned m_variantNumericOrdinal : 1; // FontVariantNumericOrdinal
167     unsigned m_variantNumericSlashedZero : 1; // FontVariantNumericSlashedZero
168     unsigned m_variantAlternates : 1; // FontVariantAlternates
169     unsigned m_variantEastAsianVariant : 3; // FontVariantEastAsianVariant
170     unsigned m_variantEastAsianWidth : 2; // FontVariantEastAsianWidth
171     unsigned m_variantEastAsianRuby : 1; // FontVariantEastAsianRuby
172     unsigned m_opticalSizing : 1; // FontOpticalSizing
173     unsigned m_fontStyleAxis : 1; // Whether &quot;font-style: italic&quot; or &quot;font-style: oblique 20deg&quot; was specified
174     unsigned m_shouldAllowUserInstalledFonts : 1; // AllowUserInstalledFonts: If this description is allowed to match a user-installed font
175 };
176 
177 inline bool FontDescription::operator==(const FontDescription&amp; other) const
178 {
179     return m_computedSize == other.m_computedSize
180         &amp;&amp; m_fontSelectionRequest == other.m_fontSelectionRequest
181         &amp;&amp; m_renderingMode == other.m_renderingMode
182         &amp;&amp; m_textRendering == other.m_textRendering
183         &amp;&amp; m_orientation == other.m_orientation
184         &amp;&amp; m_nonCJKGlyphOrientation == other.m_nonCJKGlyphOrientation
185         &amp;&amp; m_widthVariant == other.m_widthVariant
186         &amp;&amp; m_locale == other.m_locale
187         &amp;&amp; m_featureSettings == other.m_featureSettings
188 #if ENABLE(VARIATION_FONTS)
189         &amp;&amp; m_variationSettings == other.m_variationSettings
190 #endif
191         &amp;&amp; m_fontSynthesis == other.m_fontSynthesis
192         &amp;&amp; m_variantCommonLigatures == other.m_variantCommonLigatures
193         &amp;&amp; m_variantDiscretionaryLigatures == other.m_variantDiscretionaryLigatures
194         &amp;&amp; m_variantHistoricalLigatures == other.m_variantHistoricalLigatures
195         &amp;&amp; m_variantContextualAlternates == other.m_variantContextualAlternates
196         &amp;&amp; m_variantPosition == other.m_variantPosition
197         &amp;&amp; m_variantCaps == other.m_variantCaps
198         &amp;&amp; m_variantNumericFigure == other.m_variantNumericFigure
199         &amp;&amp; m_variantNumericSpacing == other.m_variantNumericSpacing
200         &amp;&amp; m_variantNumericFraction == other.m_variantNumericFraction
201         &amp;&amp; m_variantNumericOrdinal == other.m_variantNumericOrdinal
202         &amp;&amp; m_variantNumericSlashedZero == other.m_variantNumericSlashedZero
203         &amp;&amp; m_variantAlternates == other.m_variantAlternates
204         &amp;&amp; m_variantEastAsianVariant == other.m_variantEastAsianVariant
205         &amp;&amp; m_variantEastAsianWidth == other.m_variantEastAsianWidth
206         &amp;&amp; m_variantEastAsianRuby == other.m_variantEastAsianRuby
207         &amp;&amp; m_opticalSizing == other.m_opticalSizing
208         &amp;&amp; m_fontStyleAxis == other.m_fontStyleAxis
209         &amp;&amp; m_shouldAllowUserInstalledFonts == other.m_shouldAllowUserInstalledFonts;
210 }
211 
212 template&lt;class Encoder&gt;
213 void FontDescription::encode(Encoder&amp; encoder) const
214 {
215     encoder &lt;&lt; featureSettings();
216 #if ENABLE(VARIATION_FONTS)
217     encoder &lt;&lt; variationSettings();
218 #endif
219     encoder &lt;&lt; locale();
220     encoder &lt;&lt; italic();
221     encoder &lt;&lt; stretch();
222     encoder &lt;&lt; weight();
223     encoder &lt;&lt; m_computedSize;
224     encoder &lt;&lt; orientation();
225     encoder &lt;&lt; nonCJKGlyphOrientation();
226     encoder &lt;&lt; widthVariant();
227     encoder &lt;&lt; renderingMode();
228     encoder &lt;&lt; textRenderingMode();
229     encoder &lt;&lt; fontSynthesis();
230     encoder &lt;&lt; variantCommonLigatures();
231     encoder &lt;&lt; variantDiscretionaryLigatures();
232     encoder &lt;&lt; variantHistoricalLigatures();
233     encoder &lt;&lt; variantContextualAlternates();
234     encoder &lt;&lt; variantPosition();
235     encoder &lt;&lt; variantCaps();
236     encoder &lt;&lt; variantNumericFigure();
237     encoder &lt;&lt; variantNumericSpacing();
238     encoder &lt;&lt; variantNumericFraction();
239     encoder &lt;&lt; variantNumericOrdinal();
240     encoder &lt;&lt; variantNumericSlashedZero();
241     encoder &lt;&lt; variantAlternates();
242     encoder &lt;&lt; variantEastAsianVariant();
243     encoder &lt;&lt; variantEastAsianWidth();
244     encoder &lt;&lt; variantEastAsianRuby();
245     encoder &lt;&lt; opticalSizing();
246     encoder &lt;&lt; fontStyleAxis();
247     encoder &lt;&lt; shouldAllowUserInstalledFonts();
248 }
249 
250 template&lt;class Decoder&gt;
251 Optional&lt;FontDescription&gt; FontDescription::decode(Decoder&amp; decoder)
252 {
253     FontDescription fontDescription;
254     Optional&lt;FontFeatureSettings&gt; featureSettings;
255     decoder &gt;&gt; featureSettings;
256     if (!featureSettings)
257         return WTF::nullopt;
258 
259 #if ENABLE(VARIATION_FONTS)
260     Optional&lt;FontVariationSettings&gt; variationSettings;
261     decoder &gt;&gt; variationSettings;
262     if (!variationSettings)
263         return WTF::nullopt;
264 #endif
265 
266     Optional&lt;AtomString&gt; locale;
267     decoder &gt;&gt; locale;
268     if (!locale)
269         return WTF::nullopt;
270 
271     Optional&lt;Optional&lt;FontSelectionValue&gt;&gt; italic;
272     decoder &gt;&gt; italic;
273     if (!italic)
274         return WTF::nullopt;
275 
276     Optional&lt;FontSelectionValue&gt; stretch;
277     decoder &gt;&gt; stretch;
278     if (!stretch)
279         return WTF::nullopt;
280 
281     Optional&lt;FontSelectionValue&gt; weight;
282     decoder &gt;&gt; weight;
283     if (!weight)
284         return WTF::nullopt;
285 
286     Optional&lt;float&gt; computedSize;
287     decoder &gt;&gt; computedSize;
288     if (!computedSize)
289         return WTF::nullopt;
290 
291     Optional&lt;FontOrientation&gt; orientation;
292     decoder &gt;&gt; orientation;
293     if (!orientation)
294         return WTF::nullopt;
295 
296     Optional&lt;NonCJKGlyphOrientation&gt; nonCJKGlyphOrientation;
297     decoder &gt;&gt; nonCJKGlyphOrientation;
298     if (!nonCJKGlyphOrientation)
299         return WTF::nullopt;
300 
301     Optional&lt;FontWidthVariant&gt; widthVariant;
302     decoder &gt;&gt; widthVariant;
303     if (!widthVariant)
304         return WTF::nullopt;
305 
306     Optional&lt;FontRenderingMode&gt; renderingMode;
307     decoder &gt;&gt; renderingMode;
308     if (!renderingMode)
309         return WTF::nullopt;
310 
311     Optional&lt;TextRenderingMode&gt; textRenderingMode;
312     decoder &gt;&gt; textRenderingMode;
313     if (!textRenderingMode)
314         return WTF::nullopt;
315 
316     Optional&lt;FontSynthesis&gt; fontSynthesis;
317     decoder &gt;&gt; fontSynthesis;
318     if (!fontSynthesis)
319         return WTF::nullopt;
320 
321     Optional&lt;FontVariantLigatures&gt; variantCommonLigatures;
322     decoder &gt;&gt; variantCommonLigatures;
323     if (!variantCommonLigatures)
324         return WTF::nullopt;
325 
326     Optional&lt;FontVariantLigatures&gt; variantDiscretionaryLigatures;
327     decoder &gt;&gt; variantDiscretionaryLigatures;
328     if (!variantDiscretionaryLigatures)
329         return WTF::nullopt;
330 
331     Optional&lt;FontVariantLigatures&gt; variantHistoricalLigatures;
332     decoder &gt;&gt; variantHistoricalLigatures;
333     if (!variantHistoricalLigatures)
334         return WTF::nullopt;
335 
336     Optional&lt;FontVariantLigatures&gt; variantContextualAlternates;
337     decoder &gt;&gt; variantContextualAlternates;
338     if (!variantContextualAlternates)
339         return WTF::nullopt;
340 
341     Optional&lt;FontVariantPosition&gt; variantPosition;
342     decoder &gt;&gt; variantPosition;
343     if (!variantPosition)
344         return WTF::nullopt;
345 
346     Optional&lt;FontVariantCaps&gt; variantCaps;
347     decoder &gt;&gt; variantCaps;
348     if (!variantCaps)
349         return WTF::nullopt;
350 
351     Optional&lt;FontVariantNumericFigure&gt; variantNumericFigure;
352     decoder &gt;&gt; variantNumericFigure;
353     if (!variantNumericFigure)
354         return WTF::nullopt;
355 
356     Optional&lt;FontVariantNumericSpacing&gt; variantNumericSpacing;
357     decoder &gt;&gt; variantNumericSpacing;
358     if (!variantNumericSpacing)
359         return WTF::nullopt;
360 
361     Optional&lt;FontVariantNumericFraction&gt; variantNumericFraction;
362     decoder &gt;&gt; variantNumericFraction;
363     if (!variantNumericFraction)
364         return WTF::nullopt;
365 
366     Optional&lt;FontVariantNumericOrdinal&gt; variantNumericOrdinal;
367     decoder &gt;&gt; variantNumericOrdinal;
368     if (!variantNumericOrdinal)
369         return WTF::nullopt;
370 
371     Optional&lt;FontVariantNumericSlashedZero&gt; variantNumericSlashedZero;
372     decoder &gt;&gt; variantNumericSlashedZero;
373     if (!variantNumericSlashedZero)
374         return WTF::nullopt;
375 
376     Optional&lt;FontVariantAlternates&gt; variantAlternates;
377     decoder &gt;&gt; variantAlternates;
378     if (!variantAlternates)
379         return WTF::nullopt;
380 
381     Optional&lt;FontVariantEastAsianVariant&gt; variantEastAsianVariant;
382     decoder &gt;&gt; variantEastAsianVariant;
383     if (!variantEastAsianVariant)
384         return WTF::nullopt;
385 
386     Optional&lt;FontVariantEastAsianWidth&gt; variantEastAsianWidth;
387     decoder &gt;&gt; variantEastAsianWidth;
388     if (!variantEastAsianWidth)
389         return WTF::nullopt;
390 
391     Optional&lt;FontVariantEastAsianRuby&gt; variantEastAsianRuby;
392     decoder &gt;&gt; variantEastAsianRuby;
393     if (!variantEastAsianRuby)
394         return WTF::nullopt;
395 
396     Optional&lt;FontOpticalSizing&gt; opticalSizing;
397     decoder &gt;&gt; opticalSizing;
398     if (!opticalSizing)
399         return WTF::nullopt;
400 
401     Optional&lt;FontStyleAxis&gt; fontStyleAxis;
402     decoder &gt;&gt; fontStyleAxis;
403     if (!fontStyleAxis)
404         return WTF::nullopt;
405 
406     Optional&lt;AllowUserInstalledFonts&gt; shouldAllowUserInstalledFonts;
407     decoder &gt;&gt; shouldAllowUserInstalledFonts;
408     if (!shouldAllowUserInstalledFonts)
409         return WTF::nullopt;
410 
411     fontDescription.setFeatureSettings(WTFMove(*featureSettings));
412 #if ENABLE(VARIATION_FONTS)
413     fontDescription.setVariationSettings(WTFMove(*variationSettings));
414 #endif
415     fontDescription.setLocale(*locale);
416     fontDescription.setItalic(*italic);
417     fontDescription.setStretch(*stretch);
418     fontDescription.setWeight(*weight);
419     fontDescription.setComputedSize(*computedSize);
420     fontDescription.setOrientation(*orientation);
421     fontDescription.setNonCJKGlyphOrientation(*nonCJKGlyphOrientation);
422     fontDescription.setWidthVariant(*widthVariant);
423     fontDescription.setRenderingMode(*renderingMode);
424     fontDescription.setTextRenderingMode(*textRenderingMode);
425     fontDescription.setFontSynthesis(*fontSynthesis);
426     fontDescription.setVariantCommonLigatures(*variantCommonLigatures);
427     fontDescription.setVariantDiscretionaryLigatures(*variantDiscretionaryLigatures);
428     fontDescription.setVariantHistoricalLigatures(*variantHistoricalLigatures);
429     fontDescription.setVariantContextualAlternates(*variantContextualAlternates);
430     fontDescription.setVariantPosition(*variantPosition);
431     fontDescription.setVariantCaps(*variantCaps);
432     fontDescription.setVariantNumericFigure(*variantNumericFigure);
433     fontDescription.setVariantNumericSpacing(*variantNumericSpacing);
434     fontDescription.setVariantNumericFraction(*variantNumericFraction);
435     fontDescription.setVariantNumericOrdinal(*variantNumericOrdinal);
436     fontDescription.setVariantNumericSlashedZero(*variantNumericSlashedZero);
437     fontDescription.setVariantAlternates(*variantAlternates);
438     fontDescription.setVariantEastAsianVariant(*variantEastAsianVariant);
439     fontDescription.setVariantEastAsianWidth(*variantEastAsianWidth);
440     fontDescription.setVariantEastAsianRuby(*variantEastAsianRuby);
441     fontDescription.setOpticalSizing(*opticalSizing);
442     fontDescription.setFontStyleAxis(*fontStyleAxis);
443     fontDescription.setShouldAllowUserInstalledFonts(*shouldAllowUserInstalledFonts);
444 
445     return fontDescription;
446 }
447 
448 }
    </pre>
  </body>
</html>