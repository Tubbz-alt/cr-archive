<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/ConsoleObject.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ConsoleClient.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ConstructAbility.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/ConsoleObject.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #include &quot;config.h&quot;
 27 #include &quot;ConsoleObject.h&quot;
 28 
 29 #include &quot;ConsoleClient.h&quot;
 30 #include &quot;Error.h&quot;
 31 #include &quot;JSCInlines.h&quot;
 32 #include &quot;ScriptArguments.h&quot;
 33 #include &quot;ScriptCallStackFactory.h&quot;
 34 
 35 namespace JSC {
 36 
<span class="line-modified"> 37 static String valueOrDefaultLabelString(ExecState* exec)</span>
 38 {
<span class="line-modified"> 39     if (exec-&gt;argumentCount() &lt; 1)</span>
 40         return &quot;default&quot;_s;
 41 
<span class="line-modified"> 42     auto value = exec-&gt;argument(0);</span>
 43     if (value.isUndefined())
 44         return &quot;default&quot;_s;
 45 
<span class="line-modified"> 46     return value.toWTFString(exec);</span>
 47 }
 48 
 49 STATIC_ASSERT_IS_TRIVIALLY_DESTRUCTIBLE(ConsoleObject);
 50 
<span class="line-modified"> 51 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDebug(ExecState*);</span>
<span class="line-modified"> 52 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncError(ExecState*);</span>
<span class="line-modified"> 53 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncLog(ExecState*);</span>
<span class="line-modified"> 54 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncInfo(ExecState*);</span>
<span class="line-modified"> 55 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncWarn(ExecState*);</span>
<span class="line-modified"> 56 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncClear(ExecState*);</span>
<span class="line-modified"> 57 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDir(ExecState*);</span>
<span class="line-modified"> 58 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDirXML(ExecState*);</span>
<span class="line-modified"> 59 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTable(ExecState*);</span>
<span class="line-modified"> 60 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTrace(ExecState*);</span>
<span class="line-modified"> 61 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncAssert(ExecState*);</span>
<span class="line-modified"> 62 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCount(ExecState*);</span>
<span class="line-modified"> 63 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCountReset(ExecState*);</span>
<span class="line-modified"> 64 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfile(ExecState*);</span>
<span class="line-modified"> 65 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfileEnd(ExecState*);</span>
<span class="line-modified"> 66 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTakeHeapSnapshot(ExecState*);</span>
<span class="line-modified"> 67 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTime(ExecState*);</span>
<span class="line-modified"> 68 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeLog(ExecState*);</span>
<span class="line-modified"> 69 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeEnd(ExecState*);</span>
<span class="line-modified"> 70 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeStamp(ExecState*);</span>
<span class="line-modified"> 71 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroup(ExecState*);</span>
<span class="line-modified"> 72 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupCollapsed(ExecState*);</span>
<span class="line-modified"> 73 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupEnd(ExecState*);</span>
<span class="line-modified"> 74 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecord(ExecState*);</span>
<span class="line-modified"> 75 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecordEnd(ExecState*);</span>
<span class="line-modified"> 76 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncScreenshot(ExecState*);</span>
 77 
 78 const ClassInfo ConsoleObject::s_info = { &quot;Console&quot;, &amp;Base::s_info, nullptr, nullptr, CREATE_METHOD_TABLE(ConsoleObject) };
 79 
 80 ConsoleObject::ConsoleObject(VM&amp; vm, Structure* structure)
 81     : JSNonFinalObject(vm, structure)
 82 {
 83 }
 84 
 85 void ConsoleObject::finishCreation(VM&amp; vm, JSGlobalObject* globalObject)
 86 {
 87     Base::finishCreation(vm);
 88     ASSERT(inherits(vm, info()));
 89 
 90     // For legacy reasons, console properties are enumerable, writable, deleteable,
 91     // and all have a length of 0. This may change if Console is standardized.
 92 
 93     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;debug&quot;, consoleProtoFuncDebug, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
 94     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;error&quot;, consoleProtoFuncError, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
 95     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;log&quot;, consoleProtoFuncLog, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
 96     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;info&quot;, consoleProtoFuncInfo, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
</pre>
<hr />
<pre>
102     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;table&quot;, consoleProtoFuncTable, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
103     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;trace&quot;, consoleProtoFuncTrace, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
104     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;assert&quot;, consoleProtoFuncAssert, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
105     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;count, consoleProtoFuncCount, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
106     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;countReset&quot;, consoleProtoFuncCountReset, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
107     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;profile&quot;, consoleProtoFuncProfile, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
108     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;profileEnd&quot;, consoleProtoFuncProfileEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
109     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;time&quot;, consoleProtoFuncTime, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
110     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;timeLog&quot;, consoleProtoFuncTimeLog, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
111     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;timeEnd&quot;, consoleProtoFuncTimeEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
112     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;timeStamp&quot;, consoleProtoFuncTimeStamp, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
113     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;takeHeapSnapshot&quot;, consoleProtoFuncTakeHeapSnapshot, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
114     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;group&quot;, consoleProtoFuncGroup, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
115     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;groupCollapsed&quot;, consoleProtoFuncGroupCollapsed, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
116     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;groupEnd&quot;, consoleProtoFuncGroupEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
117     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;record&quot;, consoleProtoFuncRecord, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
118     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;recordEnd&quot;, consoleProtoFuncRecordEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
119     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;screenshot&quot;, consoleProtoFuncScreenshot, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
120 }
121 
<span class="line-modified">122 static String valueToStringWithUndefinedOrNullCheck(ExecState* exec, JSValue value)</span>
123 {
124     if (value.isUndefinedOrNull())
125         return String();
<span class="line-modified">126     return value.toWTFString(exec);</span>
127 }
128 
<span class="line-modified">129 static EncodedJSValue consoleLogWithLevel(ExecState* exec, MessageLevel level)</span>
130 {
<span class="line-modified">131     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
132     if (!client)
133         return JSValue::encode(jsUndefined());
134 
<span class="line-modified">135     client-&gt;logWithLevel(exec, Inspector::createScriptArguments(exec, 0), level);</span>
136     return JSValue::encode(jsUndefined());
137 }
138 
<span class="line-modified">139 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDebug(ExecState* exec)</span>
140 {
<span class="line-modified">141     return consoleLogWithLevel(exec, MessageLevel::Debug);</span>
142 }
143 
<span class="line-modified">144 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncError(ExecState* exec)</span>
145 {
<span class="line-modified">146     return consoleLogWithLevel(exec, MessageLevel::Error);</span>
147 }
148 
<span class="line-modified">149 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncLog(ExecState* exec)</span>
150 {
<span class="line-modified">151     return consoleLogWithLevel(exec, MessageLevel::Log);</span>
152 }
153 
<span class="line-modified">154 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncInfo(ExecState* exec)</span>
155 {
<span class="line-modified">156     return consoleLogWithLevel(exec, MessageLevel::Info);</span>
157 }
158 
<span class="line-modified">159 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncWarn(ExecState* exec)</span>
160 {
<span class="line-modified">161     return consoleLogWithLevel(exec, MessageLevel::Warning);</span>
162 }
163 
<span class="line-modified">164 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncClear(ExecState* exec)</span>
165 {
<span class="line-modified">166     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
167     if (!client)
168         return JSValue::encode(jsUndefined());
169 
<span class="line-modified">170     client-&gt;clear(exec);</span>
171     return JSValue::encode(jsUndefined());
172 }
173 
<span class="line-modified">174 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDir(ExecState* exec)</span>
175 {
<span class="line-modified">176     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
177     if (!client)
178         return JSValue::encode(jsUndefined());
179 
<span class="line-modified">180     client-&gt;dir(exec, Inspector::createScriptArguments(exec, 0));</span>
181     return JSValue::encode(jsUndefined());
182 }
183 
<span class="line-modified">184 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDirXML(ExecState* exec)</span>
185 {
<span class="line-modified">186     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
187     if (!client)
188         return JSValue::encode(jsUndefined());
189 
<span class="line-modified">190     client-&gt;dirXML(exec, Inspector::createScriptArguments(exec, 0));</span>
191     return JSValue::encode(jsUndefined());
192 }
193 
<span class="line-modified">194 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTable(ExecState* exec)</span>
195 {
<span class="line-modified">196     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
197     if (!client)
198         return JSValue::encode(jsUndefined());
199 
<span class="line-modified">200     client-&gt;table(exec, Inspector::createScriptArguments(exec, 0));</span>
201     return JSValue::encode(jsUndefined());
202 }
203 
<span class="line-modified">204 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTrace(ExecState* exec)</span>
205 {
<span class="line-modified">206     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
207     if (!client)
208         return JSValue::encode(jsUndefined());
209 
<span class="line-modified">210     client-&gt;trace(exec, Inspector::createScriptArguments(exec, 0));</span>
211     return JSValue::encode(jsUndefined());
212 }
213 
<span class="line-modified">214 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncAssert(ExecState* exec)</span>
215 {
<span class="line-modified">216     VM&amp; vm = exec-&gt;vm();</span>
217     auto scope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">218     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
219     if (!client)
220         return JSValue::encode(jsUndefined());
221 
<span class="line-modified">222     bool condition = exec-&gt;argument(0).toBoolean(exec);</span>
223     RETURN_IF_EXCEPTION(scope, encodedJSValue());
224 
225     if (condition)
226         return JSValue::encode(jsUndefined());
227 
<span class="line-modified">228     client-&gt;assertion(exec, Inspector::createScriptArguments(exec, 1));</span>
229     return JSValue::encode(jsUndefined());
230 }
231 
<span class="line-modified">232 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCount(ExecState* exec)</span>
233 {
<span class="line-modified">234     auto scope = DECLARE_THROW_SCOPE(exec-&gt;vm());</span>
<span class="line-modified">235     auto* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
236     if (!client)
237         return JSValue::encode(jsUndefined());
238 
<span class="line-modified">239     auto label = valueOrDefaultLabelString(exec);</span>
240     RETURN_IF_EXCEPTION(scope, encodedJSValue());
241 
<span class="line-modified">242     client-&gt;count(exec, label);</span>
243     return JSValue::encode(jsUndefined());
244 }
245 
<span class="line-modified">246 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCountReset(ExecState* exec)</span>
247 {
<span class="line-modified">248     auto scope = DECLARE_THROW_SCOPE(exec-&gt;vm());</span>
<span class="line-modified">249     auto* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
250     if (!client)
251         return JSValue::encode(jsUndefined());
252 
<span class="line-modified">253     auto label = valueOrDefaultLabelString(exec);</span>
254     RETURN_IF_EXCEPTION(scope, encodedJSValue());
255 
<span class="line-modified">256     client-&gt;countReset(exec, label);</span>
257     return JSValue::encode(jsUndefined());
258 }
259 
<span class="line-modified">260 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfile(ExecState* exec)</span>
261 {
<span class="line-modified">262     VM&amp; vm = exec-&gt;vm();</span>
263     auto scope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">264     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
265     if (!client)
266         return JSValue::encode(jsUndefined());
267 
<span class="line-modified">268     size_t argsCount = exec-&gt;argumentCount();</span>
269     if (!argsCount) {
<span class="line-modified">270         client-&gt;profile(exec, String());</span>
271         return JSValue::encode(jsUndefined());
272     }
273 
<span class="line-modified">274     const String&amp; title(valueToStringWithUndefinedOrNullCheck(exec, exec-&gt;argument(0)));</span>
275     RETURN_IF_EXCEPTION(scope, encodedJSValue());
276 
<span class="line-modified">277     client-&gt;profile(exec, title);</span>
278     return JSValue::encode(jsUndefined());
279 }
280 
<span class="line-modified">281 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfileEnd(ExecState* exec)</span>
282 {
<span class="line-modified">283     VM&amp; vm = exec-&gt;vm();</span>
284     auto scope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">285     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
286     if (!client)
287         return JSValue::encode(jsUndefined());
288 
<span class="line-modified">289     size_t argsCount = exec-&gt;argumentCount();</span>
290     if (!argsCount) {
<span class="line-modified">291         client-&gt;profileEnd(exec, String());</span>
292         return JSValue::encode(jsUndefined());
293     }
294 
<span class="line-modified">295     const String&amp; title(valueToStringWithUndefinedOrNullCheck(exec, exec-&gt;argument(0)));</span>
296     RETURN_IF_EXCEPTION(scope, encodedJSValue());
297 
<span class="line-modified">298     client-&gt;profileEnd(exec, title);</span>
299     return JSValue::encode(jsUndefined());
300 }
301 
<span class="line-modified">302 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTakeHeapSnapshot(ExecState* exec)</span>
303 {
<span class="line-modified">304     VM&amp; vm = exec-&gt;vm();</span>
305     auto scope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">306     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
307     if (!client)
308         return JSValue::encode(jsUndefined());
309 
<span class="line-modified">310     size_t argsCount = exec-&gt;argumentCount();</span>
311     if (!argsCount) {
<span class="line-modified">312         client-&gt;takeHeapSnapshot(exec, String());</span>
313         return JSValue::encode(jsUndefined());
314     }
315 
<span class="line-modified">316     const String&amp; title(valueToStringWithUndefinedOrNullCheck(exec, exec-&gt;argument(0)));</span>
317     RETURN_IF_EXCEPTION(scope, encodedJSValue());
318 
<span class="line-modified">319     client-&gt;takeHeapSnapshot(exec, title);</span>
320     return JSValue::encode(jsUndefined());
321 }
322 
<span class="line-modified">323 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTime(ExecState* exec)</span>
324 {
<span class="line-modified">325     auto scope = DECLARE_THROW_SCOPE(exec-&gt;vm());</span>
<span class="line-modified">326     auto* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
327     if (!client)
328         return JSValue::encode(jsUndefined());
329 
<span class="line-modified">330     auto label = valueOrDefaultLabelString(exec);</span>
331     RETURN_IF_EXCEPTION(scope, encodedJSValue());
332 
<span class="line-modified">333     client-&gt;time(exec, label);</span>
334     return JSValue::encode(jsUndefined());
335 }
336 
<span class="line-modified">337 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeLog(ExecState* exec)</span>
338 {
<span class="line-modified">339     auto scope = DECLARE_THROW_SCOPE(exec-&gt;vm());</span>
<span class="line-modified">340     auto* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
341     if (!client)
342         return JSValue::encode(jsUndefined());
343 
<span class="line-modified">344     auto label = valueOrDefaultLabelString(exec);</span>
345     RETURN_IF_EXCEPTION(scope, encodedJSValue());
346 
<span class="line-modified">347     client-&gt;timeLog(exec, label, Inspector::createScriptArguments(exec, 1));</span>
348     return JSValue::encode(jsUndefined());
349 }
350 
<span class="line-modified">351 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeEnd(ExecState* exec)</span>
352 {
<span class="line-modified">353     auto scope = DECLARE_THROW_SCOPE(exec-&gt;vm());</span>
<span class="line-modified">354     auto* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
355     if (!client)
356         return JSValue::encode(jsUndefined());
357 
<span class="line-modified">358     auto label = valueOrDefaultLabelString(exec);</span>
359     RETURN_IF_EXCEPTION(scope, encodedJSValue());
360 
<span class="line-modified">361     client-&gt;timeEnd(exec, label);</span>
362     return JSValue::encode(jsUndefined());
363 }
364 
<span class="line-modified">365 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeStamp(ExecState* exec)</span>
366 {
<span class="line-modified">367     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
368     if (!client)
369         return JSValue::encode(jsUndefined());
370 
<span class="line-modified">371     client-&gt;timeStamp(exec, Inspector::createScriptArguments(exec, 0));</span>
372     return JSValue::encode(jsUndefined());
373 }
374 
<span class="line-modified">375 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroup(ExecState* exec)</span>
376 {
<span class="line-modified">377     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
378     if (!client)
379         return JSValue::encode(jsUndefined());
380 
<span class="line-modified">381     client-&gt;group(exec, Inspector::createScriptArguments(exec, 0));</span>
382     return JSValue::encode(jsUndefined());
383 }
384 
<span class="line-modified">385 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupCollapsed(ExecState* exec)</span>
386 {
<span class="line-modified">387     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
388     if (!client)
389         return JSValue::encode(jsUndefined());
390 
<span class="line-modified">391     client-&gt;groupCollapsed(exec, Inspector::createScriptArguments(exec, 0));</span>
392     return JSValue::encode(jsUndefined());
393 }
394 
<span class="line-modified">395 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupEnd(ExecState* exec)</span>
396 {
<span class="line-modified">397     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
398     if (!client)
399         return JSValue::encode(jsUndefined());
400 
<span class="line-modified">401     client-&gt;groupEnd(exec, Inspector::createScriptArguments(exec, 0));</span>
402     return JSValue::encode(jsUndefined());
403 }
404 
<span class="line-modified">405 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecord(ExecState* exec)</span>
406 {
<span class="line-modified">407     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
408     if (!client)
409         return JSValue::encode(jsUndefined());
410 
<span class="line-modified">411     client-&gt;record(exec, Inspector::createScriptArguments(exec, 0));</span>
412     return JSValue::encode(jsUndefined());
413 }
414 
<span class="line-modified">415 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecordEnd(ExecState* exec)</span>
416 {
<span class="line-modified">417     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
418     if (!client)
419         return JSValue::encode(jsUndefined());
420 
<span class="line-modified">421     client-&gt;recordEnd(exec, Inspector::createScriptArguments(exec, 0));</span>
422     return JSValue::encode(jsUndefined());
423 }
424 
<span class="line-modified">425 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncScreenshot(ExecState* exec)</span>
426 {
<span class="line-modified">427     ConsoleClient* client = exec-&gt;lexicalGlobalObject()-&gt;consoleClient();</span>
428     if (!client)
429         return JSValue::encode(jsUndefined());
430 
<span class="line-modified">431     client-&gt;screenshot(exec, Inspector::createScriptArguments(exec, 0));</span>
432     return JSValue::encode(jsUndefined());
433 }
434 
435 } // namespace JSC
</pre>
</td>
<td>
<hr />
<pre>
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #include &quot;config.h&quot;
 27 #include &quot;ConsoleObject.h&quot;
 28 
 29 #include &quot;ConsoleClient.h&quot;
 30 #include &quot;Error.h&quot;
 31 #include &quot;JSCInlines.h&quot;
 32 #include &quot;ScriptArguments.h&quot;
 33 #include &quot;ScriptCallStackFactory.h&quot;
 34 
 35 namespace JSC {
 36 
<span class="line-modified"> 37 static String valueOrDefaultLabelString(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
 38 {
<span class="line-modified"> 39     if (callFrame-&gt;argumentCount() &lt; 1)</span>
 40         return &quot;default&quot;_s;
 41 
<span class="line-modified"> 42     auto value = callFrame-&gt;argument(0);</span>
 43     if (value.isUndefined())
 44         return &quot;default&quot;_s;
 45 
<span class="line-modified"> 46     return value.toWTFString(globalObject);</span>
 47 }
 48 
 49 STATIC_ASSERT_IS_TRIVIALLY_DESTRUCTIBLE(ConsoleObject);
 50 
<span class="line-modified"> 51 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDebug(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 52 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncError(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 53 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncLog(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 54 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncInfo(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 55 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncWarn(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 56 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncClear(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 57 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDir(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 58 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDirXML(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 59 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTable(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 60 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTrace(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 61 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncAssert(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 62 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCount(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 63 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCountReset(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 64 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfile(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 65 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfileEnd(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 66 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTakeHeapSnapshot(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 67 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTime(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 68 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeLog(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 69 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeEnd(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 70 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeStamp(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 71 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroup(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 72 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupCollapsed(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 73 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupEnd(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 74 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecord(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 75 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecordEnd(JSGlobalObject*, CallFrame*);</span>
<span class="line-modified"> 76 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncScreenshot(JSGlobalObject*, CallFrame*);</span>
 77 
 78 const ClassInfo ConsoleObject::s_info = { &quot;Console&quot;, &amp;Base::s_info, nullptr, nullptr, CREATE_METHOD_TABLE(ConsoleObject) };
 79 
 80 ConsoleObject::ConsoleObject(VM&amp; vm, Structure* structure)
 81     : JSNonFinalObject(vm, structure)
 82 {
 83 }
 84 
 85 void ConsoleObject::finishCreation(VM&amp; vm, JSGlobalObject* globalObject)
 86 {
 87     Base::finishCreation(vm);
 88     ASSERT(inherits(vm, info()));
 89 
 90     // For legacy reasons, console properties are enumerable, writable, deleteable,
 91     // and all have a length of 0. This may change if Console is standardized.
 92 
 93     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;debug&quot;, consoleProtoFuncDebug, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
 94     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;error&quot;, consoleProtoFuncError, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
 95     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;log&quot;, consoleProtoFuncLog, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
 96     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;info&quot;, consoleProtoFuncInfo, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
</pre>
<hr />
<pre>
102     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;table&quot;, consoleProtoFuncTable, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
103     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;trace&quot;, consoleProtoFuncTrace, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
104     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;assert&quot;, consoleProtoFuncAssert, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
105     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;count, consoleProtoFuncCount, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
106     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;countReset&quot;, consoleProtoFuncCountReset, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
107     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;profile&quot;, consoleProtoFuncProfile, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
108     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;profileEnd&quot;, consoleProtoFuncProfileEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
109     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;time&quot;, consoleProtoFuncTime, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
110     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;timeLog&quot;, consoleProtoFuncTimeLog, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
111     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;timeEnd&quot;, consoleProtoFuncTimeEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
112     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;timeStamp&quot;, consoleProtoFuncTimeStamp, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
113     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;takeHeapSnapshot&quot;, consoleProtoFuncTakeHeapSnapshot, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
114     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;group&quot;, consoleProtoFuncGroup, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
115     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;groupCollapsed&quot;, consoleProtoFuncGroupCollapsed, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
116     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;groupEnd&quot;, consoleProtoFuncGroupEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
117     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;record&quot;, consoleProtoFuncRecord, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
118     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;recordEnd&quot;, consoleProtoFuncRecordEnd, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
119     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;screenshot&quot;, consoleProtoFuncScreenshot, static_cast&lt;unsigned&gt;(PropertyAttribute::None), 0);
120 }
121 
<span class="line-modified">122 static String valueToStringWithUndefinedOrNullCheck(JSGlobalObject* globalObject, JSValue value)</span>
123 {
124     if (value.isUndefinedOrNull())
125         return String();
<span class="line-modified">126     return value.toWTFString(globalObject);</span>
127 }
128 
<span class="line-modified">129 static EncodedJSValue consoleLogWithLevel(JSGlobalObject* globalObject, CallFrame* callFrame, MessageLevel level)</span>
130 {
<span class="line-modified">131     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
132     if (!client)
133         return JSValue::encode(jsUndefined());
134 
<span class="line-modified">135     client-&gt;logWithLevel(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0), level);</span>
136     return JSValue::encode(jsUndefined());
137 }
138 
<span class="line-modified">139 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDebug(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
140 {
<span class="line-modified">141     return consoleLogWithLevel(globalObject, callFrame, MessageLevel::Debug);</span>
142 }
143 
<span class="line-modified">144 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncError(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
145 {
<span class="line-modified">146     return consoleLogWithLevel(globalObject, callFrame, MessageLevel::Error);</span>
147 }
148 
<span class="line-modified">149 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncLog(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
150 {
<span class="line-modified">151     return consoleLogWithLevel(globalObject, callFrame, MessageLevel::Log);</span>
152 }
153 
<span class="line-modified">154 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncInfo(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
155 {
<span class="line-modified">156     return consoleLogWithLevel(globalObject, callFrame, MessageLevel::Info);</span>
157 }
158 
<span class="line-modified">159 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncWarn(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
160 {
<span class="line-modified">161     return consoleLogWithLevel(globalObject, callFrame, MessageLevel::Warning);</span>
162 }
163 
<span class="line-modified">164 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncClear(JSGlobalObject* globalObject, CallFrame*)</span>
165 {
<span class="line-modified">166     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
167     if (!client)
168         return JSValue::encode(jsUndefined());
169 
<span class="line-modified">170     client-&gt;clear(globalObject);</span>
171     return JSValue::encode(jsUndefined());
172 }
173 
<span class="line-modified">174 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDir(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
175 {
<span class="line-modified">176     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
177     if (!client)
178         return JSValue::encode(jsUndefined());
179 
<span class="line-modified">180     client-&gt;dir(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
181     return JSValue::encode(jsUndefined());
182 }
183 
<span class="line-modified">184 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncDirXML(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
185 {
<span class="line-modified">186     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
187     if (!client)
188         return JSValue::encode(jsUndefined());
189 
<span class="line-modified">190     client-&gt;dirXML(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
191     return JSValue::encode(jsUndefined());
192 }
193 
<span class="line-modified">194 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTable(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
195 {
<span class="line-modified">196     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
197     if (!client)
198         return JSValue::encode(jsUndefined());
199 
<span class="line-modified">200     client-&gt;table(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
201     return JSValue::encode(jsUndefined());
202 }
203 
<span class="line-modified">204 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTrace(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
205 {
<span class="line-modified">206     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
207     if (!client)
208         return JSValue::encode(jsUndefined());
209 
<span class="line-modified">210     client-&gt;trace(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
211     return JSValue::encode(jsUndefined());
212 }
213 
<span class="line-modified">214 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncAssert(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
215 {
<span class="line-modified">216     VM&amp; vm = globalObject-&gt;vm();</span>
217     auto scope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">218     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
219     if (!client)
220         return JSValue::encode(jsUndefined());
221 
<span class="line-modified">222     bool condition = callFrame-&gt;argument(0).toBoolean(globalObject);</span>
223     RETURN_IF_EXCEPTION(scope, encodedJSValue());
224 
225     if (condition)
226         return JSValue::encode(jsUndefined());
227 
<span class="line-modified">228     client-&gt;assertion(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 1));</span>
229     return JSValue::encode(jsUndefined());
230 }
231 
<span class="line-modified">232 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCount(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
233 {
<span class="line-modified">234     auto scope = DECLARE_THROW_SCOPE(globalObject-&gt;vm());</span>
<span class="line-modified">235     auto* client = globalObject-&gt;consoleClient();</span>
236     if (!client)
237         return JSValue::encode(jsUndefined());
238 
<span class="line-modified">239     auto label = valueOrDefaultLabelString(globalObject, callFrame);</span>
240     RETURN_IF_EXCEPTION(scope, encodedJSValue());
241 
<span class="line-modified">242     client-&gt;count(globalObject, label);</span>
243     return JSValue::encode(jsUndefined());
244 }
245 
<span class="line-modified">246 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncCountReset(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
247 {
<span class="line-modified">248     auto scope = DECLARE_THROW_SCOPE(globalObject-&gt;vm());</span>
<span class="line-modified">249     auto* client = globalObject-&gt;consoleClient();</span>
250     if (!client)
251         return JSValue::encode(jsUndefined());
252 
<span class="line-modified">253     auto label = valueOrDefaultLabelString(globalObject, callFrame);</span>
254     RETURN_IF_EXCEPTION(scope, encodedJSValue());
255 
<span class="line-modified">256     client-&gt;countReset(globalObject, label);</span>
257     return JSValue::encode(jsUndefined());
258 }
259 
<span class="line-modified">260 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfile(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
261 {
<span class="line-modified">262     VM&amp; vm = globalObject-&gt;vm();</span>
263     auto scope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">264     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
265     if (!client)
266         return JSValue::encode(jsUndefined());
267 
<span class="line-modified">268     size_t argsCount = callFrame-&gt;argumentCount();</span>
269     if (!argsCount) {
<span class="line-modified">270         client-&gt;profile(globalObject, String());</span>
271         return JSValue::encode(jsUndefined());
272     }
273 
<span class="line-modified">274     const String&amp; title(valueToStringWithUndefinedOrNullCheck(globalObject, callFrame-&gt;argument(0)));</span>
275     RETURN_IF_EXCEPTION(scope, encodedJSValue());
276 
<span class="line-modified">277     client-&gt;profile(globalObject, title);</span>
278     return JSValue::encode(jsUndefined());
279 }
280 
<span class="line-modified">281 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncProfileEnd(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
282 {
<span class="line-modified">283     VM&amp; vm = globalObject-&gt;vm();</span>
284     auto scope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">285     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
286     if (!client)
287         return JSValue::encode(jsUndefined());
288 
<span class="line-modified">289     size_t argsCount = callFrame-&gt;argumentCount();</span>
290     if (!argsCount) {
<span class="line-modified">291         client-&gt;profileEnd(globalObject, String());</span>
292         return JSValue::encode(jsUndefined());
293     }
294 
<span class="line-modified">295     const String&amp; title(valueToStringWithUndefinedOrNullCheck(globalObject, callFrame-&gt;argument(0)));</span>
296     RETURN_IF_EXCEPTION(scope, encodedJSValue());
297 
<span class="line-modified">298     client-&gt;profileEnd(globalObject, title);</span>
299     return JSValue::encode(jsUndefined());
300 }
301 
<span class="line-modified">302 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTakeHeapSnapshot(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
303 {
<span class="line-modified">304     VM&amp; vm = globalObject-&gt;vm();</span>
305     auto scope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">306     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
307     if (!client)
308         return JSValue::encode(jsUndefined());
309 
<span class="line-modified">310     size_t argsCount = callFrame-&gt;argumentCount();</span>
311     if (!argsCount) {
<span class="line-modified">312         client-&gt;takeHeapSnapshot(globalObject, String());</span>
313         return JSValue::encode(jsUndefined());
314     }
315 
<span class="line-modified">316     const String&amp; title(valueToStringWithUndefinedOrNullCheck(globalObject, callFrame-&gt;argument(0)));</span>
317     RETURN_IF_EXCEPTION(scope, encodedJSValue());
318 
<span class="line-modified">319     client-&gt;takeHeapSnapshot(globalObject, title);</span>
320     return JSValue::encode(jsUndefined());
321 }
322 
<span class="line-modified">323 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTime(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
324 {
<span class="line-modified">325     auto scope = DECLARE_THROW_SCOPE(globalObject-&gt;vm());</span>
<span class="line-modified">326     auto* client = globalObject-&gt;consoleClient();</span>
327     if (!client)
328         return JSValue::encode(jsUndefined());
329 
<span class="line-modified">330     auto label = valueOrDefaultLabelString(globalObject, callFrame);</span>
331     RETURN_IF_EXCEPTION(scope, encodedJSValue());
332 
<span class="line-modified">333     client-&gt;time(globalObject, label);</span>
334     return JSValue::encode(jsUndefined());
335 }
336 
<span class="line-modified">337 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeLog(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
338 {
<span class="line-modified">339     auto scope = DECLARE_THROW_SCOPE(globalObject-&gt;vm());</span>
<span class="line-modified">340     auto* client = globalObject-&gt;consoleClient();</span>
341     if (!client)
342         return JSValue::encode(jsUndefined());
343 
<span class="line-modified">344     auto label = valueOrDefaultLabelString(globalObject, callFrame);</span>
345     RETURN_IF_EXCEPTION(scope, encodedJSValue());
346 
<span class="line-modified">347     client-&gt;timeLog(globalObject, label, Inspector::createScriptArguments(globalObject, callFrame, 1));</span>
348     return JSValue::encode(jsUndefined());
349 }
350 
<span class="line-modified">351 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeEnd(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
352 {
<span class="line-modified">353     auto scope = DECLARE_THROW_SCOPE(globalObject-&gt;vm());</span>
<span class="line-modified">354     auto* client = globalObject-&gt;consoleClient();</span>
355     if (!client)
356         return JSValue::encode(jsUndefined());
357 
<span class="line-modified">358     auto label = valueOrDefaultLabelString(globalObject, callFrame);</span>
359     RETURN_IF_EXCEPTION(scope, encodedJSValue());
360 
<span class="line-modified">361     client-&gt;timeEnd(globalObject, label);</span>
362     return JSValue::encode(jsUndefined());
363 }
364 
<span class="line-modified">365 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncTimeStamp(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
366 {
<span class="line-modified">367     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
368     if (!client)
369         return JSValue::encode(jsUndefined());
370 
<span class="line-modified">371     client-&gt;timeStamp(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
372     return JSValue::encode(jsUndefined());
373 }
374 
<span class="line-modified">375 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroup(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
376 {
<span class="line-modified">377     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
378     if (!client)
379         return JSValue::encode(jsUndefined());
380 
<span class="line-modified">381     client-&gt;group(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
382     return JSValue::encode(jsUndefined());
383 }
384 
<span class="line-modified">385 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupCollapsed(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
386 {
<span class="line-modified">387     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
388     if (!client)
389         return JSValue::encode(jsUndefined());
390 
<span class="line-modified">391     client-&gt;groupCollapsed(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
392     return JSValue::encode(jsUndefined());
393 }
394 
<span class="line-modified">395 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncGroupEnd(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
396 {
<span class="line-modified">397     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
398     if (!client)
399         return JSValue::encode(jsUndefined());
400 
<span class="line-modified">401     client-&gt;groupEnd(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
402     return JSValue::encode(jsUndefined());
403 }
404 
<span class="line-modified">405 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecord(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
406 {
<span class="line-modified">407     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
408     if (!client)
409         return JSValue::encode(jsUndefined());
410 
<span class="line-modified">411     client-&gt;record(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
412     return JSValue::encode(jsUndefined());
413 }
414 
<span class="line-modified">415 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncRecordEnd(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
416 {
<span class="line-modified">417     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
418     if (!client)
419         return JSValue::encode(jsUndefined());
420 
<span class="line-modified">421     client-&gt;recordEnd(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
422     return JSValue::encode(jsUndefined());
423 }
424 
<span class="line-modified">425 static EncodedJSValue JSC_HOST_CALL consoleProtoFuncScreenshot(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
426 {
<span class="line-modified">427     ConsoleClient* client = globalObject-&gt;consoleClient();</span>
428     if (!client)
429         return JSValue::encode(jsUndefined());
430 
<span class="line-modified">431     client-&gt;screenshot(globalObject, Inspector::createScriptArguments(globalObject, callFrame, 0));</span>
432     return JSValue::encode(jsUndefined());
433 }
434 
435 } // namespace JSC
</pre>
</td>
</tr>
</table>
<center><a href="ConsoleClient.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ConstructAbility.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>