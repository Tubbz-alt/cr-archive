<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/platform/mock/mediasource/MockSourceBufferPrivate.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MockMediaSourcePrivate.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../network/BlobRegistry.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/platform/mock/mediasource/MockSourceBufferPrivate.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
203 
204     m_client-&gt;sourceBufferPrivateDidReceiveSample(MockMediaSample::create(sampleBox));
205 }
206 
207 void MockSourceBufferPrivate::abort()
208 {
209 }
210 
211 void MockSourceBufferPrivate::resetParserState()
212 {
213 }
214 
215 void MockSourceBufferPrivate::removedFromMediaSource()
216 {
217     if (m_mediaSource)
218         m_mediaSource-&gt;removeSourceBuffer(this);
219 }
220 
221 MediaPlayer::ReadyState MockSourceBufferPrivate::readyState() const
222 {
<span class="line-modified">223     return m_mediaSource ? m_mediaSource-&gt;player().readyState() : MediaPlayer::HaveNothing;</span>
224 }
225 
226 void MockSourceBufferPrivate::setReadyState(MediaPlayer::ReadyState readyState)
227 {
228     if (m_mediaSource)
229         m_mediaSource-&gt;player().setReadyState(readyState);
230 }
231 
232 void MockSourceBufferPrivate::setActive(bool isActive)
233 {
234     if (m_mediaSource)
235         m_mediaSource-&gt;sourceBufferPrivateDidChangeActiveState(this, isActive);
236 }
237 
238 Vector&lt;String&gt; MockSourceBufferPrivate::enqueuedSamplesForTrackID(const AtomString&amp;)
239 {
240     return m_enqueuedSamples;
241 }
242 
243 MediaTime MockSourceBufferPrivate::minimumUpcomingPresentationTimeForTrackID(const AtomString&amp;)
</pre>
<hr />
<pre>
253 bool MockSourceBufferPrivate::canSetMinimumUpcomingPresentationTime(const AtomString&amp;) const
254 {
255     return true;
256 }
257 
258 void MockSourceBufferPrivate::setMinimumUpcomingPresentationTime(const AtomString&amp;, const MediaTime&amp; presentationTime)
259 {
260     m_minimumUpcomingPresentationTime = presentationTime;
261 }
262 
263 void MockSourceBufferPrivate::clearMinimumUpcomingPresentationTime(const AtomString&amp;)
264 {
265     m_minimumUpcomingPresentationTime = MediaTime::invalidTime();
266 }
267 
268 bool MockSourceBufferPrivate::canSwitchToType(const ContentType&amp; contentType)
269 {
270     MediaEngineSupportParameters parameters;
271     parameters.isMediaSource = true;
272     parameters.type = contentType;
<span class="line-modified">273     return MockMediaPlayerMediaSource::supportsType(parameters) != MediaPlayer::IsNotSupported;</span>
274 }
275 
276 void MockSourceBufferPrivate::enqueueSample(Ref&lt;MediaSample&gt;&amp;&amp; sample, const AtomString&amp;)
277 {
278     if (!m_mediaSource)
279         return;
280 
281     PlatformSample platformSample = sample-&gt;platformSample();
282     if (platformSample.type != PlatformSample::MockSampleBoxType)
283         return;
284 
285     auto* box = platformSample.sample.mockSampleBox;
286     if (!box)
287         return;
288 
289     m_mediaSource-&gt;incrementTotalVideoFrames();
290     if (box-&gt;isCorrupted())
291         m_mediaSource-&gt;incrementCorruptedFrames();
292     if (box-&gt;isDropped())
293         m_mediaSource-&gt;incrementDroppedFrames();
</pre>
</td>
<td>
<hr />
<pre>
203 
204     m_client-&gt;sourceBufferPrivateDidReceiveSample(MockMediaSample::create(sampleBox));
205 }
206 
207 void MockSourceBufferPrivate::abort()
208 {
209 }
210 
211 void MockSourceBufferPrivate::resetParserState()
212 {
213 }
214 
215 void MockSourceBufferPrivate::removedFromMediaSource()
216 {
217     if (m_mediaSource)
218         m_mediaSource-&gt;removeSourceBuffer(this);
219 }
220 
221 MediaPlayer::ReadyState MockSourceBufferPrivate::readyState() const
222 {
<span class="line-modified">223     return m_mediaSource ? m_mediaSource-&gt;player().readyState() : MediaPlayer::ReadyState::HaveNothing;</span>
224 }
225 
226 void MockSourceBufferPrivate::setReadyState(MediaPlayer::ReadyState readyState)
227 {
228     if (m_mediaSource)
229         m_mediaSource-&gt;player().setReadyState(readyState);
230 }
231 
232 void MockSourceBufferPrivate::setActive(bool isActive)
233 {
234     if (m_mediaSource)
235         m_mediaSource-&gt;sourceBufferPrivateDidChangeActiveState(this, isActive);
236 }
237 
238 Vector&lt;String&gt; MockSourceBufferPrivate::enqueuedSamplesForTrackID(const AtomString&amp;)
239 {
240     return m_enqueuedSamples;
241 }
242 
243 MediaTime MockSourceBufferPrivate::minimumUpcomingPresentationTimeForTrackID(const AtomString&amp;)
</pre>
<hr />
<pre>
253 bool MockSourceBufferPrivate::canSetMinimumUpcomingPresentationTime(const AtomString&amp;) const
254 {
255     return true;
256 }
257 
258 void MockSourceBufferPrivate::setMinimumUpcomingPresentationTime(const AtomString&amp;, const MediaTime&amp; presentationTime)
259 {
260     m_minimumUpcomingPresentationTime = presentationTime;
261 }
262 
263 void MockSourceBufferPrivate::clearMinimumUpcomingPresentationTime(const AtomString&amp;)
264 {
265     m_minimumUpcomingPresentationTime = MediaTime::invalidTime();
266 }
267 
268 bool MockSourceBufferPrivate::canSwitchToType(const ContentType&amp; contentType)
269 {
270     MediaEngineSupportParameters parameters;
271     parameters.isMediaSource = true;
272     parameters.type = contentType;
<span class="line-modified">273     return MockMediaPlayerMediaSource::supportsType(parameters) != MediaPlayer::SupportsType::IsNotSupported;</span>
274 }
275 
276 void MockSourceBufferPrivate::enqueueSample(Ref&lt;MediaSample&gt;&amp;&amp; sample, const AtomString&amp;)
277 {
278     if (!m_mediaSource)
279         return;
280 
281     PlatformSample platformSample = sample-&gt;platformSample();
282     if (platformSample.type != PlatformSample::MockSampleBoxType)
283         return;
284 
285     auto* box = platformSample.sample.mockSampleBox;
286     if (!box)
287         return;
288 
289     m_mediaSource-&gt;incrementTotalVideoFrames();
290     if (box-&gt;isCorrupted())
291         m_mediaSource-&gt;incrementCorruptedFrames();
292     if (box-&gt;isDropped())
293         m_mediaSource-&gt;incrementDroppedFrames();
</pre>
</td>
</tr>
</table>
<center><a href="MockMediaSourcePrivate.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../network/BlobRegistry.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>