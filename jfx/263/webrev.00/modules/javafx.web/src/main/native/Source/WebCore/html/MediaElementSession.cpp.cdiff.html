<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/html/MediaElementSession.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MediaDocument.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MediaElementSession.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/html/MediaElementSession.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 310,11 ***</span>
  }
  
  bool MediaElementSession::autoplayPermitted() const
  {
      const Document&amp; document = m_element.document();
<span class="line-modified">!     if (document.pageCacheState() != Document::NotInPageCache)</span>
          return false;
      if (document.activeDOMObjectsAreSuspended())
          return false;
  
      if (!hasBehaviorRestriction(MediaElementSession::InvisibleAutoplayNotPermitted))
<span class="line-new-header">--- 310,11 ---</span>
  }
  
  bool MediaElementSession::autoplayPermitted() const
  {
      const Document&amp; document = m_element.document();
<span class="line-modified">!     if (document.backForwardCacheState() != Document::NotInBackForwardCache)</span>
          return false;
      if (document.activeDOMObjectsAreSuspended())
          return false;
  
      if (!hasBehaviorRestriction(MediaElementSession::InvisibleAutoplayNotPermitted))
</pre>
<hr />
<pre>
<span class="line-old-header">*** 434,11 ***</span>
      if (m_element.document().isMediaDocument() &amp;&amp; (m_element.document().frame() &amp;&amp; m_element.document().frame()-&gt;isMainFrame())) {
          INFO_LOG(LOGIDENTIFIER, &quot;returning TRUE: is media document&quot;);
          return true;
      }
  
<span class="line-modified">!     if (client().presentationType() == Audio) {</span>
          if (!hasBehaviorRestriction(RequireUserGestureToControlControlsManager) || m_element.document().processingUserGestureForMedia()) {
              INFO_LOG(LOGIDENTIFIER, &quot;returning TRUE: audio element with user gesture&quot;);
              return true;
          }
  
<span class="line-new-header">--- 434,11 ---</span>
      if (m_element.document().isMediaDocument() &amp;&amp; (m_element.document().frame() &amp;&amp; m_element.document().frame()-&gt;isMainFrame())) {
          INFO_LOG(LOGIDENTIFIER, &quot;returning TRUE: is media document&quot;);
          return true;
      }
  
<span class="line-modified">!     if (client().presentationType() == Audio &amp;&amp; purpose == PlaybackControlsPurpose::ControlsManager) {</span>
          if (!hasBehaviorRestriction(RequireUserGestureToControlControlsManager) || m_element.document().processingUserGestureForMedia()) {
              INFO_LOG(LOGIDENTIFIER, &quot;returning TRUE: audio element with user gesture&quot;);
              return true;
          }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 598,10 ***</span>
<span class="line-new-header">--- 598,15 ---</span>
          INFO_LOG(LOGIDENTIFIER, &quot;returning FALSE because of legacy attribute&quot;);
          return false;
      }
  #endif
  
<span class="line-added">+     if (m_element.document().settings().remotePlaybackEnabled() &amp;&amp; m_element.hasAttributeWithoutSynchronization(HTMLNames::disableremoteplaybackAttr)) {</span>
<span class="line-added">+         LOG(Media, &quot;MediaElementSession::wirelessVideoPlaybackDisabled - returning TRUE because of RemotePlayback attribute&quot;);</span>
<span class="line-added">+         return true;</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
      auto player = m_element.player();
      if (!player)
          return true;
  
      bool disabled = player-&gt;wirelessVideoPlaybackDisabled();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 676,10 ***</span>
<span class="line-new-header">--- 681,16 ---</span>
      m_shouldPlayToPlaybackTarget = shouldPlay;
      updateClientDataBuffering();
      client().setShouldPlayToPlaybackTarget(shouldPlay);
  }
  
<span class="line-added">+ void MediaElementSession::playbackTargetPickerWasDismissed()</span>
<span class="line-added">+ {</span>
<span class="line-added">+     INFO_LOG(LOGIDENTIFIER);</span>
<span class="line-added">+     client().playbackTargetPickerWasDismissed();</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  void MediaElementSession::mediaStateDidChange(MediaProducer::MediaStateFlags state)
  {
      m_element.document().playbackTargetPickerClientStateDidChange(*this, state);
  }
  #endif
</pre>
<hr />
<pre>
<span class="line-old-header">*** 690,12 ***</span>
  
      if (pageExplicitlyAllowsElementToAutoplayInline(m_element))
          return preload;
  
      if (m_restrictions &amp; AutoPreloadingNotPermitted) {
<span class="line-modified">!         if (preload &gt; MediaPlayer::MetaData)</span>
<span class="line-modified">!             return MediaPlayer::MetaData;</span>
      }
  
      return preload;
  }
  
<span class="line-new-header">--- 701,12 ---</span>
  
      if (pageExplicitlyAllowsElementToAutoplayInline(m_element))
          return preload;
  
      if (m_restrictions &amp; AutoPreloadingNotPermitted) {
<span class="line-modified">!         if (preload &gt; MediaPlayer::Preload::MetaData)</span>
<span class="line-modified">!             return MediaPlayer::Preload::MetaData;</span>
      }
  
      return preload;
  }
  
</pre>
<center><a href="MediaDocument.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MediaElementSession.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>