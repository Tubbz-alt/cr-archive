<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/loader/appcache/ApplicationCacheHost.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ApplicationCacheHost.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="ApplicationCacheResource.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/loader/appcache/ApplicationCacheHost.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 73     };
 74 
 75     struct ResourceInfo {
 76         URL resource;
 77         bool isMaster;
 78         bool isManifest;
 79         bool isFallback;
 80         bool isForeign;
 81         bool isExplicit;
 82         long long size;
 83     };
 84 
 85     explicit ApplicationCacheHost(DocumentLoader&amp;);
 86     ~ApplicationCacheHost();
 87 
 88     static URL createFileURL(const String&amp;);
 89 
 90     void selectCacheWithoutManifest();
 91     void selectCacheWithManifest(const URL&amp; manifestURL);
 92 


 93     void maybeLoadMainResource(const ResourceRequest&amp;, SubstituteData&amp;);
 94     void maybeLoadMainResourceForRedirect(const ResourceRequest&amp;, SubstituteData&amp;);
 95     bool maybeLoadFallbackForMainResponse(const ResourceRequest&amp;, const ResourceResponse&amp;);
 96     void mainResourceDataReceived(const char* data, int length, long long encodedDataLength, bool allAtOnce);
 97     void finishedLoadingMainResource();
 98     void failedLoadingMainResource();
 99 
100     WEBCORE_EXPORT bool maybeLoadResource(ResourceLoader&amp;, const ResourceRequest&amp;, const URL&amp; originalURL);
101     WEBCORE_EXPORT bool maybeLoadFallbackForRedirect(ResourceLoader*, ResourceRequest&amp;, const ResourceResponse&amp;);
102     WEBCORE_EXPORT bool maybeLoadFallbackForResponse(ResourceLoader*, const ResourceResponse&amp;);
103     WEBCORE_EXPORT bool maybeLoadFallbackForError(ResourceLoader*, const ResourceError&amp;);
104 
105     bool maybeLoadSynchronously(ResourceRequest&amp;, ResourceError&amp;, ResourceResponse&amp;, RefPtr&lt;SharedBuffer&gt;&amp;);
106     void maybeLoadFallbackSynchronously(const ResourceRequest&amp;, ResourceError&amp;, ResourceResponse&amp;, RefPtr&lt;SharedBuffer&gt;&amp;);
107 
<span class="line-modified">108     bool canCacheInPageCache();</span>
109 
110     Status status() const;
111     bool update();
112     bool swapCache();
113     void abort();
114 
115     void setDOMApplicationCache(DOMApplicationCache*);
116     void notifyDOMApplicationCache(const AtomString&amp; eventType, int progressTotal, int progressDone);
117 
118     void stopLoadingInFrame(Frame&amp;);
119 
120     void stopDeferringEvents(); // Also raises the events that have been queued up.
121 
122     Vector&lt;ResourceInfo&gt; resourceList();
123     CacheInfo applicationCacheInfo();
124 
125     bool shouldLoadResourceFromApplicationCache(const ResourceRequest&amp;, ApplicationCacheResource*&amp;);
126     bool getApplicationCacheFallbackResource(const ResourceRequest&amp;, ApplicationCacheResource*&amp;, ApplicationCache* = nullptr);
127 
128 private:
129     friend class ApplicationCacheGroup;
130 
131     struct DeferredEvent {
132         AtomString eventType;
133         int progressTotal;
134         int progressDone;
135     };
136 
137     bool isApplicationCacheEnabled();
138     bool isApplicationCacheBlockedForRequest(const ResourceRequest&amp;);
139 
140     void dispatchDOMEvent(const AtomString&amp; eventType, int progressTotal, int progressDone);
141 
142     bool scheduleLoadFallbackResourceFromApplicationCache(ResourceLoader*, ApplicationCache* = nullptr);
143     void setCandidateApplicationCacheGroup(ApplicationCacheGroup*);
<span class="line-modified">144     ApplicationCacheGroup* candidateApplicationCacheGroup() const { return m_candidateApplicationCacheGroup; }</span>
145     void setApplicationCache(RefPtr&lt;ApplicationCache&gt;&amp;&amp;);
146     ApplicationCache* applicationCache() const { return m_applicationCache.get(); }
147     ApplicationCache* mainResourceApplicationCache() const { return m_mainResourceApplicationCache.get(); }
148     bool maybeLoadFallbackForMainError(const ResourceRequest&amp;, const ResourceError&amp;);
149 
150     WeakPtr&lt;DOMApplicationCache&gt; m_domApplicationCache;
151     DocumentLoader&amp; m_documentLoader;
152 
153     bool m_defersEvents { true }; // Events are deferred until after document onload.
154     Vector&lt;DeferredEvent&gt; m_deferredEvents;
155 
156     // The application cache that the document loader is associated with (if any).
157     RefPtr&lt;ApplicationCache&gt; m_applicationCache;
158 
159     // Before an application cache has finished loading, this will be the candidate application
160     // group that the document loader is associated with.
<span class="line-modified">161     ApplicationCacheGroup* m_candidateApplicationCacheGroup { nullptr };</span>
162 
163     // This is the application cache the main resource was loaded from (if any).
164     RefPtr&lt;ApplicationCache&gt; m_mainResourceApplicationCache;
165 };
166 
167 }  // namespace WebCore
</pre>
</td>
<td>
<hr />
<pre>
 73     };
 74 
 75     struct ResourceInfo {
 76         URL resource;
 77         bool isMaster;
 78         bool isManifest;
 79         bool isFallback;
 80         bool isForeign;
 81         bool isExplicit;
 82         long long size;
 83     };
 84 
 85     explicit ApplicationCacheHost(DocumentLoader&amp;);
 86     ~ApplicationCacheHost();
 87 
 88     static URL createFileURL(const String&amp;);
 89 
 90     void selectCacheWithoutManifest();
 91     void selectCacheWithManifest(const URL&amp; manifestURL);
 92 
<span class="line-added"> 93     bool canLoadMainResource(const ResourceRequest&amp;);</span>
<span class="line-added"> 94 </span>
 95     void maybeLoadMainResource(const ResourceRequest&amp;, SubstituteData&amp;);
 96     void maybeLoadMainResourceForRedirect(const ResourceRequest&amp;, SubstituteData&amp;);
 97     bool maybeLoadFallbackForMainResponse(const ResourceRequest&amp;, const ResourceResponse&amp;);
 98     void mainResourceDataReceived(const char* data, int length, long long encodedDataLength, bool allAtOnce);
 99     void finishedLoadingMainResource();
100     void failedLoadingMainResource();
101 
102     WEBCORE_EXPORT bool maybeLoadResource(ResourceLoader&amp;, const ResourceRequest&amp;, const URL&amp; originalURL);
103     WEBCORE_EXPORT bool maybeLoadFallbackForRedirect(ResourceLoader*, ResourceRequest&amp;, const ResourceResponse&amp;);
104     WEBCORE_EXPORT bool maybeLoadFallbackForResponse(ResourceLoader*, const ResourceResponse&amp;);
105     WEBCORE_EXPORT bool maybeLoadFallbackForError(ResourceLoader*, const ResourceError&amp;);
106 
107     bool maybeLoadSynchronously(ResourceRequest&amp;, ResourceError&amp;, ResourceResponse&amp;, RefPtr&lt;SharedBuffer&gt;&amp;);
108     void maybeLoadFallbackSynchronously(const ResourceRequest&amp;, ResourceError&amp;, ResourceResponse&amp;, RefPtr&lt;SharedBuffer&gt;&amp;);
109 
<span class="line-modified">110     bool canCacheInBackForwardCache();</span>
111 
112     Status status() const;
113     bool update();
114     bool swapCache();
115     void abort();
116 
117     void setDOMApplicationCache(DOMApplicationCache*);
118     void notifyDOMApplicationCache(const AtomString&amp; eventType, int progressTotal, int progressDone);
119 
120     void stopLoadingInFrame(Frame&amp;);
121 
122     void stopDeferringEvents(); // Also raises the events that have been queued up.
123 
124     Vector&lt;ResourceInfo&gt; resourceList();
125     CacheInfo applicationCacheInfo();
126 
127     bool shouldLoadResourceFromApplicationCache(const ResourceRequest&amp;, ApplicationCacheResource*&amp;);
128     bool getApplicationCacheFallbackResource(const ResourceRequest&amp;, ApplicationCacheResource*&amp;, ApplicationCache* = nullptr);
129 
130 private:
131     friend class ApplicationCacheGroup;
132 
133     struct DeferredEvent {
134         AtomString eventType;
135         int progressTotal;
136         int progressDone;
137     };
138 
139     bool isApplicationCacheEnabled();
140     bool isApplicationCacheBlockedForRequest(const ResourceRequest&amp;);
141 
142     void dispatchDOMEvent(const AtomString&amp; eventType, int progressTotal, int progressDone);
143 
144     bool scheduleLoadFallbackResourceFromApplicationCache(ResourceLoader*, ApplicationCache* = nullptr);
145     void setCandidateApplicationCacheGroup(ApplicationCacheGroup*);
<span class="line-modified">146     ApplicationCacheGroup* candidateApplicationCacheGroup() const;</span>
147     void setApplicationCache(RefPtr&lt;ApplicationCache&gt;&amp;&amp;);
148     ApplicationCache* applicationCache() const { return m_applicationCache.get(); }
149     ApplicationCache* mainResourceApplicationCache() const { return m_mainResourceApplicationCache.get(); }
150     bool maybeLoadFallbackForMainError(const ResourceRequest&amp;, const ResourceError&amp;);
151 
152     WeakPtr&lt;DOMApplicationCache&gt; m_domApplicationCache;
153     DocumentLoader&amp; m_documentLoader;
154 
155     bool m_defersEvents { true }; // Events are deferred until after document onload.
156     Vector&lt;DeferredEvent&gt; m_deferredEvents;
157 
158     // The application cache that the document loader is associated with (if any).
159     RefPtr&lt;ApplicationCache&gt; m_applicationCache;
160 
161     // Before an application cache has finished loading, this will be the candidate application
162     // group that the document loader is associated with.
<span class="line-modified">163     WeakPtr&lt;ApplicationCacheGroup&gt; m_candidateApplicationCacheGroup;</span>
164 
165     // This is the application cache the main resource was loaded from (if any).
166     RefPtr&lt;ApplicationCache&gt; m_mainResourceApplicationCache;
167 };
168 
169 }  // namespace WebCore
</pre>
</td>
</tr>
</table>
<center><a href="ApplicationCacheHost.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="ApplicationCacheResource.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>