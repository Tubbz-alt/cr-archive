diff a/modules/javafx.web/src/main/native/Source/WebCore/dom/messageports/MessagePortChannelProvider.cpp b/modules/javafx.web/src/main/native/Source/WebCore/dom/messageports/MessagePortChannelProvider.cpp
--- a/modules/javafx.web/src/main/native/Source/WebCore/dom/messageports/MessagePortChannelProvider.cpp
+++ b/modules/javafx.web/src/main/native/Source/WebCore/dom/messageports/MessagePortChannelProvider.cpp
@@ -24,19 +24,22 @@
  */
 
 #include "config.h"
 #include "MessagePortChannelProvider.h"
 
+#include "Document.h"
 #include "MessagePortChannelProviderImpl.h"
+#include "WorkerGlobalScope.h"
 #include <wtf/MainThread.h>
 
 namespace WebCore {
 
 static MessagePortChannelProvider* globalProvider;
 
 MessagePortChannelProvider& MessagePortChannelProvider::singleton()
 {
+    ASSERT(isMainThread());
     static std::once_flag onceFlag;
     std::call_once(onceFlag, [] {
         if (!globalProvider)
             globalProvider = new MessagePortChannelProviderImpl;
     });
@@ -49,6 +52,14 @@
     RELEASE_ASSERT(isMainThread());
     RELEASE_ASSERT(!globalProvider);
     globalProvider = &provider;
 }
 
+MessagePortChannelProvider& MessagePortChannelProvider::fromContext(ScriptExecutionContext& context)
+{
+    if (is<Document>(context))
+        return downcast<Document>(context).messagePortChannelProvider();
+
+    return downcast<WorkerGlobalScope>(context).messagePortChannelProvider();
+}
+
 } // namespace WebCore
