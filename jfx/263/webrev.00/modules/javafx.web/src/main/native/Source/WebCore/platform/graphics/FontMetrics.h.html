<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/FontMetrics.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) Research In Motion Limited 2010-2011. All rights reserved.
  3  *
  4  * This library is free software; you can redistribute it and/or
  5  * modify it under the terms of the GNU Library General Public
  6  * License as published by the Free Software Foundation; either
  7  * version 2 of the License, or (at your option) any later version.
  8  *
  9  * This library is distributed in the hope that it will be useful,
 10  * but WITHOUT ANY WARRANTY; without even the implied warranty of
 11  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 12  * Library General Public License for more details.
 13  *
 14  * You should have received a copy of the GNU Library General Public License
 15  * along with this library; see the file COPYING.LIB.  If not, write to
 16  * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 17  * Boston, MA 02110-1301, USA.
 18  */
 19 
 20 #ifndef FontMetrics_h
 21 #define FontMetrics_h
 22 
 23 #include &quot;FontBaseline.h&quot;
 24 #include &lt;wtf/MathExtras.h&gt;
 25 
 26 namespace WebCore {
 27 
 28 class FontMetrics {
 29 public:
 30     static const unsigned defaultUnitsPerEm = 1000;
 31 
 32     unsigned unitsPerEm() const { return m_unitsPerEm; }
 33     void setUnitsPerEm(unsigned unitsPerEm) { m_unitsPerEm = unitsPerEm; }
 34 
 35     float floatAscent(FontBaseline baselineType = AlphabeticBaseline) const
 36     {
 37         if (baselineType == AlphabeticBaseline)
 38             return m_floatAscent;
 39         return floatHeight() / 2;
 40     }
 41 
 42     void setAscent(float ascent)
 43     {
 44         m_floatAscent = ascent;
 45         m_intAscent = lroundf(ascent);
 46     }
 47 
 48     float floatDescent(FontBaseline baselineType = AlphabeticBaseline) const
 49     {
 50         if (baselineType == AlphabeticBaseline)
 51             return m_floatDescent;
 52         return floatHeight() / 2;
 53     }
 54 
 55     void setDescent(float descent)
 56     {
 57         m_floatDescent = descent;
 58         m_intDescent = lroundf(descent);
 59     }
 60 
 61     float floatHeight(FontBaseline baselineType = AlphabeticBaseline) const
 62     {
 63         return floatAscent(baselineType) + floatDescent(baselineType);
 64     }
 65 
 66     float floatLineGap() const { return m_floatLineGap; }
 67     void setLineGap(float lineGap)
 68     {
 69         m_floatLineGap = lineGap;
 70         m_intLineGap = lroundf(lineGap);
 71     }
 72 
 73     float floatLineSpacing() const { return m_floatLineSpacing; }
 74     void setLineSpacing(float lineSpacing)
 75     {
 76         m_floatLineSpacing = lineSpacing;
 77         m_intLineSpacing = lroundf(lineSpacing);
 78     }
 79 
 80     float xHeight() const { return m_xHeight; }
 81     void setXHeight(float xHeight) { m_xHeight = xHeight; }
 82     bool hasXHeight() const { return m_xHeight &gt; 0; }
 83 
 84     bool hasCapHeight() const { return m_floatCapHeight &gt; 0; }
 85     float floatCapHeight() const { return m_floatCapHeight; }
 86     void setCapHeight(float capHeight)
 87     {
 88         m_floatCapHeight = capHeight;
 89         m_intCapHeight = lroundf(capHeight);
 90     }
 91 
 92     // Integer variants of certain metrics, used for HTML rendering.
 93     int ascent(FontBaseline baselineType = AlphabeticBaseline) const
 94     {
 95         if (baselineType == AlphabeticBaseline)
 96             return m_intAscent;
 97         return height() - height() / 2;
 98     }
 99 
100     int descent(FontBaseline baselineType = AlphabeticBaseline) const
101     {
102         if (baselineType == AlphabeticBaseline)
103             return m_intDescent;
104         return height() / 2;
105     }
106 
107     int height(FontBaseline baselineType = AlphabeticBaseline) const
108     {
109         return ascent(baselineType) + descent(baselineType);
110     }
111 
112     int lineGap() const { return m_intLineGap; }
113     int lineSpacing() const { return m_intLineSpacing; }
114 
115     int capHeight() const { return m_intCapHeight; }
116 
117     bool hasIdenticalAscentDescentAndLineGap(const FontMetrics&amp; other) const
118     {
119         return ascent() == other.ascent() &amp;&amp; descent() == other.descent() &amp;&amp; lineGap() == other.lineGap();
120     }
121 
122     float zeroWidth() const { return m_zeroWidth; }
123     void setZeroWidth(float zeroWidth) { m_zeroWidth = zeroWidth; }
124 
125     float underlinePosition() const { return m_underlinePosition; }
126     void setUnderlinePosition(float underlinePosition) { m_underlinePosition = underlinePosition; }
127 
128     float underlineThickness() const { return m_underlineThickness; }
129     void setUnderlineThickness(float underlineThickness) { m_underlineThickness = underlineThickness; }
130 
131 private:
132     friend class Font;
133 
134     void reset()
135     {
136         m_unitsPerEm = defaultUnitsPerEm;
137         m_floatAscent = 0;
138         m_floatDescent = 0;
139         m_floatLineGap = 0;
140         m_floatLineSpacing = 0;
141         m_floatCapHeight = 0;
142         m_intAscent = 0;
143         m_intDescent = 0;
144         m_intLineGap = 0;
145         m_intLineSpacing = 0;
146         m_intCapHeight = 0;
147         m_xHeight = 0;
148         m_zeroWidth = 0;
149         m_underlinePosition = 0;
150         m_underlineThickness = 0;
151     }
152 
153     unsigned m_unitsPerEm { defaultUnitsPerEm };
154 
155     float m_floatAscent { 0 };
156     float m_floatDescent { 0 };
157     float m_floatLineGap { 0 };
158     float m_floatLineSpacing { 0 };
159     float m_floatCapHeight { 0 };
160 
161     // Also cached as integers for performance.
162     int m_intAscent { 0 };
163     int m_intDescent { 0 };
164     int m_intLineGap { 0 };
165     int m_intLineSpacing { 0 };
166     int m_intCapHeight { 0 };
167 
168     float m_zeroWidth { 0 };
169     float m_xHeight { 0 };
170     float m_underlinePosition { 0 };
171     float m_underlineThickness { 0 };
172 };
173 
174 static inline float scaleEmToUnits(float x, unsigned unitsPerEm)
175 {
176     return unitsPerEm ? x / unitsPerEm : x;
177 }
178 
179 } // namespace WebCore
180 
181 #endif // FontMetrics_h
    </pre>
  </body>
</html>