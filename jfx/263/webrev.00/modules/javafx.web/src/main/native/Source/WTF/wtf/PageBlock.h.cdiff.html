<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WTF/wtf/PageBlock.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="PageBlock.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ParkingLot.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WTF/wtf/PageBlock.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 23,12 ***</span>
<span class="line-new-header">--- 23,42 ---</span>
   * THE POSSIBILITY OF SUCH DAMAGE.
   */
  
  #pragma once
  
<span class="line-added">+ #include &lt;wtf/StdLibExtras.h&gt;</span>
<span class="line-added">+ </span>
  namespace WTF {
  
<span class="line-added">+ // We attempt to guess a value that is *AT LEAST* as large as the system&#39;s actual page size.</span>
<span class="line-added">+ // This is impossible to do correctly at build time, but JSC really needs it at build time, so</span>
<span class="line-added">+ // we have a RELEASE_ASSERT() inside WTF::pageSize to make sure it is set properly at runtime.</span>
<span class="line-added">+ // All of these values are going to be incorrect on systems configured to use larger than normal</span>
<span class="line-added">+ // page size, so on such systems it is expected that WebKit will crash until this value is changed</span>
<span class="line-added">+ // and recompiled. Sorry.</span>
<span class="line-added">+ //</span>
<span class="line-added">+ // macOS x86_64 uses 4 KiB, but Apple&#39;s aarch64 systems use 16 KiB. Use 16 KiB on all Apple systems</span>
<span class="line-added">+ // for consistency.</span>
<span class="line-added">+ //</span>
<span class="line-added">+ // Most Linux and Windows systems use a page size of 4 KiB.</span>
<span class="line-added">+ //</span>
<span class="line-added">+ // On Linux, Power systems normally use 64 KiB pages.</span>
<span class="line-added">+ //</span>
<span class="line-added">+ // aarch64 systems seem to be all over the place. Most Linux distros use 4 KiB, but RHEL uses</span>
<span class="line-added">+ // 64 KiB. (Apple uses 16 KiB.)</span>
<span class="line-added">+ //</span>
<span class="line-added">+ // Use 64 KiB for any unknown CPUs to be conservative.</span>
<span class="line-added">+ #if OS(DARWIN)</span>
<span class="line-added">+ constexpr size_t CeilingOnPageSize = 16 * KB;</span>
<span class="line-added">+ #elif OS(WINDOWS) || CPU(MIPS) || CPU(MIPS64) || CPU(X86) || CPU(X86_64) || CPU(ARM) || CPU(ARM64)</span>
<span class="line-added">+ constexpr size_t CeilingOnPageSize = 4 * KB;</span>
<span class="line-added">+ #elif CPU(UNKNOWN) || CPU(PPC) || CPU(PPC64) || CPU(PPC64LE)</span>
<span class="line-added">+ constexpr size_t CeilingOnPageSize = 64 * KB;</span>
<span class="line-added">+ #else</span>
<span class="line-added">+ #error Must set CeilingOnPageSize in PageBlock.h when adding a new CPU architecture!</span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ </span>
  WTF_EXPORT_PRIVATE size_t pageSize();
  WTF_EXPORT_PRIVATE size_t pageMask();
  inline bool isPageAligned(void* address) { return !(reinterpret_cast&lt;intptr_t&gt;(address) &amp; (pageSize() - 1)); }
  inline bool isPageAligned(size_t size) { return !(size &amp; (pageSize() - 1)); }
  inline bool isPowerOfTwo(size_t size) { return !(size &amp; (size - 1)); }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 78,8 ***</span>
<span class="line-new-header">--- 108,9 ---</span>
  {
  }
  
  } // namespace WTF
  
<span class="line-added">+ using WTF::CeilingOnPageSize;</span>
  using WTF::pageSize;
  using WTF::isPageAligned;
  using WTF::isPowerOfTwo;
</pre>
<center><a href="PageBlock.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ParkingLot.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>