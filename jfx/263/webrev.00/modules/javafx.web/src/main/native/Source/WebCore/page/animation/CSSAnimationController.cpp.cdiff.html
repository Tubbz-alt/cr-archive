<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/page/animation/CSSAnimationController.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="AnimationBase.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="CSSAnimationController.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/page/animation/CSSAnimationController.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 148,11 ***</span>
              if (timeToNextService &amp;&amp; timeToNextService.value() == 0_s) {
                  if (callSetChanged != CallSetChanged)
                      break;
  
                  Element&amp; element = *compositeAnimation.key;
<span class="line-modified">!                 ASSERT(element.document().pageCacheState() == Document::NotInPageCache);</span>
                  element.invalidateStyle();
                  calledSetChanged = true;
              }
          }
      }
<span class="line-new-header">--- 148,11 ---</span>
              if (timeToNextService &amp;&amp; timeToNextService.value() == 0_s) {
                  if (callSetChanged != CallSetChanged)
                      break;
  
                  Element&amp; element = *compositeAnimation.key;
<span class="line-modified">!                 ASSERT(element.document().backForwardCacheState() == Document::NotInBackForwardCache);</span>
                  element.invalidateStyle();
                  calledSetChanged = true;
              }
          }
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 223,13 ***</span>
      // fire all the events
      Vector&lt;EventToDispatch&gt; eventsToDispatch = WTFMove(m_eventsToDispatch);
      for (auto&amp; event : eventsToDispatch) {
          Element&amp; element = event.element;
          if (event.eventType == eventNames().transitionendEvent)
<span class="line-modified">!             element.dispatchEvent(TransitionEvent::create(event.eventType, event.name, event.elapsedTime, PseudoElement::pseudoElementNameForEvents(element.pseudoId())));</span>
          else
<span class="line-modified">!             element.dispatchEvent(AnimationEvent::create(event.eventType, event.name, event.elapsedTime));</span>
      }
  
      for (auto&amp; change : m_elementChangesToDispatch)
          change-&gt;invalidateStyle();
  
<span class="line-new-header">--- 223,13 ---</span>
      // fire all the events
      Vector&lt;EventToDispatch&gt; eventsToDispatch = WTFMove(m_eventsToDispatch);
      for (auto&amp; event : eventsToDispatch) {
          Element&amp; element = event.element;
          if (event.eventType == eventNames().transitionendEvent)
<span class="line-modified">!             element.dispatchEvent(TransitionEvent::create(event.eventType, event.name, event.elapsedTime, PseudoElement::pseudoElementNameForEvents(element.pseudoId()), WTF::nullopt, nullptr));</span>
          else
<span class="line-modified">!             element.dispatchEvent(AnimationEvent::create(event.eventType, event.name, event.elapsedTime, PseudoElement::pseudoElementNameForEvents(element.pseudoId()), WTF::nullopt, nullptr));</span>
      }
  
      for (auto&amp; change : m_elementChangesToDispatch)
          change-&gt;invalidateStyle();
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 252,11 ***</span>
  }
  
  void CSSAnimationControllerPrivate::addElementChangeToDispatch(Element&amp; element)
  {
      m_elementChangesToDispatch.append(element);
<span class="line-modified">!     ASSERT(m_elementChangesToDispatch.last()-&gt;document().pageCacheState() == Document::NotInPageCache);</span>
      startUpdateStyleIfNeededDispatcher();
  }
  
  void CSSAnimationControllerPrivate::animationFrameCallbackFired()
  {
<span class="line-new-header">--- 252,11 ---</span>
  }
  
  void CSSAnimationControllerPrivate::addElementChangeToDispatch(Element&amp; element)
  {
      m_elementChangesToDispatch.append(element);
<span class="line-modified">!     ASSERT(m_elementChangesToDispatch.last()-&gt;document().backForwardCacheState() == Document::NotInBackForwardCache);</span>
      startUpdateStyleIfNeededDispatcher();
  }
  
  void CSSAnimationControllerPrivate::animationFrameCallbackFired()
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 607,21 ***</span>
      if (!m_data-&gt;clear(element))
          return;
  
      if (element.document().renderTreeBeingDestroyed())
          return;
<span class="line-modified">!     ASSERT(element.document().pageCacheState() == Document::NotInPageCache);</span>
      element.invalidateStyle();
  }
  
  AnimationUpdate CSSAnimationController::updateAnimations(Element&amp; element, const RenderStyle&amp; newStyle, const RenderStyle* oldStyle)
  {
      bool hasOrHadAnimations = (oldStyle &amp;&amp; oldStyle-&gt;hasAnimationsOrTransitions()) || newStyle.hasAnimationsOrTransitions();
      if (!hasOrHadAnimations)
          return { };
  
<span class="line-modified">!     if (element.document().pageCacheState() != Document::NotInPageCache)</span>
          return { };
  
      // Don&#39;t run transitions when printing.
      if (element.document().renderView()-&gt;printing())
          return { };
<span class="line-new-header">--- 607,21 ---</span>
      if (!m_data-&gt;clear(element))
          return;
  
      if (element.document().renderTreeBeingDestroyed())
          return;
<span class="line-modified">!     ASSERT(element.document().backForwardCacheState() == Document::NotInBackForwardCache);</span>
      element.invalidateStyle();
  }
  
  AnimationUpdate CSSAnimationController::updateAnimations(Element&amp; element, const RenderStyle&amp; newStyle, const RenderStyle* oldStyle)
  {
      bool hasOrHadAnimations = (oldStyle &amp;&amp; oldStyle-&gt;hasAnimationsOrTransitions()) || newStyle.hasAnimationsOrTransitions();
      if (!hasOrHadAnimations)
          return { };
  
<span class="line-modified">!     if (element.document().backForwardCacheState() != Document::NotInBackForwardCache)</span>
          return { };
  
      // Don&#39;t run transitions when printing.
      if (element.document().renderView()-&gt;printing())
          return { };
</pre>
<center><a href="AnimationBase.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="CSSAnimationController.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>