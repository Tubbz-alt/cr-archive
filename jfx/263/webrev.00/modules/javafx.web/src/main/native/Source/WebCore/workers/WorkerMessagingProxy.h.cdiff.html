<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/workers/WorkerMessagingProxy.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="WorkerMessagingProxy.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="WorkerRunLoop.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/workers/WorkerMessagingProxy.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 41,19 ***</span>
      WTF_MAKE_FAST_ALLOCATED;
  public:
      explicit WorkerMessagingProxy(Worker&amp;);
      virtual ~WorkerMessagingProxy();
  
  private:
      // Implementations of WorkerGlobalScopeProxy.
      // (Only use these functions in the worker object thread.)
<span class="line-modified">!     void startWorkerGlobalScope(const URL&amp; scriptURL, const String&amp; name, const String&amp; userAgent, bool isOnline, const String&amp; sourceCode, const ContentSecurityPolicyResponseHeaders&amp;, bool shouldBypassMainWorldContentSecurityPolicy, MonotonicTime timeOrigin, JSC::RuntimeFlags, PAL::SessionID) final;</span>
      void terminateWorkerGlobalScope() final;
      void postMessageToWorkerGlobalScope(MessageWithMessagePorts&amp;&amp;) final;
      bool hasPendingActivity() const final;
      void workerObjectDestroyed() final;
      void notifyNetworkStateChange(bool isOnline) final;
  
      // Implementation of WorkerObjectProxy.
      // (Only use these functions in the worker context thread.)
      void postMessageToWorkerObject(MessageWithMessagePorts&amp;&amp;) final;
      void postExceptionToWorkerObject(const String&amp; errorMessage, int lineNumber, int columnNumber, const String&amp; sourceURL) final;
<span class="line-new-header">--- 41,25 ---</span>
      WTF_MAKE_FAST_ALLOCATED;
  public:
      explicit WorkerMessagingProxy(Worker&amp;);
      virtual ~WorkerMessagingProxy();
  
<span class="line-added">+     // Implementation of WorkerLoaderProxy.</span>
<span class="line-added">+     // This method is used in the main thread to post task back to the worker thread.</span>
<span class="line-added">+     bool postTaskForModeToWorkerGlobalScope(ScriptExecutionContext::Task&amp;&amp;, const String&amp; mode) final;</span>
<span class="line-added">+ </span>
  private:
      // Implementations of WorkerGlobalScopeProxy.
      // (Only use these functions in the worker object thread.)
<span class="line-modified">!     void startWorkerGlobalScope(const URL&amp; scriptURL, const String&amp; name, const String&amp; userAgent, bool isOnline, const String&amp; sourceCode, const ContentSecurityPolicyResponseHeaders&amp;, bool shouldBypassMainWorldContentSecurityPolicy, MonotonicTime timeOrigin, ReferrerPolicy, JSC::RuntimeFlags) final;</span>
      void terminateWorkerGlobalScope() final;
      void postMessageToWorkerGlobalScope(MessageWithMessagePorts&amp;&amp;) final;
      bool hasPendingActivity() const final;
      void workerObjectDestroyed() final;
      void notifyNetworkStateChange(bool isOnline) final;
<span class="line-added">+     void suspendForBackForwardCache() final;</span>
<span class="line-added">+     void resumeForBackForwardCache() final;</span>
  
      // Implementation of WorkerObjectProxy.
      // (Only use these functions in the worker context thread.)
      void postMessageToWorkerObject(MessageWithMessagePorts&amp;&amp;) final;
      void postExceptionToWorkerObject(const String&amp; errorMessage, int lineNumber, int columnNumber, const String&amp; sourceURL) final;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 63,17 ***</span>
      void workerGlobalScopeDestroyed() final;
  
      // Implementation of WorkerDebuggerProxy.
      // (Only use these functions in the worker context thread.)
      void postMessageToDebugger(const String&amp;) final;
<span class="line-modified">!     void setResourceCachingDisabled(bool) final;</span>
  
      // Implementation of WorkerLoaderProxy.
      // These functions are called on different threads to schedule loading
      // requests and to send callbacks back to WorkerGlobalScope.
      void postTaskToLoader(ScriptExecutionContext::Task&amp;&amp;) final;
<span class="line-removed">-     bool postTaskForModeToWorkerGlobalScope(ScriptExecutionContext::Task&amp;&amp;, const String&amp; mode) final;</span>
      Ref&lt;CacheStorageConnection&gt; createCacheStorageConnection() final;
  
      void workerThreadCreated(DedicatedWorkerThread&amp;);
  
      // Only use this method on the worker object thread.
<span class="line-new-header">--- 69,17 ---</span>
      void workerGlobalScopeDestroyed() final;
  
      // Implementation of WorkerDebuggerProxy.
      // (Only use these functions in the worker context thread.)
      void postMessageToDebugger(const String&amp;) final;
<span class="line-modified">!     void setResourceCachingDisabledByWebInspector(bool) final;</span>
  
      // Implementation of WorkerLoaderProxy.
      // These functions are called on different threads to schedule loading
      // requests and to send callbacks back to WorkerGlobalScope.
<span class="line-added">+     bool isWorkerMessagingProxy() const final { return true; }</span>
      void postTaskToLoader(ScriptExecutionContext::Task&amp;&amp;) final;
      Ref&lt;CacheStorageConnection&gt; createCacheStorageConnection() final;
  
      void workerThreadCreated(DedicatedWorkerThread&amp;);
  
      // Only use this method on the worker object thread.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 90,11 ***</span>
<span class="line-new-header">--- 96,16 ---</span>
      RefPtr&lt;DedicatedWorkerThread&gt; m_workerThread;
  
      unsigned m_unconfirmedMessageCount { 0 }; // Unconfirmed messages from worker object to worker thread.
      bool m_workerThreadHadPendingActivity { false }; // The latest confirmation from worker thread reported that it was still active.
  
<span class="line-added">+     bool m_askedToSuspend { false };</span>
      bool m_askedToTerminate { false };
  
      Vector&lt;std::unique_ptr&lt;ScriptExecutionContext::Task&gt;&gt; m_queuedEarlyTasks; // Tasks are queued here until there&#39;s a thread object created.
  };
  
  } // namespace WebCore
<span class="line-added">+ </span>
<span class="line-added">+ SPECIALIZE_TYPE_TRAITS_BEGIN(WebCore::WorkerMessagingProxy)</span>
<span class="line-added">+     static bool isType(const WebCore::WorkerLoaderProxy&amp; proxy) { return proxy.isWorkerMessagingProxy(); }</span>
<span class="line-added">+ SPECIALIZE_TYPE_TRAITS_END()</span>
</pre>
<center><a href="WorkerMessagingProxy.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="WorkerRunLoop.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>