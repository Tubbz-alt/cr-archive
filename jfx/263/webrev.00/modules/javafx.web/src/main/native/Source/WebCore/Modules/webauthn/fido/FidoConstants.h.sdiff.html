<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/Modules/webauthn/fido/FidoConstants.h</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DeviceResponseConverter.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="FidoHidMessage.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/Modules/webauthn/fido/FidoConstants.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 90     kCtap2ErrNotAllowed = 0x30,
 91     kCtap2ErrPinInvalid = 0x31,
 92     kCtap2ErrPinBlocked = 0x32,
 93     kCtap2ErrPinAuthInvalid = 0x33,
 94     kCtap2ErrPinAuthBlocked = 0x34,
 95     kCtap2ErrPinNotSet = 0x35,
 96     kCtap2ErrPinRequired = 0x36,
 97     kCtap2ErrPinPolicyViolation = 0x37,
 98     kCtap2ErrPinTokenExpired = 0x38,
 99     kCtap2ErrRequestTooLarge = 0x39,
100     kCtap2ErrOther = 0x7F,
101     kCtap2ErrSpecLast = 0xDF,
102     kCtap2ErrExtensionFirst = 0xE0,
103     kCtap2ErrExtensionLast = 0xEF,
104     kCtap2ErrVendorFirst = 0xF0,
105     kCtap2ErrVendorLast = 0xFF
106 };
107 
108 bool isCtapDeviceResponseCode(CtapDeviceResponseCode);
109 


110 // Commands supported by CTAPHID device as specified in
111 // https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-client-to-authenticator-protocol-v2.0-ps-20170927.html#ctaphid-commands
112 enum class FidoHidDeviceCommand : uint8_t {
113     kMsg = 0x03,
114     kCbor = 0x10,
115     kInit = 0x06,
116     kPing = 0x01,
117     kCancel = 0x11,
118     kError = 0x3F,
119     kKeepAlive = 0x3B,
120     kWink = 0x08,
121     kLock = 0x04,
122 };
123 
124 bool isFidoHidDeviceCommand(FidoHidDeviceCommand);
125 
126 // Parameters for fake U2F registration used to check for user presence.
127 const uint8_t kBogusAppParam[] = {
128     0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41,
129     0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41,
</pre>
<hr />
<pre>
206 // request.
207 const char kFormatKey[] = &quot;fmt&quot;;
208 const char kAttestationStatementKey[] = &quot;attStmt&quot;;
209 const char kAuthDataKey[] = &quot;authData&quot;;
210 
211 // String representation of public key credential enum.
212 // https://w3c.github.io/webauthn/#credentialType
213 const char kPublicKey[] = &quot;public-key&quot;;
214 
215 const char* publicKeyCredentialTypeToString(WebCore::PublicKeyCredentialType);
216 
217 // FIXME: Add url to the official spec once it&#39;s standardized.
218 const char kCtap2Version[] = &quot;FIDO_2_0&quot;;
219 const char kU2fVersion[] = &quot;U2F_V2&quot;;
220 
221 // CTAPHID Usage Page and Usage
222 // https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-client-to-authenticator-protocol-v2.0-ps-20170927.html#hid-report-descriptor-and-device-discovery
223 const uint32_t kCtapHidUsagePage = 0xF1D0;
224 const uint32_t kCtapHidUsage = 0x01;
225 







226 // CTAPNFC Applet selection command and responses
227 // https://fidoalliance.org/specs/fido-v2.0-ps-20190130/fido-client-to-authenticator-protocol-v2.0-ps-20190130.html#nfc-applet-selection
228 const uint8_t kCtapNfcAppletSelectionCommand[] = {
229     0x00, 0xA4, 0x04, 0x00, // CLA, INS, P1, P2
230     0x08, // L
231     0xA0, 0x00, 0x00, 0x06, 0x47, // RID
232     0x2F, 0x00, 0x01 // PIX
233 };
234 
235 const uint8_t kCtapNfcAppletSelectionU2f[] = {
236     0x55, 0x32, 0x46, 0x5F, 0x56, 0x32, // Version
237     0x90, 0x00 // APDU response code
238 };
239 
240 const uint8_t kCtapNfcAppletSelectionCtap[] = {
241     0x46, 0x49, 0x44, 0x4f, 0x5f, 0x32, 0x5f, 0x30, // Version
242     0x90, 0x00 // APDU response code
243 };
244 
245 // https://fidoalliance.org/specs/fido-v2.0-ps-20190130/fido-client-to-authenticator-protocol-v2.0-ps-20190130.html#nfc-command-framing
</pre>
</td>
<td>
<hr />
<pre>
 90     kCtap2ErrNotAllowed = 0x30,
 91     kCtap2ErrPinInvalid = 0x31,
 92     kCtap2ErrPinBlocked = 0x32,
 93     kCtap2ErrPinAuthInvalid = 0x33,
 94     kCtap2ErrPinAuthBlocked = 0x34,
 95     kCtap2ErrPinNotSet = 0x35,
 96     kCtap2ErrPinRequired = 0x36,
 97     kCtap2ErrPinPolicyViolation = 0x37,
 98     kCtap2ErrPinTokenExpired = 0x38,
 99     kCtap2ErrRequestTooLarge = 0x39,
100     kCtap2ErrOther = 0x7F,
101     kCtap2ErrSpecLast = 0xDF,
102     kCtap2ErrExtensionFirst = 0xE0,
103     kCtap2ErrExtensionLast = 0xEF,
104     kCtap2ErrVendorFirst = 0xF0,
105     kCtap2ErrVendorLast = 0xFF
106 };
107 
108 bool isCtapDeviceResponseCode(CtapDeviceResponseCode);
109 
<span class="line-added">110 const size_t kResponseCodeLength = 1;</span>
<span class="line-added">111 </span>
112 // Commands supported by CTAPHID device as specified in
113 // https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-client-to-authenticator-protocol-v2.0-ps-20170927.html#ctaphid-commands
114 enum class FidoHidDeviceCommand : uint8_t {
115     kMsg = 0x03,
116     kCbor = 0x10,
117     kInit = 0x06,
118     kPing = 0x01,
119     kCancel = 0x11,
120     kError = 0x3F,
121     kKeepAlive = 0x3B,
122     kWink = 0x08,
123     kLock = 0x04,
124 };
125 
126 bool isFidoHidDeviceCommand(FidoHidDeviceCommand);
127 
128 // Parameters for fake U2F registration used to check for user presence.
129 const uint8_t kBogusAppParam[] = {
130     0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41,
131     0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41,
</pre>
<hr />
<pre>
208 // request.
209 const char kFormatKey[] = &quot;fmt&quot;;
210 const char kAttestationStatementKey[] = &quot;attStmt&quot;;
211 const char kAuthDataKey[] = &quot;authData&quot;;
212 
213 // String representation of public key credential enum.
214 // https://w3c.github.io/webauthn/#credentialType
215 const char kPublicKey[] = &quot;public-key&quot;;
216 
217 const char* publicKeyCredentialTypeToString(WebCore::PublicKeyCredentialType);
218 
219 // FIXME: Add url to the official spec once it&#39;s standardized.
220 const char kCtap2Version[] = &quot;FIDO_2_0&quot;;
221 const char kU2fVersion[] = &quot;U2F_V2&quot;;
222 
223 // CTAPHID Usage Page and Usage
224 // https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-client-to-authenticator-protocol-v2.0-ps-20170927.html#hid-report-descriptor-and-device-discovery
225 const uint32_t kCtapHidUsagePage = 0xF1D0;
226 const uint32_t kCtapHidUsage = 0x01;
227 
<span class="line-added">228 // U2F_VERSION command</span>
<span class="line-added">229 // https://fidoalliance.org/specs/fido-u2f-v1.2-ps-20170411/fido-u2f-raw-message-formats-v1.2-ps-20170411.html#getversion-request-and-response---u2f_version</span>
<span class="line-added">230 const uint8_t kCtapNfcU2fVersionCommand[] = {</span>
<span class="line-added">231     0x00, 0x03, 0x00, 0x00, // CLA, INS, P1, P2</span>
<span class="line-added">232     0x00, // L</span>
<span class="line-added">233 };</span>
<span class="line-added">234 </span>
235 // CTAPNFC Applet selection command and responses
236 // https://fidoalliance.org/specs/fido-v2.0-ps-20190130/fido-client-to-authenticator-protocol-v2.0-ps-20190130.html#nfc-applet-selection
237 const uint8_t kCtapNfcAppletSelectionCommand[] = {
238     0x00, 0xA4, 0x04, 0x00, // CLA, INS, P1, P2
239     0x08, // L
240     0xA0, 0x00, 0x00, 0x06, 0x47, // RID
241     0x2F, 0x00, 0x01 // PIX
242 };
243 
244 const uint8_t kCtapNfcAppletSelectionU2f[] = {
245     0x55, 0x32, 0x46, 0x5F, 0x56, 0x32, // Version
246     0x90, 0x00 // APDU response code
247 };
248 
249 const uint8_t kCtapNfcAppletSelectionCtap[] = {
250     0x46, 0x49, 0x44, 0x4f, 0x5f, 0x32, 0x5f, 0x30, // Version
251     0x90, 0x00 // APDU response code
252 };
253 
254 // https://fidoalliance.org/specs/fido-v2.0-ps-20190130/fido-client-to-authenticator-protocol-v2.0-ps-20190130.html#nfc-command-framing
</pre>
</td>
</tr>
</table>
<center><a href="DeviceResponseConverter.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="FidoHidMessage.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>