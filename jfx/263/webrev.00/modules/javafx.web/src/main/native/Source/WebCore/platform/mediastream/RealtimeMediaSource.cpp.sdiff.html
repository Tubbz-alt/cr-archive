<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/platform/mediastream/RealtimeMediaSource.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="RealtimeIncomingVideoSource.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RealtimeMediaSource.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/platform/mediastream/RealtimeMediaSource.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  73     if (m_observers.isEmpty())
  74         stopBeingObserved();
  75 }
  76 
  77 void RealtimeMediaSource::setInterrupted(bool interrupted, bool pageMuted)
  78 {
  79     if (interrupted == m_interrupted)
  80         return;
  81 
  82     ALWAYS_LOG_IF(m_logger, LOGIDENTIFIER, interrupted, &quot;, page muted : &quot;, pageMuted);
  83 
  84     m_interrupted = interrupted;
  85     if (!interrupted &amp;&amp; pageMuted)
  86         return;
  87 
  88     setMuted(interrupted);
  89 }
  90 
  91 void RealtimeMediaSource::setMuted(bool muted)
  92 {





  93     ALWAYS_LOG_IF(m_logger, LOGIDENTIFIER, muted);
  94 



  95     if (muted)
  96         stop();
<span class="line-modified">  97     else {</span>
<span class="line-removed">  98         if (interrupted())</span>
<span class="line-removed">  99             return;</span>
<span class="line-removed"> 100 </span>
 101         start();
<span class="line-removed"> 102     }</span>
 103 
<span class="line-modified"> 104     notifyMutedChange(muted);</span>

 105 }
 106 
 107 void RealtimeMediaSource::notifyMutedChange(bool muted)
 108 {
 109     if (m_muted == muted)
 110         return;
 111 
 112     ALWAYS_LOG_IF(m_logger, LOGIDENTIFIER, muted);
 113     m_muted = muted;
 114 
 115     notifyMutedObservers();
 116 }
 117 
 118 void RealtimeMediaSource::setInterruptedForTesting(bool interrupted)
 119 {
 120     notifyMutedChange(interrupted);
 121 }
 122 
 123 void RealtimeMediaSource::forEachObserver(const WTF::Function&lt;void(Observer&amp;)&gt;&amp; apply) const
 124 {
</pre>
</td>
<td>
<hr />
<pre>
  73     if (m_observers.isEmpty())
  74         stopBeingObserved();
  75 }
  76 
  77 void RealtimeMediaSource::setInterrupted(bool interrupted, bool pageMuted)
  78 {
  79     if (interrupted == m_interrupted)
  80         return;
  81 
  82     ALWAYS_LOG_IF(m_logger, LOGIDENTIFIER, interrupted, &quot;, page muted : &quot;, pageMuted);
  83 
  84     m_interrupted = interrupted;
  85     if (!interrupted &amp;&amp; pageMuted)
  86         return;
  87 
  88     setMuted(interrupted);
  89 }
  90 
  91 void RealtimeMediaSource::setMuted(bool muted)
  92 {
<span class="line-added">  93     if (!muted &amp;&amp; interrupted()) {</span>
<span class="line-added">  94         ALWAYS_LOG_IF(m_logger, LOGIDENTIFIER, &quot;ignoring unmute because of interruption&quot;);</span>
<span class="line-added">  95         return;</span>
<span class="line-added">  96     }</span>
<span class="line-added">  97 </span>
  98     ALWAYS_LOG_IF(m_logger, LOGIDENTIFIER, muted);
  99 
<span class="line-added"> 100     // Changed m_muted before calling start/stop so muted() will reflect the correct state.</span>
<span class="line-added"> 101     bool changed = m_muted != muted;</span>
<span class="line-added"> 102     m_muted = muted;</span>
 103     if (muted)
 104         stop();
<span class="line-modified"> 105     else</span>



 106         start();

 107 
<span class="line-modified"> 108     if (changed)</span>
<span class="line-added"> 109         notifyMutedObservers();</span>
 110 }
 111 
 112 void RealtimeMediaSource::notifyMutedChange(bool muted)
 113 {
 114     if (m_muted == muted)
 115         return;
 116 
 117     ALWAYS_LOG_IF(m_logger, LOGIDENTIFIER, muted);
 118     m_muted = muted;
 119 
 120     notifyMutedObservers();
 121 }
 122 
 123 void RealtimeMediaSource::setInterruptedForTesting(bool interrupted)
 124 {
 125     notifyMutedChange(interrupted);
 126 }
 127 
 128 void RealtimeMediaSource::forEachObserver(const WTF::Function&lt;void(Observer&amp;)&gt;&amp; apply) const
 129 {
</pre>
</td>
</tr>
</table>
<center><a href="RealtimeIncomingVideoSource.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RealtimeMediaSource.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>