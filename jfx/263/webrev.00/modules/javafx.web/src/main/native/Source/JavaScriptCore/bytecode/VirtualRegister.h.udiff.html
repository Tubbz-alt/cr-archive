<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/VirtualRegister.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="VirtualRegister.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Watchpoint.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/VirtualRegister.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (C) 2011, 2015-2016 Apple Inc. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (C) 2011-2019 Apple Inc. All rights reserved.</span>
   *
   * Redistribution and use in source and binary forms, with or without
   * modification, are permitted provided that the following conditions
   * are met:
   * 1. Redistributions of source code must retain the above copyright
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -29,46 +29,54 @@</span>
  #include &quot;CallFrame.h&quot;
  #include &lt;wtf/PrintStream.h&gt;
  
  namespace JSC {
  
<span class="udiff-line-modified-removed">- inline bool operandIsLocal(int operand)</span>
<span class="udiff-line-modified-added">+ inline bool virtualRegisterIsLocal(int operand)</span>
  {
      return operand &lt; 0;
  }
  
<span class="udiff-line-modified-removed">- inline bool operandIsArgument(int operand)</span>
<span class="udiff-line-modified-added">+ inline bool virtualRegisterIsArgument(int operand)</span>
  {
      return operand &gt;= 0;
  }
  
  
  class RegisterID;
  
  class VirtualRegister {
  public:
      friend VirtualRegister virtualRegisterForLocal(int);
<span class="udiff-line-modified-removed">-     friend VirtualRegister virtualRegisterForArgument(int, int);</span>
<span class="udiff-line-modified-added">+     friend VirtualRegister virtualRegisterForArgumentIncludingThis(int, int);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     static constexpr int invalidVirtualRegister = 0x3fffffff;</span>
<span class="udiff-line-added">+     static constexpr int firstConstantRegisterIndex = FirstConstantRegisterIndex;</span>
  
      VirtualRegister(RegisterID*);
<span class="udiff-line-added">+     VirtualRegister(RefPtr&lt;RegisterID&gt;);</span>
  
      VirtualRegister()
<span class="udiff-line-modified-removed">-         : m_virtualRegister(s_invalidVirtualRegister)</span>
<span class="udiff-line-modified-added">+         : m_virtualRegister(invalidVirtualRegister)</span>
      { }
  
      explicit VirtualRegister(int virtualRegister)
          : m_virtualRegister(virtualRegister)
      { }
  
<span class="udiff-line-modified-removed">-     bool isValid() const { return (m_virtualRegister != s_invalidVirtualRegister); }</span>
<span class="udiff-line-modified-removed">-     bool isLocal() const { return operandIsLocal(m_virtualRegister); }</span>
<span class="udiff-line-modified-removed">-     bool isArgument() const { return operandIsArgument(m_virtualRegister); }</span>
<span class="udiff-line-modified-added">+     VirtualRegister(CallFrameSlot slot)</span>
<span class="udiff-line-modified-added">+         : m_virtualRegister(static_cast&lt;int&gt;(slot))</span>
<span class="udiff-line-modified-added">+     { }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     bool isValid() const { return (m_virtualRegister != invalidVirtualRegister); }</span>
<span class="udiff-line-added">+     bool isLocal() const { return virtualRegisterIsLocal(m_virtualRegister); }</span>
<span class="udiff-line-added">+     bool isArgument() const { return virtualRegisterIsArgument(m_virtualRegister); }</span>
      bool isHeader() const { return m_virtualRegister &gt;= 0 &amp;&amp; m_virtualRegister &lt; CallFrameSlot::thisArgument; }
<span class="udiff-line-modified-removed">-     bool isConstant() const { return m_virtualRegister &gt;= s_firstConstantRegisterIndex; }</span>
<span class="udiff-line-modified-added">+     bool isConstant() const { return m_virtualRegister &gt;= firstConstantRegisterIndex; }</span>
      int toLocal() const { ASSERT(isLocal()); return operandToLocal(m_virtualRegister); }
      int toArgument() const { ASSERT(isArgument()); return operandToArgument(m_virtualRegister); }
<span class="udiff-line-modified-removed">-     int toConstantIndex() const { ASSERT(isConstant()); return m_virtualRegister - s_firstConstantRegisterIndex; }</span>
<span class="udiff-line-modified-added">+     int toConstantIndex() const { ASSERT(isConstant()); return m_virtualRegister - firstConstantRegisterIndex; }</span>
      int offset() const { return m_virtualRegister; }
      int offsetInBytes() const { return m_virtualRegister * sizeof(Register); }
  
      bool operator==(VirtualRegister other) const { return m_virtualRegister == other.m_virtualRegister; }
      bool operator!=(VirtualRegister other) const { return m_virtualRegister != other.m_virtualRegister; }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -103,13 +111,10 @@</span>
      }
  
      void dump(PrintStream&amp; out) const;
  
  private:
<span class="udiff-line-removed">-     static const int s_invalidVirtualRegister = 0x3fffffff;</span>
<span class="udiff-line-removed">-     static const int s_firstConstantRegisterIndex = FirstConstantRegisterIndex;</span>
<span class="udiff-line-removed">- </span>
      static int localToOperand(int local) { return -1 - local; }
      static int operandToLocal(int operand) { return -1 - operand; }
      static int operandToArgument(int operand) { return operand - CallFrame::thisArgumentOffset(); }
      static int argumentToOperand(int argument) { return argument + CallFrame::thisArgumentOffset(); }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -121,11 +126,11 @@</span>
  inline VirtualRegister virtualRegisterForLocal(int local)
  {
      return VirtualRegister(VirtualRegister::localToOperand(local));
  }
  
<span class="udiff-line-modified-removed">- inline VirtualRegister virtualRegisterForArgument(int argument, int offset = 0)</span>
<span class="udiff-line-modified-added">+ inline VirtualRegister virtualRegisterForArgumentIncludingThis(int argument, int offset = 0)</span>
  {
      return VirtualRegister(VirtualRegister::argumentToOperand(argument) + offset);
  }
  
  } // namespace JSC
</pre>
<center><a href="VirtualRegister.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="Watchpoint.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>