<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/dom/KeyboardEvent.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="InputEvent.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="KeyboardEvent.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/dom/KeyboardEvent.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -29,13 +29,16 @@</span>
  #include &quot;EventHandler.h&quot;
  #include &quot;EventNames.h&quot;
  #include &quot;Frame.h&quot;
  #include &quot;PlatformKeyboardEvent.h&quot;
  #include &quot;WindowsKeyboardCodes.h&quot;
<span class="udiff-line-added">+ #include &lt;wtf/IsoMallocInlines.h&gt;</span>
  
  namespace WebCore {
  
<span class="udiff-line-added">+ WTF_MAKE_ISO_ALLOCATED_IMPL(KeyboardEvent);</span>
<span class="udiff-line-added">+ </span>
  static inline const AtomString&amp; eventTypeForKeyboardEventType(PlatformEvent::Type type)
  {
      switch (type) {
          case PlatformEvent::KeyUp:
              return eventNames().keyupEvent;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -76,17 +79,23 @@</span>
          return KeyboardEvent::DOM_KEY_LOCATION_NUMPAD;
  
      switch (key.windowsVirtualKeyCode()) {
      case VK_LCONTROL:
      case VK_LSHIFT:
<span class="udiff-line-modified-removed">-     case VK_LMENU:</span>
<span class="udiff-line-modified-removed">-     case VK_LWIN:</span>
<span class="udiff-line-modified-added">+     case VK_LMENU: // Left Option/Alt</span>
<span class="udiff-line-modified-added">+     case VK_LWIN: // Left Command/Windows key (Natural keyboard)</span>
          return KeyboardEvent::DOM_KEY_LOCATION_LEFT;
      case VK_RCONTROL:
      case VK_RSHIFT:
<span class="udiff-line-modified-removed">-     case VK_RMENU:</span>
<span class="udiff-line-modified-removed">-     case VK_RWIN:</span>
<span class="udiff-line-modified-added">+     case VK_RMENU: // Right Option/Alt</span>
<span class="udiff-line-modified-added">+     case VK_RWIN: // Right Windows key (Natural keyboard)</span>
<span class="udiff-line-added">+ #if PLATFORM(COCOA)</span>
<span class="udiff-line-added">+     // FIXME: WebCore maps the right command key to VK_APPS even though the USB HID spec.,</span>
<span class="udiff-line-added">+     // &lt;https://www.usb.org/sites/default/files/documents/hut1_12v2.pdf&gt;, states that it</span>
<span class="udiff-line-added">+     // should map to the same key as the right Windows key (VK_RWIN).</span>
<span class="udiff-line-added">+     case VK_APPS: // Right Command</span>
<span class="udiff-line-added">+ #endif</span>
          return KeyboardEvent::DOM_KEY_LOCATION_RIGHT;
      default:
          return KeyboardEvent::DOM_KEY_LOCATION_STANDARD;
      }
  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -95,16 +104,12 @@</span>
  
  inline KeyboardEvent::KeyboardEvent(const PlatformKeyboardEvent&amp; key, RefPtr&lt;WindowProxy&gt;&amp;&amp; view)
      : UIEventWithKeyState(eventTypeForKeyboardEventType(key.type()), CanBubble::Yes, IsCancelable::Yes, IsComposed::Yes,
          key.timestamp().approximateMonotonicTime(), view.copyRef(), 0, key.modifiers(), IsTrusted::Yes)
      , m_underlyingPlatformEvent(makeUnique&lt;PlatformKeyboardEvent&gt;(key))
<span class="udiff-line-removed">- #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)</span>
      , m_key(key.key())
<span class="udiff-line-removed">- #endif</span>
<span class="udiff-line-removed">- #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)</span>
      , m_code(key.code())
<span class="udiff-line-removed">- #endif</span>
      , m_keyIdentifier(key.keyIdentifier())
      , m_location(keyLocationCode(key))
      , m_repeat(key.isAutoRepeat())
      , m_isComposing(view &amp;&amp; is&lt;DOMWindow&gt;(view-&gt;window()) &amp;&amp; downcast&lt;DOMWindow&gt;(*view-&gt;window()).frame() &amp;&amp; downcast&lt;DOMWindow&gt;(*view-&gt;window()).frame()-&gt;editor().hasComposition())
  #if USE(APPKIT) || USE(UIKIT_KEYBOARD_ADDITIONS)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -116,16 +121,12 @@</span>
  {
  }
  
  inline KeyboardEvent::KeyboardEvent(const AtomString&amp; eventType, const Init&amp; initializer)
      : UIEventWithKeyState(eventType, initializer)
<span class="udiff-line-removed">- #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)</span>
      , m_key(initializer.key)
<span class="udiff-line-removed">- #endif</span>
<span class="udiff-line-removed">- #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)</span>
      , m_code(initializer.code)
<span class="udiff-line-removed">- #endif</span>
      , m_keyIdentifier(initializer.keyIdentifier)
      , m_location(initializer.keyLocation ? *initializer.keyLocation : initializer.location)
      , m_repeat(initializer.repeat)
      , m_isComposing(initializer.isComposing)
      , m_charCode(initializer.charCode)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -168,18 +169,12 @@</span>
      m_isComposing = false;
      m_keyCode = WTF::nullopt;
      m_repeat = false;
      m_underlyingPlatformEvent = nullptr;
      m_which = WTF::nullopt;
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)</span>
      m_code = { };
<span class="udiff-line-removed">- #endif</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)</span>
      m_key = { };
<span class="udiff-line-removed">- #endif</span>
  
  #if PLATFORM(COCOA)
      m_handledByInputMethod = false;
      m_keypressCommands = { };
  #endif
</pre>
<center><a href="InputEvent.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="KeyboardEvent.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>