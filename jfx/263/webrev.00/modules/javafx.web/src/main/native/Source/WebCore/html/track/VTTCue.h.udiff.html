<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/html/track/VTTCue.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="VTTCue.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="VTTRegion.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/html/track/VTTCue.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -47,19 +47,20 @@</span>
  class VTTScanner;
  class WebVTTCueData;
  
  // ----------------------------
  
<span class="udiff-line-modified-removed">- class VTTCueBox : public HTMLElement {</span>
<span class="udiff-line-modified-added">+ class VTTCueBox : public TextTrackCueBox {</span>
      WTF_MAKE_ISO_ALLOCATED(VTTCueBox);
  public:
<span class="udiff-line-modified-removed">-     static Ref&lt;VTTCueBox&gt; create(Document&amp;, VTTCue&amp;);</span>
<span class="udiff-line-modified-added">+     static Ref&lt;VTTCueBox&gt; create(Document&amp; document, VTTCue&amp; cue)</span>
<span class="udiff-line-added">+     {</span>
<span class="udiff-line-added">+         return adoptRef(*new VTTCueBox(document, cue));</span>
<span class="udiff-line-added">+     }</span>
  
<span class="udiff-line-modified-removed">-     VTTCue* getCue() const;</span>
<span class="udiff-line-removed">-     virtual void applyCSSProperties(const IntSize&amp; videoSize);</span>
<span class="udiff-line-modified-added">+     void applyCSSProperties(const IntSize&amp;) override;</span>
  
<span class="udiff-line-removed">-     static const AtomString&amp; vttCueBoxShadowPseudoId();</span>
      void setFontSizeFromCaptionUserPrefs(int fontSize) { m_fontSizeFromCaptionUserPrefs = fontSize; }
  
  protected:
      VTTCueBox(Document&amp;, VTTCue&amp;);
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -72,11 +73,11 @@</span>
      int m_fontSizeFromCaptionUserPrefs;
  };
  
  // ----------------------------
  
<span class="udiff-line-modified-removed">- class VTTCue : public TextTrackCue, public CanMakeWeakPtr&lt;VTTCue&gt; {</span>
<span class="udiff-line-modified-added">+ class VTTCue : public TextTrackCue {</span>
      WTF_MAKE_ISO_ALLOCATED(VTTCue);
  public:
      static Ref&lt;VTTCue&gt; create(ScriptExecutionContext&amp; context, double start, double end, const String&amp; content)
      {
          return create(context, MediaTime::createWithDouble(start), MediaTime::createWithDouble(end), content);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -87,12 +88,10 @@</span>
          return adoptRef(*new VTTCue(context, start, end, content));
      }
  
      static Ref&lt;VTTCue&gt; create(ScriptExecutionContext&amp;, const WebVTTCueData&amp;);
  
<span class="udiff-line-removed">-     static const AtomString&amp; cueBackdropShadowPseudoId();</span>
<span class="udiff-line-removed">- </span>
      virtual ~VTTCue();
  
      enum AutoKeyword {
          Auto
      };
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -121,25 +120,25 @@</span>
      void setText(const String&amp;);
  
      const String&amp; cueSettings() const { return m_settings; }
      void setCueSettings(const String&amp;);
  
<span class="udiff-line-modified-removed">-     RefPtr&lt;DocumentFragment&gt; getCueAsHTML();</span>
<span class="udiff-line-modified-added">+     RefPtr&lt;DocumentFragment&gt; getCueAsHTML() final;</span>
      RefPtr&lt;DocumentFragment&gt; createCueRenderingTree();
  
      const String&amp; regionId() const { return m_regionId; }
      void setRegionId(const String&amp;);
      void notifyRegionWhenRemovingDisplayTree(bool);
  
      void setIsActive(bool) override;
  
      bool hasDisplayTree() const { return m_displayTree; }
<span class="udiff-line-modified-removed">-     VTTCueBox&amp; getDisplayTree(const IntSize&amp; videoSize, int fontSize);</span>
<span class="udiff-line-modified-added">+     RefPtr&lt;TextTrackCueBox&gt; getDisplayTree(const IntSize&amp;, int) final;</span>
      HTMLSpanElement&amp; element() const { return *m_cueHighlightBox; }
  
<span class="udiff-line-modified-removed">-     void updateDisplayTree(const MediaTime&amp;);</span>
<span class="udiff-line-modified-removed">-     void removeDisplayTree();</span>
<span class="udiff-line-modified-added">+     void updateDisplayTree(const MediaTime&amp;) final;</span>
<span class="udiff-line-modified-added">+     void removeDisplayTree() final;</span>
      void markFutureAndPastNodes(ContainerNode*, const MediaTime&amp;, const MediaTime&amp;);
  
      int calculateComputedLinePosition();
      std::pair&lt;double, double&gt; getPositionCoordinates() const;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -166,18 +165,19 @@</span>
          Right,
          NumberOfAlignments
      };
      CueAlignment getAlignment() const { return m_cueAlignment; }
  
<span class="udiff-line-modified-removed">-     virtual void setFontSize(int, const IntSize&amp;, bool important);</span>
<span class="udiff-line-modified-added">+     void recalculateStyles() final { m_displayTreeShouldChange = true; }</span>
<span class="udiff-line-added">+     void setFontSize(int, const IntSize&amp;, bool important) override;</span>
  
      bool isEqual(const TextTrackCue&amp;, CueMatchRules) const override;
      bool cueContentsMatch(const TextTrackCue&amp;) const override;
      bool doesExtendCue(const TextTrackCue&amp;) const override;
  
      CueType cueType() const override { return WebVTT; }
<span class="udiff-line-modified-removed">-     bool isRenderable() const final { return true; }</span>
<span class="udiff-line-modified-added">+     bool isRenderable() const final { return !m_content.isEmpty(); }</span>
  
      void didChange() override;
  
      String toJSONString() const;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -235,10 +235,13 @@</span>
      int m_displaySize;
      std::pair&lt;float, float&gt; m_displayPosition;
  
      MediaTime m_originalStartTime;
  
<span class="udiff-line-added">+     int m_fontSize { 0 };</span>
<span class="udiff-line-added">+     bool m_fontSizeIsImportant { false };</span>
<span class="udiff-line-added">+ </span>
      bool m_snapToLines : 1;
      bool m_displayTreeShouldChange : 1;
      bool m_notifyRegion : 1;
  };
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -247,23 +250,22 @@</span>
  
  } // namespace WebCore
  
  namespace WTF {
  
<span class="udiff-line-modified-removed">- template&lt;typename Type&gt;</span>
<span class="udiff-line-removed">- struct LogArgument;</span>
<span class="udiff-line-modified-added">+ template&lt;typename&gt; struct LogArgument;</span>
  
<span class="udiff-line-modified-removed">- template &lt;&gt;</span>
<span class="udiff-line-modified-removed">- struct LogArgument&lt;WebCore::VTTCue&gt; {</span>
<span class="udiff-line-removed">-     static String toString(const WebCore::VTTCue&amp; cue)</span>
<span class="udiff-line-removed">-     {</span>
<span class="udiff-line-removed">-         return cue.toJSONString();</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-modified-added">+ template&lt;&gt; struct LogArgument&lt;WebCore::VTTCue&gt; {</span>
<span class="udiff-line-modified-added">+     static String toString(const WebCore::VTTCue&amp; cue) { return cue.toJSONString(); }</span>
  };
  
  } // namespace WTF
  
<span class="udiff-line-added">+ // FIXME: The following isType function is incorrect, since it returns true for TextTrackCueGeneric.</span>
<span class="udiff-line-added">+ // Should fix this so that is&lt;VTTCue&gt; and downcast&lt;VTTCue&gt; will work correctly and eliminate toVTTCue</span>
<span class="udiff-line-added">+ // since it&#39;s just another name for downcast&lt;VTTCue&gt;.</span>
<span class="udiff-line-added">+ </span>
  SPECIALIZE_TYPE_TRAITS_BEGIN(WebCore::VTTCue)
<span class="udiff-line-modified-removed">-     static bool isType(const WebCore::TextTrackCue&amp; cue) { return cue.isRenderable(); }</span>
<span class="udiff-line-modified-added">+ static bool isType(const WebCore::TextTrackCue&amp; cue) { return cue.cueType() == WebCore::TextTrackCue::WebVTT; }</span>
  SPECIALIZE_TYPE_TRAITS_END()
  
  #endif
</pre>
<center><a href="VTTCue.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="VTTRegion.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>