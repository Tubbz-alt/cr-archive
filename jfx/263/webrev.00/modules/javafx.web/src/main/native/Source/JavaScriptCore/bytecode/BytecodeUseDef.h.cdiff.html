<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/BytecodeUseDef.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="BytecodeRewriter.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CallLinkInfo.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/bytecode/BytecodeUseDef.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 30,454 ***</span>
  #include &quot;Instruction.h&quot;
  #include &lt;wtf/Forward.h&gt;
  
  namespace JSC {
  
<span class="line-modified">! #define CALL_FUNCTOR(__arg) \</span>
<span class="line-modified">!     functor(__bytecode.m_##__arg);</span>
  
<span class="line-modified">! #define USES_OR_DEFS(__opcode, ...) \</span>
<span class="line-modified">!     case __opcode::opcodeID: { \</span>
<span class="line-removed">-         auto __bytecode = instruction-&gt;as&lt;__opcode&gt;(); \</span>
<span class="line-removed">-         WTF_LAZY_FOR_EACH_TERM(CALL_FUNCTOR, __VA_ARGS__) \</span>
<span class="line-removed">-         return; \</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">- #define USES USES_OR_DEFS</span>
<span class="line-removed">- #define DEFS USES_OR_DEFS</span>
<span class="line-removed">- </span>
<span class="line-removed">- template&lt;typename Block, typename Functor&gt;</span>
<span class="line-removed">- void computeUsesForBytecodeOffset(Block* codeBlock, OpcodeID opcodeID, const Instruction* instruction, const Functor&amp; functor)</span>
  {
      if (opcodeID != op_enter &amp;&amp; (codeBlock-&gt;wasCompiledWithDebuggingOpcodes() || codeBlock-&gt;usesEval()) &amp;&amp; codeBlock-&gt;scopeRegister().isValid())
          functor(codeBlock-&gt;scopeRegister());
  
<span class="line-modified">!     auto handleNewArrayLike = [&amp;](auto op) {</span>
<span class="line-removed">-         int base = op.m_argv.offset();</span>
<span class="line-removed">-         for (int i = 0; i &lt; static_cast&lt;int&gt;(op.m_argc); i++)</span>
<span class="line-removed">-             functor(VirtualRegister { base - i });</span>
<span class="line-removed">-     };</span>
<span class="line-removed">- </span>
<span class="line-removed">-     auto handleOpCallLike = [&amp;](auto op) {</span>
<span class="line-removed">-         functor(op.m_callee);</span>
<span class="line-removed">-         int lastArg = -static_cast&lt;int&gt;(op.m_argv) + CallFrame::thisArgumentOffset();</span>
<span class="line-removed">-         for (int i = 0; i &lt; static_cast&lt;int&gt;(op.m_argc); i++)</span>
<span class="line-removed">-             functor(VirtualRegister { lastArg + i });</span>
<span class="line-removed">-         if (opcodeID == op_call_eval)</span>
<span class="line-removed">-             functor(codeBlock-&gt;scopeRegister());</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">-     };</span>
<span class="line-removed">- </span>
<span class="line-removed">-     switch (opcodeID) {</span>
<span class="line-removed">-     case op_wide16:</span>
<span class="line-removed">-     case op_wide32:</span>
<span class="line-removed">-         RELEASE_ASSERT_NOT_REACHED();</span>
<span class="line-removed">- </span>
<span class="line-removed">-     // No uses.</span>
<span class="line-removed">-     case op_new_regexp:</span>
<span class="line-removed">-     case op_debug:</span>
<span class="line-removed">-     case op_jneq_ptr:</span>
<span class="line-removed">-     case op_loop_hint:</span>
<span class="line-removed">-     case op_jmp:</span>
<span class="line-removed">-     case op_new_object:</span>
<span class="line-removed">-     case op_enter:</span>
<span class="line-removed">-     case op_argument_count:</span>
<span class="line-removed">-     case op_catch:</span>
<span class="line-removed">-     case op_profile_control_flow:</span>
<span class="line-removed">-     case op_create_direct_arguments:</span>
<span class="line-removed">-     case op_create_cloned_arguments:</span>
<span class="line-removed">-     case op_get_rest_length:</span>
<span class="line-removed">-     case op_get_argument:</span>
<span class="line-removed">-     case op_nop:</span>
<span class="line-removed">-     case op_unreachable:</span>
<span class="line-removed">-     case op_super_sampler_begin:</span>
<span class="line-removed">-     case op_super_sampler_end:</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpGetScope, dst)</span>
<span class="line-removed">-     USES(OpToThis, srcDst)</span>
<span class="line-removed">-     USES(OpCheckTdz, targetVirtualRegister)</span>
<span class="line-removed">-     USES(OpIdentityWithProfile, srcDst)</span>
<span class="line-removed">-     USES(OpProfileType, targetVirtualRegister);</span>
<span class="line-removed">-     USES(OpThrow, value)</span>
<span class="line-removed">-     USES(OpThrowStaticError, message)</span>
<span class="line-removed">-     USES(OpEnd, value)</span>
<span class="line-removed">-     USES(OpRet, value)</span>
<span class="line-removed">-     USES(OpJtrue, condition)</span>
<span class="line-removed">-     USES(OpJfalse, condition)</span>
<span class="line-removed">-     USES(OpJeqNull, value)</span>
<span class="line-removed">-     USES(OpJneqNull, value)</span>
<span class="line-removed">-     USES(OpJundefinedOrNull, value)</span>
<span class="line-removed">-     USES(OpJnundefinedOrNull, value)</span>
<span class="line-removed">-     USES(OpDec, srcDst)</span>
<span class="line-removed">-     USES(OpInc, srcDst)</span>
<span class="line-removed">-     USES(OpLogShadowChickenPrologue, scope)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpJless, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJlesseq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJgreater, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJgreatereq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJnless, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJnlesseq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJngreater, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJngreatereq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJeq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJneq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJstricteq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJnstricteq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJbelow, lhs, rhs)</span>
<span class="line-removed">-     USES(OpJbeloweq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpSetFunctionName, function, name)</span>
<span class="line-removed">-     USES(OpLogShadowChickenTail, thisValue, scope)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpPutByVal, base, property, value)</span>
<span class="line-removed">-     USES(OpPutByValDirect, base, property, value)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpPutById, base, value)</span>
<span class="line-removed">-     USES(OpPutToScope, scope, value)</span>
<span class="line-removed">-     USES(OpPutToArguments, arguments, value)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpPutByIdWithThis, base, thisValue, value)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpPutByValWithThis, base, thisValue, property, value)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpPutGetterById, base, accessor)</span>
<span class="line-removed">-     USES(OpPutSetterById, base, accessor)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpPutGetterSetterById, base, getter, setter)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpPutGetterByVal, base, property, accessor)</span>
<span class="line-removed">-     USES(OpPutSetterByVal, base, property, accessor)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpDefineDataProperty, base, property, value, attributes)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpDefineAccessorProperty, base, property, getter, setter, attributes)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpSpread, argument)</span>
<span class="line-removed">-     USES(OpGetPropertyEnumerator, base)</span>
<span class="line-removed">-     USES(OpGetEnumerableLength, base)</span>
<span class="line-removed">-     USES(OpNewFuncExp, scope)</span>
<span class="line-removed">-     USES(OpNewGeneratorFuncExp, scope)</span>
<span class="line-removed">-     USES(OpNewAsyncFuncExp, scope)</span>
<span class="line-removed">-     USES(OpToIndexString, index)</span>
<span class="line-removed">-     USES(OpCreateLexicalEnvironment, scope, symbolTable, initialValue)</span>
<span class="line-removed">-     USES(OpCreateGeneratorFrameEnvironment, scope, symbolTable, initialValue)</span>
<span class="line-removed">-     USES(OpResolveScope, scope)</span>
<span class="line-removed">-     USES(OpResolveScopeForHoistingFuncDeclInEval, scope)</span>
<span class="line-removed">-     USES(OpGetFromScope, scope)</span>
<span class="line-removed">-     USES(OpToPrimitive, src)</span>
<span class="line-removed">-     USES(OpTryGetById, base)</span>
<span class="line-removed">-     USES(OpGetById, base)</span>
<span class="line-removed">-     USES(OpGetByIdDirect, base)</span>
<span class="line-removed">-     USES(OpInById, base)</span>
<span class="line-removed">-     USES(OpTypeof, value)</span>
<span class="line-removed">-     USES(OpIsEmpty, operand)</span>
<span class="line-removed">-     USES(OpIsUndefined, operand)</span>
<span class="line-removed">-     USES(OpIsUndefinedOrNull, operand)</span>
<span class="line-removed">-     USES(OpIsBoolean, operand)</span>
<span class="line-removed">-     USES(OpIsNumber, operand)</span>
<span class="line-removed">-     USES(OpIsObject, operand)</span>
<span class="line-removed">-     USES(OpIsObjectOrNull, operand)</span>
<span class="line-removed">-     USES(OpIsCellWithType, operand)</span>
<span class="line-removed">-     USES(OpIsFunction, operand)</span>
<span class="line-removed">-     USES(OpToNumber, operand)</span>
<span class="line-removed">-     USES(OpToString, operand)</span>
<span class="line-removed">-     USES(OpToObject, operand)</span>
<span class="line-removed">-     USES(OpNegate, operand)</span>
<span class="line-removed">-     USES(OpBitnot, operand)</span>
<span class="line-removed">-     USES(OpEqNull, operand)</span>
<span class="line-removed">-     USES(OpNeqNull, operand)</span>
<span class="line-removed">-     USES(OpNot, operand)</span>
<span class="line-removed">-     USES(OpUnsigned, operand)</span>
<span class="line-removed">-     USES(OpMov, src)</span>
<span class="line-removed">-     USES(OpNewArrayWithSize, length)</span>
<span class="line-removed">-     USES(OpCreateThis, callee)</span>
<span class="line-removed">-     USES(OpDelById, base)</span>
<span class="line-removed">-     USES(OpNewFunc, scope)</span>
<span class="line-removed">-     USES(OpNewAsyncGeneratorFunc, scope)</span>
<span class="line-removed">-     USES(OpNewAsyncGeneratorFuncExp, scope)</span>
<span class="line-removed">-     USES(OpNewGeneratorFunc, scope)</span>
<span class="line-removed">-     USES(OpNewAsyncFunc, scope)</span>
<span class="line-removed">-     USES(OpGetParentScope, scope)</span>
<span class="line-removed">-     USES(OpCreateScopedArguments, scope)</span>
<span class="line-removed">-     USES(OpCreateRest, arraySize)</span>
<span class="line-removed">-     USES(OpGetFromArguments, arguments)</span>
<span class="line-removed">-     USES(OpNewArrayBuffer, immutableButterfly)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpHasGenericProperty, base, property)</span>
<span class="line-removed">-     USES(OpHasIndexedProperty, base, property)</span>
<span class="line-removed">-     USES(OpEnumeratorStructurePname, enumerator, index)</span>
<span class="line-removed">-     USES(OpEnumeratorGenericPname, enumerator, index)</span>
<span class="line-removed">-     USES(OpGetByVal, base, property)</span>
<span class="line-removed">-     USES(OpInByVal, base, property)</span>
<span class="line-removed">-     USES(OpOverridesHasInstance, constructor, hasInstanceValue)</span>
<span class="line-removed">-     USES(OpInstanceof, value, prototype)</span>
<span class="line-removed">-     USES(OpAdd, lhs, rhs)</span>
<span class="line-removed">-     USES(OpMul, lhs, rhs)</span>
<span class="line-removed">-     USES(OpDiv, lhs, rhs)</span>
<span class="line-removed">-     USES(OpMod, lhs, rhs)</span>
<span class="line-removed">-     USES(OpSub, lhs, rhs)</span>
<span class="line-removed">-     USES(OpPow, lhs, rhs)</span>
<span class="line-removed">-     USES(OpLshift, lhs, rhs)</span>
<span class="line-removed">-     USES(OpRshift, lhs, rhs)</span>
<span class="line-removed">-     USES(OpUrshift, lhs, rhs)</span>
<span class="line-removed">-     USES(OpBitand, lhs, rhs)</span>
<span class="line-removed">-     USES(OpBitxor, lhs, rhs)</span>
<span class="line-removed">-     USES(OpBitor, lhs, rhs)</span>
<span class="line-removed">-     USES(OpLess, lhs, rhs)</span>
<span class="line-removed">-     USES(OpLesseq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpGreater, lhs, rhs)</span>
<span class="line-removed">-     USES(OpGreatereq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpBelow, lhs, rhs)</span>
<span class="line-removed">-     USES(OpBeloweq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpNstricteq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpStricteq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpNeq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpEq, lhs, rhs)</span>
<span class="line-removed">-     USES(OpPushWithScope, currentScope, newScope)</span>
<span class="line-removed">-     USES(OpGetByIdWithThis, base, thisValue)</span>
<span class="line-removed">-     USES(OpDelByVal, base, property)</span>
<span class="line-removed">-     USES(OpTailCallForwardArguments, callee, thisValue)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpGetByValWithThis, base, thisValue, property)</span>
<span class="line-removed">-     USES(OpInstanceofCustom, value, constructor, hasInstanceValue)</span>
<span class="line-removed">-     USES(OpHasStructureProperty, base, property, enumerator)</span>
<span class="line-removed">-     USES(OpConstructVarargs, callee, thisValue, arguments)</span>
<span class="line-removed">-     USES(OpCallVarargs, callee, thisValue, arguments)</span>
<span class="line-removed">-     USES(OpTailCallVarargs, callee, thisValue, arguments)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpGetDirectPname, base, property, index, enumerator)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpSwitchString, scrutinee)</span>
<span class="line-removed">-     USES(OpSwitchChar, scrutinee)</span>
<span class="line-removed">-     USES(OpSwitchImm, scrutinee)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     USES(OpYield, generator, argument)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     case op_new_array_with_spread:</span>
<span class="line-removed">-         handleNewArrayLike(instruction-&gt;as&lt;OpNewArrayWithSpread&gt;());</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">-     case op_new_array:</span>
<span class="line-removed">-         handleNewArrayLike(instruction-&gt;as&lt;OpNewArray&gt;());</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     case op_strcat: {</span>
<span class="line-removed">-         auto bytecode = instruction-&gt;as&lt;OpStrcat&gt;();</span>
<span class="line-removed">-         int base = bytecode.m_src.offset();</span>
<span class="line-removed">-         for (int i = 0; i &lt; bytecode.m_count; i++)</span>
<span class="line-removed">-             functor(VirtualRegister { base - i });</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     case op_construct:</span>
<span class="line-removed">-         handleOpCallLike(instruction-&gt;as&lt;OpConstruct&gt;());</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">-     case op_call_eval:</span>
<span class="line-removed">-         handleOpCallLike(instruction-&gt;as&lt;OpCallEval&gt;());</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">-     case op_call:</span>
<span class="line-removed">-         handleOpCallLike(instruction-&gt;as&lt;OpCall&gt;());</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">-     case op_tail_call:</span>
<span class="line-removed">-         handleOpCallLike(instruction-&gt;as&lt;OpTailCall&gt;());</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     default:</span>
<span class="line-removed">-         RELEASE_ASSERT_NOT_REACHED();</span>
<span class="line-removed">-         break;</span>
<span class="line-removed">-     }</span>
  }
  
<span class="line-modified">! template&lt;typename Block, typename Functor&gt;</span>
<span class="line-modified">! void computeDefsForBytecodeOffset(Block* codeBlock, OpcodeID opcodeID, const Instruction* instruction, const Functor&amp; functor)</span>
  {
<span class="line-modified">!     switch (opcodeID) {</span>
<span class="line-removed">-     case op_wide16:</span>
<span class="line-removed">-     case op_wide32:</span>
<span class="line-removed">-         RELEASE_ASSERT_NOT_REACHED();</span>
<span class="line-removed">- </span>
<span class="line-removed">-     // These don&#39;t define anything.</span>
<span class="line-removed">-     case op_put_to_scope:</span>
<span class="line-removed">-     case op_end:</span>
<span class="line-removed">-     case op_throw:</span>
<span class="line-removed">-     case op_throw_static_error:</span>
<span class="line-removed">-     case op_check_tdz:</span>
<span class="line-removed">-     case op_debug:</span>
<span class="line-removed">-     case op_ret:</span>
<span class="line-removed">-     case op_jmp:</span>
<span class="line-removed">-     case op_jtrue:</span>
<span class="line-removed">-     case op_jfalse:</span>
<span class="line-removed">-     case op_jeq_null:</span>
<span class="line-removed">-     case op_jneq_null:</span>
<span class="line-removed">-     case op_jundefined_or_null:</span>
<span class="line-removed">-     case op_jnundefined_or_null:</span>
<span class="line-removed">-     case op_jneq_ptr:</span>
<span class="line-removed">-     case op_jless:</span>
<span class="line-removed">-     case op_jlesseq:</span>
<span class="line-removed">-     case op_jgreater:</span>
<span class="line-removed">-     case op_jgreatereq:</span>
<span class="line-removed">-     case op_jnless:</span>
<span class="line-removed">-     case op_jnlesseq:</span>
<span class="line-removed">-     case op_jngreater:</span>
<span class="line-removed">-     case op_jngreatereq:</span>
<span class="line-removed">-     case op_jeq:</span>
<span class="line-removed">-     case op_jneq:</span>
<span class="line-removed">-     case op_jstricteq:</span>
<span class="line-removed">-     case op_jnstricteq:</span>
<span class="line-removed">-     case op_jbelow:</span>
<span class="line-removed">-     case op_jbeloweq:</span>
<span class="line-removed">-     case op_loop_hint:</span>
<span class="line-removed">-     case op_switch_imm:</span>
<span class="line-removed">-     case op_switch_char:</span>
<span class="line-removed">-     case op_switch_string:</span>
<span class="line-removed">-     case op_put_by_id:</span>
<span class="line-removed">-     case op_put_by_id_with_this:</span>
<span class="line-removed">-     case op_put_by_val_with_this:</span>
<span class="line-removed">-     case op_put_getter_by_id:</span>
<span class="line-removed">-     case op_put_setter_by_id:</span>
<span class="line-removed">-     case op_put_getter_setter_by_id:</span>
<span class="line-removed">-     case op_put_getter_by_val:</span>
<span class="line-removed">-     case op_put_setter_by_val:</span>
<span class="line-removed">-     case op_put_by_val:</span>
<span class="line-removed">-     case op_put_by_val_direct:</span>
<span class="line-removed">-     case op_define_data_property:</span>
<span class="line-removed">-     case op_define_accessor_property:</span>
<span class="line-removed">-     case op_profile_type:</span>
<span class="line-removed">-     case op_profile_control_flow:</span>
<span class="line-removed">-     case op_put_to_arguments:</span>
<span class="line-removed">-     case op_set_function_name:</span>
<span class="line-removed">-     case op_log_shadow_chicken_prologue:</span>
<span class="line-removed">-     case op_log_shadow_chicken_tail:</span>
<span class="line-removed">-     case op_yield:</span>
<span class="line-removed">-     case op_nop:</span>
<span class="line-removed">-     case op_unreachable:</span>
<span class="line-removed">-     case op_super_sampler_begin:</span>
<span class="line-removed">-     case op_super_sampler_end:</span>
<span class="line-removed">- #define LLINT_HELPER_OPCODES(opcode, length) case opcode:</span>
<span class="line-removed">-         FOR_EACH_LLINT_OPCODE_EXTENSION(LLINT_HELPER_OPCODES);</span>
<span class="line-removed">- #undef LLINT_HELPER_OPCODES</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">-     // These all have a single destination for the first argument.</span>
<span class="line-removed">-     DEFS(OpArgumentCount, dst)</span>
<span class="line-removed">-     DEFS(OpToIndexString, dst)</span>
<span class="line-removed">-     DEFS(OpGetEnumerableLength, dst)</span>
<span class="line-removed">-     DEFS(OpHasIndexedProperty, dst)</span>
<span class="line-removed">-     DEFS(OpHasStructureProperty, dst)</span>
<span class="line-removed">-     DEFS(OpHasGenericProperty, dst)</span>
<span class="line-removed">-     DEFS(OpGetDirectPname, dst)</span>
<span class="line-removed">-     DEFS(OpGetPropertyEnumerator, dst)</span>
<span class="line-removed">-     DEFS(OpEnumeratorStructurePname, dst)</span>
<span class="line-removed">-     DEFS(OpEnumeratorGenericPname, dst)</span>
<span class="line-removed">-     DEFS(OpGetParentScope, dst)</span>
<span class="line-removed">-     DEFS(OpPushWithScope, dst)</span>
<span class="line-removed">-     DEFS(OpCreateLexicalEnvironment, dst)</span>
<span class="line-removed">-     DEFS(OpCreateGeneratorFrameEnvironment, dst)</span>
<span class="line-removed">-     DEFS(OpResolveScope, dst)</span>
<span class="line-removed">-     DEFS(OpResolveScopeForHoistingFuncDeclInEval, dst)</span>
<span class="line-removed">-     DEFS(OpStrcat, dst)</span>
<span class="line-removed">-     DEFS(OpToPrimitive, dst)</span>
<span class="line-removed">-     DEFS(OpCreateThis, dst)</span>
<span class="line-removed">-     DEFS(OpNewArray, dst)</span>
<span class="line-removed">-     DEFS(OpNewArrayWithSpread, dst)</span>
<span class="line-removed">-     DEFS(OpSpread, dst)</span>
<span class="line-removed">-     DEFS(OpNewArrayBuffer, dst)</span>
<span class="line-removed">-     DEFS(OpNewArrayWithSize, dst)</span>
<span class="line-removed">-     DEFS(OpNewRegexp, dst)</span>
<span class="line-removed">-     DEFS(OpNewFunc, dst)</span>
<span class="line-removed">-     DEFS(OpNewFuncExp, dst)</span>
<span class="line-removed">-     DEFS(OpNewGeneratorFunc, dst)</span>
<span class="line-removed">-     DEFS(OpNewGeneratorFuncExp, dst)</span>
<span class="line-removed">-     DEFS(OpNewAsyncGeneratorFunc, dst)</span>
<span class="line-removed">-     DEFS(OpNewAsyncGeneratorFuncExp, dst)</span>
<span class="line-removed">-     DEFS(OpNewAsyncFunc, dst)</span>
<span class="line-removed">-     DEFS(OpNewAsyncFuncExp, dst)</span>
<span class="line-removed">-     DEFS(OpCallVarargs, dst)</span>
<span class="line-removed">-     DEFS(OpTailCallVarargs, dst)</span>
<span class="line-removed">-     DEFS(OpTailCallForwardArguments, dst)</span>
<span class="line-removed">-     DEFS(OpConstructVarargs, dst)</span>
<span class="line-removed">-     DEFS(OpGetFromScope, dst)</span>
<span class="line-removed">-     DEFS(OpCall, dst)</span>
<span class="line-removed">-     DEFS(OpTailCall, dst)</span>
<span class="line-removed">-     DEFS(OpCallEval, dst)</span>
<span class="line-removed">-     DEFS(OpConstruct, dst)</span>
<span class="line-removed">-     DEFS(OpTryGetById, dst)</span>
<span class="line-removed">-     DEFS(OpGetById, dst)</span>
<span class="line-removed">-     DEFS(OpGetByIdDirect, dst)</span>
<span class="line-removed">-     DEFS(OpGetByIdWithThis, dst)</span>
<span class="line-removed">-     DEFS(OpGetByValWithThis, dst)</span>
<span class="line-removed">-     DEFS(OpOverridesHasInstance, dst)</span>
<span class="line-removed">-     DEFS(OpInstanceof, dst)</span>
<span class="line-removed">-     DEFS(OpInstanceofCustom, dst)</span>
<span class="line-removed">-     DEFS(OpGetByVal, dst)</span>
<span class="line-removed">-     DEFS(OpTypeof, dst)</span>
<span class="line-removed">-     DEFS(OpIdentityWithProfile, srcDst)</span>
<span class="line-removed">-     DEFS(OpIsEmpty, dst)</span>
<span class="line-removed">-     DEFS(OpIsUndefined, dst)</span>
<span class="line-removed">-     USES(OpIsUndefinedOrNull, dst)</span>
<span class="line-removed">-     DEFS(OpIsBoolean, dst)</span>
<span class="line-removed">-     DEFS(OpIsNumber, dst)</span>
<span class="line-removed">-     DEFS(OpIsObject, dst)</span>
<span class="line-removed">-     DEFS(OpIsObjectOrNull, dst)</span>
<span class="line-removed">-     DEFS(OpIsCellWithType, dst)</span>
<span class="line-removed">-     DEFS(OpIsFunction, dst)</span>
<span class="line-removed">-     DEFS(OpInById, dst)</span>
<span class="line-removed">-     DEFS(OpInByVal, dst)</span>
<span class="line-removed">-     DEFS(OpToNumber, dst)</span>
<span class="line-removed">-     DEFS(OpToString, dst)</span>
<span class="line-removed">-     DEFS(OpToObject, dst)</span>
<span class="line-removed">-     DEFS(OpNegate, dst)</span>
<span class="line-removed">-     DEFS(OpAdd, dst)</span>
<span class="line-removed">-     DEFS(OpMul, dst)</span>
<span class="line-removed">-     DEFS(OpDiv, dst)</span>
<span class="line-removed">-     DEFS(OpMod, dst)</span>
<span class="line-removed">-     DEFS(OpSub, dst)</span>
<span class="line-removed">-     DEFS(OpPow, dst)</span>
<span class="line-removed">-     DEFS(OpLshift, dst)</span>
<span class="line-removed">-     DEFS(OpRshift, dst)</span>
<span class="line-removed">-     DEFS(OpUrshift, dst)</span>
<span class="line-removed">-     DEFS(OpBitand, dst)</span>
<span class="line-removed">-     DEFS(OpBitxor, dst)</span>
<span class="line-removed">-     DEFS(OpBitor, dst)</span>
<span class="line-removed">-     DEFS(OpBitnot, dst)</span>
<span class="line-removed">-     DEFS(OpInc, srcDst)</span>
<span class="line-removed">-     DEFS(OpDec, srcDst)</span>
<span class="line-removed">-     DEFS(OpEq, dst)</span>
<span class="line-removed">-     DEFS(OpNeq, dst)</span>
<span class="line-removed">-     DEFS(OpStricteq, dst)</span>
<span class="line-removed">-     DEFS(OpNstricteq, dst)</span>
<span class="line-removed">-     DEFS(OpLess, dst)</span>
<span class="line-removed">-     DEFS(OpLesseq, dst)</span>
<span class="line-removed">-     DEFS(OpGreater, dst)</span>
<span class="line-removed">-     DEFS(OpGreatereq, dst)</span>
<span class="line-removed">-     DEFS(OpBelow, dst)</span>
<span class="line-removed">-     DEFS(OpBeloweq, dst)</span>
<span class="line-removed">-     DEFS(OpNeqNull, dst)</span>
<span class="line-removed">-     DEFS(OpEqNull, dst)</span>
<span class="line-removed">-     DEFS(OpNot, dst)</span>
<span class="line-removed">-     DEFS(OpMov, dst)</span>
<span class="line-removed">-     DEFS(OpNewObject, dst)</span>
<span class="line-removed">-     DEFS(OpToThis, srcDst)</span>
<span class="line-removed">-     DEFS(OpGetScope, dst)</span>
<span class="line-removed">-     DEFS(OpCreateDirectArguments, dst)</span>
<span class="line-removed">-     DEFS(OpCreateScopedArguments, dst)</span>
<span class="line-removed">-     DEFS(OpCreateClonedArguments, dst)</span>
<span class="line-removed">-     DEFS(OpDelById, dst)</span>
<span class="line-removed">-     DEFS(OpDelByVal, dst)</span>
<span class="line-removed">-     DEFS(OpUnsigned, dst)</span>
<span class="line-removed">-     DEFS(OpGetFromArguments, dst)</span>
<span class="line-removed">-     DEFS(OpGetArgument, dst)</span>
<span class="line-removed">-     DEFS(OpCreateRest, dst)</span>
<span class="line-removed">-     DEFS(OpGetRestLength, dst)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     DEFS(OpCatch, exception, thrownValue)</span>
<span class="line-removed">- </span>
<span class="line-removed">-     case op_enter: {</span>
<span class="line-removed">-         for (unsigned i = codeBlock-&gt;numVars(); i--;)</span>
<span class="line-removed">-             functor(virtualRegisterForLocal(i));</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-     }</span>
  }
  
  #undef CALL_FUNCTOR
  #undef USES_OR_DEFS
  #undef USES
<span class="line-new-header">--- 30,27 ---</span>
  #include &quot;Instruction.h&quot;
  #include &lt;wtf/Forward.h&gt;
  
  namespace JSC {
  
<span class="line-modified">! void computeUsesForBytecodeIndexImpl(VirtualRegister, const Instruction*, const Function&lt;void(VirtualRegister)&gt;&amp;);</span>
<span class="line-modified">! void computeDefsForBytecodeIndexImpl(unsigned, const Instruction*, const Function&lt;void(VirtualRegister)&gt;&amp;);</span>
  
<span class="line-modified">! template&lt;typename Block&gt;</span>
<span class="line-modified">! void computeUsesForBytecodeIndex(Block* codeBlock, const Instruction* instruction, const Function&lt;void(VirtualRegister)&gt;&amp; functor)</span>
  {
<span class="line-added">+     OpcodeID opcodeID = instruction-&gt;opcodeID();</span>
      if (opcodeID != op_enter &amp;&amp; (codeBlock-&gt;wasCompiledWithDebuggingOpcodes() || codeBlock-&gt;usesEval()) &amp;&amp; codeBlock-&gt;scopeRegister().isValid())
          functor(codeBlock-&gt;scopeRegister());
  
<span class="line-modified">!     computeUsesForBytecodeIndexImpl(codeBlock-&gt;scopeRegister(), instruction, functor);</span>
  }
  
<span class="line-modified">! template&lt;typename Block&gt;</span>
<span class="line-modified">! void computeDefsForBytecodeIndex(Block* codeBlock, const Instruction* instruction, const Function&lt;void(VirtualRegister)&gt;&amp; functor)</span>
  {
<span class="line-modified">!     computeDefsForBytecodeIndexImpl(codeBlock-&gt;numVars(), instruction, functor);</span>
  }
  
  #undef CALL_FUNCTOR
  #undef USES_OR_DEFS
  #undef USES
</pre>
<center><a href="BytecodeRewriter.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CallLinkInfo.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>