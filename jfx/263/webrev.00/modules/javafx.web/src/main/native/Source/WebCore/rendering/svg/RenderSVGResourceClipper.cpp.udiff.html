<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/rendering/svg/RenderSVGResourceClipper.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="RenderSVGRect.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RenderSVGResourceFilter.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/rendering/svg/RenderSVGResourceClipper.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -74,11 +74,11 @@</span>
  }
  
  bool RenderSVGResourceClipper::pathOnlyClipping(GraphicsContext&amp; context, const AffineTransform&amp; animatedLocalTransform, const FloatRect&amp; objectBoundingBox)
  {
      // If the current clip-path gets clipped itself, we have to fallback to masking.
<span class="udiff-line-modified-removed">-     if (!style().svgStyle().clipperResource().isEmpty())</span>
<span class="udiff-line-modified-added">+     if (style().clipPath())</span>
          return false;
      WindRule clipRule = WindRule::NonZero;
      Path clipPath = Path();
  
      // If clip-path only contains one visible shape or path, we can use path-based clipping. Invisible
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -99,11 +99,11 @@</span>
          const RenderStyle&amp; style = renderer-&gt;style();
          if (style.display() == DisplayType::None || style.visibility() != Visibility::Visible)
               continue;
          const SVGRenderStyle&amp; svgStyle = style.svgStyle();
          // Current shape in clip-path gets clipped too. Fallback to masking.
<span class="udiff-line-modified-removed">-         if (!svgStyle.clipperResource().isEmpty())</span>
<span class="udiff-line-modified-added">+         if (style.clipPath())</span>
              return false;
          // Fallback to masking, if there is more than one clipping path.
          if (clipPath.isEmpty()) {
              clipPath = styled.toClipPath();
              clipRule = svgStyle.clipRule();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -140,11 +140,11 @@</span>
  
      AffineTransform absoluteTransform = SVGRenderingContext::calculateTransformationToOutermostCoordinateSystem(renderer);
  
      if (shouldCreateClipperMaskImage &amp;&amp; !repaintRect.isEmpty()) {
          // FIXME (149469): This image buffer should not be unconditionally unaccelerated. Making it match the context breaks nested clipping, though.
<span class="udiff-line-modified-removed">-         clipperMaskImage = SVGRenderingContext::createImageBuffer(repaintRect, absoluteTransform, ColorSpaceSRGB, Unaccelerated, &amp;context);</span>
<span class="udiff-line-modified-added">+         clipperMaskImage = SVGRenderingContext::createImageBuffer(repaintRect, absoluteTransform, ColorSpace::SRGB, RenderingMode::Unaccelerated, &amp;context);</span>
          if (!clipperMaskImage)
              return false;
  
          GraphicsContext&amp; maskContext = clipperMaskImage-&gt;context();
          maskContext.concatCTM(animatedLocalTransform);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -277,10 +277,20 @@</span>
          RenderObject* renderer = childNode-&gt;renderer();
          if (!childNode-&gt;isSVGElement() || !renderer)
              continue;
          if (!renderer-&gt;isSVGShape() &amp;&amp; !renderer-&gt;isSVGText() &amp;&amp; !childNode-&gt;hasTagName(SVGNames::useTag))
              continue;
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         const RenderStyle&amp; style = renderer-&gt;style();</span>
<span class="udiff-line-added">+         if (is&lt;ReferenceClipPathOperation&gt;(style.clipPath())) {</span>
<span class="udiff-line-added">+             auto&amp; clipPath = downcast&lt;ReferenceClipPathOperation&gt;(*style.clipPath());</span>
<span class="udiff-line-added">+             AtomString id(clipPath.fragment());</span>
<span class="udiff-line-added">+             RenderSVGResourceClipper* clipper = getRenderSVGResourceById&lt;RenderSVGResourceClipper&gt;(document(), id);</span>
<span class="udiff-line-added">+             if (clipper == this)</span>
<span class="udiff-line-added">+                 continue;</span>
<span class="udiff-line-added">+         }</span>
<span class="udiff-line-added">+ </span>
          IntPoint hitPoint;
          HitTestResult result(hitPoint);
          if (renderer-&gt;nodeAtFloatPoint(HitTestRequest(HitTestRequest::SVGClipContent | HitTestRequest::DisallowUserAgentShadowContent), result, point, HitTestForeground))
              return true;
      }
</pre>
<center><a href="RenderSVGRect.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RenderSVGResourceFilter.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>