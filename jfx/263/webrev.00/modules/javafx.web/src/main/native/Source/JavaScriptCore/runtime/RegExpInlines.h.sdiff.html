<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/RegExpInlines.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="RegExpGlobalDataInlines.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="RegExpKey.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/RegExpInlines.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
124         return;
125 
126     if (m_state == ParseError)
127         return;
128 
129     compile(&amp;vm, charSize);
130 }
131 
132 template&lt;typename VectorType&gt;
133 ALWAYS_INLINE int RegExp::matchInline(VM&amp; vm, const String&amp; s, unsigned startOffset, VectorType&amp; ovector)
134 {
135 #if ENABLE(REGEXP_TRACING)
136     m_rtMatchCallCount++;
137     m_rtMatchTotalSubjectStringLen += (double)(s.length() - startOffset);
138 #endif
139 
140     compileIfNecessary(vm, s.is8Bit() ? Yarr::Char8 : Yarr::Char16);
141 
142     auto throwError = [&amp;] {
143         auto throwScope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">144         ExecState* exec = vm.topCallFrame;</span>
<span class="line-modified">145         throwScope.throwException(exec, errorToThrow(exec));</span>


146         if (!hasHardError(m_constructionErrorCode))
147             reset();
148         return -1;
149     };
150 
151     if (m_state == ParseError)
152         return throwError();
153 
154     int offsetVectorSize = (m_numSubpatterns + 1) * 2;
155     ovector.resize(offsetVectorSize);
156     int* offsetVector = ovector.data();
157 
158     int result;
159 #if ENABLE(YARR_JIT)
160     if (m_state == JITCode) {
161         {
162             ASSERT(m_regExpJITCode);
163             PatternContextBufferHolder patternContextBufferHolder(vm, m_regExpJITCode-&gt;usesPatternContextBuffer());
164 
165             if (s.is8Bit())
</pre>
<hr />
<pre>
252     if (hasMatchOnlyCodeFor(charSize))
253         return;
254 
255     if (m_state == ParseError)
256         return;
257 
258     compileMatchOnly(&amp;vm, charSize);
259 }
260 
261 ALWAYS_INLINE MatchResult RegExp::matchInline(VM&amp; vm, const String&amp; s, unsigned startOffset)
262 {
263 #if ENABLE(REGEXP_TRACING)
264     m_rtMatchOnlyCallCount++;
265     m_rtMatchOnlyTotalSubjectStringLen += (double)(s.length() - startOffset);
266 #endif
267 
268     compileIfNecessaryMatchOnly(vm, s.is8Bit() ? Yarr::Char8 : Yarr::Char16);
269 
270     auto throwError = [&amp;] {
271         auto throwScope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">272         ExecState* exec = vm.topCallFrame;</span>
<span class="line-modified">273         throwScope.throwException(exec, errorToThrow(exec));</span>


274         if (!hasHardError(m_constructionErrorCode))
275             reset();
276         return MatchResult::failed();
277     };
278 
279     if (m_state == ParseError)
280         return throwError();
281 
282 #if ENABLE(YARR_JIT)
283     MatchResult result;
284 
285     if (m_state == JITCode) {
286         {
287             ASSERT(m_regExpJITCode);
288             PatternContextBufferHolder patternContextBufferHolder(vm, m_regExpJITCode-&gt;usesPatternContextBuffer());
289             if (s.is8Bit())
290                 result = m_regExpJITCode-&gt;execute(s.characters8(), startOffset, s.length(), patternContextBufferHolder.buffer(), patternContextBufferHolder.size());
291             else
292                 result = m_regExpJITCode-&gt;execute(s.characters16(), startOffset, s.length(), patternContextBufferHolder.buffer(), patternContextBufferHolder.size());
293         }
</pre>
</td>
<td>
<hr />
<pre>
124         return;
125 
126     if (m_state == ParseError)
127         return;
128 
129     compile(&amp;vm, charSize);
130 }
131 
132 template&lt;typename VectorType&gt;
133 ALWAYS_INLINE int RegExp::matchInline(VM&amp; vm, const String&amp; s, unsigned startOffset, VectorType&amp; ovector)
134 {
135 #if ENABLE(REGEXP_TRACING)
136     m_rtMatchCallCount++;
137     m_rtMatchTotalSubjectStringLen += (double)(s.length() - startOffset);
138 #endif
139 
140     compileIfNecessary(vm, s.is8Bit() ? Yarr::Char8 : Yarr::Char16);
141 
142     auto throwError = [&amp;] {
143         auto throwScope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">144         // FIXME: Revisit JSGlobalObject.</span>
<span class="line-modified">145         // https://bugs.webkit.org/show_bug.cgi?id=203204</span>
<span class="line-added">146         JSGlobalObject* globalObject = vm.topCallFrame-&gt;lexicalGlobalObject(vm);</span>
<span class="line-added">147         throwScope.throwException(globalObject, errorToThrow(globalObject));</span>
148         if (!hasHardError(m_constructionErrorCode))
149             reset();
150         return -1;
151     };
152 
153     if (m_state == ParseError)
154         return throwError();
155 
156     int offsetVectorSize = (m_numSubpatterns + 1) * 2;
157     ovector.resize(offsetVectorSize);
158     int* offsetVector = ovector.data();
159 
160     int result;
161 #if ENABLE(YARR_JIT)
162     if (m_state == JITCode) {
163         {
164             ASSERT(m_regExpJITCode);
165             PatternContextBufferHolder patternContextBufferHolder(vm, m_regExpJITCode-&gt;usesPatternContextBuffer());
166 
167             if (s.is8Bit())
</pre>
<hr />
<pre>
254     if (hasMatchOnlyCodeFor(charSize))
255         return;
256 
257     if (m_state == ParseError)
258         return;
259 
260     compileMatchOnly(&amp;vm, charSize);
261 }
262 
263 ALWAYS_INLINE MatchResult RegExp::matchInline(VM&amp; vm, const String&amp; s, unsigned startOffset)
264 {
265 #if ENABLE(REGEXP_TRACING)
266     m_rtMatchOnlyCallCount++;
267     m_rtMatchOnlyTotalSubjectStringLen += (double)(s.length() - startOffset);
268 #endif
269 
270     compileIfNecessaryMatchOnly(vm, s.is8Bit() ? Yarr::Char8 : Yarr::Char16);
271 
272     auto throwError = [&amp;] {
273         auto throwScope = DECLARE_THROW_SCOPE(vm);
<span class="line-modified">274         // FIXME: Revisit JSGlobalObject.</span>
<span class="line-modified">275         // https://bugs.webkit.org/show_bug.cgi?id=203204</span>
<span class="line-added">276         JSGlobalObject* globalObject = vm.topCallFrame-&gt;lexicalGlobalObject(vm);</span>
<span class="line-added">277         throwScope.throwException(globalObject, errorToThrow(globalObject));</span>
278         if (!hasHardError(m_constructionErrorCode))
279             reset();
280         return MatchResult::failed();
281     };
282 
283     if (m_state == ParseError)
284         return throwError();
285 
286 #if ENABLE(YARR_JIT)
287     MatchResult result;
288 
289     if (m_state == JITCode) {
290         {
291             ASSERT(m_regExpJITCode);
292             PatternContextBufferHolder patternContextBufferHolder(vm, m_regExpJITCode-&gt;usesPatternContextBuffer());
293             if (s.is8Bit())
294                 result = m_regExpJITCode-&gt;execute(s.characters8(), startOffset, s.length(), patternContextBufferHolder.buffer(), patternContextBufferHolder.size());
295             else
296                 result = m_regExpJITCode-&gt;execute(s.characters16(), startOffset, s.length(), patternContextBufferHolder.buffer(), patternContextBufferHolder.size());
297         }
</pre>
</td>
</tr>
</table>
<center><a href="RegExpGlobalDataInlines.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="RegExpKey.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>