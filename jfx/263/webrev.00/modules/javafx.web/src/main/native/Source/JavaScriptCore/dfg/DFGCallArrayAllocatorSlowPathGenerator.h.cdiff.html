<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/dfg/DFGCallArrayAllocatorSlowPathGenerator.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DFGCSEPhase.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DFGCallCreateDirectArgumentsSlowPathGenerator.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/dfg/DFGCallArrayAllocatorSlowPathGenerator.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 34,11 ***</span>
  namespace JSC { namespace DFG {
  
  class CallArrayAllocatorSlowPathGenerator : public JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt; {
  public:
      CallArrayAllocatorSlowPathGenerator(
<span class="line-modified">!         MacroAssembler::JumpList from, SpeculativeJIT* jit, P_JITOperation_EStZB function,</span>
          GPRReg resultGPR, GPRReg storageGPR, RegisteredStructure structure, size_t size)
          : JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt;(from, jit)
          , m_function(function)
          , m_resultGPR(resultGPR)
          , m_storageGPR(storageGPR)
<span class="line-new-header">--- 34,11 ---</span>
  namespace JSC { namespace DFG {
  
  class CallArrayAllocatorSlowPathGenerator : public JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt; {
  public:
      CallArrayAllocatorSlowPathGenerator(
<span class="line-modified">!         MacroAssembler::JumpList from, SpeculativeJIT* jit, P_JITOperation_VmStZB function,</span>
          GPRReg resultGPR, GPRReg storageGPR, RegisteredStructure structure, size_t size)
          : JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt;(from, jit)
          , m_function(function)
          , m_resultGPR(resultGPR)
          , m_storageGPR(storageGPR)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 53,37 ***</span>
      void generateInternal(SpeculativeJIT* jit) override
      {
          linkFrom(jit);
          for (unsigned i = 0; i &lt; m_plans.size(); ++i)
              jit-&gt;silentSpill(m_plans[i]);
<span class="line-modified">!         jit-&gt;callOperation(m_function, m_resultGPR, m_structure, m_size, m_storageGPR);</span>
          for (unsigned i = m_plans.size(); i--;)
              jit-&gt;silentFill(m_plans[i]);
          jit-&gt;m_jit.exceptionCheck();
          jit-&gt;m_jit.loadPtr(MacroAssembler::Address(m_resultGPR, JSObject::butterflyOffset()), m_storageGPR);
          jumpTo(jit);
      }
  
  private:
<span class="line-modified">!     P_JITOperation_EStZB m_function;</span>
      GPRReg m_resultGPR;
      GPRReg m_storageGPR;
      int m_size;
      RegisteredStructure m_structure;
      Vector&lt;SilentRegisterSavePlan, 2&gt; m_plans;
  };
  
  class CallArrayAllocatorWithVariableSizeSlowPathGenerator : public JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt; {
  public:
      CallArrayAllocatorWithVariableSizeSlowPathGenerator(
<span class="line-modified">!         MacroAssembler::JumpList from, SpeculativeJIT* jit, P_JITOperation_EStZB function,</span>
<span class="line-modified">!         GPRReg resultGPR, RegisteredStructure contiguousStructure, RegisteredStructure arrayStorageStructure, GPRReg sizeGPR, GPRReg storageGPR)</span>
          : JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt;(from, jit)
          , m_function(function)
          , m_contiguousStructure(contiguousStructure)
          , m_arrayStorageOrContiguousStructure(arrayStorageStructure)
          , m_resultGPR(resultGPR)
          , m_sizeGPR(sizeGPR)
          , m_storageGPR(storageGPR)
      {
          jit-&gt;silentSpillAllRegistersImpl(false, m_plans, resultGPR);
      }
<span class="line-new-header">--- 53,38 ---</span>
      void generateInternal(SpeculativeJIT* jit) override
      {
          linkFrom(jit);
          for (unsigned i = 0; i &lt; m_plans.size(); ++i)
              jit-&gt;silentSpill(m_plans[i]);
<span class="line-modified">!         jit-&gt;callOperation(m_function, m_resultGPR, &amp;jit-&gt;vm(), m_structure, m_size, m_storageGPR);</span>
          for (unsigned i = m_plans.size(); i--;)
              jit-&gt;silentFill(m_plans[i]);
          jit-&gt;m_jit.exceptionCheck();
          jit-&gt;m_jit.loadPtr(MacroAssembler::Address(m_resultGPR, JSObject::butterflyOffset()), m_storageGPR);
          jumpTo(jit);
      }
  
  private:
<span class="line-modified">!     P_JITOperation_VmStZB m_function;</span>
      GPRReg m_resultGPR;
      GPRReg m_storageGPR;
      int m_size;
      RegisteredStructure m_structure;
      Vector&lt;SilentRegisterSavePlan, 2&gt; m_plans;
  };
  
  class CallArrayAllocatorWithVariableSizeSlowPathGenerator : public JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt; {
  public:
      CallArrayAllocatorWithVariableSizeSlowPathGenerator(
<span class="line-modified">!         MacroAssembler::JumpList from, SpeculativeJIT* jit, P_JITOperation_GStZB function,</span>
<span class="line-modified">!         GPRReg resultGPR, CCallHelpers::TrustedImmPtr globalObject, RegisteredStructure contiguousStructure, RegisteredStructure arrayStorageStructure, GPRReg sizeGPR, GPRReg storageGPR)</span>
          : JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt;(from, jit)
          , m_function(function)
          , m_contiguousStructure(contiguousStructure)
          , m_arrayStorageOrContiguousStructure(arrayStorageStructure)
          , m_resultGPR(resultGPR)
<span class="line-added">+         , m_globalObject(globalObject)</span>
          , m_sizeGPR(sizeGPR)
          , m_storageGPR(storageGPR)
      {
          jit-&gt;silentSpillAllRegistersImpl(false, m_plans, resultGPR);
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 102,35 ***</span>
              bigLength.link(&amp;jit-&gt;m_jit);
              jit-&gt;m_jit.move(SpeculativeJIT::TrustedImmPtr(m_arrayStorageOrContiguousStructure), scratchGPR);
              done.link(&amp;jit-&gt;m_jit);
          } else
              jit-&gt;m_jit.move(SpeculativeJIT::TrustedImmPtr(m_contiguousStructure), scratchGPR);
<span class="line-modified">!         jit-&gt;callOperation(m_function, m_resultGPR, scratchGPR, m_sizeGPR, m_storageGPR);</span>
          for (unsigned i = m_plans.size(); i--;)
              jit-&gt;silentFill(m_plans[i]);
          jit-&gt;m_jit.exceptionCheck();
          jumpTo(jit);
      }
  
  private:
<span class="line-modified">!     P_JITOperation_EStZB m_function;</span>
      RegisteredStructure m_contiguousStructure;
      RegisteredStructure m_arrayStorageOrContiguousStructure;
      GPRReg m_resultGPR;
      GPRReg m_sizeGPR;
      GPRReg m_storageGPR;
      Vector&lt;SilentRegisterSavePlan, 2&gt; m_plans;
  };
  
  class CallArrayAllocatorWithVariableStructureVariableSizeSlowPathGenerator : public JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt; {
  public:
      CallArrayAllocatorWithVariableStructureVariableSizeSlowPathGenerator(
<span class="line-modified">!         MacroAssembler::JumpList from, SpeculativeJIT* jit, P_JITOperation_EStZB function,</span>
<span class="line-modified">!         GPRReg resultGPR, GPRReg structureGPR, GPRReg sizeGPR, GPRReg storageGPR)</span>
          : JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt;(from, jit)
          , m_function(function)
          , m_resultGPR(resultGPR)
          , m_structureGPR(structureGPR)
          , m_sizeGPR(sizeGPR)
          , m_storageGPR(storageGPR)
      {
          jit-&gt;silentSpillAllRegistersImpl(false, m_plans, resultGPR);
<span class="line-new-header">--- 103,37 ---</span>
              bigLength.link(&amp;jit-&gt;m_jit);
              jit-&gt;m_jit.move(SpeculativeJIT::TrustedImmPtr(m_arrayStorageOrContiguousStructure), scratchGPR);
              done.link(&amp;jit-&gt;m_jit);
          } else
              jit-&gt;m_jit.move(SpeculativeJIT::TrustedImmPtr(m_contiguousStructure), scratchGPR);
<span class="line-modified">!         jit-&gt;callOperation(m_function, m_resultGPR, m_globalObject, scratchGPR, m_sizeGPR, m_storageGPR);</span>
          for (unsigned i = m_plans.size(); i--;)
              jit-&gt;silentFill(m_plans[i]);
          jit-&gt;m_jit.exceptionCheck();
          jumpTo(jit);
      }
  
  private:
<span class="line-modified">!     P_JITOperation_GStZB m_function;</span>
      RegisteredStructure m_contiguousStructure;
      RegisteredStructure m_arrayStorageOrContiguousStructure;
      GPRReg m_resultGPR;
<span class="line-added">+     CCallHelpers::TrustedImmPtr m_globalObject;</span>
      GPRReg m_sizeGPR;
      GPRReg m_storageGPR;
      Vector&lt;SilentRegisterSavePlan, 2&gt; m_plans;
  };
  
  class CallArrayAllocatorWithVariableStructureVariableSizeSlowPathGenerator : public JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt; {
  public:
      CallArrayAllocatorWithVariableStructureVariableSizeSlowPathGenerator(
<span class="line-modified">!         MacroAssembler::JumpList from, SpeculativeJIT* jit, P_JITOperation_GStZB function,</span>
<span class="line-modified">!         GPRReg resultGPR, CCallHelpers::TrustedImmPtr globalObject, GPRReg structureGPR, GPRReg sizeGPR, GPRReg storageGPR)</span>
          : JumpingSlowPathGenerator&lt;MacroAssembler::JumpList&gt;(from, jit)
          , m_function(function)
          , m_resultGPR(resultGPR)
<span class="line-added">+         , m_globalObject(globalObject)</span>
          , m_structureGPR(structureGPR)
          , m_sizeGPR(sizeGPR)
          , m_storageGPR(storageGPR)
      {
          jit-&gt;silentSpillAllRegistersImpl(false, m_plans, resultGPR);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 140,20 ***</span>
      void generateInternal(SpeculativeJIT* jit) override
      {
          linkFrom(jit);
          for (unsigned i = 0; i &lt; m_plans.size(); ++i)
              jit-&gt;silentSpill(m_plans[i]);
<span class="line-modified">!         jit-&gt;callOperation(m_function, m_resultGPR, m_structureGPR, m_sizeGPR, m_storageGPR);</span>
          for (unsigned i = m_plans.size(); i--;)
              jit-&gt;silentFill(m_plans[i]);
          jit-&gt;m_jit.exceptionCheck();
          jumpTo(jit);
      }
  
  private:
<span class="line-modified">!     P_JITOperation_EStZB m_function;</span>
      GPRReg m_resultGPR;
      GPRReg m_structureGPR;
      GPRReg m_sizeGPR;
      GPRReg m_storageGPR;
      Vector&lt;SilentRegisterSavePlan, 2&gt; m_plans;
  };
<span class="line-new-header">--- 143,21 ---</span>
      void generateInternal(SpeculativeJIT* jit) override
      {
          linkFrom(jit);
          for (unsigned i = 0; i &lt; m_plans.size(); ++i)
              jit-&gt;silentSpill(m_plans[i]);
<span class="line-modified">!         jit-&gt;callOperation(m_function, m_resultGPR, m_globalObject, m_structureGPR, m_sizeGPR, m_storageGPR);</span>
          for (unsigned i = m_plans.size(); i--;)
              jit-&gt;silentFill(m_plans[i]);
          jit-&gt;m_jit.exceptionCheck();
          jumpTo(jit);
      }
  
  private:
<span class="line-modified">!     P_JITOperation_GStZB m_function;</span>
      GPRReg m_resultGPR;
<span class="line-added">+     CCallHelpers::TrustedImmPtr m_globalObject;</span>
      GPRReg m_structureGPR;
      GPRReg m_sizeGPR;
      GPRReg m_storageGPR;
      Vector&lt;SilentRegisterSavePlan, 2&gt; m_plans;
  };
</pre>
<center><a href="DFGCSEPhase.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DFGCallCreateDirectArgumentsSlowPathGenerator.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>