<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/svg/SVGLengthValue.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (C) 2004, 2005, 2006 Nikolas Zimmermann &lt;zimmermann@kde.org&gt;
  3  * Copyright (C) 2004, 2005, 2006, 2007 Rob Buis &lt;buis@kde.org&gt;
<a name="1" id="anc1"></a><span class="line-modified">  4  * Copyright (C) 2007 Apple Inc. All rights reserved.</span>
  5  *
  6  * This library is free software; you can redistribute it and/or
  7  * modify it under the terms of the GNU Library General Public
  8  * License as published by the Free Software Foundation; either
  9  * version 2 of the License, or (at your option) any later version.
 10  *
 11  * This library is distributed in the hope that it will be useful,
 12  * but WITHOUT ANY WARRANTY; without even the implied warranty of
 13  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 14  * Library General Public License for more details.
 15  *
 16  * You should have received a copy of the GNU Library General Public License
 17  * along with this library; see the file COPYING.LIB.  If not, write to
 18  * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 19  * Boston, MA 02110-1301, USA.
 20  */
 21 
 22 #include &quot;config.h&quot;
 23 #include &quot;SVGLengthValue.h&quot;
 24 
<a name="2" id="anc2"></a><span class="line-modified"> 25 #include &quot;CSSHelper.h&quot;</span>
 26 #include &quot;CSSPrimitiveValue.h&quot;
<a name="3" id="anc3"></a><span class="line-modified"> 27 #include &quot;FloatConversion.h&quot;</span>
<span class="line-removed"> 28 #include &quot;SVGNames.h&quot;</span>
 29 #include &quot;SVGParserUtilities.h&quot;
<a name="4" id="anc4"></a><span class="line-removed"> 30 #include &lt;wtf/MathExtras.h&gt;</span>
<span class="line-removed"> 31 #include &lt;wtf/NeverDestroyed.h&gt;</span>
 32 #include &lt;wtf/text/StringConcatenateNumbers.h&gt;
 33 #include &lt;wtf/text/TextStream.h&gt;
 34 
 35 namespace WebCore {
 36 
<a name="5" id="anc5"></a><span class="line-modified"> 37 // Helper functions</span>
<span class="line-removed"> 38 static inline unsigned storeUnit(SVGLengthMode mode, SVGLengthType type)</span>
 39 {
<a name="6" id="anc6"></a><span class="line-modified"> 40     return (mode &lt;&lt; 4) | type;</span>
<span class="line-modified"> 41 }</span>
<span class="line-modified"> 42 </span>
<span class="line-removed"> 43 static inline SVGLengthMode extractMode(unsigned unit)</span>
<span class="line-removed"> 44 {</span>
<span class="line-removed"> 45     unsigned mode = unit &gt;&gt; 4;</span>
<span class="line-removed"> 46     return static_cast&lt;SVGLengthMode&gt;(mode);</span>
<span class="line-removed"> 47 }</span>
<span class="line-removed"> 48 </span>
<span class="line-removed"> 49 static inline SVGLengthType extractType(unsigned unit)</span>
<span class="line-removed"> 50 {</span>
<span class="line-removed"> 51     return static_cast&lt;SVGLengthType&gt;(unit &amp; ((1 &lt;&lt; 4) - 1));</span>
<span class="line-removed"> 52 }</span>
<span class="line-removed"> 53 </span>
<span class="line-removed"> 54 static inline const char* lengthTypeToString(SVGLengthType type)</span>
<span class="line-removed"> 55 {</span>
<span class="line-removed"> 56     switch (type) {</span>
<span class="line-removed"> 57     case LengthTypeUnknown:</span>
<span class="line-removed"> 58     case LengthTypeNumber:</span>
 59         return &quot;&quot;;
<a name="7" id="anc7"></a><span class="line-modified"> 60     case LengthTypePercentage:</span>
 61         return &quot;%&quot;;
<a name="8" id="anc8"></a><span class="line-modified"> 62     case LengthTypeEMS:</span>
 63         return &quot;em&quot;;
<a name="9" id="anc9"></a><span class="line-modified"> 64     case LengthTypeEXS:</span>
 65         return &quot;ex&quot;;
<a name="10" id="anc10"></a><span class="line-modified"> 66     case LengthTypePX:</span>
 67         return &quot;px&quot;;
<a name="11" id="anc11"></a><span class="line-modified"> 68     case LengthTypeCM:</span>
 69         return &quot;cm&quot;;
<a name="12" id="anc12"></a><span class="line-modified"> 70     case LengthTypeMM:</span>
 71         return &quot;mm&quot;;
<a name="13" id="anc13"></a><span class="line-modified"> 72     case LengthTypeIN:</span>
 73         return &quot;in&quot;;
<a name="14" id="anc14"></a><span class="line-modified"> 74     case LengthTypePT:</span>
 75         return &quot;pt&quot;;
<a name="15" id="anc15"></a><span class="line-modified"> 76     case LengthTypePC:</span>
 77         return &quot;pc&quot;;
 78     }
 79 
 80     ASSERT_NOT_REACHED();
 81     return &quot;&quot;;
 82 }
 83 
<a name="16" id="anc16"></a><span class="line-modified"> 84 inline SVGLengthType parseLengthType(const UChar* ptr, const UChar* end)</span>
 85 {
 86     if (ptr == end)
<a name="17" id="anc17"></a><span class="line-modified"> 87         return LengthTypeNumber;</span>
 88 
 89     const UChar firstChar = *ptr;
 90 
 91     if (++ptr == end)
<a name="18" id="anc18"></a><span class="line-modified"> 92         return firstChar == &#39;%&#39; ? LengthTypePercentage : LengthTypeUnknown;</span>
 93 
 94     const UChar secondChar = *ptr;
 95 
 96     if (++ptr != end)
<a name="19" id="anc19"></a><span class="line-modified"> 97         return LengthTypeUnknown;</span>
 98 
 99     if (firstChar == &#39;e&#39; &amp;&amp; secondChar == &#39;m&#39;)
<a name="20" id="anc20"></a><span class="line-modified">100         return LengthTypeEMS;</span>
101     if (firstChar == &#39;e&#39; &amp;&amp; secondChar == &#39;x&#39;)
<a name="21" id="anc21"></a><span class="line-modified">102         return LengthTypeEXS;</span>
103     if (firstChar == &#39;p&#39; &amp;&amp; secondChar == &#39;x&#39;)
<a name="22" id="anc22"></a><span class="line-modified">104         return LengthTypePX;</span>
105     if (firstChar == &#39;c&#39; &amp;&amp; secondChar == &#39;m&#39;)
<a name="23" id="anc23"></a><span class="line-modified">106         return LengthTypeCM;</span>
107     if (firstChar == &#39;m&#39; &amp;&amp; secondChar == &#39;m&#39;)
<a name="24" id="anc24"></a><span class="line-modified">108         return LengthTypeMM;</span>
109     if (firstChar == &#39;i&#39; &amp;&amp; secondChar == &#39;n&#39;)
<a name="25" id="anc25"></a><span class="line-modified">110         return LengthTypeIN;</span>
111     if (firstChar == &#39;p&#39; &amp;&amp; secondChar == &#39;t&#39;)
<a name="26" id="anc26"></a><span class="line-modified">112         return LengthTypePT;</span>
113     if (firstChar == &#39;p&#39; &amp;&amp; secondChar == &#39;c&#39;)
<a name="27" id="anc27"></a><span class="line-modified">114         return LengthTypePC;</span>
115 
<a name="28" id="anc28"></a><span class="line-modified">116     return LengthTypeUnknown;</span>
117 }
118 
<a name="29" id="anc29"></a><span class="line-modified">119 SVGLengthValue::SVGLengthValue(SVGLengthMode mode, const String&amp; valueAsString)</span>
<span class="line-removed">120     : m_unit(storeUnit(mode, LengthTypeNumber))</span>
121 {
<a name="30" id="anc30"></a><span class="line-modified">122     setValueAsString(valueAsString);</span>



























123 }
124 
<a name="31" id="anc31"></a><span class="line-modified">125 SVGLengthValue::SVGLengthValue(const SVGLengthContext&amp; context, float value, SVGLengthMode mode, SVGLengthType unitType)</span>
<span class="line-removed">126     : m_unit(storeUnit(mode, unitType))</span>
127 {
<a name="32" id="anc32"></a><span class="line-modified">128     setValue(value, context);</span>


























129 }
130 
<a name="33" id="anc33"></a><span class="line-modified">131 ExceptionOr&lt;void&gt; SVGLengthValue::setValueAsString(const String&amp; valueAsString, SVGLengthMode mode)</span>

132 {
<a name="34" id="anc34"></a><span class="line-modified">133     m_valueInSpecifiedUnits = 0;</span>
<span class="line-removed">134     m_unit = storeUnit(mode, LengthTypeNumber);</span>
<span class="line-removed">135     return setValueAsString(valueAsString);</span>
136 }
137 
<a name="35" id="anc35"></a><span class="line-modified">138 bool SVGLengthValue::operator==(const SVGLengthValue&amp; other) const</span>



139 {
<a name="36" id="anc36"></a><span class="line-modified">140     return m_unit == other.m_unit &amp;&amp; m_valueInSpecifiedUnits == other.m_valueInSpecifiedUnits;</span>
141 }
142 
<a name="37" id="anc37"></a><span class="line-modified">143 bool SVGLengthValue::operator!=(const SVGLengthValue&amp; other) const</span>


144 {
<a name="38" id="anc38"></a><span class="line-modified">145     return !operator==(other);</span>
146 }
147 
<a name="39" id="anc39"></a><span class="line-modified">148 SVGLengthValue SVGLengthValue::construct(SVGLengthMode mode, const String&amp; valueAsString, SVGParsingError&amp; parseError, SVGLengthNegativeValuesMode negativeValuesMode)</span>
149 {
<a name="40" id="anc40"></a><span class="line-modified">150     SVGLengthValue length(mode);</span>
151 
152     if (length.setValueAsString(valueAsString).hasException())
153         parseError = ParsingAttributeFailedError;
<a name="41" id="anc41"></a><span class="line-modified">154     else if (negativeValuesMode == ForbidNegativeLengths &amp;&amp; length.valueInSpecifiedUnits() &lt; 0)</span>
155         parseError = NegativeValueForbiddenError;
156 
157     return length;
158 }
159 
<a name="42" id="anc42"></a><span class="line-modified">160 SVGLengthType SVGLengthValue::unitType() const</span>



































161 {
<a name="43" id="anc43"></a><span class="line-modified">162     return extractType(m_unit);</span>


163 }
164 
<a name="44" id="anc44"></a><span class="line-modified">165 SVGLengthMode SVGLengthValue::unitMode() const</span>
166 {
<a name="45" id="anc45"></a><span class="line-modified">167     return extractMode(m_unit);</span>








168 }
169 
170 float SVGLengthValue::value(const SVGLengthContext&amp; context) const
171 {
172     auto result = valueForBindings(context);
173     if (result.hasException())
174         return 0;
175     return result.releaseReturnValue();
176 }
177 
<a name="46" id="anc46"></a><span class="line-modified">178 ExceptionOr&lt;float&gt; SVGLengthValue::valueForBindings(const SVGLengthContext&amp; context) const</span>
179 {
<a name="47" id="anc47"></a><span class="line-modified">180     return context.convertValueToUserUnits(m_valueInSpecifiedUnits, extractMode(m_unit), extractType(m_unit));</span>
181 }
182 
<a name="48" id="anc48"></a><span class="line-modified">183 ExceptionOr&lt;void&gt; SVGLengthValue::setValue(const SVGLengthContext&amp; context, float value, SVGLengthMode mode, SVGLengthType unitType)</span>
184 {
<a name="49" id="anc49"></a><span class="line-modified">185     // FIXME: Seems like a bug that we change the value of m_unit even if setValue throws an exception.</span>
<span class="line-removed">186     m_unit = storeUnit(mode, unitType);</span>
<span class="line-removed">187     return setValue(value, context);</span>
188 }
189 
<a name="50" id="anc50"></a><span class="line-modified">190 ExceptionOr&lt;void&gt; SVGLengthValue::setValue(float value, const SVGLengthContext&amp; context)</span>
191 {
192     // 100% = 100.0 instead of 1.0 for historical reasons, this could eventually be changed
<a name="51" id="anc51"></a><span class="line-modified">193     if (extractType(m_unit) == LengthTypePercentage)</span>
194         value = value / 100;
195 
<a name="52" id="anc52"></a><span class="line-modified">196     auto convertedValue = context.convertValueFromUserUnits(value, extractMode(m_unit), extractType(m_unit));</span>
197     if (convertedValue.hasException())
198         return convertedValue.releaseException();
199     m_valueInSpecifiedUnits = convertedValue.releaseReturnValue();
200     return { };
201 }
<a name="53" id="anc53"></a><span class="line-removed">202 float SVGLengthValue::valueAsPercentage() const</span>
<span class="line-removed">203 {</span>
<span class="line-removed">204     // 100% = 100.0 instead of 1.0 for historical reasons, this could eventually be changed</span>
<span class="line-removed">205     if (extractType(m_unit) == LengthTypePercentage)</span>
<span class="line-removed">206         return m_valueInSpecifiedUnits / 100;</span>
207 
<a name="54" id="anc54"></a><span class="line-modified">208     return m_valueInSpecifiedUnits;</span>





209 }
210 
211 ExceptionOr&lt;void&gt; SVGLengthValue::setValueAsString(const String&amp; string)
212 {
213     if (string.isEmpty())
214         return { };
215 
216     float convertedNumber = 0;
217     auto upconvertedCharacters = StringView(string).upconvertedCharacters();
218     const UChar* ptr = upconvertedCharacters;
219     const UChar* end = ptr + string.length();
220 
221     if (!parseNumber(ptr, end, convertedNumber, false))
222         return Exception { SyntaxError };
223 
<a name="55" id="anc55"></a><span class="line-modified">224     auto type = parseLengthType(ptr, end);</span>
<span class="line-modified">225     if (type == LengthTypeUnknown)</span>
226         return Exception { SyntaxError };
227 
<a name="56" id="anc56"></a><span class="line-modified">228     m_unit = storeUnit(extractMode(m_unit), type);</span>
229     m_valueInSpecifiedUnits = convertedNumber;
230     return { };
231 }
232 
<a name="57" id="anc57"></a><span class="line-modified">233 String SVGLengthValue::valueAsString() const</span>
<span class="line-removed">234 {</span>
<span class="line-removed">235     return makeString(FormattedNumber::fixedPrecision(m_valueInSpecifiedUnits), lengthTypeToString(extractType(m_unit)));</span>
<span class="line-removed">236 }</span>
<span class="line-removed">237 </span>
<span class="line-removed">238 ExceptionOr&lt;void&gt; SVGLengthValue::newValueSpecifiedUnits(unsigned short type, float value)</span>
<span class="line-removed">239 {</span>
<span class="line-removed">240     if (type == LengthTypeUnknown || type &gt; LengthTypePC)</span>
<span class="line-removed">241         return Exception { NotSupportedError };</span>
<span class="line-removed">242 </span>
<span class="line-removed">243     m_unit = storeUnit(extractMode(m_unit), static_cast&lt;SVGLengthType&gt;(type));</span>
<span class="line-removed">244     m_valueInSpecifiedUnits = value;</span>
<span class="line-removed">245     return { };</span>
<span class="line-removed">246 }</span>
<span class="line-removed">247 </span>
<span class="line-removed">248 ExceptionOr&lt;void&gt; SVGLengthValue::convertToSpecifiedUnits(unsigned short type, const SVGLengthContext&amp; context)</span>
249 {
<a name="58" id="anc58"></a><span class="line-removed">250     if (type == LengthTypeUnknown || type &gt; LengthTypePC)</span>
<span class="line-removed">251         return Exception { NotSupportedError };</span>
<span class="line-removed">252 </span>
253     auto valueInUserUnits = valueForBindings(context);
254     if (valueInUserUnits.hasException())
255         return valueInUserUnits.releaseException();
256 
<a name="59" id="anc59"></a><span class="line-modified">257     auto originalUnitAndType = m_unit;</span>
<span class="line-modified">258     m_unit = storeUnit(extractMode(m_unit), static_cast&lt;SVGLengthType&gt;(type));</span>
<span class="line-modified">259     auto result = setValue(valueInUserUnits.releaseReturnValue(), context);</span>
<span class="line-modified">260     if (result.hasException()) {</span>
<span class="line-removed">261         m_unit = originalUnitAndType;</span>
<span class="line-removed">262         return result.releaseException();</span>
<span class="line-removed">263     }</span>
<span class="line-removed">264 </span>
<span class="line-removed">265     return { };</span>
<span class="line-removed">266 }</span>
<span class="line-removed">267 </span>
<span class="line-removed">268 SVGLengthValue SVGLengthValue::fromCSSPrimitiveValue(const CSSPrimitiveValue&amp; value)</span>
<span class="line-removed">269 {</span>
<span class="line-removed">270     SVGLengthType type;</span>
<span class="line-removed">271     switch (value.primitiveType()) {</span>
<span class="line-removed">272     case CSSPrimitiveValue::CSS_NUMBER:</span>
<span class="line-removed">273         type = LengthTypeNumber;</span>
<span class="line-removed">274         break;</span>
<span class="line-removed">275     case CSSPrimitiveValue::CSS_PERCENTAGE:</span>
<span class="line-removed">276         type = LengthTypePercentage;</span>
<span class="line-removed">277         break;</span>
<span class="line-removed">278     case CSSPrimitiveValue::CSS_EMS:</span>
<span class="line-removed">279         type = LengthTypeEMS;</span>
<span class="line-removed">280         break;</span>
<span class="line-removed">281     case CSSPrimitiveValue::CSS_EXS:</span>
<span class="line-removed">282         type = LengthTypeEXS;</span>
<span class="line-removed">283         break;</span>
<span class="line-removed">284     case CSSPrimitiveValue::CSS_PX:</span>
<span class="line-removed">285         type = LengthTypePX;</span>
<span class="line-removed">286         break;</span>
<span class="line-removed">287     case CSSPrimitiveValue::CSS_CM:</span>
<span class="line-removed">288         type = LengthTypeCM;</span>
<span class="line-removed">289         break;</span>
<span class="line-removed">290     case CSSPrimitiveValue::CSS_MM:</span>
<span class="line-removed">291         type = LengthTypeMM;</span>
<span class="line-removed">292         break;</span>
<span class="line-removed">293     case CSSPrimitiveValue::CSS_IN:</span>
<span class="line-removed">294         type = LengthTypeIN;</span>
<span class="line-removed">295         break;</span>
<span class="line-removed">296     case CSSPrimitiveValue::CSS_PT:</span>
<span class="line-removed">297         type = LengthTypePT;</span>
<span class="line-removed">298         break;</span>
<span class="line-removed">299     case CSSPrimitiveValue::CSS_PC:</span>
<span class="line-removed">300         type = LengthTypePC;</span>
<span class="line-removed">301         break;</span>
<span class="line-removed">302     case CSSPrimitiveValue::CSS_UNKNOWN:</span>
<span class="line-removed">303     default:</span>
304         return { };
<a name="60" id="anc60"></a><span class="line-removed">305     };</span>
306 
<a name="61" id="anc61"></a><span class="line-modified">307     SVGLengthValue length;</span>
<span class="line-modified">308     length.newValueSpecifiedUnits(type, value.floatValue());</span>
<span class="line-removed">309     return length;</span>
<span class="line-removed">310 }</span>
<span class="line-removed">311 </span>
<span class="line-removed">312 Ref&lt;CSSPrimitiveValue&gt; SVGLengthValue::toCSSPrimitiveValue(const SVGLengthValue&amp; length)</span>
<span class="line-removed">313 {</span>
<span class="line-removed">314     CSSPrimitiveValue::UnitType cssType = CSSPrimitiveValue::CSS_UNKNOWN;</span>
<span class="line-removed">315     switch (length.unitType()) {</span>
<span class="line-removed">316     case LengthTypeUnknown:</span>
<span class="line-removed">317         break;</span>
<span class="line-removed">318     case LengthTypeNumber:</span>
<span class="line-removed">319         cssType = CSSPrimitiveValue::CSS_NUMBER;</span>
<span class="line-removed">320         break;</span>
<span class="line-removed">321     case LengthTypePercentage:</span>
<span class="line-removed">322         cssType = CSSPrimitiveValue::CSS_PERCENTAGE;</span>
<span class="line-removed">323         break;</span>
<span class="line-removed">324     case LengthTypeEMS:</span>
<span class="line-removed">325         cssType = CSSPrimitiveValue::CSS_EMS;</span>
<span class="line-removed">326         break;</span>
<span class="line-removed">327     case LengthTypeEXS:</span>
<span class="line-removed">328         cssType = CSSPrimitiveValue::CSS_EXS;</span>
<span class="line-removed">329         break;</span>
<span class="line-removed">330     case LengthTypePX:</span>
<span class="line-removed">331         cssType = CSSPrimitiveValue::CSS_PX;</span>
<span class="line-removed">332         break;</span>
<span class="line-removed">333     case LengthTypeCM:</span>
<span class="line-removed">334         cssType = CSSPrimitiveValue::CSS_CM;</span>
<span class="line-removed">335         break;</span>
<span class="line-removed">336     case LengthTypeMM:</span>
<span class="line-removed">337         cssType = CSSPrimitiveValue::CSS_MM;</span>
<span class="line-removed">338         break;</span>
<span class="line-removed">339     case LengthTypeIN:</span>
<span class="line-removed">340         cssType = CSSPrimitiveValue::CSS_IN;</span>
<span class="line-removed">341         break;</span>
<span class="line-removed">342     case LengthTypePT:</span>
<span class="line-removed">343         cssType = CSSPrimitiveValue::CSS_PT;</span>
<span class="line-removed">344         break;</span>
<span class="line-removed">345     case LengthTypePC:</span>
<span class="line-removed">346         cssType = CSSPrimitiveValue::CSS_PC;</span>
<span class="line-removed">347         break;</span>
<span class="line-removed">348     };</span>
<span class="line-removed">349 </span>
<span class="line-removed">350     return CSSPrimitiveValue::create(length.valueInSpecifiedUnits(), cssType);</span>
<span class="line-removed">351 }</span>
<span class="line-removed">352 </span>
<span class="line-removed">353 SVGLengthMode SVGLengthValue::lengthModeForAnimatedLengthAttribute(const QualifiedName&amp; attrName)</span>
<span class="line-removed">354 {</span>
<span class="line-removed">355     using Map = HashMap&lt;QualifiedName, SVGLengthMode&gt;;</span>
<span class="line-removed">356     static NeverDestroyed&lt;Map&gt; map = [] {</span>
<span class="line-removed">357         struct Mode {</span>
<span class="line-removed">358             const QualifiedName&amp; name;</span>
<span class="line-removed">359             SVGLengthMode mode;</span>
<span class="line-removed">360         };</span>
<span class="line-removed">361         static const Mode modes[] = {</span>
<span class="line-removed">362             { SVGNames::xAttr, LengthModeWidth },</span>
<span class="line-removed">363             { SVGNames::yAttr, LengthModeHeight },</span>
<span class="line-removed">364             { SVGNames::cxAttr, LengthModeWidth },</span>
<span class="line-removed">365             { SVGNames::cyAttr, LengthModeHeight },</span>
<span class="line-removed">366             { SVGNames::dxAttr, LengthModeWidth },</span>
<span class="line-removed">367             { SVGNames::dyAttr, LengthModeHeight },</span>
<span class="line-removed">368             { SVGNames::fxAttr, LengthModeWidth },</span>
<span class="line-removed">369             { SVGNames::fyAttr, LengthModeHeight },</span>
<span class="line-removed">370             { SVGNames::widthAttr, LengthModeWidth },</span>
<span class="line-removed">371             { SVGNames::heightAttr, LengthModeHeight },</span>
<span class="line-removed">372             { SVGNames::x1Attr, LengthModeWidth },</span>
<span class="line-removed">373             { SVGNames::x2Attr, LengthModeWidth },</span>
<span class="line-removed">374             { SVGNames::y1Attr, LengthModeHeight },</span>
<span class="line-removed">375             { SVGNames::y2Attr, LengthModeHeight },</span>
<span class="line-removed">376             { SVGNames::refXAttr, LengthModeWidth },</span>
<span class="line-removed">377             { SVGNames::refYAttr, LengthModeHeight },</span>
<span class="line-removed">378             { SVGNames::markerWidthAttr, LengthModeWidth },</span>
<span class="line-removed">379             { SVGNames::markerHeightAttr, LengthModeHeight },</span>
<span class="line-removed">380             { SVGNames::textLengthAttr, LengthModeWidth },</span>
<span class="line-removed">381             { SVGNames::startOffsetAttr, LengthModeWidth },</span>
<span class="line-removed">382         };</span>
<span class="line-removed">383         Map map;</span>
<span class="line-removed">384         for (auto&amp; mode : modes)</span>
<span class="line-removed">385             map.add(mode.name, mode.mode);</span>
<span class="line-removed">386         return map;</span>
<span class="line-removed">387     }();</span>
<span class="line-removed">388 </span>
<span class="line-removed">389     auto result = map.get().find(attrName);</span>
<span class="line-removed">390     if (result == map.get().end())</span>
<span class="line-removed">391         return LengthModeOther;</span>
<span class="line-removed">392     return result-&gt;value;</span>
393 }
394 
395 TextStream&amp; operator&lt;&lt;(TextStream&amp; ts, const SVGLengthValue&amp; length)
396 {
397     ts &lt;&lt; length.valueAsString();
398     return ts;
399 }
400 
401 }
<a name="62" id="anc62"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="62" type="hidden" />
</body>
</html>