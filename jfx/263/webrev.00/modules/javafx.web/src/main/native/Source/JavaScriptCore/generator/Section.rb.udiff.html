<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/JavaScriptCore/generator/Section.rb</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="Options.rb.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../heap/AlignedMemoryAllocator.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/generator/Section.rb</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -41,11 +41,11 @@</span>
    def add_opcode(name, config)
        @opcodes &lt;&lt; create_opcode(name, config)
    end
  
    def create_opcode(name, config)
<span class="udiff-line-modified-removed">-       Opcode.new(self, name, config[:args], config[:metadata], config[:metadata_initializers])</span>
<span class="udiff-line-modified-added">+       Opcode.new(self, name, config[:extras], config[:args], config[:metadata], config[:metadata_initializers], config[:tmps], config[:checkpoints])</span>
    end
  
    def add_opcode_group(name, opcodes, config)
        opcodes = opcodes.map { |opcode| create_opcode(opcode, config) }
        @opcode_groups &lt;&lt; OpcodeGroup.new(self, name, opcodes, config)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -55,18 +55,23 @@</span>
    def sort!
        @opcodes = @opcodes.sort { |a, b| a.metadata.empty? ? b.metadata.empty? ? 0 : 1 : -1 }
        @opcodes.each(&amp;:create_id!)
    end
  
<span class="udiff-line-added">+   def is_wasm?</span>
<span class="udiff-line-added">+     @name == :Wasm</span>
<span class="udiff-line-added">+   end</span>
<span class="udiff-line-added">+ </span>
    def header_helpers(num_opcodes)
        out = StringIO.new
        if config[:emit_in_h_file]
            out.write(&quot;#define FOR_EACH_#{config[:macro_name_component]}_ID(macro) \\\n&quot;)
            opcodes.each { |opcode| out.write(&quot;    macro(#{opcode.name}, #{opcode.length}) \\\n&quot;) }
            out &lt;&lt; &quot;\n&quot;
  
            out.write(&quot;#define NUMBER_OF_#{config[:macro_name_component]}_IDS #{opcodes.length}\n&quot;)
<span class="udiff-line-added">+           out.write(&quot;#define MAX_LENGTH_OF_#{config[:macro_name_component]}_IDS #{(opcodes.max {|a, b| a.length &lt;=&gt; b.length }).length}\n&quot;)</span>
        end
  
        if config[:emit_in_structs_file]
            out.write(&quot;#define FOR_EACH_#{config[:macro_name_component]}_METADATA_SIZE(macro) \\\n&quot;)
            i = 0
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -106,6 +111,16 @@</span>
                out.write(&quot;#define #{opcode.name}_wide32_value_string \&quot;#{num_opcodes * 2 + opcode.id}\&quot;\n&quot;)
            }
        end
        out.string
    end
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     def for_each_struct</span>
<span class="udiff-line-added">+         &lt;&lt;-EOF</span>
<span class="udiff-line-added">+ #define FOR_EACH_#{config[:macro_name_component]}_STRUCT(macro) \\</span>
<span class="udiff-line-added">+ #{opcodes.map do |op|</span>
<span class="udiff-line-added">+     &quot;    macro(#{op.capitalized_name}) \\&quot;</span>
<span class="udiff-line-added">+ end.join(&quot;\n&quot;)}</span>
<span class="udiff-line-added">+ EOF</span>
<span class="udiff-line-added">+     end</span>
<span class="udiff-line-added">+ </span>
  end
</pre>
<center><a href="Options.rb.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../heap/AlignedMemoryAllocator.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>