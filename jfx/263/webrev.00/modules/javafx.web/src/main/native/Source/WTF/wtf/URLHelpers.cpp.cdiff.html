<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WTF/wtf/URLHelpers.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="URLHash.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="URLParser.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WTF/wtf/URLHelpers.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 546,11 ***</span>
  
      UChar destinationBuffer[hostNameBufferLength];
      UErrorCode uerror = U_ZERO_ERROR;
      UIDNAInfo processingDetails = UIDNA_INFO_INITIALIZER;
      int32_t numCharactersConverted = (decodeFunction ? uidna_nameToASCII : uidna_nameToUnicode)(&amp;URLParser::internationalDomainNameTranscoder(), sourceBuffer.data(), length, destinationBuffer, hostNameBufferLength, &amp;processingDetails, &amp;uerror);
<span class="line-modified">!     if (length &amp;&amp; (U_FAILURE(uerror) || processingDetails.errors))</span>
          return nullopt;
  
      if (numCharactersConverted == static_cast&lt;int32_t&gt;(length) &amp;&amp; !memcmp(sourceBuffer.data(), destinationBuffer, length * sizeof(UChar)))
          return String();
  
<span class="line-new-header">--- 546,12 ---</span>
  
      UChar destinationBuffer[hostNameBufferLength];
      UErrorCode uerror = U_ZERO_ERROR;
      UIDNAInfo processingDetails = UIDNA_INFO_INITIALIZER;
      int32_t numCharactersConverted = (decodeFunction ? uidna_nameToASCII : uidna_nameToUnicode)(&amp;URLParser::internationalDomainNameTranscoder(), sourceBuffer.data(), length, destinationBuffer, hostNameBufferLength, &amp;processingDetails, &amp;uerror);
<span class="line-modified">!     int allowedErrors = decodeFunction ? 0 : UIDNA_ERROR_EMPTY_LABEL | UIDNA_ERROR_LEADING_HYPHEN | UIDNA_ERROR_TRAILING_HYPHEN | UIDNA_ERROR_HYPHEN_3_4;</span>
<span class="line-added">+     if (length &amp;&amp; (U_FAILURE(uerror) || processingDetails.errors &amp; ~allowedErrors))</span>
          return nullopt;
  
      if (numCharactersConverted == static_cast&lt;int32_t&gt;(length) &amp;&amp; !memcmp(sourceBuffer.data(), destinationBuffer, length * sizeof(UChar)))
          return String();
  
</pre>
<center><a href="URLHash.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="URLParser.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>