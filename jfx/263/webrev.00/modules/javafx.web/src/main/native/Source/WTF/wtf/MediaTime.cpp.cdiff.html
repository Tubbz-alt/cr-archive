<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WTF/wtf/MediaTime.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MathExtras.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MediaTime.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WTF/wtf/MediaTime.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 35,13 ***</span>
<span class="line-new-header">--- 35,16 ---</span>
  #include &lt;wtf/CheckedArithmetic.h&gt;
  #include &lt;wtf/JSONValues.h&gt;
  #include &lt;wtf/MathExtras.h&gt;
  #include &lt;wtf/PrintStream.h&gt;
  #include &lt;wtf/text/StringBuilder.h&gt;
<span class="line-added">+ #include &lt;wtf/text/TextStream.h&gt;</span>
  
  namespace WTF {
  
<span class="line-added">+ static_assert(std::is_trivially_destructible_v&lt;MediaTime&gt;, &quot;MediaTime should be trivially destructible.&quot;);</span>
<span class="line-added">+ </span>
  static uint32_t greatestCommonDivisor(uint32_t a, uint32_t b)
  {
      ASSERT(a);
      ASSERT(b);
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 67,32 ***</span>
      return (0 &lt; val) - (val &lt; 0);
  }
  
  const uint32_t MediaTime::MaximumTimeScale = 1000000000;
  
<span class="line-removed">- MediaTime::MediaTime()</span>
<span class="line-removed">-     : m_timeValue(0)</span>
<span class="line-removed">-     , m_timeScale(DefaultTimeScale)</span>
<span class="line-removed">-     , m_timeFlags(Valid)</span>
<span class="line-removed">- {</span>
<span class="line-removed">- }</span>
<span class="line-removed">- </span>
<span class="line-removed">- MediaTime::MediaTime(int64_t value, uint32_t scale, uint8_t flags)</span>
<span class="line-removed">-     : m_timeValue(value)</span>
<span class="line-removed">-     , m_timeScale(scale)</span>
<span class="line-removed">-     , m_timeFlags(flags)</span>
<span class="line-removed">- {</span>
<span class="line-removed">-     if (scale || isInvalid())</span>
<span class="line-removed">-         return;</span>
<span class="line-removed">- </span>
<span class="line-removed">-     *this = value &lt; 0 ? negativeInfiniteTime() : positiveInfiniteTime();</span>
<span class="line-removed">- }</span>
<span class="line-removed">- </span>
<span class="line-removed">- MediaTime::~MediaTime()</span>
<span class="line-removed">- {</span>
<span class="line-removed">- }</span>
<span class="line-removed">- </span>
  MediaTime::MediaTime(const MediaTime&amp; rhs)
  {
      *this = rhs;
  }
  
<span class="line-new-header">--- 70,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 454,36 ***</span>
      return *this &gt; a &amp;&amp; *this &lt; b;
  }
  
  const MediaTime&amp; MediaTime::zeroTime()
  {
<span class="line-modified">!     static const MediaTime* time = new MediaTime(0, 1, Valid);</span>
<span class="line-modified">!     return *time;</span>
  }
  
  const MediaTime&amp; MediaTime::invalidTime()
  {
<span class="line-modified">!     static const MediaTime* time = new MediaTime(-1, 1, 0);</span>
<span class="line-modified">!     return *time;</span>
  }
  
  const MediaTime&amp; MediaTime::positiveInfiniteTime()
  {
<span class="line-modified">!     static const MediaTime* time = new MediaTime(0, 1, PositiveInfinite | Valid);</span>
<span class="line-modified">!     return *time;</span>
  }
  
  const MediaTime&amp; MediaTime::negativeInfiniteTime()
  {
<span class="line-modified">!     static const MediaTime* time = new MediaTime(-1, 1, NegativeInfinite | Valid);</span>
<span class="line-modified">!     return *time;</span>
  }
  
  const MediaTime&amp; MediaTime::indefiniteTime()
  {
<span class="line-modified">!     static const MediaTime* time = new MediaTime(0, 1, Indefinite | Valid);</span>
<span class="line-modified">!     return *time;</span>
  }
  
  MediaTime MediaTime::toTimeScale(uint32_t timeScale, RoundingFlags flags) const
  {
      MediaTime result = *this;
<span class="line-new-header">--- 435,36 ---</span>
      return *this &gt; a &amp;&amp; *this &lt; b;
  }
  
  const MediaTime&amp; MediaTime::zeroTime()
  {
<span class="line-modified">!     static const MediaTime time(0, 1, Valid);</span>
<span class="line-modified">!     return time;</span>
  }
  
  const MediaTime&amp; MediaTime::invalidTime()
  {
<span class="line-modified">!     static const MediaTime time(-1, 1, 0);</span>
<span class="line-modified">!     return time;</span>
  }
  
  const MediaTime&amp; MediaTime::positiveInfiniteTime()
  {
<span class="line-modified">!     static const MediaTime time(0, 1, PositiveInfinite | Valid);</span>
<span class="line-modified">!     return time;</span>
  }
  
  const MediaTime&amp; MediaTime::negativeInfiniteTime()
  {
<span class="line-modified">!     static const MediaTime time(-1, 1, NegativeInfinite | Valid);</span>
<span class="line-modified">!     return time;</span>
  }
  
  const MediaTime&amp; MediaTime::indefiniteTime()
  {
<span class="line-modified">!     static const MediaTime time(0, 1, Indefinite | Valid);</span>
<span class="line-modified">!     return time;</span>
  }
  
  MediaTime MediaTime::toTimeScale(uint32_t timeScale, RoundingFlags flags) const
  {
      MediaTime result = *this;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 583,19 ***</span>
  }
  
  String MediaTime::toString() const
  {
      StringBuilder builder;
<span class="line-removed">- </span>
      builder.append(&#39;{&#39;);
<span class="line-modified">!     if (!hasDoubleValue()) {</span>
<span class="line-modified">!         builder.appendNumber(m_timeValue);</span>
<span class="line-modified">!         builder.append(&#39;/&#39;);</span>
<span class="line-modified">!         builder.appendNumber(m_timeScale);</span>
<span class="line-modified">!         builder.appendLiteral(&quot; = &quot;);</span>
<span class="line-removed">-     }</span>
<span class="line-removed">-     builder.appendFixedPrecisionNumber(toDouble());</span>
      builder.append(&#39;}&#39;);
      return builder.toString();
  }
  
  Ref&lt;JSON::Object&gt; MediaTime::toJSONObject() const
<span class="line-new-header">--- 564,16 ---</span>
  }
  
  String MediaTime::toString() const
  {
      StringBuilder builder;
      builder.append(&#39;{&#39;);
<span class="line-modified">!     if (!hasDoubleValue())</span>
<span class="line-modified">!         builder.append(m_timeValue, &#39;/&#39;, m_timeScale, &quot; = &quot;);</span>
<span class="line-modified">!     builder.append(toDouble());</span>
<span class="line-modified">!     if (isInvalid())</span>
<span class="line-modified">!         builder.appendLiteral(&quot;, invalid&quot;);</span>
      builder.append(&#39;}&#39;);
      return builder.toString();
  }
  
  Ref&lt;JSON::Object&gt; MediaTime::toJSONObject() const
</pre>
<hr />
<pre>
<span class="line-old-header">*** 605,11 ***</span>
      if (hasDoubleValue()) {
          object-&gt;setDouble(&quot;value&quot;_s, toDouble());
          return object;
      }
  
<span class="line-modified">!     if (isInvalid() || isIndefinite())</span>
          object-&gt;setString(&quot;value&quot;_s, &quot;NaN&quot;_s);
      else if (isPositiveInfinite())
          object-&gt;setString(&quot;value&quot;_s, &quot;POSITIVE_INFINITY&quot;_s);
      else if (isNegativeInfinite())
          object-&gt;setString(&quot;value&quot;_s, &quot;NEGATIVE_INFINITY&quot;_s);
<span class="line-new-header">--- 583,13 ---</span>
      if (hasDoubleValue()) {
          object-&gt;setDouble(&quot;value&quot;_s, toDouble());
          return object;
      }
  
<span class="line-modified">!     if (isInvalid())</span>
<span class="line-added">+         object-&gt;setBoolean(&quot;invalid&quot;_s, true);</span>
<span class="line-added">+     else if (isIndefinite())</span>
          object-&gt;setString(&quot;value&quot;_s, &quot;NaN&quot;_s);
      else if (isPositiveInfinite())
          object-&gt;setString(&quot;value&quot;_s, &quot;POSITIVE_INFINITY&quot;_s);
      else if (isNegativeInfinite())
          object-&gt;setString(&quot;value&quot;_s, &quot;NEGATIVE_INFINITY&quot;_s);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 650,6 ***</span>
<span class="line-new-header">--- 630,15 ---</span>
      object-&gt;setObject(&quot;end&quot;_s, end.toJSONObject());
  
      return object-&gt;toJSONString();
  }
  
<span class="line-added">+ #ifndef NDEBUG</span>
<span class="line-added">+ </span>
<span class="line-added">+ TextStream&amp; operator&lt;&lt;(TextStream&amp; stream, const MediaTime&amp; time)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     return stream &lt;&lt; time.toJSONString();</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ </span>
  }
</pre>
<center><a href="MathExtras.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="MediaTime.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>