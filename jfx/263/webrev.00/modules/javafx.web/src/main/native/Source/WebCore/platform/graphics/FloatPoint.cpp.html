<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/FloatPoint.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
 1 /*
 2  * Copyright (C) 2004, 2006, 2007 Apple Inc.  All rights reserved.
 3  * Copyright (C) 2005 Nokia.  All rights reserved.
 4  *
 5  * Redistribution and use in source and binary forms, with or without
 6  * modification, are permitted provided that the following conditions
 7  * are met:
 8  * 1. Redistributions of source code must retain the above copyright
 9  *    notice, this list of conditions and the following disclaimer.
10  * 2. Redistributions in binary form must reproduce the above copyright
11  *    notice, this list of conditions and the following disclaimer in the
12  *    documentation and/or other materials provided with the distribution.
13  *
14  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
15  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
16  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
17  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
18  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
19  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
20  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
21  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
22  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
23  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
24  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
25  */
26 
27 #include &quot;config.h&quot;
28 #include &quot;FloatPoint.h&quot;
29 
30 #include &quot;AffineTransform.h&quot;
31 #include &quot;FloatConversion.h&quot;
32 #include &quot;IntPoint.h&quot;
33 #include &quot;TransformationMatrix.h&quot;
34 #include &lt;limits&gt;
35 #include &lt;math.h&gt;
36 #include &lt;wtf/text/TextStream.h&gt;
37 
38 namespace WebCore {
39 
40 FloatPoint::FloatPoint(const IntPoint&amp; p) : m_x(p.x()), m_y(p.y())
41 {
42 }
43 
44 FloatPoint FloatPoint::constrainedBetween(const FloatPoint&amp; min, const FloatPoint&amp; max) const
45 {
46     return {
47         std::max(min.x(), std::min(max.x(), m_x)),
48         std::max(min.y(), std::min(max.y(), m_y))
49     };
50 }
51 
52 void FloatPoint::normalize()
53 {
54     float tempLength = length();
55 
56     if (tempLength) {
57         m_x /= tempLength;
58         m_y /= tempLength;
59     }
60 }
61 
62 float FloatPoint::slopeAngleRadians() const
63 {
64     return atan2f(m_y, m_x);
65 }
66 
67 FloatPoint FloatPoint::matrixTransform(const AffineTransform&amp; transform) const
68 {
69     double newX, newY;
70     transform.map(static_cast&lt;double&gt;(m_x), static_cast&lt;double&gt;(m_y), newX, newY);
71     return narrowPrecision(newX, newY);
72 }
73 
74 FloatPoint FloatPoint::matrixTransform(const TransformationMatrix&amp; transform) const
75 {
76     double newX, newY;
77     transform.map(static_cast&lt;double&gt;(m_x), static_cast&lt;double&gt;(m_y), newX, newY);
78     return narrowPrecision(newX, newY);
79 }
80 
81 FloatPoint FloatPoint::narrowPrecision(double x, double y)
82 {
83     return FloatPoint(narrowPrecisionToFloat(x), narrowPrecisionToFloat(y));
84 }
85 
86 TextStream&amp; operator&lt;&lt;(TextStream&amp; ts, const FloatPoint&amp; p)
87 {
88     // FIXME: callers should use the NumberRespectingIntegers flag.
89     return ts &lt;&lt; &quot;(&quot; &lt;&lt; TextStream::FormatNumberRespectingIntegers(p.x()) &lt;&lt; &quot;,&quot; &lt;&lt; TextStream::FormatNumberRespectingIntegers(p.y()) &lt;&lt; &quot;)&quot;;
90 }
91 
92 }
    </pre>
  </body>
</html>