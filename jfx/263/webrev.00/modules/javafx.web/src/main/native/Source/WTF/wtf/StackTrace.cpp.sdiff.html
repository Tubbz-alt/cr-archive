<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WTF/wtf/StackTrace.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="StackStats.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="StdLibExtras.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WTF/wtf/StackTrace.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
113 #if HAVE(BACKTRACE_SYMBOLS)
114     char** symbols = backtrace_symbols(stack, m_size);
115     if (!symbols)
116         return;
117 #elif OS(WINDOWS)
118     HANDLE hProc = GetCurrentProcess();
119     uint8_t symbolData[sizeof(SYMBOL_INFO) + MAX_SYM_NAME * sizeof(TCHAR)] = { 0 };
120     auto symbolInfo = reinterpret_cast&lt;SYMBOL_INFO*&gt;(symbolData);
121 
122     symbolInfo-&gt;SizeOfStruct = sizeof(SYMBOL_INFO);
123     symbolInfo-&gt;MaxNameLen = MAX_SYM_NAME;
124 #endif
125 
126     if (!indentString)
127         indentString = &quot;&quot;;
128     for (int i = 0; i &lt; m_size; ++i) {
129         const char* mangledName = nullptr;
130         const char* cxaDemangled = nullptr;
131 #if HAVE(BACKTRACE_SYMBOLS)
132         mangledName = symbols[i];
<span class="line-modified">133 #elif HAVE(DLADDR)</span>



134         auto demangled = demangle(stack[i]);
135         if (demangled) {
136             mangledName = demangled-&gt;mangledName();
137             cxaDemangled = demangled-&gt;demangledName();
138         }
<span class="line-removed">139 #elif OS(WINDOWS)</span>
<span class="line-removed">140         if (DbgHelper::SymFromAddress(hProc, reinterpret_cast&lt;DWORD64&gt;(stack[i]), 0, symbolInfo))</span>
<span class="line-removed">141             mangledName = symbolInfo-&gt;Name;</span>
<span class="line-removed">142 #endif</span>
143         const int frameNumber = i + 1;
144         if (mangledName || cxaDemangled)
145             out.printf(&quot;%s%-3d %p %s\n&quot;, indentString, frameNumber, stack[i], cxaDemangled ? cxaDemangled : mangledName);
146         else
147             out.printf(&quot;%s%-3d %p\n&quot;, indentString, frameNumber, stack[i]);
148     }
149 
150 #if HAVE(BACKTRACE_SYMBOLS)
151     free(symbols);
152 #endif
153 }
154 
155 } // namespace WTF
</pre>
</td>
<td>
<hr />
<pre>
113 #if HAVE(BACKTRACE_SYMBOLS)
114     char** symbols = backtrace_symbols(stack, m_size);
115     if (!symbols)
116         return;
117 #elif OS(WINDOWS)
118     HANDLE hProc = GetCurrentProcess();
119     uint8_t symbolData[sizeof(SYMBOL_INFO) + MAX_SYM_NAME * sizeof(TCHAR)] = { 0 };
120     auto symbolInfo = reinterpret_cast&lt;SYMBOL_INFO*&gt;(symbolData);
121 
122     symbolInfo-&gt;SizeOfStruct = sizeof(SYMBOL_INFO);
123     symbolInfo-&gt;MaxNameLen = MAX_SYM_NAME;
124 #endif
125 
126     if (!indentString)
127         indentString = &quot;&quot;;
128     for (int i = 0; i &lt; m_size; ++i) {
129         const char* mangledName = nullptr;
130         const char* cxaDemangled = nullptr;
131 #if HAVE(BACKTRACE_SYMBOLS)
132         mangledName = symbols[i];
<span class="line-modified">133 #elif OS(WINDOWS)</span>
<span class="line-added">134         if (DbgHelper::SymFromAddress(hProc, reinterpret_cast&lt;DWORD64&gt;(stack[i]), 0, symbolInfo))</span>
<span class="line-added">135             mangledName = symbolInfo-&gt;Name;</span>
<span class="line-added">136 #endif</span>
137         auto demangled = demangle(stack[i]);
138         if (demangled) {
139             mangledName = demangled-&gt;mangledName();
140             cxaDemangled = demangled-&gt;demangledName();
141         }




142         const int frameNumber = i + 1;
143         if (mangledName || cxaDemangled)
144             out.printf(&quot;%s%-3d %p %s\n&quot;, indentString, frameNumber, stack[i], cxaDemangled ? cxaDemangled : mangledName);
145         else
146             out.printf(&quot;%s%-3d %p\n&quot;, indentString, frameNumber, stack[i]);
147     }
148 
149 #if HAVE(BACKTRACE_SYMBOLS)
150     free(symbols);
151 #endif
152 }
153 
154 } // namespace WTF
</pre>
</td>
</tr>
</table>
<center><a href="StackStats.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="StdLibExtras.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>