<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/testing/InternalSettings.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
   1 /*
   2  * Copyright (C) 2012 Google Inc. All rights reserved.
   3  * Copyright (C) 2013 Apple Inc. All rights reserved.
   4  *
   5  * Redistribution and use in source and binary forms, with or without
   6  * modification, are permitted provided that the following conditions
   7  * are met:
   8  *
   9  * 1.  Redistributions of source code must retain the above copyright
  10  *     notice, this list of conditions and the following disclaimer.
  11  * 2.  Redistributions in binary form must reproduce the above copyright
  12  *     notice, this list of conditions and the following disclaimer in the
  13  *     documentation and/or other materials provided with the distribution.
  14  *
  15  * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS &quot;AS IS&quot; AND ANY
  16  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
  17  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  18  * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
  19  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  20  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  21  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  22  * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  23  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
  24  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  25  */
  26 
  27 #include &quot;config.h&quot;
  28 #include &quot;InternalSettings.h&quot;
  29 
  30 #include &quot;CaptionUserPreferences.h&quot;
  31 #include &quot;DeprecatedGlobalSettings.h&quot;
  32 #include &quot;Document.h&quot;
  33 #include &quot;FontCache.h&quot;
  34 #include &quot;Frame.h&quot;
  35 #include &quot;FrameView.h&quot;
  36 #include &quot;LocaleToScriptMapping.h&quot;
  37 #include &quot;Page.h&quot;
  38 #include &quot;PageGroup.h&quot;
  39 #include &quot;PlatformMediaSessionManager.h&quot;
  40 #include &quot;RenderTheme.h&quot;
  41 #include &quot;RuntimeEnabledFeatures.h&quot;
  42 #include &quot;Settings.h&quot;
  43 #include &quot;Supplementable.h&quot;
  44 #include &lt;wtf/Language.h&gt;
  45 
  46 #if ENABLE(INPUT_TYPE_COLOR)
  47 #include &quot;ColorChooser.h&quot;
  48 #endif
  49 
  50 #if USE(SOUP)
  51 #include &quot;SoupNetworkSession.h&quot;
  52 #endif
  53 
  54 namespace WebCore {
  55 
  56 InternalSettings::Backup::Backup(Settings&amp; settings)
  57     : m_originalEditingBehavior(settings.editingBehaviorType())
  58 #if ENABLE(TEXT_AUTOSIZING)
  59     , m_originalTextAutosizingEnabled(settings.textAutosizingEnabled())
  60     , m_originalTextAutosizingWindowSizeOverride(settings.textAutosizingWindowSizeOverride())
  61     , m_originalTextAutosizingUsesIdempotentMode(settings.textAutosizingUsesIdempotentMode())
  62 #endif
  63     , m_originalMediaTypeOverride(settings.mediaTypeOverride())
  64     , m_originalCanvasUsesAcceleratedDrawing(settings.canvasUsesAcceleratedDrawing())
  65     , m_originalMockScrollbarsEnabled(DeprecatedGlobalSettings::mockScrollbarsEnabled())
  66     , m_imagesEnabled(settings.areImagesEnabled())
  67     , m_preferMIMETypeForImages(settings.preferMIMETypeForImages())
  68     , m_minimumDOMTimerInterval(settings.minimumDOMTimerInterval())
  69 #if ENABLE(VIDEO_TRACK)
  70     , m_shouldDisplaySubtitles(settings.shouldDisplaySubtitles())
  71     , m_shouldDisplayCaptions(settings.shouldDisplayCaptions())
  72     , m_shouldDisplayTextDescriptions(settings.shouldDisplayTextDescriptions())
  73 #endif
  74     , m_defaultVideoPosterURL(settings.defaultVideoPosterURL())
  75     , m_forcePendingWebGLPolicy(settings.isForcePendingWebGLPolicy())
  76     , m_originalTimeWithoutMouseMovementBeforeHidingControls(settings.timeWithoutMouseMovementBeforeHidingControls())
  77     , m_useLegacyBackgroundSizeShorthandBehavior(settings.useLegacyBackgroundSizeShorthandBehavior())
  78     , m_autoscrollForDragAndDropEnabled(settings.autoscrollForDragAndDropEnabled())
  79     , m_quickTimePluginReplacementEnabled(settings.quickTimePluginReplacementEnabled())
  80     , m_youTubeFlashPluginReplacementEnabled(settings.youTubeFlashPluginReplacementEnabled())
  81     , m_shouldConvertPositionStyleOnCopy(settings.shouldConvertPositionStyleOnCopy())
  82     , m_fontFallbackPrefersPictographs(settings.fontFallbackPrefersPictographs())
  83     , m_shouldIgnoreFontLoadCompletions(settings.shouldIgnoreFontLoadCompletions())
  84     , m_backgroundShouldExtendBeyondPage(settings.backgroundShouldExtendBeyondPage())
  85     , m_storageBlockingPolicy(settings.storageBlockingPolicy())
  86     , m_scrollingTreeIncludesFrames(settings.scrollingTreeIncludesFrames())
  87 #if ENABLE(TOUCH_EVENTS)
  88     , m_touchEventEmulationEnabled(settings.isTouchEventEmulationEnabled())
  89 #endif
  90 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
  91     , m_allowsAirPlayForMediaPlayback(settings.allowsAirPlayForMediaPlayback())
  92 #endif
  93     , m_allowsInlineMediaPlayback(settings.allowsInlineMediaPlayback())
  94     , m_allowsInlineMediaPlaybackAfterFullscreen(settings.allowsInlineMediaPlaybackAfterFullscreen())
  95     , m_inlineMediaPlaybackRequiresPlaysInlineAttribute(settings.inlineMediaPlaybackRequiresPlaysInlineAttribute())
  96     , m_deferredCSSParserEnabled(settings.deferredCSSParserEnabled())
  97     , m_inputEventsEnabled(settings.inputEventsEnabled())
  98     , m_incompleteImageBorderEnabled(settings.incompleteImageBorderEnabled())
  99     , m_shouldDispatchSyntheticMouseEventsWhenModifyingSelection(settings.shouldDispatchSyntheticMouseEventsWhenModifyingSelection())
 100     , m_shouldDispatchSyntheticMouseOutAfterSyntheticClick(settings.shouldDispatchSyntheticMouseOutAfterSyntheticClick())
 101 #if ENABLE(VIDEO) || ENABLE(WEB_AUDIO)
 102     , m_shouldDeactivateAudioSession(PlatformMediaSessionManager::shouldDeactivateAudioSession())
 103 #endif
 104     , m_animatedImageDebugCanvasDrawingEnabled(settings.animatedImageDebugCanvasDrawingEnabled())
 105     , m_userInterfaceDirectionPolicy(settings.userInterfaceDirectionPolicy())
 106     , m_systemLayoutDirection(settings.systemLayoutDirection())
 107     , m_pdfImageCachingPolicy(settings.pdfImageCachingPolicy())
 108     , m_forcedColorsAreInvertedAccessibilityValue(settings.forcedColorsAreInvertedAccessibilityValue())
 109     , m_forcedDisplayIsMonochromeAccessibilityValue(settings.forcedDisplayIsMonochromeAccessibilityValue())
 110     , m_forcedPrefersReducedMotionAccessibilityValue(settings.forcedPrefersReducedMotionAccessibilityValue())
 111     , m_fontLoadTimingOverride(settings.fontLoadTimingOverride())
 112     , m_frameFlattening(settings.frameFlattening())
 113 #if ENABLE(INDEXED_DATABASE_IN_WORKERS)
 114     , m_indexedDBWorkersEnabled(RuntimeEnabledFeatures::sharedFeatures().indexedDBWorkersEnabled())
 115 #endif
 116 #if ENABLE(WEBGL2)
 117     , m_webGL2Enabled(RuntimeEnabledFeatures::sharedFeatures().webGL2Enabled())
 118 #endif
 119 #if ENABLE(MEDIA_STREAM)
 120     , m_setScreenCaptureEnabled(RuntimeEnabledFeatures::sharedFeatures().screenCaptureEnabled())
 121 #endif
 122     , m_shouldMockBoldSystemFontForAccessibility(RenderTheme::singleton().shouldMockBoldSystemFontForAccessibility())
 123 #if USE(AUDIO_SESSION)
 124     , m_shouldManageAudioSessionCategory(DeprecatedGlobalSettings::shouldManageAudioSessionCategory())
 125 #endif
 126     , m_customPasteboardDataEnabled(RuntimeEnabledFeatures::sharedFeatures().customPasteboardDataEnabled())
 127 {
 128 }
 129 
 130 void InternalSettings::Backup::restoreTo(Settings&amp; settings)
 131 {
 132     settings.setEditingBehaviorType(m_originalEditingBehavior);
 133 
 134     for (const auto&amp; standardFont : m_standardFontFamilies)
 135         settings.setStandardFontFamily(standardFont.value, static_cast&lt;UScriptCode&gt;(standardFont.key));
 136     m_standardFontFamilies.clear();
 137 
 138     for (const auto&amp; fixedFont : m_fixedFontFamilies)
 139         settings.setFixedFontFamily(fixedFont.value, static_cast&lt;UScriptCode&gt;(fixedFont.key));
 140     m_fixedFontFamilies.clear();
 141 
 142     for (const auto&amp; serifFont : m_serifFontFamilies)
 143         settings.setSerifFontFamily(serifFont.value, static_cast&lt;UScriptCode&gt;(serifFont.key));
 144     m_serifFontFamilies.clear();
 145 
 146     for (const auto&amp; sansSerifFont : m_sansSerifFontFamilies)
 147         settings.setSansSerifFontFamily(sansSerifFont.value, static_cast&lt;UScriptCode&gt;(sansSerifFont.key));
 148     m_sansSerifFontFamilies.clear();
 149 
 150     for (const auto&amp; cursiveFont : m_cursiveFontFamilies)
 151         settings.setCursiveFontFamily(cursiveFont.value, static_cast&lt;UScriptCode&gt;(cursiveFont.key));
 152     m_cursiveFontFamilies.clear();
 153 
 154     for (const auto&amp; fantasyFont : m_fantasyFontFamilies)
 155         settings.setFantasyFontFamily(fantasyFont.value, static_cast&lt;UScriptCode&gt;(fantasyFont.key));
 156     m_fantasyFontFamilies.clear();
 157 
 158     for (const auto&amp; pictographFont : m_pictographFontFamilies)
 159         settings.setPictographFontFamily(pictographFont.value, static_cast&lt;UScriptCode&gt;(pictographFont.key));
 160     m_pictographFontFamilies.clear();
 161 
 162 #if ENABLE(TEXT_AUTOSIZING)
 163     settings.setTextAutosizingEnabled(m_originalTextAutosizingEnabled);
 164     settings.setTextAutosizingWindowSizeOverride(m_originalTextAutosizingWindowSizeOverride);
 165     settings.setTextAutosizingUsesIdempotentMode(m_originalTextAutosizingUsesIdempotentMode);
 166 #endif
 167     settings.setMediaTypeOverride(m_originalMediaTypeOverride);
 168     settings.setCanvasUsesAcceleratedDrawing(m_originalCanvasUsesAcceleratedDrawing);
 169     settings.setImagesEnabled(m_imagesEnabled);
 170     settings.setPreferMIMETypeForImages(m_preferMIMETypeForImages);
 171     settings.setMinimumDOMTimerInterval(m_minimumDOMTimerInterval);
 172 #if ENABLE(VIDEO_TRACK)
 173     settings.setShouldDisplaySubtitles(m_shouldDisplaySubtitles);
 174     settings.setShouldDisplayCaptions(m_shouldDisplayCaptions);
 175     settings.setShouldDisplayTextDescriptions(m_shouldDisplayTextDescriptions);
 176 #endif
 177     settings.setDefaultVideoPosterURL(m_defaultVideoPosterURL);
 178     settings.setForcePendingWebGLPolicy(m_forcePendingWebGLPolicy);
 179     settings.setTimeWithoutMouseMovementBeforeHidingControls(m_originalTimeWithoutMouseMovementBeforeHidingControls);
 180     settings.setUseLegacyBackgroundSizeShorthandBehavior(m_useLegacyBackgroundSizeShorthandBehavior);
 181     settings.setAutoscrollForDragAndDropEnabled(m_autoscrollForDragAndDropEnabled);
 182     settings.setShouldConvertPositionStyleOnCopy(m_shouldConvertPositionStyleOnCopy);
 183     settings.setFontFallbackPrefersPictographs(m_fontFallbackPrefersPictographs);
 184     settings.setShouldIgnoreFontLoadCompletions(m_shouldIgnoreFontLoadCompletions);
 185     settings.setBackgroundShouldExtendBeyondPage(m_backgroundShouldExtendBeyondPage);
 186     settings.setStorageBlockingPolicy(m_storageBlockingPolicy);
 187     settings.setScrollingTreeIncludesFrames(m_scrollingTreeIncludesFrames);
 188 #if ENABLE(TOUCH_EVENTS)
 189     settings.setTouchEventEmulationEnabled(m_touchEventEmulationEnabled);
 190 #endif
 191     settings.setAllowsInlineMediaPlayback(m_allowsInlineMediaPlayback);
 192     settings.setAllowsInlineMediaPlaybackAfterFullscreen(m_allowsInlineMediaPlaybackAfterFullscreen);
 193     settings.setInlineMediaPlaybackRequiresPlaysInlineAttribute(m_inlineMediaPlaybackRequiresPlaysInlineAttribute);
 194     settings.setQuickTimePluginReplacementEnabled(m_quickTimePluginReplacementEnabled);
 195     settings.setYouTubeFlashPluginReplacementEnabled(m_youTubeFlashPluginReplacementEnabled);
 196     settings.setDeferredCSSParserEnabled(m_deferredCSSParserEnabled);
 197     settings.setInputEventsEnabled(m_inputEventsEnabled);
 198     settings.setUserInterfaceDirectionPolicy(m_userInterfaceDirectionPolicy);
 199     settings.setSystemLayoutDirection(m_systemLayoutDirection);
 200     settings.setPdfImageCachingPolicy(m_pdfImageCachingPolicy);
 201     settings.setForcedColorsAreInvertedAccessibilityValue(m_forcedColorsAreInvertedAccessibilityValue);
 202     settings.setForcedDisplayIsMonochromeAccessibilityValue(m_forcedDisplayIsMonochromeAccessibilityValue);
 203     settings.setForcedPrefersReducedMotionAccessibilityValue(m_forcedPrefersReducedMotionAccessibilityValue);
 204     settings.setFontLoadTimingOverride(m_fontLoadTimingOverride);
 205     RenderTheme::singleton().setShouldMockBoldSystemFontForAccessibility(m_shouldMockBoldSystemFontForAccessibility);
 206     FontCache::singleton().setShouldMockBoldSystemFontForAccessibility(m_shouldMockBoldSystemFontForAccessibility);
 207     settings.setFrameFlattening(m_frameFlattening);
 208     settings.setIncompleteImageBorderEnabled(m_incompleteImageBorderEnabled);
 209     settings.setShouldDispatchSyntheticMouseEventsWhenModifyingSelection(m_shouldDispatchSyntheticMouseEventsWhenModifyingSelection);
 210     settings.setShouldDispatchSyntheticMouseOutAfterSyntheticClick(m_shouldDispatchSyntheticMouseOutAfterSyntheticClick);
 211 #if ENABLE(VIDEO) || ENABLE(WEB_AUDIO)
 212     PlatformMediaSessionManager::setShouldDeactivateAudioSession(m_shouldDeactivateAudioSession);
 213 #endif
 214     settings.setAnimatedImageDebugCanvasDrawingEnabled(m_animatedImageDebugCanvasDrawingEnabled);
 215 
 216 #if ENABLE(INDEXED_DATABASE_IN_WORKERS)
 217     RuntimeEnabledFeatures::sharedFeatures().setIndexedDBWorkersEnabled(m_indexedDBWorkersEnabled);
 218 #endif
 219 #if ENABLE(WEBGL2)
 220     RuntimeEnabledFeatures::sharedFeatures().setWebGL2Enabled(m_webGL2Enabled);
 221 #endif
 222 #if ENABLE(MEDIA_STREAM)
 223     RuntimeEnabledFeatures::sharedFeatures().setScreenCaptureEnabled(m_setScreenCaptureEnabled);
 224 #endif
 225     RuntimeEnabledFeatures::sharedFeatures().setCustomPasteboardDataEnabled(m_customPasteboardDataEnabled);
 226 
 227 #if USE(AUDIO_SESSION)
 228     DeprecatedGlobalSettings::setShouldManageAudioSessionCategory(m_shouldManageAudioSessionCategory);
 229 #endif
 230 }
 231 
 232 class InternalSettingsWrapper : public Supplement&lt;Page&gt; {
 233     WTF_MAKE_FAST_ALLOCATED;
 234 public:
 235     explicit InternalSettingsWrapper(Page* page)
 236         : m_internalSettings(InternalSettings::create(page)) { }
 237     virtual ~InternalSettingsWrapper() { m_internalSettings-&gt;hostDestroyed(); }
 238 #if ASSERT_ENABLED
 239     bool isRefCountedWrapper() const override { return true; }
 240 #endif
 241     InternalSettings* internalSettings() const { return m_internalSettings.get(); }
 242 
 243 private:
 244     RefPtr&lt;InternalSettings&gt; m_internalSettings;
 245 };
 246 
 247 const char* InternalSettings::supplementName()
 248 {
 249     return &quot;InternalSettings&quot;;
 250 }
 251 
 252 InternalSettings* InternalSettings::from(Page* page)
 253 {
 254     if (!Supplement&lt;Page&gt;::from(page, supplementName()))
 255         Supplement&lt;Page&gt;::provideTo(page, supplementName(), makeUnique&lt;InternalSettingsWrapper&gt;(page));
 256     return static_cast&lt;InternalSettingsWrapper*&gt;(Supplement&lt;Page&gt;::from(page, supplementName()))-&gt;internalSettings();
 257 }
 258 
 259 void InternalSettings::hostDestroyed()
 260 {
 261     m_page = nullptr;
 262 }
 263 
 264 InternalSettings::InternalSettings(Page* page)
 265     : InternalSettingsGenerated(page)
 266     , m_page(page)
 267     , m_backup(page-&gt;settings())
 268 {
 269 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
 270     setAllowsAirPlayForMediaPlayback(false);
 271 #endif
 272 #if ENABLE(MEDIA_STREAM)
 273     setMediaCaptureRequiresSecureConnection(false);
 274 #endif
 275 }
 276 
 277 Ref&lt;InternalSettings&gt; InternalSettings::create(Page* page)
 278 {
 279     return adoptRef(*new InternalSettings(page));
 280 }
 281 
 282 void InternalSettings::resetToConsistentState()
 283 {
 284     m_page-&gt;setPageScaleFactor(1, { 0, 0 });
 285     m_page-&gt;mainFrame().setPageAndTextZoomFactors(1, 1);
 286     m_page-&gt;setCanStartMedia(true);
 287     setUseDarkAppearanceInternal(false);
 288 
 289     settings().setForcePendingWebGLPolicy(false);
 290 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
 291     settings().setAllowsAirPlayForMediaPlayback(false);
 292 #endif
 293 #if ENABLE(MEDIA_STREAM)
 294     setMediaCaptureRequiresSecureConnection(false);
 295 #endif
 296 
 297     m_backup.restoreTo(settings());
 298     m_backup = Backup { settings() };
 299 
 300     InternalSettingsGenerated::resetToConsistentState();
 301 }
 302 
 303 Settings&amp; InternalSettings::settings() const
 304 {
 305     ASSERT(m_page);
 306     return m_page-&gt;settings();
 307 }
 308 
 309 ExceptionOr&lt;void&gt; InternalSettings::setTouchEventEmulationEnabled(bool enabled)
 310 {
 311     if (!m_page)
 312         return Exception { InvalidAccessError };
 313 #if ENABLE(TOUCH_EVENTS)
 314     settings().setTouchEventEmulationEnabled(enabled);
 315 #else
 316     UNUSED_PARAM(enabled);
 317 #endif
 318     return { };
 319 }
 320 
 321 ExceptionOr&lt;void&gt; InternalSettings::setStandardFontFamily(const String&amp; family, const String&amp; script)
 322 {
 323     if (!m_page)
 324         return Exception { InvalidAccessError };
 325     UScriptCode code = scriptNameToCode(script);
 326     if (code == USCRIPT_INVALID_CODE)
 327         return { };
 328     m_backup.m_standardFontFamilies.add(code, settings().standardFontFamily(code));
 329     settings().setStandardFontFamily(family, code);
 330     return { };
 331 }
 332 
 333 ExceptionOr&lt;void&gt; InternalSettings::setSerifFontFamily(const String&amp; family, const String&amp; script)
 334 {
 335     if (!m_page)
 336         return Exception { InvalidAccessError };
 337     UScriptCode code = scriptNameToCode(script);
 338     if (code == USCRIPT_INVALID_CODE)
 339         return { };
 340     m_backup.m_serifFontFamilies.add(code, settings().serifFontFamily(code));
 341     settings().setSerifFontFamily(family, code);
 342     return { };
 343 }
 344 
 345 ExceptionOr&lt;void&gt; InternalSettings::setSansSerifFontFamily(const String&amp; family, const String&amp; script)
 346 {
 347     if (!m_page)
 348         return Exception { InvalidAccessError };
 349     UScriptCode code = scriptNameToCode(script);
 350     if (code == USCRIPT_INVALID_CODE)
 351         return { };
 352     m_backup.m_sansSerifFontFamilies.add(code, settings().sansSerifFontFamily(code));
 353     settings().setSansSerifFontFamily(family, code);
 354     return { };
 355 }
 356 
 357 ExceptionOr&lt;void&gt; InternalSettings::setFixedFontFamily(const String&amp; family, const String&amp; script)
 358 {
 359     if (!m_page)
 360         return Exception { InvalidAccessError };
 361     UScriptCode code = scriptNameToCode(script);
 362     if (code == USCRIPT_INVALID_CODE)
 363         return { };
 364     m_backup.m_fixedFontFamilies.add(code, settings().fixedFontFamily(code));
 365     settings().setFixedFontFamily(family, code);
 366     return { };
 367 }
 368 
 369 ExceptionOr&lt;void&gt; InternalSettings::setCursiveFontFamily(const String&amp; family, const String&amp; script)
 370 {
 371     if (!m_page)
 372         return Exception { InvalidAccessError };
 373     UScriptCode code = scriptNameToCode(script);
 374     if (code == USCRIPT_INVALID_CODE)
 375         return { };
 376     m_backup.m_cursiveFontFamilies.add(code, settings().cursiveFontFamily(code));
 377     settings().setCursiveFontFamily(family, code);
 378     return { };
 379 }
 380 
 381 ExceptionOr&lt;void&gt; InternalSettings::setFantasyFontFamily(const String&amp; family, const String&amp; script)
 382 {
 383     if (!m_page)
 384         return Exception { InvalidAccessError };
 385     UScriptCode code = scriptNameToCode(script);
 386     if (code == USCRIPT_INVALID_CODE)
 387         return { };
 388     m_backup.m_fantasyFontFamilies.add(code, settings().fantasyFontFamily(code));
 389     settings().setFantasyFontFamily(family, code);
 390     return { };
 391 }
 392 
 393 ExceptionOr&lt;void&gt; InternalSettings::setPictographFontFamily(const String&amp; family, const String&amp; script)
 394 {
 395     if (!m_page)
 396         return Exception { InvalidAccessError };
 397     UScriptCode code = scriptNameToCode(script);
 398     if (code == USCRIPT_INVALID_CODE)
 399         return { };
 400     m_backup.m_pictographFontFamilies.add(code, settings().pictographFontFamily(code));
 401     settings().setPictographFontFamily(family, code);
 402     return { };
 403 }
 404 
 405 ExceptionOr&lt;void&gt; InternalSettings::setTextAutosizingEnabled(bool enabled)
 406 {
 407     if (!m_page)
 408         return Exception { InvalidAccessError };
 409 #if ENABLE(TEXT_AUTOSIZING)
 410     settings().setTextAutosizingEnabled(enabled);
 411 #else
 412     UNUSED_PARAM(enabled);
 413 #endif
 414     return { };
 415 }
 416 
 417 ExceptionOr&lt;void&gt; InternalSettings::setTextAutosizingWindowSizeOverride(int width, int height)
 418 {
 419     if (!m_page)
 420         return Exception { InvalidAccessError };
 421 #if ENABLE(TEXT_AUTOSIZING)
 422     settings().setTextAutosizingWindowSizeOverride(IntSize(width, height));
 423 #else
 424     UNUSED_PARAM(width);
 425     UNUSED_PARAM(height);
 426 #endif
 427     return { };
 428 }
 429 
 430 ExceptionOr&lt;void&gt; InternalSettings::setTextAutosizingUsesIdempotentMode(bool enabled)
 431 {
 432     if (!m_page)
 433         return Exception { InvalidAccessError };
 434 #if ENABLE(TEXT_AUTOSIZING)
 435     settings().setTextAutosizingUsesIdempotentMode(enabled);
 436 #else
 437     UNUSED_PARAM(enabled);
 438 #endif
 439     return { };
 440 }
 441 
 442 ExceptionOr&lt;void&gt; InternalSettings::setMediaTypeOverride(const String&amp; mediaType)
 443 {
 444     if (!m_page)
 445         return Exception { InvalidAccessError };
 446     settings().setMediaTypeOverride(mediaType);
 447     return { };
 448 }
 449 
 450 ExceptionOr&lt;void&gt; InternalSettings::setCanStartMedia(bool enabled)
 451 {
 452     if (!m_page)
 453         return Exception { InvalidAccessError };
 454     m_page-&gt;setCanStartMedia(enabled);
 455     return { };
 456 }
 457 
 458 ExceptionOr&lt;void&gt; InternalSettings::setAllowsAirPlayForMediaPlayback(bool allows)
 459 {
 460     if (!m_page)
 461         return Exception { InvalidAccessError };
 462 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
 463     settings().setAllowsAirPlayForMediaPlayback(allows);
 464 #else
 465     UNUSED_PARAM(allows);
 466 #endif
 467     return { };
 468 }
 469 
 470 ExceptionOr&lt;void&gt; InternalSettings::setMediaCaptureRequiresSecureConnection(bool requires)
 471 {
 472     if (!m_page)
 473         return Exception { InvalidAccessError };
 474 #if ENABLE(MEDIA_STREAM)
 475     m_page-&gt;settings().setMediaCaptureRequiresSecureConnection(requires);
 476 #else
 477     UNUSED_PARAM(requires);
 478 #endif
 479     return { };
 480 }
 481 
 482 ExceptionOr&lt;void&gt; InternalSettings::setEditingBehavior(const String&amp; editingBehavior)
 483 {
 484     if (!m_page)
 485         return Exception { InvalidAccessError };
 486     if (equalLettersIgnoringASCIICase(editingBehavior, &quot;win&quot;))
 487         settings().setEditingBehaviorType(EditingWindowsBehavior);
 488     else if (equalLettersIgnoringASCIICase(editingBehavior, &quot;mac&quot;))
 489         settings().setEditingBehaviorType(EditingMacBehavior);
 490     else if (equalLettersIgnoringASCIICase(editingBehavior, &quot;unix&quot;))
 491         settings().setEditingBehaviorType(EditingUnixBehavior);
 492     else if (equalLettersIgnoringASCIICase(editingBehavior, &quot;ios&quot;))
 493         settings().setEditingBehaviorType(EditingIOSBehavior);
 494     else
 495         return Exception { SyntaxError };
 496     return { };
 497 }
 498 
 499 ExceptionOr&lt;void&gt; InternalSettings::setShouldDisplayTrackKind(const String&amp; kind, bool enabled)
 500 {
 501     if (!m_page)
 502         return Exception { InvalidAccessError };
 503 #if ENABLE(VIDEO_TRACK)
 504     auto&amp; captionPreferences = m_page-&gt;group().captionPreferences();
 505     if (equalLettersIgnoringASCIICase(kind, &quot;subtitles&quot;))
 506         captionPreferences.setUserPrefersSubtitles(enabled);
 507     else if (equalLettersIgnoringASCIICase(kind, &quot;captions&quot;))
 508         captionPreferences.setUserPrefersCaptions(enabled);
 509     else if (equalLettersIgnoringASCIICase(kind, &quot;textdescriptions&quot;))
 510         captionPreferences.setUserPrefersTextDescriptions(enabled);
 511     else
 512         return Exception { SyntaxError };
 513 #else
 514     UNUSED_PARAM(kind);
 515     UNUSED_PARAM(enabled);
 516 #endif
 517     return { };
 518 }
 519 
 520 ExceptionOr&lt;bool&gt; InternalSettings::shouldDisplayTrackKind(const String&amp; kind)
 521 {
 522     if (!m_page)
 523         return Exception { InvalidAccessError };
 524 #if ENABLE(VIDEO_TRACK)
 525     auto&amp; captionPreferences = m_page-&gt;group().captionPreferences();
 526     if (equalLettersIgnoringASCIICase(kind, &quot;subtitles&quot;))
 527         return captionPreferences.userPrefersSubtitles();
 528     if (equalLettersIgnoringASCIICase(kind, &quot;captions&quot;))
 529         return captionPreferences.userPrefersCaptions();
 530     if (equalLettersIgnoringASCIICase(kind, &quot;textdescriptions&quot;))
 531         return captionPreferences.userPrefersTextDescriptions();
 532 
 533     return Exception { SyntaxError };
 534 #else
 535     UNUSED_PARAM(kind);
 536     return false;
 537 #endif
 538 }
 539 
 540 void InternalSettings::setUseDarkAppearanceInternal(bool useDarkAppearance)
 541 {
 542     ASSERT(m_page);
 543     m_page-&gt;effectiveAppearanceDidChange(useDarkAppearance, m_page-&gt;useElevatedUserInterfaceLevel());
 544 }
 545 
 546 ExceptionOr&lt;void&gt; InternalSettings::setUseDarkAppearance(bool useDarkAppearance)
 547 {
 548     if (!m_page)
 549         return Exception { InvalidAccessError };
 550     setUseDarkAppearanceInternal(useDarkAppearance);
 551     return { };
 552 }
 553 
 554 ExceptionOr&lt;void&gt; InternalSettings::setStorageBlockingPolicy(const String&amp; mode)
 555 {
 556     if (!m_page)
 557         return Exception { InvalidAccessError };
 558     if (mode == &quot;AllowAll&quot;)
 559         settings().setStorageBlockingPolicy(SecurityOrigin::AllowAllStorage);
 560     else if (mode == &quot;BlockThirdParty&quot;)
 561         settings().setStorageBlockingPolicy(SecurityOrigin::BlockThirdPartyStorage);
 562     else if (mode == &quot;BlockAll&quot;)
 563         settings().setStorageBlockingPolicy(SecurityOrigin::BlockAllStorage);
 564     else
 565         return Exception { SyntaxError };
 566     return { };
 567 }
 568 
 569 ExceptionOr&lt;void&gt; InternalSettings::setPreferMIMETypeForImages(bool preferMIMETypeForImages)
 570 {
 571     if (!m_page)
 572         return Exception { InvalidAccessError };
 573     settings().setPreferMIMETypeForImages(preferMIMETypeForImages);
 574     return { };
 575 }
 576 
 577 ExceptionOr&lt;void&gt; InternalSettings::setImagesEnabled(bool enabled)
 578 {
 579     if (!m_page)
 580         return Exception { InvalidAccessError };
 581     settings().setImagesEnabled(enabled);
 582     return { };
 583 }
 584 
 585 ExceptionOr&lt;void&gt; InternalSettings::setPDFImageCachingPolicy(const String&amp; policy)
 586 {
 587     if (!m_page)
 588         return Exception { InvalidAccessError };
 589     if (equalLettersIgnoringASCIICase(policy, &quot;disabled&quot;))
 590         settings().setPdfImageCachingPolicy(PDFImageCachingDisabled);
 591     else if (equalLettersIgnoringASCIICase(policy, &quot;belowmemorylimit&quot;))
 592         settings().setPdfImageCachingPolicy(PDFImageCachingBelowMemoryLimit);
 593     else if (equalLettersIgnoringASCIICase(policy, &quot;clipboundsonly&quot;))
 594         settings().setPdfImageCachingPolicy(PDFImageCachingClipBoundsOnly);
 595     else if (equalLettersIgnoringASCIICase(policy, &quot;enabled&quot;))
 596         settings().setPdfImageCachingPolicy(PDFImageCachingEnabled);
 597     else
 598         return Exception { SyntaxError };
 599     return { };
 600 }
 601 
 602 ExceptionOr&lt;void&gt; InternalSettings::setMinimumTimerInterval(double intervalInSeconds)
 603 {
 604     if (!m_page)
 605         return Exception { InvalidAccessError };
 606     settings().setMinimumDOMTimerInterval(Seconds { intervalInSeconds });
 607     return { };
 608 }
 609 
 610 ExceptionOr&lt;void&gt; InternalSettings::setDefaultVideoPosterURL(const String&amp; url)
 611 {
 612     if (!m_page)
 613         return Exception { InvalidAccessError };
 614     settings().setDefaultVideoPosterURL(url);
 615     return { };
 616 }
 617 
 618 ExceptionOr&lt;void&gt; InternalSettings::setForcePendingWebGLPolicy(bool forced)
 619 {
 620     if (!m_page)
 621         return Exception { InvalidAccessError };
 622     settings().setForcePendingWebGLPolicy(forced);
 623     return { };
 624 }
 625 
 626 ExceptionOr&lt;void&gt; InternalSettings::setTimeWithoutMouseMovementBeforeHidingControls(double time)
 627 {
 628     if (!m_page)
 629         return Exception { InvalidAccessError };
 630     settings().setTimeWithoutMouseMovementBeforeHidingControls(Seconds { time });
 631     return { };
 632 }
 633 
 634 ExceptionOr&lt;void&gt; InternalSettings::setUseLegacyBackgroundSizeShorthandBehavior(bool enabled)
 635 {
 636     if (!m_page)
 637         return Exception { InvalidAccessError };
 638     settings().setUseLegacyBackgroundSizeShorthandBehavior(enabled);
 639     return { };
 640 }
 641 
 642 ExceptionOr&lt;void&gt; InternalSettings::setAutoscrollForDragAndDropEnabled(bool enabled)
 643 {
 644     if (!m_page)
 645         return Exception { InvalidAccessError };
 646     settings().setAutoscrollForDragAndDropEnabled(enabled);
 647     return { };
 648 }
 649 
 650 ExceptionOr&lt;void&gt; InternalSettings::setFontFallbackPrefersPictographs(bool preferPictographs)
 651 {
 652     if (!m_page)
 653         return Exception { InvalidAccessError };
 654     settings().setFontFallbackPrefersPictographs(preferPictographs);
 655     return { };
 656 }
 657 
 658 ExceptionOr&lt;void&gt; InternalSettings::setFontLoadTimingOverride(const FontLoadTimingOverride&amp; fontLoadTimingOverride)
 659 {
 660     if (!m_page)
 661         return Exception { InvalidAccessError };
 662     auto policy = Settings::FontLoadTimingOverride::None;
 663     switch (fontLoadTimingOverride) {
 664     case FontLoadTimingOverride::Block:
 665         policy = Settings::FontLoadTimingOverride::Block;
 666         break;
 667     case FontLoadTimingOverride::Swap:
 668         policy = Settings::FontLoadTimingOverride::Swap;
 669         break;
 670     case FontLoadTimingOverride::Failure:
 671         policy = Settings::FontLoadTimingOverride::Failure;
 672         break;
 673     }
 674     settings().setFontLoadTimingOverride(policy);
 675     return { };
 676 }
 677 
 678 ExceptionOr&lt;void&gt; InternalSettings::setShouldIgnoreFontLoadCompletions(bool ignore)
 679 {
 680     if (!m_page)
 681         return Exception { InvalidAccessError };
 682     settings().setShouldIgnoreFontLoadCompletions(ignore);
 683     return { };
 684 }
 685 
 686 ExceptionOr&lt;void&gt; InternalSettings::setQuickTimePluginReplacementEnabled(bool enabled)
 687 {
 688     if (!m_page)
 689         return Exception { InvalidAccessError };
 690     settings().setQuickTimePluginReplacementEnabled(enabled);
 691     return { };
 692 }
 693 
 694 ExceptionOr&lt;void&gt; InternalSettings::setYouTubeFlashPluginReplacementEnabled(bool enabled)
 695 {
 696     if (!m_page)
 697         return Exception { InvalidAccessError };
 698     settings().setYouTubeFlashPluginReplacementEnabled(enabled);
 699     return { };
 700 }
 701 
 702 ExceptionOr&lt;void&gt; InternalSettings::setBackgroundShouldExtendBeyondPage(bool hasExtendedBackground)
 703 {
 704     if (!m_page)
 705         return Exception { InvalidAccessError };
 706     settings().setBackgroundShouldExtendBeyondPage(hasExtendedBackground);
 707     return { };
 708 }
 709 
 710 ExceptionOr&lt;void&gt; InternalSettings::setShouldConvertPositionStyleOnCopy(bool convert)
 711 {
 712     if (!m_page)
 713         return Exception { InvalidAccessError };
 714     settings().setShouldConvertPositionStyleOnCopy(convert);
 715     return { };
 716 }
 717 
 718 ExceptionOr&lt;void&gt; InternalSettings::setScrollingTreeIncludesFrames(bool enabled)
 719 {
 720     if (!m_page)
 721         return Exception { InvalidAccessError };
 722     settings().setScrollingTreeIncludesFrames(enabled);
 723     return { };
 724 }
 725 
 726 ExceptionOr&lt;void&gt; InternalSettings::setAllowUnclampedScrollPosition(bool allowUnclamped)
 727 {
 728     if (!m_page || !m_page-&gt;mainFrame().view())
 729         return Exception { InvalidAccessError };
 730 
 731     m_page-&gt;mainFrame().view()-&gt;setAllowsUnclampedScrollPositionForTesting(allowUnclamped);
 732     return { };
 733 }
 734 
 735 ExceptionOr&lt;void&gt; InternalSettings::setAllowsInlineMediaPlayback(bool allows)
 736 {
 737     if (!m_page)
 738         return Exception { InvalidAccessError };
 739     settings().setAllowsInlineMediaPlayback(allows);
 740     return { };
 741 }
 742 
 743 ExceptionOr&lt;void&gt; InternalSettings::setAllowsInlineMediaPlaybackAfterFullscreen(bool allows)
 744 {
 745     if (!m_page)
 746         return Exception { InvalidAccessError };
 747     settings().setAllowsInlineMediaPlaybackAfterFullscreen(allows);
 748     return { };
 749 }
 750 
 751 ExceptionOr&lt;void&gt; InternalSettings::setInlineMediaPlaybackRequiresPlaysInlineAttribute(bool requires)
 752 {
 753     if (!m_page)
 754         return Exception { InvalidAccessError };
 755     settings().setInlineMediaPlaybackRequiresPlaysInlineAttribute(requires);
 756     return { };
 757 }
 758 
 759 ExceptionOr&lt;void&gt; InternalSettings::setShouldMockBoldSystemFontForAccessibility(bool requires)
 760 {
 761     if (!m_page)
 762         return Exception { InvalidAccessError };
 763     RenderTheme::singleton().setShouldMockBoldSystemFontForAccessibility(requires);
 764     FontCache::singleton().setShouldMockBoldSystemFontForAccessibility(requires);
 765     return { };
 766 }
 767 
 768 ExceptionOr&lt;void&gt; InternalSettings::setAnimatedImageDebugCanvasDrawingEnabled(bool ignore)
 769 {
 770     if (!m_page)
 771         return Exception { InvalidAccessError };
 772     settings().setAnimatedImageDebugCanvasDrawingEnabled(ignore);
 773     return { };
 774 }
 775 
 776 void InternalSettings::setIndexedDBWorkersEnabled(bool enabled)
 777 {
 778 #if ENABLE(INDEXED_DATABASE_IN_WORKERS)
 779     RuntimeEnabledFeatures::sharedFeatures().setIndexedDBWorkersEnabled(enabled);
 780 #else
 781     UNUSED_PARAM(enabled);
 782 #endif
 783 }
 784 
 785 void InternalSettings::setWebGL2Enabled(bool enabled)
 786 {
 787 #if ENABLE(WEBGL2)
 788     RuntimeEnabledFeatures::sharedFeatures().setWebGL2Enabled(enabled);
 789 #else
 790     UNUSED_PARAM(enabled);
 791 #endif
 792 }
 793 
 794 void InternalSettings::setWebGPUEnabled(bool enabled)
 795 {
 796 #if ENABLE(WEBGPU)
 797     RuntimeEnabledFeatures::sharedFeatures().setWebGPUEnabled(enabled);
 798 #else
 799     UNUSED_PARAM(enabled);
 800 #endif
 801 }
 802 
 803 void InternalSettings::setScreenCaptureEnabled(bool enabled)
 804 {
 805 #if ENABLE(MEDIA_STREAM)
 806     RuntimeEnabledFeatures::sharedFeatures().setScreenCaptureEnabled(enabled);
 807 #else
 808     UNUSED_PARAM(enabled);
 809 #endif
 810 }
 811 
 812 ExceptionOr&lt;String&gt; InternalSettings::userInterfaceDirectionPolicy()
 813 {
 814     if (!m_page)
 815         return Exception { InvalidAccessError };
 816     switch (settings().userInterfaceDirectionPolicy()) {
 817     case UserInterfaceDirectionPolicy::Content:
 818         return &quot;Content&quot;_str;
 819     case UserInterfaceDirectionPolicy::System:
 820         return &quot;View&quot;_str;
 821     }
 822     ASSERT_NOT_REACHED();
 823     return Exception { InvalidAccessError };
 824 }
 825 
 826 ExceptionOr&lt;void&gt; InternalSettings::setUserInterfaceDirectionPolicy(const String&amp; policy)
 827 {
 828     if (!m_page)
 829         return Exception { InvalidAccessError };
 830     if (equalLettersIgnoringASCIICase(policy, &quot;content&quot;)) {
 831         settings().setUserInterfaceDirectionPolicy(UserInterfaceDirectionPolicy::Content);
 832         return { };
 833     }
 834     if (equalLettersIgnoringASCIICase(policy, &quot;view&quot;)) {
 835         settings().setUserInterfaceDirectionPolicy(UserInterfaceDirectionPolicy::System);
 836         return { };
 837     }
 838     return Exception { InvalidAccessError };
 839 }
 840 
 841 ExceptionOr&lt;String&gt; InternalSettings::systemLayoutDirection()
 842 {
 843     if (!m_page)
 844         return Exception { InvalidAccessError };
 845     switch (settings().systemLayoutDirection()) {
 846     case TextDirection::LTR:
 847         return &quot;LTR&quot;_str;
 848     case TextDirection::RTL:
 849         return &quot;RTL&quot;_str;
 850     }
 851     ASSERT_NOT_REACHED();
 852     return Exception { InvalidAccessError };
 853 }
 854 
 855 ExceptionOr&lt;void&gt; InternalSettings::setSystemLayoutDirection(const String&amp; direction)
 856 {
 857     if (!m_page)
 858         return Exception { InvalidAccessError };
 859     if (equalLettersIgnoringASCIICase(direction, &quot;ltr&quot;)) {
 860         settings().setSystemLayoutDirection(TextDirection::LTR);
 861         return { };
 862     }
 863     if (equalLettersIgnoringASCIICase(direction, &quot;rtl&quot;)) {
 864         settings().setSystemLayoutDirection(TextDirection::RTL);
 865         return { };
 866     }
 867     return Exception { InvalidAccessError };
 868 }
 869 
 870 ExceptionOr&lt;void&gt; InternalSettings::setFrameFlattening(FrameFlatteningValue frameFlattening)
 871 {
 872     if (!m_page)
 873         return Exception { InvalidAccessError };
 874     settings().setFrameFlattening(frameFlattening);
 875     return { };
 876 }
 877 
 878 void InternalSettings::setAllowsAnySSLCertificate(bool allowsAnyCertificate)
 879 {
 880     DeprecatedGlobalSettings::setAllowsAnySSLCertificate(allowsAnyCertificate);
 881 #if USE(SOUP)
 882     SoupNetworkSession::setShouldIgnoreTLSErrors(allowsAnyCertificate);
 883 #endif
 884 }
 885 
 886 ExceptionOr&lt;bool&gt; InternalSettings::deferredCSSParserEnabled()
 887 {
 888     if (!m_page)
 889         return Exception { InvalidAccessError };
 890     return settings().deferredCSSParserEnabled();
 891 }
 892 
 893 ExceptionOr&lt;void&gt; InternalSettings::setDeferredCSSParserEnabled(bool enabled)
 894 {
 895     if (!m_page)
 896         return Exception { InvalidAccessError };
 897     settings().setDeferredCSSParserEnabled(enabled);
 898     return { };
 899 }
 900 
 901 ExceptionOr&lt;void&gt; InternalSettings::setShouldManageAudioSessionCategory(bool should)
 902 {
 903 #if USE(AUDIO_SESSION)
 904     DeprecatedGlobalSettings::setShouldManageAudioSessionCategory(should);
 905     return { };
 906 #else
 907     UNUSED_PARAM(should);
 908     return Exception { InvalidAccessError };
 909 #endif
 910 }
 911 
 912 ExceptionOr&lt;void&gt; InternalSettings::setCustomPasteboardDataEnabled(bool enabled)
 913 {
 914     RuntimeEnabledFeatures::sharedFeatures().setCustomPasteboardDataEnabled(enabled);
 915     return { };
 916 }
 917 
 918 ExceptionOr&lt;void&gt; InternalSettings::setIncompleteImageBorderEnabled(bool enabled)
 919 {
 920     if (!m_page)
 921         return Exception { InvalidAccessError };
 922     settings().setIncompleteImageBorderEnabled(enabled);
 923     return { };
 924 }
 925 
 926 ExceptionOr&lt;void&gt; InternalSettings::setShouldDispatchSyntheticMouseEventsWhenModifyingSelection(bool shouldDispatch)
 927 {
 928     if (!m_page)
 929         return Exception { InvalidAccessError };
 930     settings().setShouldDispatchSyntheticMouseEventsWhenModifyingSelection(shouldDispatch);
 931     return { };
 932 }
 933 
 934 ExceptionOr&lt;void&gt; InternalSettings::setShouldDispatchSyntheticMouseOutAfterSyntheticClick(bool shouldDispatch)
 935 {
 936     if (!m_page)
 937         return Exception { InvalidAccessError };
 938     settings().setShouldDispatchSyntheticMouseOutAfterSyntheticClick(shouldDispatch);
 939     return { };
 940 }
 941 
 942 static InternalSettings::ForcedAccessibilityValue settingsToInternalSettingsValue(Settings::ForcedAccessibilityValue value)
 943 {
 944     switch (value) {
 945     case Settings::ForcedAccessibilityValue::System:
 946         return InternalSettings::ForcedAccessibilityValue::System;
 947     case Settings::ForcedAccessibilityValue::On:
 948         return InternalSettings::ForcedAccessibilityValue::On;
 949     case Settings::ForcedAccessibilityValue::Off:
 950         return InternalSettings::ForcedAccessibilityValue::Off;
 951     }
 952 
 953     ASSERT_NOT_REACHED();
 954     return InternalSettings::ForcedAccessibilityValue::Off;
 955 }
 956 
 957 static Settings::ForcedAccessibilityValue internalSettingsToSettingsValue(InternalSettings::ForcedAccessibilityValue value)
 958 {
 959     switch (value) {
 960     case InternalSettings::ForcedAccessibilityValue::System:
 961         return Settings::ForcedAccessibilityValue::System;
 962     case InternalSettings::ForcedAccessibilityValue::On:
 963         return Settings::ForcedAccessibilityValue::On;
 964     case InternalSettings::ForcedAccessibilityValue::Off:
 965         return Settings::ForcedAccessibilityValue::Off;
 966     }
 967 
 968     ASSERT_NOT_REACHED();
 969     return Settings::ForcedAccessibilityValue::Off;
 970 }
 971 
 972 InternalSettings::ForcedAccessibilityValue InternalSettings::forcedColorsAreInvertedAccessibilityValue() const
 973 {
 974     return settingsToInternalSettingsValue(settings().forcedColorsAreInvertedAccessibilityValue());
 975 }
 976 
 977 void InternalSettings::setForcedColorsAreInvertedAccessibilityValue(InternalSettings::ForcedAccessibilityValue value)
 978 {
 979     settings().setForcedColorsAreInvertedAccessibilityValue(internalSettingsToSettingsValue(value));
 980 }
 981 
 982 InternalSettings::ForcedAccessibilityValue InternalSettings::forcedDisplayIsMonochromeAccessibilityValue() const
 983 {
 984     return settingsToInternalSettingsValue(settings().forcedDisplayIsMonochromeAccessibilityValue());
 985 }
 986 
 987 void InternalSettings::setForcedDisplayIsMonochromeAccessibilityValue(InternalSettings::ForcedAccessibilityValue value)
 988 {
 989     settings().setForcedDisplayIsMonochromeAccessibilityValue(internalSettingsToSettingsValue(value));
 990 }
 991 
 992 InternalSettings::ForcedAccessibilityValue InternalSettings::forcedPrefersReducedMotionAccessibilityValue() const
 993 {
 994     return settingsToInternalSettingsValue(settings().forcedPrefersReducedMotionAccessibilityValue());
 995 }
 996 
 997 void InternalSettings::setForcedPrefersReducedMotionAccessibilityValue(InternalSettings::ForcedAccessibilityValue value)
 998 {
 999     settings().setForcedPrefersReducedMotionAccessibilityValue(internalSettingsToSettingsValue(value));
1000 }
1001 
1002 InternalSettings::ForcedAccessibilityValue InternalSettings::forcedSupportsHighDynamicRangeValue() const
1003 {
1004     return settingsToInternalSettingsValue(settings().forcedSupportsHighDynamicRangeValue());
1005 }
1006 
1007 void InternalSettings::setForcedSupportsHighDynamicRangeValue(InternalSettings::ForcedAccessibilityValue value)
1008 {
1009     settings().setForcedSupportsHighDynamicRangeValue(internalSettingsToSettingsValue(value));
1010 }
1011 
1012 bool InternalSettings::webAnimationsCSSIntegrationEnabled()
1013 {
1014     return RuntimeEnabledFeatures::sharedFeatures().webAnimationsCSSIntegrationEnabled();
1015 }
1016 
1017 void InternalSettings::setShouldDeactivateAudioSession(bool should)
1018 {
1019 #if ENABLE(VIDEO) || ENABLE(WEB_AUDIO)
1020     PlatformMediaSessionManager::setShouldDeactivateAudioSession(should);
1021 #endif
1022 }
1023 
1024 // If you add to this class, make sure that you update the Backup class for test reproducability!
1025 
1026 }
    </pre>
  </body>
</html>