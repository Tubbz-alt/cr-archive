<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/Modules/webgpu/WHLSL/WHLSLSemanticMatcher.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="WHLSLPruneUnreachableStandardLibraryFunctions.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="WHLSLStandardLibrary.txt.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/Modules/webgpu/WHLSL/WHLSLSemanticMatcher.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -59,13 +59,11 @@</span>
  }
  
  static Optional&lt;HashMap&lt;Binding*, size_t&gt;&gt; matchResources(Vector&lt;EntryPointItem&gt;&amp; entryPointItems, Layout&amp; layout, ShaderStage shaderStage)
  {
      HashMap&lt;Binding*, size_t&gt; result;
<span class="udiff-line-modified-removed">-     HashSet&lt;size_t&gt; itemIndices;</span>
<span class="udiff-line-removed">-     if (entryPointItems.size() == std::numeric_limits&lt;size_t&gt;::max())</span>
<span class="udiff-line-removed">-         return WTF::nullopt; // Work around the fact that HashSet&#39;s keys are restricted.</span>
<span class="udiff-line-modified-added">+     HashSet&lt;size_t, DefaultHash&lt;size_t&gt;::Hash, WTF::UnsignedWithZeroKeyHashTraits&lt;size_t&gt;&gt; itemIndices;</span>
      for (auto&amp; bindGroup : layout) {
          auto space = bindGroup.name;
          for (auto&amp; binding : bindGroup.bindings) {
              if (!binding.visibility.contains(shaderStage))
                  continue;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -80,21 +78,21 @@</span>
                  if (binding.externalName != resourceSemantic.index())
                      continue;
                  if (space != resourceSemantic.space())
                      continue;
                  result.add(&amp;binding, i);
<span class="udiff-line-modified-removed">-                 itemIndices.add(i + 1); // Work around the fact that HashSet&#39;s keys are restricted.</span>
<span class="udiff-line-modified-added">+                 itemIndices.add(i);</span>
              }
          }
      }
  
      for (size_t i = 0; i &lt; entryPointItems.size(); ++i) {
          auto&amp; item = entryPointItems[i];
          auto&amp; semantic = *item.semantic;
          if (!WTF::holds_alternative&lt;AST::ResourceSemantic&gt;(semantic))
              continue;
<span class="udiff-line-modified-removed">-         if (!itemIndices.contains(i + 1))</span>
<span class="udiff-line-modified-added">+         if (!itemIndices.contains(i))</span>
              return WTF::nullopt;
      }
  
      return result;
  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -140,13 +138,11 @@</span>
  }
  
  static Optional&lt;HashMap&lt;VertexAttribute*, size_t&gt;&gt; matchVertexAttributes(Vector&lt;EntryPointItem&gt;&amp; vertexInputs, VertexAttributes&amp; vertexAttributes, Intrinsics&amp; intrinsics)
  {
      HashMap&lt;VertexAttribute*, size_t&gt; result;
<span class="udiff-line-modified-removed">-     HashSet&lt;size_t&gt; itemIndices;</span>
<span class="udiff-line-removed">-     if (vertexInputs.size() == std::numeric_limits&lt;size_t&gt;::max())</span>
<span class="udiff-line-removed">-         return WTF::nullopt; // Work around the fact that HashSet&#39;s keys are restricted.</span>
<span class="udiff-line-modified-added">+     HashSet&lt;size_t, DefaultHash&lt;size_t&gt;::Hash, WTF::UnsignedWithZeroKeyHashTraits&lt;size_t&gt;&gt; itemIndices;</span>
      for (auto&amp; vertexAttribute : vertexAttributes) {
          for (size_t i = 0; i &lt; vertexInputs.size(); ++i) {
              auto&amp; item = vertexInputs[i];
              auto&amp; semantic = *item.semantic;
              if (!WTF::holds_alternative&lt;AST::StageInOutSemantic&gt;(semantic))
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -155,20 +151,20 @@</span>
              if (stageInOutSemantic.index() != vertexAttribute.shaderLocation)
                  continue;
              if (!isAcceptableFormat(vertexAttribute.vertexFormat, *item.unnamedType, intrinsics))
                  return WTF::nullopt;
              result.add(&amp;vertexAttribute, i);
<span class="udiff-line-modified-removed">-             itemIndices.add(i + 1); // Work around the fact that HashSet&#39;s keys are restricted.</span>
<span class="udiff-line-modified-added">+             itemIndices.add(i);</span>
          }
      }
  
      for (size_t i = 0; i &lt; vertexInputs.size(); ++i) {
          auto&amp; item = vertexInputs[i];
          auto&amp; semantic = *item.semantic;
          if (!WTF::holds_alternative&lt;AST::StageInOutSemantic&gt;(semantic))
              continue;
<span class="udiff-line-modified-removed">-         if (!itemIndices.contains(i + 1))</span>
<span class="udiff-line-modified-added">+         if (!itemIndices.contains(i))</span>
              return WTF::nullopt;
      }
  
      return result;
  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -228,13 +224,11 @@</span>
  }
  
  static Optional&lt;HashMap&lt;AttachmentDescriptor*, size_t&gt;&gt; matchColorAttachments(Vector&lt;EntryPointItem&gt;&amp; fragmentOutputs, Vector&lt;AttachmentDescriptor&gt;&amp; attachmentDescriptors, Intrinsics&amp; intrinsics)
  {
      HashMap&lt;AttachmentDescriptor*, size_t&gt; result;
<span class="udiff-line-modified-removed">-     HashSet&lt;size_t&gt; itemIndices;</span>
<span class="udiff-line-removed">-     if (attachmentDescriptors.size() == std::numeric_limits&lt;size_t&gt;::max())</span>
<span class="udiff-line-removed">-         return WTF::nullopt; // Work around the fact that HashSet&#39;s keys are restricted.</span>
<span class="udiff-line-modified-added">+     HashSet&lt;size_t, DefaultHash&lt;size_t&gt;::Hash, WTF::UnsignedWithZeroKeyHashTraits&lt;size_t&gt;&gt; itemIndices;</span>
      for (auto&amp; attachmentDescriptor : attachmentDescriptors) {
          for (size_t i = 0; i &lt; fragmentOutputs.size(); ++i) {
              auto&amp; item = fragmentOutputs[i];
              auto&amp; semantic = *item.semantic;
              if (!WTF::holds_alternative&lt;AST::StageInOutSemantic&gt;(semantic))
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -243,20 +237,20 @@</span>
              if (stageInOutSemantic.index() != attachmentDescriptor.name)
                  continue;
              if (!isAcceptableFormat(attachmentDescriptor.textureFormat, *item.unnamedType, intrinsics, true))
                  return WTF::nullopt;
              result.add(&amp;attachmentDescriptor, i);
<span class="udiff-line-modified-removed">-             itemIndices.add(i + 1); // Work around the fact that HashSet&#39;s keys are restricted.</span>
<span class="udiff-line-modified-added">+             itemIndices.add(i);</span>
          }
      }
  
      for (size_t i = 0; i &lt; fragmentOutputs.size(); ++i) {
          auto&amp; item = fragmentOutputs[i];
          auto&amp; semantic = *item.semantic;
          if (!WTF::holds_alternative&lt;AST::StageInOutSemantic&gt;(semantic))
              continue;
<span class="udiff-line-modified-removed">-         if (!itemIndices.contains(i + 1))</span>
<span class="udiff-line-modified-added">+         if (!itemIndices.contains(i))</span>
              return WTF::nullopt;
      }
  
      return result;
  }
</pre>
<center><a href="WHLSLPruneUnreachableStandardLibraryFunctions.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="WHLSLStandardLibrary.txt.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>