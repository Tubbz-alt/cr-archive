<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/IteratorOperations.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="IteratorOperations.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="IteratorPrototype.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/IteratorOperations.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 20  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 21  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 22  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 23  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 24  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 25  */
 26 
 27 #pragma once
 28 
 29 #include &quot;JSCJSValue.h&quot;
 30 #include &quot;JSObject.h&quot;
 31 #include &quot;ThrowScope.h&quot;
 32 
 33 namespace JSC {
 34 
 35 struct IterationRecord {
 36     JSValue iterator;
 37     JSValue nextMethod;
 38 };
 39 
<span class="line-modified"> 40 JSValue iteratorNext(ExecState*, IterationRecord, JSValue argument = JSValue());</span>
<span class="line-modified"> 41 JS_EXPORT_PRIVATE JSValue iteratorValue(ExecState*, JSValue iterResult);</span>
<span class="line-modified"> 42 bool iteratorComplete(ExecState*, JSValue iterResult);</span>
<span class="line-modified"> 43 JS_EXPORT_PRIVATE JSValue iteratorStep(ExecState*, IterationRecord);</span>
<span class="line-modified"> 44 JS_EXPORT_PRIVATE void iteratorClose(ExecState*, IterationRecord);</span>
<span class="line-modified"> 45 JS_EXPORT_PRIVATE JSObject* createIteratorResultObject(ExecState*, JSValue, bool done);</span>
 46 
 47 Structure* createIteratorResultObjectStructure(VM&amp;, JSGlobalObject&amp;);
 48 
<span class="line-modified"> 49 JS_EXPORT_PRIVATE JSValue iteratorMethod(ExecState&amp;, JSObject*);</span>
<span class="line-modified"> 50 JS_EXPORT_PRIVATE IterationRecord iteratorForIterable(ExecState&amp;, JSObject*, JSValue iteratorMethod);</span>
<span class="line-modified"> 51 JS_EXPORT_PRIVATE IterationRecord iteratorForIterable(ExecState*, JSValue iterable);</span>
 52 
<span class="line-modified"> 53 JS_EXPORT_PRIVATE JSValue iteratorMethod(ExecState&amp;, JSObject*);</span>
<span class="line-modified"> 54 JS_EXPORT_PRIVATE bool hasIteratorMethod(ExecState&amp;, JSValue);</span>
 55 
 56 template&lt;typename CallBackType&gt;
<span class="line-modified"> 57 void forEachInIterable(ExecState* exec, JSValue iterable, const CallBackType&amp; callback)</span>
 58 {
<span class="line-modified"> 59     auto&amp; vm = exec-&gt;vm();</span>
 60     auto scope = DECLARE_THROW_SCOPE(vm);
 61 
<span class="line-modified"> 62     IterationRecord iterationRecord = iteratorForIterable(exec, iterable);</span>
 63     RETURN_IF_EXCEPTION(scope, void());
 64     while (true) {
<span class="line-modified"> 65         JSValue next = iteratorStep(exec, iterationRecord);</span>
 66         if (UNLIKELY(scope.exception()) || next.isFalse())
 67             return;
 68 
<span class="line-modified"> 69         JSValue nextValue = iteratorValue(exec, next);</span>
 70         RETURN_IF_EXCEPTION(scope, void());
 71 
<span class="line-modified"> 72         callback(vm, exec, nextValue);</span>
 73         if (UNLIKELY(scope.exception())) {
 74             scope.release();
<span class="line-modified"> 75             iteratorClose(exec, iterationRecord);</span>
 76             return;
 77         }
 78     }
 79 }
 80 
 81 template&lt;typename CallBackType&gt;
<span class="line-modified"> 82 void forEachInIterable(ExecState&amp; state, JSObject* iterable, JSValue iteratorMethod, const CallBackType&amp; callback)</span>
 83 {
<span class="line-modified"> 84     auto&amp; vm = state.vm();</span>
 85     auto scope = DECLARE_THROW_SCOPE(vm);
 86 
<span class="line-modified"> 87     auto iterationRecord = iteratorForIterable(state, iterable, iteratorMethod);</span>
 88     RETURN_IF_EXCEPTION(scope, void());
 89     while (true) {
<span class="line-modified"> 90         JSValue next = iteratorStep(&amp;state, iterationRecord);</span>
 91         if (UNLIKELY(scope.exception()) || next.isFalse())
 92             return;
 93 
<span class="line-modified"> 94         JSValue nextValue = iteratorValue(&amp;state, next);</span>
 95         RETURN_IF_EXCEPTION(scope, void());
 96 
<span class="line-modified"> 97         callback(vm, state, nextValue);</span>
 98         if (UNLIKELY(scope.exception())) {
 99             scope.release();
<span class="line-modified">100             iteratorClose(&amp;state, iterationRecord);</span>
101             return;
102         }
103     }
104 }
105 
106 } // namespace JSC
</pre>
</td>
<td>
<hr />
<pre>
 20  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 21  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 22  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 23  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 24  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 25  */
 26 
 27 #pragma once
 28 
 29 #include &quot;JSCJSValue.h&quot;
 30 #include &quot;JSObject.h&quot;
 31 #include &quot;ThrowScope.h&quot;
 32 
 33 namespace JSC {
 34 
 35 struct IterationRecord {
 36     JSValue iterator;
 37     JSValue nextMethod;
 38 };
 39 
<span class="line-modified"> 40 JSValue iteratorNext(JSGlobalObject*, IterationRecord, JSValue argument = JSValue());</span>
<span class="line-modified"> 41 JS_EXPORT_PRIVATE JSValue iteratorValue(JSGlobalObject*, JSValue iterResult);</span>
<span class="line-modified"> 42 bool iteratorComplete(JSGlobalObject*, JSValue iterResult);</span>
<span class="line-modified"> 43 JS_EXPORT_PRIVATE JSValue iteratorStep(JSGlobalObject*, IterationRecord);</span>
<span class="line-modified"> 44 JS_EXPORT_PRIVATE void iteratorClose(JSGlobalObject*, IterationRecord);</span>
<span class="line-modified"> 45 JS_EXPORT_PRIVATE JSObject* createIteratorResultObject(JSGlobalObject*, JSValue, bool done);</span>
 46 
 47 Structure* createIteratorResultObjectStructure(VM&amp;, JSGlobalObject&amp;);
 48 
<span class="line-modified"> 49 JS_EXPORT_PRIVATE JSValue iteratorMethod(JSGlobalObject*, JSObject*);</span>
<span class="line-modified"> 50 JS_EXPORT_PRIVATE IterationRecord iteratorForIterable(JSGlobalObject*, JSObject*, JSValue iteratorMethod);</span>
<span class="line-modified"> 51 JS_EXPORT_PRIVATE IterationRecord iteratorForIterable(JSGlobalObject*, JSValue iterable);</span>
 52 
<span class="line-modified"> 53 JS_EXPORT_PRIVATE JSValue iteratorMethod(JSGlobalObject*, JSObject*);</span>
<span class="line-modified"> 54 JS_EXPORT_PRIVATE bool hasIteratorMethod(JSGlobalObject*, JSValue);</span>
 55 
 56 template&lt;typename CallBackType&gt;
<span class="line-modified"> 57 void forEachInIterable(JSGlobalObject* globalObject, JSValue iterable, const CallBackType&amp; callback)</span>
 58 {
<span class="line-modified"> 59     auto&amp; vm = getVM(globalObject);</span>
 60     auto scope = DECLARE_THROW_SCOPE(vm);
 61 
<span class="line-modified"> 62     IterationRecord iterationRecord = iteratorForIterable(globalObject, iterable);</span>
 63     RETURN_IF_EXCEPTION(scope, void());
 64     while (true) {
<span class="line-modified"> 65         JSValue next = iteratorStep(globalObject, iterationRecord);</span>
 66         if (UNLIKELY(scope.exception()) || next.isFalse())
 67             return;
 68 
<span class="line-modified"> 69         JSValue nextValue = iteratorValue(globalObject, next);</span>
 70         RETURN_IF_EXCEPTION(scope, void());
 71 
<span class="line-modified"> 72         callback(vm, globalObject, nextValue);</span>
 73         if (UNLIKELY(scope.exception())) {
 74             scope.release();
<span class="line-modified"> 75             iteratorClose(globalObject, iterationRecord);</span>
 76             return;
 77         }
 78     }
 79 }
 80 
 81 template&lt;typename CallBackType&gt;
<span class="line-modified"> 82 void forEachInIterable(JSGlobalObject&amp; globalObject, JSObject* iterable, JSValue iteratorMethod, const CallBackType&amp; callback)</span>
 83 {
<span class="line-modified"> 84     auto&amp; vm = getVM(&amp;globalObject);</span>
 85     auto scope = DECLARE_THROW_SCOPE(vm);
 86 
<span class="line-modified"> 87     auto iterationRecord = iteratorForIterable(&amp;globalObject, iterable, iteratorMethod);</span>
 88     RETURN_IF_EXCEPTION(scope, void());
 89     while (true) {
<span class="line-modified"> 90         JSValue next = iteratorStep(&amp;globalObject, iterationRecord);</span>
 91         if (UNLIKELY(scope.exception()) || next.isFalse())
 92             return;
 93 
<span class="line-modified"> 94         JSValue nextValue = iteratorValue(&amp;globalObject, next);</span>
 95         RETURN_IF_EXCEPTION(scope, void());
 96 
<span class="line-modified"> 97         callback(vm, globalObject, nextValue);</span>
 98         if (UNLIKELY(scope.exception())) {
 99             scope.release();
<span class="line-modified">100             iteratorClose(&amp;globalObject, iterationRecord);</span>
101             return;
102         }
103     }
104 }
105 
106 } // namespace JSC
</pre>
</td>
</tr>
</table>
<center><a href="IteratorOperations.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="IteratorPrototype.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>