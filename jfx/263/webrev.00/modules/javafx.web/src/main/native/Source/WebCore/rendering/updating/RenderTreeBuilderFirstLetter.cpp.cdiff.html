<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/rendering/updating/RenderTreeBuilderFirstLetter.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="RenderTreeBuilderBlockFlow.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RenderTreeBuilderFirstLetter.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/rendering/updating/RenderTreeBuilderFirstLetter.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 54,11 ***</span>
          // FIXME: For ideographic baselines, we want to go from line edge to line edge. This is equivalent to (N-1)*line-height + the font height.
          // We don&#39;t yet support ideographic baselines.
          // For an N-line first-letter and for alphabetic baselines, the cap-height of the first letter needs to equal (N-1)*line-height of paragraph lines + cap-height of the paragraph
          // Mathematically we can&#39;t rely on font-size, since font().height() doesn&#39;t necessarily match. For reliability, the best approach is simply to
          // compare the final measured cap-heights of the two fonts in order to get to the closest possible value.
<span class="line-modified">!         firstLetterStyle.setLineBoxContain(LineBoxContainInitialLetter);</span>
          int lineHeight = paragraph-&gt;style().computedLineHeight();
  
          // Set the font to be one line too big and then ratchet back to get to a precise fit. We can&#39;t just set the desired font size based off font height metrics
          // because many fonts bake ascent into the font metrics. Therefore we have to look at actual measured cap height values in order to know when we have a good fit.
          auto newFontDescription = firstLetterStyle.fontDescription();
<span class="line-new-header">--- 54,11 ---</span>
          // FIXME: For ideographic baselines, we want to go from line edge to line edge. This is equivalent to (N-1)*line-height + the font height.
          // We don&#39;t yet support ideographic baselines.
          // For an N-line first-letter and for alphabetic baselines, the cap-height of the first letter needs to equal (N-1)*line-height of paragraph lines + cap-height of the paragraph
          // Mathematically we can&#39;t rely on font-size, since font().height() doesn&#39;t necessarily match. For reliability, the best approach is simply to
          // compare the final measured cap-heights of the two fonts in order to get to the closest possible value.
<span class="line-modified">!         firstLetterStyle.setLineBoxContain({ LineBoxContain::InitialLetter });</span>
          int lineHeight = paragraph-&gt;style().computedLineHeight();
  
          // Set the font to be one line too big and then ratchet back to get to a precise fit. We can&#39;t just set the desired font size based off font height metrics
          // because many fonts bake ascent into the font metrics. Therefore we have to look at actual measured cap height values in order to know when we have a good fit.
          auto newFontDescription = firstLetterStyle.fontDescription();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 79,14 ***</span>
<span class="line-new-header">--- 79,16 ---</span>
              firstLetterStyle.fontCascade().update(firstLetterStyle.fontCascade().fontSelector());
              actualCapHeight = firstLetterStyle.fontMetrics().capHeight();
          }
      }
  
<span class="line-added">+     firstLetterStyle.setStyleType(PseudoId::FirstLetter);</span>
      // Force inline display (except for floating first-letters).
      firstLetterStyle.setDisplay(firstLetterStyle.isFloating() ? DisplayType::Block : DisplayType::Inline);
      // CSS2 says first-letter can&#39;t be positioned.
      firstLetterStyle.setPosition(PositionType::Static);
<span class="line-added">+ </span>
      return firstLetterStyle;
  }
  
  // CSS 2.1 http://www.w3.org/TR/CSS21/selector.html#first-letter
  // &quot;Punctuation (i.e, characters defined in Unicode [UNICODE] in the &quot;open&quot; (Ps), &quot;close&quot; (Pe),
</pre>
<center><a href="RenderTreeBuilderBlockFlow.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="RenderTreeBuilderFirstLetter.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>