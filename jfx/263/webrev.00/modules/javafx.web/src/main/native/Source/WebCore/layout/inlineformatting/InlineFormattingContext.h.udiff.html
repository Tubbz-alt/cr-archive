<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WebCore/layout/inlineformatting/InlineFormattingContext.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="InlineFormattingContext.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="InlineFormattingContextGeometry.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/layout/inlineformatting/InlineFormattingContext.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -25,77 +25,91 @@</span>
  
  #pragma once
  
  #if ENABLE(LAYOUT_FORMATTING_CONTEXT)
  
<span class="udiff-line-removed">- #include &quot;DisplayBox.h&quot;</span>
  #include &quot;FormattingContext.h&quot;
<span class="udiff-line-modified-removed">- #include &quot;InlineFormattingState.h&quot;</span>
<span class="udiff-line-removed">- #include &quot;InlineLine.h&quot;</span>
<span class="udiff-line-modified-added">+ #include &quot;LineLayoutContext.h&quot;</span>
  #include &lt;wtf/IsoMalloc.h&gt;
  
  namespace WebCore {
  namespace Layout {
  
<span class="udiff-line-modified-removed">- class FloatingState;</span>
<span class="udiff-line-modified-removed">- struct LineContent;</span>
<span class="udiff-line-removed">- struct LineInput;</span>
<span class="udiff-line-modified-added">+ class InlineFormattingState;</span>
<span class="udiff-line-modified-added">+ class InvalidationState;</span>
  
  // This class implements the layout logic for inline formatting contexts.
  // https://www.w3.org/TR/CSS22/visuren.html#inline-formatting
<span class="udiff-line-modified-removed">- class InlineFormattingContext : public FormattingContext {</span>
<span class="udiff-line-modified-added">+ class InlineFormattingContext final : public FormattingContext {</span>
      WTF_MAKE_ISO_ALLOCATED(InlineFormattingContext);
  public:
<span class="udiff-line-modified-removed">-     InlineFormattingContext(const Box&amp; formattingContextRoot, InlineFormattingState&amp;);</span>
<span class="udiff-line-modified-removed">-     void layout() const override;</span>
<span class="udiff-line-modified-added">+     InlineFormattingContext(const Container&amp; formattingContextRoot, InlineFormattingState&amp;);</span>
<span class="udiff-line-modified-added">+     void layoutInFlowContent(InvalidationState&amp;, const HorizontalConstraints&amp;, const VerticalConstraints&amp;) override;</span>
  
  private:
<span class="udiff-line-modified-removed">-     IntrinsicWidthConstraints computedIntrinsicWidthConstraints() const override;</span>
<span class="udiff-line-modified-added">+     IntrinsicWidthConstraints computedIntrinsicWidthConstraints() override;</span>
  
<span class="udiff-line-modified-removed">-     class InlineLayout {</span>
<span class="udiff-line-modified-added">+     class Quirks : public FormattingContext::Quirks {</span>
      public:
<span class="udiff-line-modified-removed">-         InlineLayout(const InlineFormattingContext&amp;);</span>
<span class="udiff-line-modified-removed">-         void layout(const InlineItems&amp;, LayoutUnit widthConstraint) const;</span>
<span class="udiff-line-removed">-         LayoutUnit computedIntrinsicWidth(const InlineItems&amp;, LayoutUnit widthConstraint) const;</span>
<span class="udiff-line-modified-added">+         bool lineDescentNeedsCollapsing(const LineBuilder::RunList&amp;) const;</span>
<span class="udiff-line-modified-added">+         LineBuilder::Constraints::HeightAndBaseline lineHeightConstraints(const Container&amp; formattingRoot) const;</span>
  
      private:
<span class="udiff-line-modified-removed">-         LayoutState&amp; layoutState() const { return m_layoutState; }</span>
<span class="udiff-line-modified-removed">-         LineContent placeInlineItems(const LineInput&amp;) const;</span>
<span class="udiff-line-removed">-         void createDisplayRuns(const Line::Content&amp;, const Vector&lt;WeakPtr&lt;InlineItem&gt;&gt;&amp; floats, LayoutUnit widthConstraint) const;</span>
<span class="udiff-line-removed">-         void alignRuns(TextAlignMode, InlineRuns&amp;, unsigned firstRunIndex, LayoutUnit availableWidth) const;</span>
<span class="udiff-line-modified-added">+         friend class InlineFormattingContext;</span>
<span class="udiff-line-modified-added">+         Quirks(const InlineFormattingContext&amp;);</span>
  
<span class="udiff-line-modified-removed">-     private:</span>
<span class="udiff-line-removed">-         LayoutState&amp; m_layoutState;</span>
<span class="udiff-line-removed">-         const Container&amp; m_formattingRoot;</span>
<span class="udiff-line-removed">-     };</span>
<span class="udiff-line-modified-added">+         const InlineFormattingContext&amp; formattingContext() const { return downcast&lt;InlineFormattingContext&gt;(FormattingContext::Quirks::formattingContext()); }</span>
  
<span class="udiff-line-removed">-     class Quirks {</span>
<span class="udiff-line-removed">-     public:</span>
<span class="udiff-line-removed">-         static bool lineDescentNeedsCollapsing(const LayoutState&amp;, const Line::Content&amp;);</span>
<span class="udiff-line-removed">-         static Line::InitialConstraints::HeightAndBaseline lineHeightConstraints(const LayoutState&amp;, const Box&amp; formattingRoot);</span>
      };
<span class="udiff-line-added">+     InlineFormattingContext::Quirks quirks() const { return Quirks(*this); }</span>
  
      class Geometry : public FormattingContext::Geometry {
      public:
<span class="udiff-line-modified-removed">-         static HeightAndMargin inlineBlockHeightAndMargin(const LayoutState&amp;, const Box&amp;);</span>
<span class="udiff-line-modified-removed">-         static WidthAndMargin inlineBlockWidthAndMargin(LayoutState&amp;, const Box&amp;, UsedHorizontalValues);</span>
<span class="udiff-line-modified-added">+         ContentHeightAndMargin inlineBlockHeightAndMargin(const Box&amp;, const HorizontalConstraints&amp;, const OverrideVerticalValues&amp;) const;</span>
<span class="udiff-line-modified-added">+         ContentWidthAndMargin inlineBlockWidthAndMargin(const Box&amp;, const HorizontalConstraints&amp;, const OverrideHorizontalValues&amp;);</span>
<span class="udiff-line-added">+         Optional&lt;InlineLayoutUnit&gt; computedTextIndent(const Container&amp; formattingContextRoot, const HorizontalConstraints&amp;) const;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     private:</span>
<span class="udiff-line-added">+         friend class InlineFormattingContext;</span>
<span class="udiff-line-added">+         Geometry(const InlineFormattingContext&amp;);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         const InlineFormattingContext&amp; formattingContext() const { return downcast&lt;InlineFormattingContext&gt;(FormattingContext::Geometry::formattingContext()); }</span>
<span class="udiff-line-added">+ </span>
      };
<span class="udiff-line-added">+     InlineFormattingContext::Geometry geometry() const { return Geometry(*this); }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     void lineLayout(InlineItems&amp;, LineLayoutContext::InlineItemRange, const HorizontalConstraints&amp;, const VerticalConstraints&amp;);</span>
  
<span class="udiff-line-modified-removed">-     void layoutFormattingContextRoot(const Box&amp;, UsedHorizontalValues) const;</span>
<span class="udiff-line-modified-removed">-     void computeMarginBorderAndPaddingForInlineContainer(const Container&amp;, UsedHorizontalValues) const;</span>
<span class="udiff-line-removed">-     void initializeMarginBorderAndPaddingForGenericInlineBox(const Box&amp;) const;</span>
<span class="udiff-line-removed">-     void computeIntrinsicWidthForFormattingRoot(const Box&amp;) const;</span>
<span class="udiff-line-removed">-     void computeWidthAndHeightForReplacedInlineBox(const Box&amp;, UsedHorizontalValues) const;</span>
<span class="udiff-line-removed">-     void computeHorizontalMargin(const Box&amp;, UsedHorizontalValues) const;</span>
<span class="udiff-line-removed">-     void computeHeightAndMargin(const Box&amp;) const;</span>
<span class="udiff-line-removed">-     void computeWidthAndMargin(const Box&amp;, UsedHorizontalValues) const;</span>
<span class="udiff-line-modified-added">+     void computeIntrinsicWidthForFormattingRoot(const Box&amp;);</span>
<span class="udiff-line-modified-added">+     InlineLayoutUnit computedIntrinsicWidthForConstraint(const HorizontalConstraints&amp;) const;</span>
  
<span class="udiff-line-modified-removed">-     void collectInlineContent() const;</span>
<span class="udiff-line-modified-added">+     void computeHorizontalMargin(const Box&amp;, const HorizontalConstraints&amp;);</span>
<span class="udiff-line-added">+     void computeHeightAndMargin(const Box&amp;, const HorizontalConstraints&amp;);</span>
<span class="udiff-line-added">+     void computeWidthAndMargin(const Box&amp;, const HorizontalConstraints&amp;);</span>
  
<span class="udiff-line-modified-removed">-     InlineFormattingState&amp; formattingState() const { return downcast&lt;InlineFormattingState&gt;(FormattingContext::formattingState()); }</span>
<span class="udiff-line-modified-added">+     void collectInlineContentIfNeeded();</span>
<span class="udiff-line-added">+     LineBuilder::Constraints constraintsForLine(const HorizontalConstraints&amp;, InlineLayoutUnit lineLogicalTop);</span>
<span class="udiff-line-added">+     void setDisplayBoxesForLine(const LineLayoutContext::LineContent&amp;, const HorizontalConstraints&amp;);</span>
<span class="udiff-line-added">+     void invalidateFormattingState(const InvalidationState&amp;);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+     const InlineFormattingState&amp; formattingState() const { return downcast&lt;InlineFormattingState&gt;(FormattingContext::formattingState()); }</span>
<span class="udiff-line-added">+     InlineFormattingState&amp; formattingState() { return downcast&lt;InlineFormattingState&gt;(FormattingContext::formattingState()); }</span>
      // FIXME: Come up with a structure that requires no friending.
<span class="udiff-line-modified-removed">-     friend class Line;</span>
<span class="udiff-line-modified-added">+     friend class LineBuilder;</span>
  };
  
<span class="udiff-line-added">+ inline InlineFormattingContext::Geometry::Geometry(const InlineFormattingContext&amp; inlineFormattingContext)</span>
<span class="udiff-line-added">+     : FormattingContext::Geometry(inlineFormattingContext)</span>
<span class="udiff-line-added">+ {</span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ inline InlineFormattingContext::Quirks::Quirks(const InlineFormattingContext&amp; inlineFormattingContext)</span>
<span class="udiff-line-added">+     : FormattingContext::Quirks(inlineFormattingContext)</span>
<span class="udiff-line-added">+ {</span>
  }
<span class="udiff-line-added">+ </span>
  }
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ SPECIALIZE_TYPE_TRAITS_LAYOUT_FORMATTING_CONTEXT(InlineFormattingContext, isInlineFormattingContext())</span>
<span class="udiff-line-added">+ </span>
  #endif
</pre>
<center><a href="InlineFormattingContext.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="InlineFormattingContextGeometry.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>