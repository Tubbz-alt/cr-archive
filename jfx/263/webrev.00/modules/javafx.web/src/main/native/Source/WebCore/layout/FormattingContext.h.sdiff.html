<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/layout/FormattingContext.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="FormattingContext.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="FormattingContextGeometry.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/layout/FormattingContext.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39;
 14  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 15  * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
 17  * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 18  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 19  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 20  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 21  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 22  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 23  * THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #if ENABLE(LAYOUT_FORMATTING_CONTEXT)
 29 
<span class="line-modified"> 30 #include &quot;DisplayBox.h&quot;</span>


 31 #include &lt;wtf/IsoMalloc.h&gt;
 32 #include &lt;wtf/WeakPtr.h&gt;
 33 
 34 namespace WebCore {
 35 
<span class="line-modified"> 36 class LayoutPoint;</span>
<span class="line-modified"> 37 class LayoutUnit;</span>



 38 
 39 namespace Layout {
 40 
 41 class Box;


 42 class Container;



 43 class FormattingState;


 44 class LayoutState;



 45 
 46 class FormattingContext {
 47     WTF_MAKE_ISO_ALLOCATED(FormattingContext);
 48 public:
<span class="line-modified"> 49     FormattingContext(const Box&amp; formattingContextRoot, FormattingState&amp;);</span>
 50     virtual ~FormattingContext();
 51 
<span class="line-modified"> 52     virtual void layout() const = 0;</span>
<span class="line-modified"> 53     void layoutOutOfFlowContent() const;</span>
 54 
 55     struct IntrinsicWidthConstraints {
 56         void expand(LayoutUnit horizontalValue);
 57         IntrinsicWidthConstraints&amp; operator+=(const IntrinsicWidthConstraints&amp;);
 58 
 59         LayoutUnit minimum;
 60         LayoutUnit maximum;
 61     };
<span class="line-modified"> 62     virtual IntrinsicWidthConstraints computedIntrinsicWidthConstraints() const = 0;</span>
<span class="line-modified"> 63 </span>
<span class="line-modified"> 64     static Display::Box mapBoxToAncestor(const LayoutState&amp;, const Box&amp;, const Container&amp; ancestor);</span>
<span class="line-modified"> 65     static LayoutUnit mapTopToAncestor(const LayoutState&amp;, const Box&amp;, const Container&amp; ancestor);</span>
<span class="line-modified"> 66     static LayoutUnit mapLeftToAncestor(const LayoutState&amp;, const Box&amp;, const Container&amp; ancestor);</span>
<span class="line-modified"> 67     static LayoutUnit mapRightToAncestor(const LayoutState&amp;, const Box&amp;, const Container&amp; ancestor);</span>
<span class="line-modified"> 68     static Point mapPointToAncestor(const LayoutState&amp;, Point, const Container&amp; from, const Container&amp; to);</span>
<span class="line-modified"> 69     static Point mapPointToDescendent(const LayoutState&amp;, Point, const Container&amp; from, const Container&amp; to);</span>












 70 
 71 protected:
 72     using LayoutQueue = Vector&lt;const Box*&gt;;
 73 

 74     LayoutState&amp; layoutState() const;
<span class="line-modified"> 75     FormattingState&amp; formattingState() const { return m_formattingState; }</span>
<span class="line-modified"> 76     const Box&amp; root() const { return *m_root; }</span>
 77 
<span class="line-modified"> 78     void computeBorderAndPadding(const Box&amp;, Optional&lt;UsedHorizontalValues&gt; = WTF::nullopt) const;</span>
 79 
 80 #ifndef NDEBUG
 81     virtual void validateGeometryConstraintsAfterLayout() const;
 82 #endif
 83 
 84     // This class implements generic positioning and sizing.
 85     class Geometry {
 86     public:
<span class="line-modified"> 87         static VerticalGeometry outOfFlowVerticalGeometry(const LayoutState&amp;, const Box&amp;, UsedVerticalValues);</span>
<span class="line-modified"> 88         static HorizontalGeometry outOfFlowHorizontalGeometry(LayoutState&amp;, const Box&amp;, UsedHorizontalValues);</span>






 89 
<span class="line-modified"> 90         static HeightAndMargin floatingHeightAndMargin(const LayoutState&amp;, const Box&amp;, UsedVerticalValues, UsedHorizontalValues);</span>
<span class="line-removed"> 91         static WidthAndMargin floatingWidthAndMargin(LayoutState&amp;, const Box&amp;, UsedHorizontalValues);</span>
 92 
<span class="line-modified"> 93         static HeightAndMargin inlineReplacedHeightAndMargin(const LayoutState&amp;, const Box&amp;, UsedVerticalValues);</span>
<span class="line-modified"> 94         static WidthAndMargin inlineReplacedWidthAndMargin(const LayoutState&amp;, const Box&amp;, UsedHorizontalValues);</span>
 95 
<span class="line-modified"> 96         static LayoutSize inFlowPositionedPositionOffset(const LayoutState&amp;, const Box&amp;);</span>

 97 
<span class="line-modified"> 98         static HeightAndMargin complicatedCases(const LayoutState&amp;, const Box&amp;, UsedVerticalValues, UsedHorizontalValues);</span>
<span class="line-modified"> 99         static LayoutUnit shrinkToFitWidth(LayoutState&amp;, const Box&amp;, UsedHorizontalValues);</span>
100 
<span class="line-modified">101         static Edges computedBorder(const Box&amp;);</span>
<span class="line-modified">102         static Optional&lt;Edges&gt; computedPadding(const Box&amp;, UsedHorizontalValues);</span>
103 
<span class="line-modified">104         static ComputedHorizontalMargin computedHorizontalMargin(const Box&amp;, UsedHorizontalValues);</span>
<span class="line-modified">105         static ComputedVerticalMargin computedVerticalMargin(const Box&amp;, UsedHorizontalValues);</span>
106 
<span class="line-modified">107         static Optional&lt;LayoutUnit&gt; computedValueIfNotAuto(const Length&amp; geometryProperty, LayoutUnit containingBlockWidth);</span>
<span class="line-modified">108         static Optional&lt;LayoutUnit&gt; fixedValue(const Length&amp; geometryProperty);</span>
109 
<span class="line-modified">110         static Optional&lt;LayoutUnit&gt; computedMinHeight(const LayoutState&amp;, const Box&amp;);</span>
<span class="line-removed">111         static Optional&lt;LayoutUnit&gt; computedMaxHeight(const LayoutState&amp;, const Box&amp;);</span>
112 
<span class="line-modified">113         static FormattingContext::IntrinsicWidthConstraints constrainByMinMaxWidth(const Box&amp;, IntrinsicWidthConstraints);</span>
114 
<span class="line-modified">115         static LayoutUnit contentHeightForFormattingContextRoot(const LayoutState&amp;, const Box&amp;);</span>



116 
117     protected:



118         enum class HeightType { Min, Max, Normal };
<span class="line-modified">119         static Optional&lt;LayoutUnit&gt; computedHeightValue(const LayoutState&amp;, const Box&amp;, HeightType);</span>






120 
121     private:
<span class="line-modified">122         static VerticalGeometry outOfFlowReplacedVerticalGeometry(const LayoutState&amp;, const Box&amp;, UsedVerticalValues);</span>
<span class="line-modified">123         static HorizontalGeometry outOfFlowReplacedHorizontalGeometry(const LayoutState&amp;, const Box&amp;, UsedHorizontalValues);</span>



124 
<span class="line-modified">125         static VerticalGeometry outOfFlowNonReplacedVerticalGeometry(const LayoutState&amp;, const Box&amp;, UsedVerticalValues);</span>
<span class="line-modified">126         static HorizontalGeometry outOfFlowNonReplacedHorizontalGeometry(LayoutState&amp;, const Box&amp;, UsedHorizontalValues);</span>
127 
<span class="line-modified">128         static HeightAndMargin floatingReplacedHeightAndMargin(const LayoutState&amp;, const Box&amp;, UsedVerticalValues);</span>
<span class="line-removed">129         static WidthAndMargin floatingReplacedWidthAndMargin(const LayoutState&amp;, const Box&amp;, UsedHorizontalValues);</span>
130 
<span class="line-modified">131         static WidthAndMargin floatingNonReplacedWidthAndMargin(LayoutState&amp;, const Box&amp;, UsedHorizontalValues);</span>



132     };

133 
134     class Quirks {
135     public:
<span class="line-modified">136         static LayoutUnit heightValueOfNearestContainingBlockWithFixedHeight(const LayoutState&amp;, const Box&amp;);</span>










137     };

138 
139 private:
<span class="line-modified">140     void computeOutOfFlowVerticalGeometry(const Box&amp;) const;</span>
<span class="line-modified">141     void computeOutOfFlowHorizontalGeometry(const Box&amp;) const;</span>

142 
<span class="line-modified">143     WeakPtr&lt;const Box&gt; m_root;</span>
144     FormattingState&amp; m_formattingState;
145 };
146 










147 inline void FormattingContext::IntrinsicWidthConstraints::expand(LayoutUnit horizontalValue)
148 {
149     minimum += horizontalValue;
150     maximum += horizontalValue;
151 }
152 
153 inline FormattingContext::IntrinsicWidthConstraints&amp; FormattingContext::IntrinsicWidthConstraints::operator+=(const IntrinsicWidthConstraints&amp; other)
154 {
155     minimum += other.minimum;
156     maximum += other.maximum;
157     return *this;
158 }
159 
160 }
161 }






162 #endif
</pre>
</td>
<td>
<hr />
<pre>
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39;
 14  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 15  * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
 17  * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 18  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 19  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 20  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 21  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 22  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 23  * THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #pragma once
 27 
 28 #if ENABLE(LAYOUT_FORMATTING_CONTEXT)
 29 
<span class="line-modified"> 30 #include &quot;LayoutContainer.h&quot;</span>
<span class="line-added"> 31 #include &quot;LayoutUnit.h&quot;</span>
<span class="line-added"> 32 #include &quot;LayoutUnits.h&quot;</span>
 33 #include &lt;wtf/IsoMalloc.h&gt;
 34 #include &lt;wtf/WeakPtr.h&gt;
 35 
 36 namespace WebCore {
 37 
<span class="line-modified"> 38 namespace Display {</span>
<span class="line-modified"> 39 class Box;</span>
<span class="line-added"> 40 }</span>
<span class="line-added"> 41 class LayoutSize;</span>
<span class="line-added"> 42 struct Length;</span>
 43 
 44 namespace Layout {
 45 
 46 class Box;
<span class="line-added"> 47 struct ComputedHorizontalMargin;</span>
<span class="line-added"> 48 struct ComputedVerticalMargin;</span>
 49 class Container;
<span class="line-added"> 50 struct ContentHeightAndMargin;</span>
<span class="line-added"> 51 struct ContentWidthAndMargin;</span>
<span class="line-added"> 52 struct Edges;</span>
 53 class FormattingState;
<span class="line-added"> 54 struct HorizontalGeometry;</span>
<span class="line-added"> 55 class InvalidationState;</span>
 56 class LayoutState;
<span class="line-added"> 57 struct OverrideHorizontalValues;</span>
<span class="line-added"> 58 struct OverrideVerticalValues;</span>
<span class="line-added"> 59 struct VerticalGeometry;</span>
 60 
 61 class FormattingContext {
 62     WTF_MAKE_ISO_ALLOCATED(FormattingContext);
 63 public:
<span class="line-modified"> 64     FormattingContext(const Container&amp; formattingContextRoot, FormattingState&amp;);</span>
 65     virtual ~FormattingContext();
 66 
<span class="line-modified"> 67     virtual void layoutInFlowContent(InvalidationState&amp;, const HorizontalConstraints&amp;, const VerticalConstraints&amp;) = 0;</span>
<span class="line-modified"> 68     void layoutOutOfFlowContent(InvalidationState&amp;, const HorizontalConstraints&amp;, const VerticalConstraints&amp;);</span>
 69 
 70     struct IntrinsicWidthConstraints {
 71         void expand(LayoutUnit horizontalValue);
 72         IntrinsicWidthConstraints&amp; operator+=(const IntrinsicWidthConstraints&amp;);
 73 
 74         LayoutUnit minimum;
 75         LayoutUnit maximum;
 76     };
<span class="line-modified"> 77     virtual IntrinsicWidthConstraints computedIntrinsicWidthConstraints() = 0;</span>
<span class="line-modified"> 78 </span>
<span class="line-modified"> 79     LayoutUnit mapTopToFormattingContextRoot(const Box&amp;) const;</span>
<span class="line-modified"> 80     LayoutUnit mapLeftToFormattingContextRoot(const Box&amp;) const;</span>
<span class="line-modified"> 81     LayoutUnit mapRightToFormattingContextRoot(const Box&amp;) const;</span>
<span class="line-modified"> 82 </span>
<span class="line-modified"> 83     bool isBlockFormattingContext() const { return root().establishesBlockFormattingContext(); }</span>
<span class="line-modified"> 84     bool isInlineFormattingContext() const { return root().establishesInlineFormattingContext(); }</span>
<span class="line-added"> 85     bool isTableFormattingContext() const { return root().establishesTableFormattingContext(); }</span>
<span class="line-added"> 86 </span>
<span class="line-added"> 87     enum class EscapeReason {</span>
<span class="line-added"> 88         NeedsGeometryFromEstablishedFormattingContext,</span>
<span class="line-added"> 89         OutOfFlowBoxNeedsInFlowGeometry,</span>
<span class="line-added"> 90         FloatBoxNeedsToBeInAbsoluteCoordinates,</span>
<span class="line-added"> 91         FindFixedHeightAncestorQuirk,</span>
<span class="line-added"> 92         BodyStrechesToViewportQuirk,</span>
<span class="line-added"> 93         StrokeOverflowNeedsViewportGeometry,</span>
<span class="line-added"> 94         TableNeedsAccessToTableWrapper</span>
<span class="line-added"> 95     };</span>
<span class="line-added"> 96     const Display::Box&amp; geometryForBox(const Box&amp;, Optional&lt;EscapeReason&gt; = WTF::nullopt) const;</span>
 97 
 98 protected:
 99     using LayoutQueue = Vector&lt;const Box*&gt;;
100 
<span class="line-added">101     const Container&amp; root() const { return *m_root; }</span>
102     LayoutState&amp; layoutState() const;
<span class="line-modified">103     const FormattingState&amp; formattingState() const { return m_formattingState; }</span>
<span class="line-modified">104     FormattingState&amp; formattingState() { return m_formattingState; }</span>
105 
<span class="line-modified">106     void computeBorderAndPadding(const Box&amp;, const HorizontalConstraints&amp;);</span>
107 
108 #ifndef NDEBUG
109     virtual void validateGeometryConstraintsAfterLayout() const;
110 #endif
111 
112     // This class implements generic positioning and sizing.
113     class Geometry {
114     public:
<span class="line-modified">115         VerticalGeometry outOfFlowVerticalGeometry(const Box&amp;, const HorizontalConstraints&amp;, const VerticalConstraints&amp;, const OverrideVerticalValues&amp;) const;</span>
<span class="line-modified">116         HorizontalGeometry outOfFlowHorizontalGeometry(const Box&amp;, const HorizontalConstraints&amp;, const OverrideHorizontalValues&amp;);</span>
<span class="line-added">117 </span>
<span class="line-added">118         ContentHeightAndMargin floatingHeightAndMargin(const Box&amp;, const HorizontalConstraints&amp;, const OverrideVerticalValues&amp;) const;</span>
<span class="line-added">119         ContentWidthAndMargin floatingWidthAndMargin(const Box&amp;, const HorizontalConstraints&amp;, const OverrideHorizontalValues&amp;);</span>
<span class="line-added">120 </span>
<span class="line-added">121         ContentHeightAndMargin inlineReplacedHeightAndMargin(const Box&amp;, const HorizontalConstraints&amp;, Optional&lt;VerticalConstraints&gt;, const OverrideVerticalValues&amp;) const;</span>
<span class="line-added">122         ContentWidthAndMargin inlineReplacedWidthAndMargin(const Box&amp;, const HorizontalConstraints&amp;, const OverrideHorizontalValues&amp;) const;</span>
123 
<span class="line-modified">124         LayoutSize inFlowPositionedPositionOffset(const Box&amp;, const HorizontalConstraints&amp;) const;</span>

125 
<span class="line-modified">126         ContentHeightAndMargin complicatedCases(const Box&amp;, const HorizontalConstraints&amp;, const OverrideVerticalValues&amp;) const;</span>
<span class="line-modified">127         LayoutUnit shrinkToFitWidth(const Box&amp;, LayoutUnit availableWidth);</span>
128 
<span class="line-modified">129         Edges computedBorder(const Box&amp;) const;</span>
<span class="line-added">130         Optional&lt;Edges&gt; computedPadding(const Box&amp;, const HorizontalConstraints&amp;) const;</span>
131 
<span class="line-modified">132         ComputedHorizontalMargin computedHorizontalMargin(const Box&amp;, const HorizontalConstraints&amp;) const;</span>
<span class="line-modified">133         ComputedVerticalMargin computedVerticalMargin(const Box&amp;, const HorizontalConstraints&amp;) const;</span>
134 
<span class="line-modified">135         Optional&lt;LayoutUnit&gt; computedValueIfNotAuto(const Length&amp; geometryProperty, LayoutUnit containingBlockWidth) const;</span>
<span class="line-modified">136         Optional&lt;LayoutUnit&gt; fixedValue(const Length&amp; geometryProperty) const;</span>
137 
<span class="line-modified">138         Optional&lt;LayoutUnit&gt; computedMinHeight(const Box&amp;, Optional&lt;LayoutUnit&gt; containingBlockHeight = WTF::nullopt) const;</span>
<span class="line-modified">139         Optional&lt;LayoutUnit&gt; computedMaxHeight(const Box&amp;, Optional&lt;LayoutUnit&gt; containingBlockHeight = WTF::nullopt) const;</span>
140 
<span class="line-modified">141         Optional&lt;LayoutUnit&gt; computedMinWidth(const Box&amp;, LayoutUnit containingBlockWidth) const;</span>
<span class="line-modified">142         Optional&lt;LayoutUnit&gt; computedMaxWidth(const Box&amp;, LayoutUnit containingBlockWidth) const;</span>
143 
<span class="line-modified">144         FormattingContext::IntrinsicWidthConstraints constrainByMinMaxWidth(const Box&amp;, IntrinsicWidthConstraints) const;</span>

145 
<span class="line-modified">146         LayoutUnit contentHeightForFormattingContextRoot(const Box&amp;) const;</span>
147 
<span class="line-modified">148         static HorizontalConstraints horizontalConstraintsForOutOfFlow(const Display::Box&amp; containingBlockGeometry);</span>
<span class="line-added">149         static VerticalConstraints verticalConstraintsForOutOfFlow(const Display::Box&amp; containingBlockGeometry);</span>
<span class="line-added">150         static HorizontalConstraints horizontalConstraintsForInFlow(const Display::Box&amp; containingBlockGeometry);</span>
<span class="line-added">151         static VerticalConstraints verticalConstraintsForInFlow(const Display::Box&amp; containingBlockGeometry);</span>
152 
153     protected:
<span class="line-added">154         friend class FormattingContext;</span>
<span class="line-added">155         Geometry(const FormattingContext&amp;);</span>
<span class="line-added">156 </span>
157         enum class HeightType { Min, Max, Normal };
<span class="line-modified">158         Optional&lt;LayoutUnit&gt; computedHeightValue(const Box&amp;, HeightType, Optional&lt;LayoutUnit&gt; containingBlockHeight) const;</span>
<span class="line-added">159         Optional&lt;LayoutUnit&gt; computedContentHeight(const Box&amp;, Optional&lt;LayoutUnit&gt; containingBlockHeight = WTF::nullopt) const;</span>
<span class="line-added">160         Optional&lt;LayoutUnit&gt; computedContentWidth(const Box&amp;, LayoutUnit containingBlockWidth) const;</span>
<span class="line-added">161 </span>
<span class="line-added">162         const LayoutState&amp; layoutState() const { return m_formattingContext.layoutState(); }</span>
<span class="line-added">163         LayoutState&amp; layoutState() { return m_formattingContext.layoutState(); }</span>
<span class="line-added">164         const FormattingContext&amp; formattingContext() const { return m_formattingContext; }</span>
165 
166     private:
<span class="line-modified">167         VerticalGeometry outOfFlowReplacedVerticalGeometry(const Box&amp;, const HorizontalConstraints&amp;, const VerticalConstraints&amp;, const OverrideVerticalValues&amp;) const;</span>
<span class="line-modified">168         HorizontalGeometry outOfFlowReplacedHorizontalGeometry(const Box&amp;, const HorizontalConstraints&amp;, const OverrideHorizontalValues&amp;) const;</span>
<span class="line-added">169 </span>
<span class="line-added">170         VerticalGeometry outOfFlowNonReplacedVerticalGeometry(const Box&amp;, const HorizontalConstraints&amp;, const VerticalConstraints&amp;, const OverrideVerticalValues&amp;) const;</span>
<span class="line-added">171         HorizontalGeometry outOfFlowNonReplacedHorizontalGeometry(const Box&amp;, const HorizontalConstraints&amp;, const OverrideHorizontalValues&amp;);</span>
172 
<span class="line-modified">173         ContentHeightAndMargin floatingReplacedHeightAndMargin(const Box&amp;, const HorizontalConstraints&amp;, const OverrideVerticalValues&amp;) const;</span>
<span class="line-modified">174         ContentWidthAndMargin floatingReplacedWidthAndMargin(const Box&amp;, const HorizontalConstraints&amp;, const OverrideHorizontalValues&amp;) const;</span>
175 
<span class="line-modified">176         ContentWidthAndMargin floatingNonReplacedWidthAndMargin(const Box&amp;, const HorizontalConstraints&amp;, const OverrideHorizontalValues&amp;);</span>

177 
<span class="line-modified">178         LayoutUnit staticVerticalPositionForOutOfFlowPositioned(const Box&amp;, const VerticalConstraints&amp;) const;</span>
<span class="line-added">179         LayoutUnit staticHorizontalPositionForOutOfFlowPositioned(const Box&amp;, const HorizontalConstraints&amp;) const;</span>
<span class="line-added">180 </span>
<span class="line-added">181         const FormattingContext&amp; m_formattingContext;</span>
182     };
<span class="line-added">183     FormattingContext::Geometry geometry() const { return Geometry(*this); }</span>
184 
185     class Quirks {
186     public:
<span class="line-modified">187         LayoutUnit heightValueOfNearestContainingBlockWithFixedHeight(const Box&amp;);</span>
<span class="line-added">188 </span>
<span class="line-added">189     protected:</span>
<span class="line-added">190         friend class FormattingContext;</span>
<span class="line-added">191         Quirks(const FormattingContext&amp;);</span>
<span class="line-added">192 </span>
<span class="line-added">193         const LayoutState&amp; layoutState() const { return m_formattingContext.layoutState(); }</span>
<span class="line-added">194         LayoutState&amp; layoutState() { return m_formattingContext.layoutState(); }</span>
<span class="line-added">195         const FormattingContext&amp; formattingContext() const { return m_formattingContext; }</span>
<span class="line-added">196 </span>
<span class="line-added">197         const FormattingContext&amp; m_formattingContext;</span>
198     };
<span class="line-added">199     FormattingContext::Quirks quirks() const { return Quirks(*this); }</span>
200 
201 private:
<span class="line-modified">202     void collectOutOfFlowDescendantsIfNeeded();</span>
<span class="line-modified">203     void computeOutOfFlowVerticalGeometry(const Box&amp;, const HorizontalConstraints&amp;, const VerticalConstraints&amp;);</span>
<span class="line-added">204     void computeOutOfFlowHorizontalGeometry(const Box&amp;, const HorizontalConstraints&amp;);</span>
205 
<span class="line-modified">206     WeakPtr&lt;const Container&gt; m_root;</span>
207     FormattingState&amp; m_formattingState;
208 };
209 
<span class="line-added">210 inline FormattingContext::Geometry::Geometry(const FormattingContext&amp; formattingContext)</span>
<span class="line-added">211     : m_formattingContext(formattingContext)</span>
<span class="line-added">212 {</span>
<span class="line-added">213 }</span>
<span class="line-added">214 </span>
<span class="line-added">215 inline FormattingContext::Quirks::Quirks(const FormattingContext&amp; formattingContext)</span>
<span class="line-added">216     : m_formattingContext(formattingContext)</span>
<span class="line-added">217 {</span>
<span class="line-added">218 }</span>
<span class="line-added">219 </span>
220 inline void FormattingContext::IntrinsicWidthConstraints::expand(LayoutUnit horizontalValue)
221 {
222     minimum += horizontalValue;
223     maximum += horizontalValue;
224 }
225 
226 inline FormattingContext::IntrinsicWidthConstraints&amp; FormattingContext::IntrinsicWidthConstraints::operator+=(const IntrinsicWidthConstraints&amp; other)
227 {
228     minimum += other.minimum;
229     maximum += other.maximum;
230     return *this;
231 }
232 
233 }
234 }
<span class="line-added">235 </span>
<span class="line-added">236 #define SPECIALIZE_TYPE_TRAITS_LAYOUT_FORMATTING_CONTEXT(ToValueTypeName, predicate) \</span>
<span class="line-added">237 SPECIALIZE_TYPE_TRAITS_BEGIN(WebCore::Layout::ToValueTypeName) \</span>
<span class="line-added">238     static bool isType(const WebCore::Layout::FormattingContext&amp; formattingContext) { return formattingContext.predicate; } \</span>
<span class="line-added">239 SPECIALIZE_TYPE_TRAITS_END()</span>
<span class="line-added">240 </span>
241 #endif
</pre>
</td>
</tr>
</table>
<center><a href="FormattingContext.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="FormattingContextGeometry.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>