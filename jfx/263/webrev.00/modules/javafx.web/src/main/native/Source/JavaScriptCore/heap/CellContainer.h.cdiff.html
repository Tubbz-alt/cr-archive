<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/heap/CellContainer.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CellContainer.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CellContainerInlines.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/heap/CellContainer.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 29,18 ***</span>
  
  namespace JSC {
  
  class Heap;
  class HeapCell;
<span class="line-modified">! class LargeAllocation;</span>
  class MarkedBlock;
  class WeakSet;
  class VM;
  
  typedef uint32_t HeapVersion;
  
<span class="line-modified">! // This is how we abstract over either MarkedBlock&amp; or LargeAllocation&amp;. Put things in here as you</span>
  // find need for them.
  
  class CellContainer {
  public:
      CellContainer()
<span class="line-new-header">--- 29,18 ---</span>
  
  namespace JSC {
  
  class Heap;
  class HeapCell;
<span class="line-modified">! class PreciseAllocation;</span>
  class MarkedBlock;
  class WeakSet;
  class VM;
  
  typedef uint32_t HeapVersion;
  
<span class="line-modified">! // This is how we abstract over either MarkedBlock&amp; or PreciseAllocation&amp;. Put things in here as you</span>
  // find need for them.
  
  class CellContainer {
  public:
      CellContainer()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 51,33 ***</span>
      CellContainer(MarkedBlock&amp; markedBlock)
          : m_encodedPointer(bitwise_cast&lt;uintptr_t&gt;(&amp;markedBlock))
      {
      }
  
<span class="line-modified">!     CellContainer(LargeAllocation&amp; largeAllocation)</span>
<span class="line-modified">!         : m_encodedPointer(bitwise_cast&lt;uintptr_t&gt;(&amp;largeAllocation) | isLargeAllocationBit)</span>
      {
      }
  
      VM&amp; vm() const;
      Heap* heap() const;
  
      explicit operator bool() const { return !!m_encodedPointer; }
  
<span class="line-modified">!     bool isMarkedBlock() const { return m_encodedPointer &amp;&amp; !(m_encodedPointer &amp; isLargeAllocationBit); }</span>
<span class="line-modified">!     bool isLargeAllocation() const { return m_encodedPointer &amp; isLargeAllocationBit; }</span>
  
      MarkedBlock&amp; markedBlock() const
      {
          ASSERT(isMarkedBlock());
          return *bitwise_cast&lt;MarkedBlock*&gt;(m_encodedPointer);
      }
  
<span class="line-modified">!     LargeAllocation&amp; largeAllocation() const</span>
      {
<span class="line-modified">!         ASSERT(isLargeAllocation());</span>
<span class="line-modified">!         return *bitwise_cast&lt;LargeAllocation*&gt;(m_encodedPointer - isLargeAllocationBit);</span>
      }
  
      void aboutToMark(HeapVersion markingVersion);
      bool areMarksStale() const;
  
<span class="line-new-header">--- 51,33 ---</span>
      CellContainer(MarkedBlock&amp; markedBlock)
          : m_encodedPointer(bitwise_cast&lt;uintptr_t&gt;(&amp;markedBlock))
      {
      }
  
<span class="line-modified">!     CellContainer(PreciseAllocation&amp; preciseAllocation)</span>
<span class="line-modified">!         : m_encodedPointer(bitwise_cast&lt;uintptr_t&gt;(&amp;preciseAllocation) | isPreciseAllocationBit)</span>
      {
      }
  
      VM&amp; vm() const;
      Heap* heap() const;
  
      explicit operator bool() const { return !!m_encodedPointer; }
  
<span class="line-modified">!     bool isMarkedBlock() const { return m_encodedPointer &amp;&amp; !(m_encodedPointer &amp; isPreciseAllocationBit); }</span>
<span class="line-modified">!     bool isPreciseAllocation() const { return m_encodedPointer &amp; isPreciseAllocationBit; }</span>
  
      MarkedBlock&amp; markedBlock() const
      {
          ASSERT(isMarkedBlock());
          return *bitwise_cast&lt;MarkedBlock*&gt;(m_encodedPointer);
      }
  
<span class="line-modified">!     PreciseAllocation&amp; preciseAllocation() const</span>
      {
<span class="line-modified">!         ASSERT(isPreciseAllocation());</span>
<span class="line-modified">!         return *bitwise_cast&lt;PreciseAllocation*&gt;(m_encodedPointer - isPreciseAllocationBit);</span>
      }
  
      void aboutToMark(HeapVersion markingVersion);
      bool areMarksStale() const;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 92,11 ***</span>
      size_t cellSize() const;
  
      WeakSet&amp; weakSet() const;
  
  private:
<span class="line-modified">!     static const uintptr_t isLargeAllocationBit = 1;</span>
      uintptr_t m_encodedPointer;
  };
  
  } // namespace JSC
  
<span class="line-new-header">--- 92,11 ---</span>
      size_t cellSize() const;
  
      WeakSet&amp; weakSet() const;
  
  private:
<span class="line-modified">!     static constexpr uintptr_t isPreciseAllocationBit = 1;</span>
      uintptr_t m_encodedPointer;
  };
  
  } // namespace JSC
  
</pre>
<center><a href="CellContainer.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="CellContainerInlines.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>