<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/JSTypedArrayViewPrototype.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) 2015-2019 Apple Inc. All rights reserved.
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions
  6  * are met:
  7  * 1. Redistributions of source code must retain the above copyright
  8  *    notice, this list of conditions and the following disclaimer.
  9  * 2. Redistributions in binary form must reproduce the above copyright
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #include &quot;config.h&quot;
 27 #include &quot;JSTypedArrayViewPrototype.h&quot;
 28 
 29 #include &quot;BuiltinNames.h&quot;
 30 #include &quot;CallFrame.h&quot;
 31 #include &quot;GetterSetter.h&quot;
 32 #include &quot;JSArrayIterator.h&quot;
 33 #include &quot;JSCInlines.h&quot;
 34 #include &quot;JSFunction.h&quot;
 35 #include &quot;JSGenericTypedArrayViewPrototypeFunctions.h&quot;
 36 #include &quot;JSObjectInlines.h&quot;
 37 #include &quot;TypedArrayAdaptors.h&quot;
 38 
 39 namespace JSC {
 40 
 41 #define CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(functionName) do {                           \
 42     switch (thisValue.getObject()-&gt;classInfo(vm)-&gt;typedArrayStorageType) {                      \
 43     case TypeUint8Clamped:                                                                      \
 44         return functionName&lt;JSUint8ClampedArray&gt;(vm, globalObject, callFrame);                  \
 45     case TypeInt32:                                                                             \
 46         return functionName&lt;JSInt32Array&gt;(vm, globalObject, callFrame);                         \
 47     case TypeUint32:                                                                            \
 48         return functionName&lt;JSUint32Array&gt;(vm, globalObject, callFrame);                        \
 49     case TypeFloat64:                                                                           \
 50         return functionName&lt;JSFloat64Array&gt;(vm, globalObject, callFrame);                       \
 51     case TypeFloat32:                                                                           \
 52         return functionName&lt;JSFloat32Array&gt;(vm, globalObject, callFrame);                       \
 53     case TypeInt8:                                                                              \
 54         return functionName&lt;JSInt8Array&gt;(vm, globalObject, callFrame);                          \
 55     case TypeUint8:                                                                             \
 56         return functionName&lt;JSUint8Array&gt;(vm, globalObject, callFrame);                         \
 57     case TypeInt16:                                                                             \
 58         return functionName&lt;JSInt16Array&gt;(vm, globalObject, callFrame);                         \
 59     case TypeUint16:                                                                            \
 60         return functionName&lt;JSUint16Array&gt;(vm, globalObject, callFrame);                        \
 61     case NotTypedArray:                                                                         \
 62     case TypeDataView:                                                                          \
 63         return throwVMTypeError(globalObject, scope,                                            \
 64             &quot;Receiver should be a typed array view&quot;_s);                                         \
 65     }                                                                                           \
 66     RELEASE_ASSERT_NOT_REACHED();                                                               \
 67 } while (false)
 68 
 69 EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncIsTypedArrayView(JSGlobalObject* globalObject, CallFrame* callFrame)
 70 {
 71     JSValue value = callFrame-&gt;uncheckedArgument(0);
 72     return JSValue::encode(jsBoolean(value.isCell() &amp;&amp; isTypedView(value.asCell()-&gt;classInfo(globalObject-&gt;vm())-&gt;typedArrayStorageType)));
 73 }
 74 
 75 EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncLength(JSGlobalObject* globalObject, CallFrame* callFrame)
 76 {
 77     VM&amp; vm = globalObject-&gt;vm();
 78     auto scope = DECLARE_THROW_SCOPE(vm);
 79     JSValue argument = callFrame-&gt;argument(0);
 80     if (!argument.isCell() || !isTypedView(argument.asCell()-&gt;classInfo(vm)-&gt;typedArrayStorageType))
 81         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view&quot;_s);
 82 
 83     JSArrayBufferView* thisObject = jsCast&lt;JSArrayBufferView*&gt;(argument);
 84 
 85     if (thisObject-&gt;isNeutered())
 86         return throwVMTypeError(globalObject, scope, &quot;Underlying ArrayBuffer has been detached from the view&quot;_s);
 87 
 88     return JSValue::encode(jsNumber(thisObject-&gt;length()));
 89 }
 90 
 91 EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncGetOriginalConstructor(JSGlobalObject* globalObject, CallFrame* callFrame)
 92 {
 93     VM&amp; vm = globalObject-&gt;vm();
 94     TypedArrayType type = callFrame-&gt;uncheckedArgument(0).getObject()-&gt;classInfo(vm)-&gt;typedArrayStorageType;
 95     ASSERT(isTypedView(type));
 96     return JSValue::encode(globalObject-&gt;typedArrayConstructor(type));
 97 }
 98 
 99 inline EncodedJSValue createTypedArrayIteratorObject(JSGlobalObject* globalObject, CallFrame* callFrame, IterationKind kind)
100 {
101     VM&amp; vm = globalObject-&gt;vm();
102     auto scope = DECLARE_THROW_SCOPE(vm);
103 
104     if (!callFrame-&gt;thisValue().isCell() || !isTypedArrayType(callFrame-&gt;thisValue().asCell()-&gt;type()))
105         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view&quot;_s);
106 
107     JSArrayBufferView* thisObject = jsCast&lt;JSArrayBufferView*&gt;(callFrame-&gt;thisValue());
108 
109     if (thisObject-&gt;isNeutered())
110         return throwVMTypeError(globalObject, scope, &quot;Underlying ArrayBuffer has been detached from the view&quot;_s);
111 
112     return JSValue::encode(JSArrayIterator::create(vm, globalObject-&gt;arrayIteratorStructure(), thisObject, jsNumber(static_cast&lt;unsigned&gt;(kind))));
113 }
114 
115 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncValues(JSGlobalObject* globalObject, CallFrame* callFrame)
116 {
117     return createTypedArrayIteratorObject(globalObject, callFrame, IterationKind::Values);
118 }
119 
120 static EncodedJSValue JSC_HOST_CALL typedArrayProtoViewFuncEntries(JSGlobalObject* globalObject, CallFrame* callFrame)
121 {
122     return createTypedArrayIteratorObject(globalObject, callFrame, IterationKind::Entries);
123 }
124 
125 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncKeys(JSGlobalObject* globalObject, CallFrame* callFrame)
126 {
127     return createTypedArrayIteratorObject(globalObject, callFrame, IterationKind::Keys);
128 }
129 
130 EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncSort(JSGlobalObject* globalObject, CallFrame* callFrame)
131 {
132     VM&amp; vm = globalObject-&gt;vm();
133     auto scope = DECLARE_THROW_SCOPE(vm);
134     JSValue thisValue = callFrame-&gt;argument(0);
135     scope.release();
136     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewPrivateFuncSort);
137 }
138 
139 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncSet(JSGlobalObject* globalObject, CallFrame* callFrame)
140 {
141     VM&amp; vm = globalObject-&gt;vm();
142     auto scope = DECLARE_THROW_SCOPE(vm);
143     JSValue thisValue = callFrame-&gt;thisValue();
144     if (UNLIKELY(!thisValue.isObject()))
145         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
146     scope.release();
147     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncSet);
148 }
149 
150 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncCopyWithin(JSGlobalObject* globalObject, CallFrame* callFrame)
151 {
152     VM&amp; vm = globalObject-&gt;vm();
153     auto scope = DECLARE_THROW_SCOPE(vm);
154     JSValue thisValue = callFrame-&gt;thisValue();
155     if (!thisValue.isObject())
156         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
157     scope.release();
158     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncCopyWithin);
159 }
160 
161 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncIncludes(JSGlobalObject* globalObject, CallFrame* callFrame)
162 {
163     VM&amp; vm = globalObject-&gt;vm();
164     auto scope = DECLARE_THROW_SCOPE(vm);
165     JSValue thisValue = callFrame-&gt;thisValue();
166     if (!thisValue.isObject())
167         return throwVMError(globalObject, scope, createTypeError(globalObject, &quot;Receiver should be a typed array view but was not an object&quot;));
168     scope.release();
169     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncIncludes);
170 }
171 
172 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncLastIndexOf(JSGlobalObject* globalObject, CallFrame* callFrame)
173 {
174     VM&amp; vm = globalObject-&gt;vm();
175     auto scope = DECLARE_THROW_SCOPE(vm);
176     JSValue thisValue = callFrame-&gt;thisValue();
177     if (!thisValue.isObject())
178         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
179     scope.release();
180     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncLastIndexOf);
181 }
182 
183 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncIndexOf(JSGlobalObject* globalObject, CallFrame* callFrame)
184 {
185     VM&amp; vm = globalObject-&gt;vm();
186     auto scope = DECLARE_THROW_SCOPE(vm);
187     JSValue thisValue = callFrame-&gt;thisValue();
188     if (!thisValue.isObject())
189         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
190     scope.release();
191     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncIndexOf);
192 }
193 
194 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncJoin(JSGlobalObject* globalObject, CallFrame* callFrame)
195 {
196     VM&amp; vm = globalObject-&gt;vm();
197     auto scope = DECLARE_THROW_SCOPE(vm);
198     JSValue thisValue = callFrame-&gt;thisValue();
199     if (!thisValue.isObject())
200         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
201     scope.release();
202     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncJoin);
203 }
204 
205 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncBuffer(JSGlobalObject* globalObject, CallFrame* callFrame)
206 {
207     VM&amp; vm = globalObject-&gt;vm();
208     auto scope = DECLARE_THROW_SCOPE(vm);
209     JSValue thisValue = callFrame-&gt;thisValue();
210     if (!thisValue.isObject())
211         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
212     scope.release();
213     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoGetterFuncBuffer);
214 }
215 
216 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncLength(JSGlobalObject* globalObject, CallFrame* callFrame)
217 {
218     VM&amp; vm = globalObject-&gt;vm();
219     auto scope = DECLARE_THROW_SCOPE(vm);
220     JSValue thisValue = callFrame-&gt;thisValue();
221     if (!thisValue.isObject())
222         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
223     scope.release();
224     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoGetterFuncLength);
225 }
226 
227 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncByteLength(JSGlobalObject* globalObject, CallFrame* callFrame)
228 {
229     VM&amp; vm = globalObject-&gt;vm();
230     auto scope = DECLARE_THROW_SCOPE(vm);
231     JSValue thisValue = callFrame-&gt;thisValue();
232     if (!thisValue.isObject())
233         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
234     scope.release();
235     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoGetterFuncByteLength);
236 }
237 
238 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncByteOffset(JSGlobalObject* globalObject, CallFrame* callFrame)
239 {
240     VM&amp; vm = globalObject-&gt;vm();
241     auto scope = DECLARE_THROW_SCOPE(vm);
242     JSValue thisValue = callFrame-&gt;thisValue();
243     if (!thisValue.isObject())
244         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
245     scope.release();
246     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoGetterFuncByteOffset);
247 }
248 
249 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncReverse(JSGlobalObject* globalObject, CallFrame* callFrame)
250 {
251     VM&amp; vm = globalObject-&gt;vm();
252     auto scope = DECLARE_THROW_SCOPE(vm);
253     JSValue thisValue = callFrame-&gt;thisValue();
254     if (!thisValue.isObject())
255         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
256     scope.release();
257     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncReverse);
258 }
259 
260 EncodedJSValue JSC_HOST_CALL typedArrayViewPrivateFuncSubarrayCreate(JSGlobalObject* globalObject, CallFrame* callFrame)
261 {
262     VM&amp; vm = globalObject-&gt;vm();
263     auto scope = DECLARE_THROW_SCOPE(vm);
264     JSValue thisValue = callFrame-&gt;thisValue();
265     if (!thisValue.isObject())
266         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
267     scope.release();
268     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewPrivateFuncSubarrayCreate);
269 }
270 
271 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoFuncSlice(JSGlobalObject* globalObject, CallFrame* callFrame)
272 {
273     VM&amp; vm = globalObject-&gt;vm();
274     auto scope = DECLARE_THROW_SCOPE(vm);
275     JSValue thisValue = callFrame-&gt;thisValue();
276     if (!thisValue.isObject())
277         return throwVMTypeError(globalObject, scope, &quot;Receiver should be a typed array view but was not an object&quot;_s);
278     scope.release();
279     CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION(genericTypedArrayViewProtoFuncSlice);
280 }
281 
282 static EncodedJSValue JSC_HOST_CALL typedArrayViewProtoGetterFuncToStringTag(JSGlobalObject* globalObject, CallFrame* callFrame)
283 {
284     JSValue thisValue = callFrame-&gt;thisValue();
285     if (!thisValue.isObject())
286         return JSValue::encode(jsUndefined());
287 
288     VM&amp; vm = globalObject-&gt;vm();
289     switch (thisValue.getObject()-&gt;classInfo(vm)-&gt;typedArrayStorageType) {
290     case TypeUint8Clamped:
291         return JSValue::encode(jsNontrivialString(vm, &quot;Uint8ClampedArray&quot;_s));
292     case TypeInt32:
293         return JSValue::encode(jsNontrivialString(vm, &quot;Int32Array&quot;_s));
294     case TypeUint32:
295         return JSValue::encode(jsNontrivialString(vm, &quot;Uint32Array&quot;_s));
296     case TypeFloat64:
297         return JSValue::encode(jsNontrivialString(vm, &quot;Float64Array&quot;_s));
298     case TypeFloat32:
299         return JSValue::encode(jsNontrivialString(vm, &quot;Float32Array&quot;_s));
300     case TypeInt8:
301         return JSValue::encode(jsNontrivialString(vm, &quot;Int8Array&quot;_s));
302     case TypeUint8:
303         return JSValue::encode(jsNontrivialString(vm, &quot;Uint8Array&quot;_s));
304     case TypeInt16:
305         return JSValue::encode(jsNontrivialString(vm, &quot;Int16Array&quot;_s));
306     case TypeUint16:
307         return JSValue::encode(jsNontrivialString(vm, &quot;Uint16Array&quot;_s));
308     case NotTypedArray:
309     case TypeDataView:
310         return JSValue::encode(jsUndefined());
311     }
312     RELEASE_ASSERT_NOT_REACHED();
313 }
314 
315 
316 #undef CALL_GENERIC_TYPEDARRAY_PROTOTYPE_FUNCTION
317 
318 JSTypedArrayViewPrototype::JSTypedArrayViewPrototype(VM&amp; vm, Structure* structure)
319     : Base(vm, structure)
320 {
321 }
322 
323 void JSTypedArrayViewPrototype::finishCreation(VM&amp; vm, JSGlobalObject* globalObject)
324 {
325     Base::finishCreation(vm);
326 
327     ASSERT(inherits(vm, info()));
328 
329     putDirectWithoutTransition(vm, vm.propertyNames-&gt;toString, globalObject-&gt;arrayProtoToStringFunction(), static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
330 
331     JSC_NATIVE_GETTER_WITHOUT_TRANSITION(&quot;buffer&quot;, typedArrayViewProtoGetterFuncBuffer, PropertyAttribute::DontEnum | PropertyAttribute::ReadOnly);
332     JSC_NATIVE_INTRINSIC_GETTER_WITHOUT_TRANSITION(vm.propertyNames-&gt;byteLength, typedArrayViewProtoGetterFuncByteLength, PropertyAttribute::DontEnum | PropertyAttribute::ReadOnly, TypedArrayByteLengthIntrinsic);
333     JSC_NATIVE_INTRINSIC_GETTER_WITHOUT_TRANSITION(vm.propertyNames-&gt;byteOffset, typedArrayViewProtoGetterFuncByteOffset, PropertyAttribute::DontEnum | PropertyAttribute::ReadOnly, TypedArrayByteOffsetIntrinsic);
334     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;copyWithin&quot;, typedArrayViewProtoFuncCopyWithin, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 2);
335     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;every&quot;, typedArrayPrototypeEveryCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
336     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;filter&quot;, typedArrayPrototypeFilterCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
337     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;sort&quot;, typedArrayPrototypeSortCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
338     JSC_NATIVE_INTRINSIC_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;entries, typedArrayProtoViewFuncEntries, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 0, TypedArrayEntriesIntrinsic);
339     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;includes&quot;, typedArrayViewProtoFuncIncludes, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
340     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;fill&quot;, typedArrayPrototypeFillCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
341     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;find&quot;, typedArrayPrototypeFindCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
342     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;findIndex&quot;, typedArrayPrototypeFindIndexCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
343     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;forEach, typedArrayPrototypeForEachCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
344     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;indexOf&quot;, typedArrayViewProtoFuncIndexOf, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
345     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;join, typedArrayViewProtoFuncJoin, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
346     JSC_NATIVE_INTRINSIC_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;keys, typedArrayViewProtoFuncKeys, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 0, TypedArrayKeysIntrinsic);
347     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;lastIndexOf&quot;, typedArrayViewProtoFuncLastIndexOf, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
348     JSC_NATIVE_INTRINSIC_GETTER_WITHOUT_TRANSITION(vm.propertyNames-&gt;length, typedArrayViewProtoGetterFuncLength, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum) | PropertyAttribute::ReadOnly, TypedArrayLengthIntrinsic);
349     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;map&quot;, typedArrayPrototypeMapCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
350     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;reduce&quot;, typedArrayPrototypeReduceCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
351     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;reduceRight&quot;, typedArrayPrototypeReduceRightCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
352     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(&quot;reverse&quot;, typedArrayViewProtoFuncReverse, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 0);
353     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;set, typedArrayViewProtoFuncSet, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 1);
354     JSC_NATIVE_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;slice, typedArrayViewProtoFuncSlice, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum), 2);
355     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(&quot;some&quot;, typedArrayPrototypeSomeCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
356     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;subarray, typedArrayPrototypeSubarrayCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
357     JSC_BUILTIN_FUNCTION_WITHOUT_TRANSITION(vm.propertyNames-&gt;toLocaleString, typedArrayPrototypeToLocaleStringCodeGenerator, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
358 
359     JSFunction* toStringTagFunction = JSFunction::create(vm, globalObject, 0, &quot;get [Symbol.toStringTag]&quot;_s, typedArrayViewProtoGetterFuncToStringTag, NoIntrinsic);
360     GetterSetter* toStringTagAccessor = GetterSetter::create(vm, globalObject, toStringTagFunction, nullptr);
361     putDirectNonIndexAccessorWithoutTransition(vm, vm.propertyNames-&gt;toStringTagSymbol, toStringTagAccessor, PropertyAttribute::DontEnum | PropertyAttribute::ReadOnly | PropertyAttribute::Accessor);
362 
363     JSFunction* valuesFunction = JSFunction::create(vm, globalObject, 0, vm.propertyNames-&gt;values.string(), typedArrayViewProtoFuncValues, TypedArrayValuesIntrinsic);
364 
365     putDirectWithoutTransition(vm, vm.propertyNames-&gt;builtinNames().valuesPublicName(), valuesFunction, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
366     putDirectWithoutTransition(vm, vm.propertyNames-&gt;iteratorSymbol, valuesFunction, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));
367 
368 }
369 
370 JSTypedArrayViewPrototype* JSTypedArrayViewPrototype::create(
371     VM&amp; vm, JSGlobalObject* globalObject, Structure* structure)
372 {
373     JSTypedArrayViewPrototype* prototype =
374         new (NotNull, allocateCell&lt;JSTypedArrayViewPrototype&gt;(vm.heap))
375         JSTypedArrayViewPrototype(vm, structure);
376     prototype-&gt;finishCreation(vm, globalObject);
377     return prototype;
378 }
379 
380 Structure* JSTypedArrayViewPrototype::createStructure(
381     VM&amp; vm, JSGlobalObject* globalObject, JSValue prototype)
382 {
383     return Structure::create(vm, globalObject, prototype, TypeInfo(ObjectType, StructureFlags), info());
384 }
385 
386 } // namespace JSC
    </pre>
  </body>
</html>