<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/platform/graphics/displaylists/DisplayListItems.h</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>   1 /*
   2  * Copyright (C) 2015 Apple Inc. All rights reserved.
   3  *
   4  * Redistribution and use in source and binary forms, with or without
   5  * modification, are permitted provided that the following conditions
   6  * are met:
   7  * 1. Redistributions of source code must retain the above copyright
   8  *    notice, this list of conditions and the following disclaimer.
   9  * 2. Redistributions in binary form must reproduce the above copyright
  10  *    notice, this list of conditions and the following disclaimer in the
  11  *    documentation and/or other materials provided with the distribution.
  12  *
  13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
  14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
  17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
  21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  24  */
  25 
  26 #pragma once
  27 
<a name="1" id="anc1"></a>
  28 #include &quot;FloatPoint.h&quot;
<a name="2" id="anc2"></a><span class="line-removed">  29 #include &quot;FloatRect.h&quot;</span>
  30 #include &quot;FloatRoundedRect.h&quot;
  31 #include &quot;Font.h&quot;
  32 #include &quot;GlyphBuffer.h&quot;
<a name="3" id="anc3"></a><span class="line-removed">  33 #include &quot;GraphicsContext.h&quot;</span>
  34 #include &quot;Image.h&quot;
<a name="4" id="anc4"></a>
  35 #include &lt;wtf/RefCounted.h&gt;
  36 #include &lt;wtf/TypeCasts.h&gt;
  37 
<a name="5" id="anc5"></a><span class="line-removed">  38 #if USE(CG)</span>
<span class="line-removed">  39 #include &quot;GraphicsContextPlatformPrivateCG.h&quot;</span>
<span class="line-removed">  40 #endif</span>
<span class="line-removed">  41 </span>
  42 namespace WTF {
  43 class TextStream;
  44 }
  45 
  46 namespace WebCore {
  47 
  48 struct ImagePaintingOptions;
  49 
  50 namespace DisplayList {
  51 
<a name="6" id="anc6"></a><span class="line-removed">  52 enum class ItemType {</span>
<span class="line-removed">  53     Save,</span>
<span class="line-removed">  54     Restore,</span>
<span class="line-removed">  55     Translate,</span>
<span class="line-removed">  56     Rotate,</span>
<span class="line-removed">  57     Scale,</span>
<span class="line-removed">  58     ConcatenateCTM,</span>
<span class="line-removed">  59     SetState,</span>
<span class="line-removed">  60     SetLineCap,</span>
<span class="line-removed">  61     SetLineDash,</span>
<span class="line-removed">  62     SetLineJoin,</span>
<span class="line-removed">  63     SetMiterLimit,</span>
<span class="line-removed">  64     ClearShadow,</span>
<span class="line-removed">  65     Clip,</span>
<span class="line-removed">  66     ClipOut,</span>
<span class="line-removed">  67     ClipOutToPath,</span>
<span class="line-removed">  68     ClipPath,</span>
<span class="line-removed">  69     DrawGlyphs,</span>
<span class="line-removed">  70     DrawImage,</span>
<span class="line-removed">  71     DrawTiledImage,</span>
<span class="line-removed">  72     DrawTiledScaledImage,</span>
<span class="line-removed">  73 #if USE(CG) || USE(CAIRO) || USE(DIRECT2D)</span>
<span class="line-removed">  74     DrawNativeImage,</span>
<span class="line-removed">  75 #endif</span>
<span class="line-removed">  76     DrawPattern,</span>
<span class="line-removed">  77     DrawRect,</span>
<span class="line-removed">  78     DrawLine,</span>
<span class="line-removed">  79     DrawLinesForText,</span>
<span class="line-removed">  80     DrawDotsForDocumentMarker,</span>
<span class="line-removed">  81     DrawEllipse,</span>
<span class="line-removed">  82     DrawPath,</span>
<span class="line-removed">  83     DrawFocusRingPath,</span>
<span class="line-removed">  84     DrawFocusRingRects,</span>
<span class="line-removed">  85     FillRect,</span>
<span class="line-removed">  86     FillRectWithColor,</span>
<span class="line-removed">  87     FillRectWithGradient,</span>
<span class="line-removed">  88     FillCompositedRect,</span>
<span class="line-removed">  89     FillRoundedRect,</span>
<span class="line-removed">  90     FillRectWithRoundedHole,</span>
<span class="line-removed">  91     FillPath,</span>
<span class="line-removed">  92     FillEllipse,</span>
<span class="line-removed">  93     StrokeRect,</span>
<span class="line-removed">  94     StrokePath,</span>
<span class="line-removed">  95     StrokeEllipse,</span>
<span class="line-removed">  96     ClearRect,</span>
<span class="line-removed">  97     BeginTransparencyLayer,</span>
<span class="line-removed">  98     EndTransparencyLayer,</span>
<span class="line-removed">  99 #if USE(CG)</span>
<span class="line-removed"> 100     ApplyStrokePattern, // FIXME: should not be a recorded item.</span>
<span class="line-removed"> 101     ApplyFillPattern, // FIXME: should not be a recorded item.</span>
<span class="line-removed"> 102 #endif</span>
<span class="line-removed"> 103     ApplyDeviceScaleFactor,</span>
<span class="line-removed"> 104 };</span>
<span class="line-removed"> 105 </span>
<span class="line-removed"> 106 class Item : public RefCounted&lt;Item&gt; {</span>
<span class="line-removed"> 107 public:</span>
<span class="line-removed"> 108     Item() = delete;</span>
<span class="line-removed"> 109 </span>
<span class="line-removed"> 110     Item(ItemType type)</span>
<span class="line-removed"> 111         : m_type(type)</span>
<span class="line-removed"> 112     {</span>
<span class="line-removed"> 113     }</span>
<span class="line-removed"> 114 </span>
<span class="line-removed"> 115     virtual ~Item() = default;</span>
<span class="line-removed"> 116 </span>
<span class="line-removed"> 117     ItemType type() const</span>
<span class="line-removed"> 118     {</span>
<span class="line-removed"> 119         return m_type;</span>
<span class="line-removed"> 120     }</span>
<span class="line-removed"> 121 </span>
<span class="line-removed"> 122     virtual void apply(GraphicsContext&amp;) const = 0;</span>
<span class="line-removed"> 123 </span>
<span class="line-removed"> 124     static constexpr bool isDisplayListItem = true;</span>
<span class="line-removed"> 125 </span>
<span class="line-removed"> 126     virtual bool isDrawingItem() const { return false; }</span>
<span class="line-removed"> 127 </span>
<span class="line-removed"> 128     // A state item is one preserved by Save/Restore.</span>
<span class="line-removed"> 129     bool isStateItem() const</span>
<span class="line-removed"> 130     {</span>
<span class="line-removed"> 131         return isStateItemType(m_type);</span>
<span class="line-removed"> 132     }</span>
<span class="line-removed"> 133 </span>
<span class="line-removed"> 134     static bool isStateItemType(ItemType itemType)</span>
<span class="line-removed"> 135     {</span>
<span class="line-removed"> 136         switch (itemType) {</span>
<span class="line-removed"> 137         case ItemType:: Translate:</span>
<span class="line-removed"> 138         case ItemType:: Rotate:</span>
<span class="line-removed"> 139         case ItemType:: Scale:</span>
<span class="line-removed"> 140         case ItemType:: ConcatenateCTM:</span>
<span class="line-removed"> 141         case ItemType:: SetState:</span>
<span class="line-removed"> 142         case ItemType:: SetLineCap:</span>
<span class="line-removed"> 143         case ItemType:: SetLineDash:</span>
<span class="line-removed"> 144         case ItemType:: SetLineJoin:</span>
<span class="line-removed"> 145         case ItemType:: SetMiterLimit:</span>
<span class="line-removed"> 146         case ItemType:: ClearShadow:</span>
<span class="line-removed"> 147             return true;</span>
<span class="line-removed"> 148         default:</span>
<span class="line-removed"> 149             return false;</span>
<span class="line-removed"> 150         }</span>
<span class="line-removed"> 151         return false;</span>
<span class="line-removed"> 152     }</span>
<span class="line-removed"> 153 </span>
<span class="line-removed"> 154 #if !defined(NDEBUG) || !LOG_DISABLED</span>
<span class="line-removed"> 155     WTF::CString description() const;</span>
<span class="line-removed"> 156 #endif</span>
<span class="line-removed"> 157     static size_t sizeInBytes(const Item&amp;);</span>
<span class="line-removed"> 158 </span>
<span class="line-removed"> 159 private:</span>
<span class="line-removed"> 160     ItemType m_type;</span>
<span class="line-removed"> 161 };</span>
<span class="line-removed"> 162 </span>
 163 class DrawingItem : public Item {
 164 public:
<a name="7" id="anc7"></a><span class="line-modified"> 165     explicit DrawingItem(ItemType type)</span>
<span class="line-modified"> 166         : Item(type)</span>
<span class="line-modified"> 167     {</span>
<span class="line-removed"> 168     }</span>
 169 
 170     void setExtent(const FloatRect&amp; r) { m_extent = r; }
 171     const FloatRect&amp; extent() const { return m_extent.value(); }
 172 
 173     bool extentKnown() const { return static_cast&lt;bool&gt;(m_extent); }
 174 
 175     // Return bounds of this drawing operation in local coordinates.
 176     // Does not include effets of transform, shadow etc in the state.
 177     virtual Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const { return WTF::nullopt; }
 178 
 179 private:
 180     bool isDrawingItem() const override { return true; }
 181 
 182     Optional&lt;FloatRect&gt; m_extent; // In base coordinates, taking shadows and transforms into account.
 183 };
 184 
 185 class Save : public Item {
 186 public:
 187     static Ref&lt;Save&gt; create()
 188     {
 189         return adoptRef(*new Save);
 190     }
 191 
<a name="8" id="anc8"></a>

 192     // Index in the display list of the corresponding Restore item. 0 if unmatched.
 193     size_t restoreIndex() const { return m_restoreIndex; }
 194     void setRestoreIndex(size_t index) { m_restoreIndex = index; }
 195 
<a name="9" id="anc9"></a>


 196 private:
<a name="10" id="anc10"></a><span class="line-modified"> 197     Save()</span>
<span class="line-removed"> 198         : Item(ItemType::Save)</span>
<span class="line-removed"> 199     {</span>
<span class="line-removed"> 200     }</span>
 201 
 202     void apply(GraphicsContext&amp;) const override;
 203 
 204     size_t m_restoreIndex { 0 };
 205 };
 206 
<a name="11" id="anc11"></a>



















 207 class Restore : public Item {
 208 public:
 209     static Ref&lt;Restore&gt; create()
 210     {
 211         return adoptRef(*new Restore);
 212     }
 213 
<a name="12" id="anc12"></a>




 214 private:
<a name="13" id="anc13"></a><span class="line-modified"> 215     Restore()</span>
<span class="line-removed"> 216         : Item(ItemType::Restore)</span>
<span class="line-removed"> 217     {</span>
<span class="line-removed"> 218     }</span>
 219 
 220     void apply(GraphicsContext&amp;) const override;
 221 };
 222 
<a name="14" id="anc14"></a>










 223 class Translate : public Item {
 224 public:
 225     static Ref&lt;Translate&gt; create(float x, float y)
 226     {
 227         return adoptRef(*new Translate(x, y));
 228     }
 229 
<a name="15" id="anc15"></a>

 230     float x() const { return m_x; }
 231     float y() const { return m_y; }
 232 
<a name="16" id="anc16"></a>


 233 private:
<a name="17" id="anc17"></a><span class="line-modified"> 234     Translate(float x, float y)</span>
<span class="line-removed"> 235         : Item(ItemType::Translate)</span>
<span class="line-removed"> 236         , m_x(x)</span>
<span class="line-removed"> 237         , m_y(y)</span>
<span class="line-removed"> 238     {</span>
<span class="line-removed"> 239     }</span>
 240 
 241     void apply(GraphicsContext&amp;) const override;
 242 
 243     float m_x;
 244     float m_y;
 245 };
 246 
<a name="18" id="anc18"></a>






















 247 class Rotate : public Item {
 248 public:
 249     static Ref&lt;Rotate&gt; create(float angleInRadians)
 250     {
 251         return adoptRef(*new Rotate(angleInRadians));
 252     }
 253 
<a name="19" id="anc19"></a>

 254     float angle() const { return m_angle; }
 255 
<a name="20" id="anc20"></a>


 256 private:
<a name="21" id="anc21"></a><span class="line-modified"> 257     Rotate(float angle)</span>
<span class="line-removed"> 258         : Item(ItemType::Rotate)</span>
<span class="line-removed"> 259         , m_angle(angle)</span>
<span class="line-removed"> 260     {</span>
<span class="line-removed"> 261     }</span>
 262 
 263     void apply(GraphicsContext&amp;) const override;
 264 
 265     float m_angle; // In radians.
 266 };
 267 
<a name="22" id="anc22"></a>
















 268 class Scale : public Item {
 269 public:
 270     static Ref&lt;Scale&gt; create(const FloatSize&amp; size)
 271     {
 272         return adoptRef(*new Scale(size));
 273     }
 274 
<a name="23" id="anc23"></a>

 275     const FloatSize&amp; amount() const { return m_size; }
 276 
<a name="24" id="anc24"></a>


 277 private:
<a name="25" id="anc25"></a><span class="line-modified"> 278     Scale(const FloatSize&amp; size)</span>
<span class="line-modified"> 279         : Item(ItemType::Scale)</span>
<span class="line-modified"> 280         , m_size(size)</span>
























 281     {
<a name="26" id="anc26"></a>
 282     }
 283 
<a name="27" id="anc27"></a>









 284     void apply(GraphicsContext&amp;) const override;
 285 
<a name="28" id="anc28"></a><span class="line-modified"> 286     FloatSize m_size;</span>
 287 };
 288 
<a name="29" id="anc29"></a>
















 289 class ConcatenateCTM : public Item {
 290 public:
 291     static Ref&lt;ConcatenateCTM&gt; create(const AffineTransform&amp; matrix)
 292     {
 293         return adoptRef(*new ConcatenateCTM(matrix));
 294     }
 295 
<a name="30" id="anc30"></a>

 296     const AffineTransform&amp; transform() const { return m_transform; }
 297 
<a name="31" id="anc31"></a>


 298 private:
<a name="32" id="anc32"></a><span class="line-modified"> 299     ConcatenateCTM(const AffineTransform&amp;);</span>
 300 
 301     void apply(GraphicsContext&amp;) const override;
 302 
 303     AffineTransform m_transform;
 304 };
 305 
<a name="33" id="anc33"></a>
















 306 class SetState : public Item {
 307 public:
 308     static Ref&lt;SetState&gt; create(const GraphicsContextState&amp; state, GraphicsContextState::StateChangeFlags flags)
 309     {
 310         return adoptRef(*new SetState(state, flags));
 311     }
 312 
<a name="34" id="anc34"></a>






 313     const GraphicsContextStateChange&amp; state() const { return m_state; }
 314 
 315     void accumulate(const GraphicsContextState&amp;, GraphicsContextState::StateChangeFlags);
 316 
 317     void accumulate(GraphicsContextState&amp;) const;
 318 
<a name="35" id="anc35"></a><span class="line-modified"> 319     static void applyState(GraphicsContext&amp;, const GraphicsContextState&amp;, GraphicsContextState::StateChangeFlags);</span>
 320 
 321     static void dumpStateChanges(WTF::TextStream&amp;, const GraphicsContextState&amp;, GraphicsContextState::StateChangeFlags);
<a name="36" id="anc36"></a>



 322 private:
<a name="37" id="anc37"></a><span class="line-modified"> 323     SetState(const GraphicsContextState&amp; state, GraphicsContextState::StateChangeFlags flags)</span>
<span class="line-modified"> 324         : Item(ItemType::SetState)</span>
<span class="line-removed"> 325         , m_state(state, flags)</span>
<span class="line-removed"> 326     {</span>
<span class="line-removed"> 327     }</span>
 328 
 329     void apply(GraphicsContext&amp;) const override;
 330 
 331     GraphicsContextStateChange m_state;
 332 };
 333 
<a name="38" id="anc38"></a>

























































































































































































































































































































 334 class SetLineCap : public Item {
 335 public:
 336     static Ref&lt;SetLineCap&gt; create(LineCap lineCap)
 337     {
 338         return adoptRef(*new SetLineCap(lineCap));
 339     }
 340 
<a name="39" id="anc39"></a>

 341     LineCap lineCap() const { return m_lineCap; }
 342 
<a name="40" id="anc40"></a>


 343 private:
<a name="41" id="anc41"></a><span class="line-modified"> 344     SetLineCap(LineCap lineCap)</span>
<span class="line-removed"> 345         : Item(ItemType::SetLineCap)</span>
<span class="line-removed"> 346         , m_lineCap(lineCap)</span>
<span class="line-removed"> 347     {</span>
<span class="line-removed"> 348     }</span>
 349 
 350     void apply(GraphicsContext&amp;) const override;
 351 
 352     LineCap m_lineCap;
 353 };
 354 
<a name="42" id="anc42"></a>
















 355 class SetLineDash : public Item {
 356 public:
 357     static Ref&lt;SetLineDash&gt; create(const DashArray&amp; dashArray, float dashOffset)
 358     {
 359         return adoptRef(*new SetLineDash(dashArray, dashOffset));
 360     }
 361 
<a name="43" id="anc43"></a>

 362     const DashArray&amp; dashArray() const { return m_dashArray; }
 363     float dashOffset() const { return m_dashOffset; }
 364 
<a name="44" id="anc44"></a>


 365 private:
<a name="45" id="anc45"></a><span class="line-modified"> 366     SetLineDash(const DashArray&amp; dashArray, float dashOffset)</span>
<span class="line-removed"> 367         : Item(ItemType::SetLineDash)</span>
<span class="line-removed"> 368         , m_dashArray(dashArray)</span>
<span class="line-removed"> 369         , m_dashOffset(dashOffset)</span>
<span class="line-removed"> 370     {</span>
<span class="line-removed"> 371     }</span>
 372 
 373     void apply(GraphicsContext&amp;) const override;
 374 
 375     DashArray m_dashArray;
 376     float m_dashOffset;
 377 };
 378 
<a name="46" id="anc46"></a>






















 379 class SetLineJoin : public Item {
 380 public:
 381     static Ref&lt;SetLineJoin&gt; create(LineJoin lineJoin)
 382     {
 383         return adoptRef(*new SetLineJoin(lineJoin));
 384     }
 385 
<a name="47" id="anc47"></a>

 386     LineJoin lineJoin() const { return m_lineJoin; }
 387 
<a name="48" id="anc48"></a>


 388 private:
<a name="49" id="anc49"></a><span class="line-modified"> 389     SetLineJoin(LineJoin lineJoin)</span>
<span class="line-removed"> 390         : Item(ItemType::SetLineJoin)</span>
<span class="line-removed"> 391         , m_lineJoin(lineJoin)</span>
<span class="line-removed"> 392     {</span>
<span class="line-removed"> 393     }</span>
 394 
 395     void apply(GraphicsContext&amp;) const override;
 396 
 397     LineJoin m_lineJoin;
 398 };
 399 
<a name="50" id="anc50"></a>
















 400 class SetMiterLimit : public Item {
 401 public:
 402     static Ref&lt;SetMiterLimit&gt; create(float limit)
 403     {
 404         return adoptRef(*new SetMiterLimit(limit));
 405     }
 406 
<a name="51" id="anc51"></a>

 407     float miterLimit() const { return m_miterLimit; }
 408 
<a name="52" id="anc52"></a>


 409 private:
<a name="53" id="anc53"></a><span class="line-modified"> 410     SetMiterLimit(float miterLimit)</span>
<span class="line-removed"> 411         : Item(ItemType::SetMiterLimit)</span>
<span class="line-removed"> 412         , m_miterLimit(miterLimit)</span>
<span class="line-removed"> 413     {</span>
<span class="line-removed"> 414     }</span>
 415 
 416     void apply(GraphicsContext&amp;) const override;
 417 
 418     float m_miterLimit;
 419 };
 420 
<a name="54" id="anc54"></a>
















 421 class ClearShadow : public Item {
 422 public:
 423     static Ref&lt;ClearShadow&gt; create()
 424     {
 425         return adoptRef(*new ClearShadow);
 426     }
 427 
<a name="55" id="anc55"></a>




 428 private:
<a name="56" id="anc56"></a><span class="line-modified"> 429     ClearShadow()</span>
<span class="line-removed"> 430         : Item(ItemType::ClearShadow)</span>
<span class="line-removed"> 431     {</span>
<span class="line-removed"> 432     }</span>
 433 
 434     void apply(GraphicsContext&amp;) const override;
 435 };
 436 
<a name="57" id="anc57"></a>










 437 // FIXME: treat as DrawingItem?
 438 class Clip : public Item {
 439 public:
 440     static Ref&lt;Clip&gt; create(const FloatRect&amp; rect)
 441     {
 442         return adoptRef(*new Clip(rect));
 443     }
 444 
<a name="58" id="anc58"></a>

 445     FloatRect rect() const { return m_rect; }
 446 
<a name="59" id="anc59"></a>


 447 private:
<a name="60" id="anc60"></a><span class="line-modified"> 448     Clip(const FloatRect&amp; rect)</span>
<span class="line-removed"> 449         : Item(ItemType::Clip)</span>
<span class="line-removed"> 450         , m_rect(rect)</span>
<span class="line-removed"> 451     {</span>
<span class="line-removed"> 452     }</span>
 453 
 454     void apply(GraphicsContext&amp;) const override;
 455 
 456     FloatRect m_rect;
 457 };
 458 
<a name="61" id="anc61"></a>
















 459 class ClipOut : public Item {
 460 public:
 461     static Ref&lt;ClipOut&gt; create(const FloatRect&amp; rect)
 462     {
 463         return adoptRef(*new ClipOut(rect));
 464     }
 465 
<a name="62" id="anc62"></a>

 466     FloatRect rect() const { return m_rect; }
 467 
<a name="63" id="anc63"></a>


 468 private:
<a name="64" id="anc64"></a><span class="line-modified"> 469     ClipOut(const FloatRect&amp; rect)</span>
<span class="line-removed"> 470         : Item(ItemType::ClipOut)</span>
<span class="line-removed"> 471         , m_rect(rect)</span>
<span class="line-removed"> 472     {</span>
<span class="line-removed"> 473     }</span>
 474 
 475     void apply(GraphicsContext&amp;) const override;
 476 
 477     FloatRect m_rect;
 478 };
 479 
<a name="65" id="anc65"></a>
















 480 class ClipOutToPath : public Item {
 481 public:
 482     static Ref&lt;ClipOutToPath&gt; create(const Path&amp; path)
 483     {
 484         return adoptRef(*new ClipOutToPath(path));
 485     }
 486 
<a name="66" id="anc66"></a>

 487     const Path&amp; path() const { return m_path; }
 488 
<a name="67" id="anc67"></a>


 489 private:
<a name="68" id="anc68"></a><span class="line-modified"> 490     ClipOutToPath(const Path&amp; path)</span>
<span class="line-removed"> 491         : Item(ItemType::ClipOutToPath)</span>
<span class="line-removed"> 492         , m_path(path)</span>
<span class="line-removed"> 493     {</span>
<span class="line-removed"> 494     }</span>
 495 
 496     void apply(GraphicsContext&amp;) const override;
 497 
 498     const Path m_path;
 499 };
 500 
<a name="69" id="anc69"></a>
















 501 class ClipPath : public Item {
 502 public:
 503     static Ref&lt;ClipPath&gt; create(const Path&amp; path, WindRule windRule)
 504     {
 505         return adoptRef(*new ClipPath(path, windRule));
 506     }
 507 
<a name="70" id="anc70"></a>

 508     const Path&amp; path() const { return m_path; }
 509     WindRule windRule() const { return m_windRule; }
 510 
<a name="71" id="anc71"></a>


 511 private:
<a name="72" id="anc72"></a><span class="line-modified"> 512     ClipPath(const Path&amp; path, WindRule windRule)</span>
<span class="line-removed"> 513         : Item(ItemType::ClipPath)</span>
<span class="line-removed"> 514         , m_path(path)</span>
<span class="line-removed"> 515         , m_windRule(windRule)</span>
<span class="line-removed"> 516     {</span>
<span class="line-removed"> 517     }</span>
 518 
 519     void apply(GraphicsContext&amp;) const override;
 520 
 521     const Path m_path;
 522     WindRule m_windRule;
 523 };
 524 
<a name="73" id="anc73"></a>






















 525 class DrawGlyphs : public DrawingItem {
 526 public:
 527     static Ref&lt;DrawGlyphs&gt; create(const Font&amp; font, const GlyphBufferGlyph* glyphs, const GlyphBufferAdvance* advances, unsigned count, const FloatPoint&amp; blockLocation, const FloatSize&amp; localAnchor, FontSmoothingMode smoothingMode)
 528     {
 529         return adoptRef(*new DrawGlyphs(font, glyphs, advances, count, blockLocation, localAnchor, smoothingMode));
 530     }
 531 
<a name="74" id="anc74"></a>






 532     const FloatPoint&amp; blockLocation() const { return m_blockLocation; }
 533     void setBlockLocation(const FloatPoint&amp; blockLocation) { m_blockLocation = blockLocation; }
 534 
 535     const FloatSize&amp; localAnchor() const { return m_localAnchor; }
 536 
 537     FloatPoint anchorPoint() const { return m_blockLocation + m_localAnchor; }
 538 
 539     const Vector&lt;GlyphBufferGlyph, 128&gt;&amp; glyphs() const { return m_glyphs; }
 540 
<a name="75" id="anc75"></a>


 541 private:
 542     DrawGlyphs(const Font&amp;, const GlyphBufferGlyph*, const GlyphBufferAdvance*, unsigned count, const FloatPoint&amp; blockLocation, const FloatSize&amp; localAnchor, FontSmoothingMode);
<a name="76" id="anc76"></a>
 543 
 544     void computeBounds();
 545 
 546     void apply(GraphicsContext&amp;) const override;
 547 
 548     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override;
 549 
 550     GlyphBuffer generateGlyphBuffer() const;
 551 
 552     Ref&lt;Font&gt; m_font;
 553     Vector&lt;GlyphBufferGlyph, 128&gt; m_glyphs;
 554     Vector&lt;GlyphBufferAdvance, 128&gt; m_advances;
 555     FloatRect m_bounds;
 556     FloatPoint m_blockLocation;
 557     FloatSize m_localAnchor;
 558     FontSmoothingMode m_smoothingMode;
 559 };
 560 
<a name="77" id="anc77"></a>



















































 561 class DrawImage : public DrawingItem {
 562 public:
 563     static Ref&lt;DrawImage&gt; create(Image&amp; image, const FloatRect&amp; destination, const FloatRect&amp; source, const ImagePaintingOptions&amp; imagePaintingOptions)
 564     {
 565         return adoptRef(*new DrawImage(image, destination, source, imagePaintingOptions));
 566     }
 567 
<a name="78" id="anc78"></a>

 568     const Image&amp; image() const { return m_image.get(); }
 569     FloatRect source() const { return m_source; }
 570     FloatRect destination() const { return m_destination; }
 571 
<a name="79" id="anc79"></a>


 572 private:
<a name="80" id="anc80"></a><span class="line-modified"> 573     DrawImage(Image&amp;, const FloatRect&amp; destination, const FloatRect&amp; source, const ImagePaintingOptions&amp;);</span>
 574 
 575     void apply(GraphicsContext&amp;) const override;
 576 
 577     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_destination; }
 578 
 579     mutable Ref&lt;Image&gt; m_image; // FIXME: Drawing images can cause their animations to progress. This shouldn&#39;t have to be mutable.
 580     FloatRect m_destination;
 581     FloatRect m_source;
 582     ImagePaintingOptions m_imagePaintingOptions;
 583 };
 584 
<a name="81" id="anc81"></a>





































 585 class DrawTiledImage : public DrawingItem {
 586 public:
 587     static Ref&lt;DrawTiledImage&gt; create(Image&amp; image, const FloatRect&amp; destination, const FloatPoint&amp; source, const FloatSize&amp; tileSize, const FloatSize&amp; spacing, const ImagePaintingOptions&amp; imagePaintingOptions)
 588     {
 589         return adoptRef(*new DrawTiledImage(image, destination, source, tileSize, spacing, imagePaintingOptions));
 590     }
 591 
<a name="82" id="anc82"></a>

 592     const Image&amp; image() const { return m_image.get(); }
 593     FloatPoint source() const { return m_source; }
 594     FloatRect destination() const { return m_destination; }
 595 
 596     FloatSize tileSize() const { return m_tileSize; }
 597     FloatSize spacing() const { return m_spacing; }
 598 
<a name="83" id="anc83"></a>


 599 private:
<a name="84" id="anc84"></a><span class="line-modified"> 600     DrawTiledImage(Image&amp;, const FloatRect&amp; destination, const FloatPoint&amp; source, const FloatSize&amp; tileSize, const FloatSize&amp; spacing, const ImagePaintingOptions&amp;);</span>
 601 
 602     void apply(GraphicsContext&amp;) const override;
 603 
 604     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_destination; }
 605 
 606     mutable Ref&lt;Image&gt; m_image; // FIXME: Drawing images can cause their animations to progress. This shouldn&#39;t have to be mutable.
 607     FloatRect m_destination;
 608     FloatPoint m_source;
 609     FloatSize m_tileSize;
 610     FloatSize m_spacing;
 611     ImagePaintingOptions m_imagePaintingOptions;
 612 };
 613 
<a name="85" id="anc85"></a>
















































 614 class DrawTiledScaledImage : public DrawingItem {
 615 public:
 616     static Ref&lt;DrawTiledScaledImage&gt; create(Image&amp; image, const FloatRect&amp; destination, const FloatRect&amp; source, const FloatSize&amp; tileScaleFactor, Image::TileRule hRule, Image::TileRule vRule, const ImagePaintingOptions&amp; imagePaintingOptions)
 617     {
 618         return adoptRef(*new DrawTiledScaledImage(image, destination, source, tileScaleFactor, hRule, vRule, imagePaintingOptions));
 619     }
 620 
<a name="86" id="anc86"></a>

 621     const Image&amp; image() const { return m_image.get(); }
 622     FloatRect source() const { return m_source; }
 623     FloatRect destination() const { return m_destination; }
 624 
<a name="87" id="anc87"></a>


 625 private:
<a name="88" id="anc88"></a><span class="line-modified"> 626     DrawTiledScaledImage(Image&amp;, const FloatRect&amp; destination, const FloatRect&amp; source, const FloatSize&amp; tileScaleFactor, Image::TileRule hRule, Image::TileRule vRule, const ImagePaintingOptions&amp;);</span>
 627 
 628     void apply(GraphicsContext&amp;) const override;
 629 
 630     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_destination; }
 631 
 632     mutable Ref&lt;Image&gt; m_image; // FIXME: Drawing images can cause their animations to progress. This shouldn&#39;t have to be mutable.
 633     FloatRect m_destination;
 634     FloatRect m_source;
 635     FloatSize m_tileScaleFactor;
 636     Image::TileRule m_hRule;
 637     Image::TileRule m_vRule;
 638     ImagePaintingOptions m_imagePaintingOptions;
 639 };
 640 
<a name="89" id="anc89"></a>




















































 641 #if USE(CG) || USE(CAIRO) || USE(DIRECT2D)
 642 class DrawNativeImage : public DrawingItem {
 643 public:
 644     static Ref&lt;DrawNativeImage&gt; create(const NativeImagePtr&amp; image, const FloatSize&amp; imageSize, const FloatRect&amp; destRect, const FloatRect&amp; srcRect, const ImagePaintingOptions&amp; options)
 645     {
 646         return adoptRef(*new DrawNativeImage(image, imageSize, destRect, srcRect, options));
 647     }
 648 
<a name="90" id="anc90"></a>

 649     FloatRect source() const { return m_srcRect; }
<a name="91" id="anc91"></a><span class="line-modified"> 650     FloatRect destination() const { return m_destination; }</span>



 651 
 652 private:
<a name="92" id="anc92"></a><span class="line-modified"> 653     DrawNativeImage(const NativeImagePtr&amp;, const FloatSize&amp; selfSize, const FloatRect&amp; destRect, const FloatRect&amp; srcRect, const ImagePaintingOptions&amp;);</span>
 654 
 655     void apply(GraphicsContext&amp;) const override;
 656 
<a name="93" id="anc93"></a><span class="line-modified"> 657     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_destination; }</span>
 658 
 659 #if USE(CG)
<a name="94" id="anc94"></a><span class="line-modified"> 660     RetainPtr&lt;CGImageRef&gt; m_image;</span>
 661 #endif
 662     FloatSize m_imageSize;
<a name="95" id="anc95"></a><span class="line-modified"> 663     FloatRect m_destination;</span>
 664     FloatRect m_srcRect;
 665     ImagePaintingOptions m_options;
 666 };
<a name="96" id="anc96"></a>


















































 667 #endif
 668 
 669 class DrawPattern : public DrawingItem {
 670 public:
 671     static Ref&lt;DrawPattern&gt; create(Image&amp; image, const FloatRect&amp; destRect, const FloatRect&amp; tileRect, const AffineTransform&amp; patternTransform, const FloatPoint&amp; phase, const FloatSize&amp; spacing, const ImagePaintingOptions&amp; options)
 672     {
 673         return adoptRef(*new DrawPattern(image, destRect, tileRect, patternTransform, phase, spacing, options));
 674     }
 675 
<a name="97" id="anc97"></a>

 676     const Image&amp; image() const { return m_image.get(); }
 677     const AffineTransform&amp; patternTransform() const { return m_patternTransform; }
 678     FloatRect tileRect() const { return m_tileRect; }
 679     FloatRect destRect() const { return m_destination; }
 680     FloatPoint phase() const { return m_phase; }
 681     FloatSize spacing() const { return m_spacing; }
 682 
<a name="98" id="anc98"></a>


 683 private:
<a name="99" id="anc99"></a><span class="line-modified"> 684     DrawPattern(Image&amp;, const FloatRect&amp; destRect, const FloatRect&amp; srcRect, const AffineTransform&amp;, const FloatPoint&amp; phase, const FloatSize&amp; spacing, const ImagePaintingOptions&amp; = { });</span>
 685 
 686     void apply(GraphicsContext&amp;) const override;
 687 
 688     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_destination; }
 689 
 690     mutable Ref&lt;Image&gt; m_image; // FIXME: Drawing images can cause their animations to progress. This shouldn&#39;t have to be mutable.
 691     AffineTransform m_patternTransform;
 692     FloatRect m_tileRect;
 693     FloatRect m_destination;
 694     FloatPoint m_phase;
 695     FloatSize m_spacing;
 696     ImagePaintingOptions m_options;
 697 };
 698 
<a name="100" id="anc100"></a>






















































 699 // Is DrawingItem because the size of the transparency layer is implicitly the clip bounds.
 700 class BeginTransparencyLayer : public DrawingItem {
 701 public:
 702     static Ref&lt;BeginTransparencyLayer&gt; create(float opacity)
 703     {
 704         return adoptRef(*new BeginTransparencyLayer(opacity));
 705     }
 706 
<a name="101" id="anc101"></a>

 707     float opacity() const { return m_opacity; }
 708 
<a name="102" id="anc102"></a>


 709 private:
<a name="103" id="anc103"></a><span class="line-modified"> 710     BeginTransparencyLayer(float opacity)</span>
<span class="line-removed"> 711         : DrawingItem(ItemType::BeginTransparencyLayer)</span>
<span class="line-removed"> 712         , m_opacity(opacity)</span>
<span class="line-removed"> 713     {</span>
<span class="line-removed"> 714     }</span>
 715 
 716     void apply(GraphicsContext&amp;) const override;
 717 
 718     float m_opacity;
 719 };
 720 
<a name="104" id="anc104"></a>
















 721 class EndTransparencyLayer : public DrawingItem {
 722 public:
 723     static Ref&lt;EndTransparencyLayer&gt; create()
 724     {
 725         return adoptRef(*new EndTransparencyLayer);
 726     }
 727 
<a name="105" id="anc105"></a>




 728 private:
<a name="106" id="anc106"></a><span class="line-modified"> 729     EndTransparencyLayer()</span>
<span class="line-removed"> 730         : DrawingItem(ItemType::EndTransparencyLayer)</span>
<span class="line-removed"> 731     {</span>
<span class="line-removed"> 732     }</span>
 733 
 734     void apply(GraphicsContext&amp;) const override;
 735 };
 736 
<a name="107" id="anc107"></a>










 737 class DrawRect : public DrawingItem {
 738 public:
 739     static Ref&lt;DrawRect&gt; create(const FloatRect&amp; rect, float borderThickness)
 740     {
 741         return adoptRef(*new DrawRect(rect, borderThickness));
 742     }
 743 
<a name="108" id="anc108"></a>

 744     FloatRect rect() const { return m_rect; }
 745     float borderThickness() const { return m_borderThickness; }
 746 
<a name="109" id="anc109"></a>


 747 private:
<a name="110" id="anc110"></a><span class="line-modified"> 748     DrawRect(const FloatRect&amp; rect, float borderThickness)</span>
<span class="line-removed"> 749         : DrawingItem(ItemType::DrawRect)</span>
<span class="line-removed"> 750         , m_rect(rect)</span>
<span class="line-removed"> 751         , m_borderThickness(borderThickness)</span>
<span class="line-removed"> 752     {</span>
<span class="line-removed"> 753     }</span>
 754 
 755     void apply(GraphicsContext&amp;) const override;
 756     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_rect; }
 757 
 758     FloatRect m_rect;
 759     float m_borderThickness;
 760 };
 761 
<a name="111" id="anc111"></a>






















 762 class DrawLine : public DrawingItem {
 763 public:
 764     static Ref&lt;DrawLine&gt; create(const FloatPoint&amp; point1, const FloatPoint&amp; point2)
 765     {
 766         return adoptRef(*new DrawLine(point1, point2));
 767     }
 768 
<a name="112" id="anc112"></a>

 769     FloatPoint point1() const { return m_point1; }
 770     FloatPoint point2() const { return m_point2; }
 771 
<a name="113" id="anc113"></a>


 772 private:
<a name="114" id="anc114"></a><span class="line-modified"> 773     DrawLine(const FloatPoint&amp; point1, const FloatPoint&amp; point2)</span>
<span class="line-removed"> 774         : DrawingItem(ItemType::DrawLine)</span>
<span class="line-removed"> 775         , m_point1(point1)</span>
<span class="line-removed"> 776         , m_point2(point2)</span>
<span class="line-removed"> 777     {</span>
<span class="line-removed"> 778     }</span>
 779 
 780     void apply(GraphicsContext&amp;) const override;
 781     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override;
 782 
 783     FloatPoint m_point1;
 784     FloatPoint m_point2;
 785 };
 786 
<a name="115" id="anc115"></a>






















 787 class DrawLinesForText : public DrawingItem {
 788 public:
 789     static Ref&lt;DrawLinesForText&gt; create(const FloatPoint&amp; blockLocation, const FloatSize&amp; localAnchor, float thickness, const DashArray&amp; widths, bool printing, bool doubleLines)
 790     {
 791         return adoptRef(*new DrawLinesForText(blockLocation, localAnchor, thickness, widths, printing, doubleLines));
 792     }
 793 
<a name="116" id="anc116"></a>

 794     void setBlockLocation(const FloatPoint&amp; blockLocation) { m_blockLocation = blockLocation; }
 795     const FloatPoint&amp; blockLocation() const { return m_blockLocation; }
 796     const FloatSize&amp; localAnchor() const { return m_localAnchor; }
 797     FloatPoint point() const { return m_blockLocation + m_localAnchor; }
 798     float thickness() const { return m_thickness; }
 799     const DashArray&amp; widths() const { return m_widths; }
 800     bool isPrinting() const { return m_printing; }
 801     bool doubleLines() const { return m_doubleLines; }
 802 
<a name="117" id="anc117"></a>


 803 private:
<a name="118" id="anc118"></a><span class="line-modified"> 804     DrawLinesForText(const FloatPoint&amp; blockLocation, const FloatSize&amp; localAnchor, float thickness, const DashArray&amp; widths, bool printing, bool doubleLines)</span>
<span class="line-removed"> 805         : DrawingItem(ItemType::DrawLinesForText)</span>
<span class="line-removed"> 806         , m_blockLocation(blockLocation)</span>
<span class="line-removed"> 807         , m_localAnchor(localAnchor)</span>
<span class="line-removed"> 808         , m_widths(widths)</span>
<span class="line-removed"> 809         , m_thickness(thickness)</span>
<span class="line-removed"> 810         , m_printing(printing)</span>
<span class="line-removed"> 811         , m_doubleLines(doubleLines)</span>
<span class="line-removed"> 812     {</span>
<span class="line-removed"> 813     }</span>
 814 
 815     void apply(GraphicsContext&amp;) const override;
 816 
 817     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override;
 818 
 819     FloatPoint m_blockLocation;
 820     FloatSize m_localAnchor;
 821     DashArray m_widths;
 822     float m_thickness;
 823     bool m_printing;
 824     bool m_doubleLines;
 825 };
 826 
<a name="119" id="anc119"></a>














































 827 class DrawDotsForDocumentMarker : public DrawingItem {
 828 public:
 829     static Ref&lt;DrawDotsForDocumentMarker&gt; create(const FloatRect&amp; rect, DocumentMarkerLineStyle style)
 830     {
 831         return adoptRef(*new DrawDotsForDocumentMarker(rect, style));
 832     }
 833 
<a name="120" id="anc120"></a>

 834     FloatRect rect() const { return m_rect; }
 835 
<a name="121" id="anc121"></a>


 836 private:
<a name="122" id="anc122"></a><span class="line-modified"> 837     DrawDotsForDocumentMarker(const FloatRect&amp; rect, DocumentMarkerLineStyle style)</span>
<span class="line-removed"> 838         : DrawingItem(ItemType::DrawDotsForDocumentMarker)</span>
<span class="line-removed"> 839         , m_rect(rect)</span>
<span class="line-removed"> 840         , m_style(style)</span>
<span class="line-removed"> 841     {</span>
<span class="line-removed"> 842     }</span>
 843 
 844     void apply(GraphicsContext&amp;) const override;
 845 
 846     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override;
 847 
 848     FloatRect m_rect;
 849     DocumentMarkerLineStyle m_style;
 850 };
 851 
<a name="123" id="anc123"></a>






















 852 class DrawEllipse : public DrawingItem {
 853 public:
 854     static Ref&lt;DrawEllipse&gt; create(const FloatRect&amp; rect)
 855     {
 856         return adoptRef(*new DrawEllipse(rect));
 857     }
 858 
<a name="124" id="anc124"></a>

 859     FloatRect rect() const { return m_rect; }
 860 
<a name="125" id="anc125"></a>


 861 private:
<a name="126" id="anc126"></a><span class="line-modified"> 862     DrawEllipse(const FloatRect&amp; rect)</span>
<span class="line-removed"> 863         : DrawingItem(ItemType::DrawEllipse)</span>
<span class="line-removed"> 864         , m_rect(rect)</span>
<span class="line-removed"> 865     {</span>
<span class="line-removed"> 866     }</span>
 867 
 868     void apply(GraphicsContext&amp;) const override;
 869     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_rect; }
 870 
 871     FloatRect m_rect;
 872 };
 873 
<a name="127" id="anc127"></a>
















 874 class DrawPath : public DrawingItem {
 875 public:
 876     static Ref&lt;DrawPath&gt; create(const Path&amp; path)
 877     {
 878         return adoptRef(*new DrawPath(path));
 879     }
 880 
<a name="128" id="anc128"></a>

 881     const Path&amp; path() const { return m_path; }
 882 
<a name="129" id="anc129"></a>


 883 private:
<a name="130" id="anc130"></a><span class="line-modified"> 884     DrawPath(const Path&amp; path)</span>
<span class="line-removed"> 885         : DrawingItem(ItemType::DrawPath)</span>
<span class="line-removed"> 886         , m_path(path)</span>
<span class="line-removed"> 887     {</span>
<span class="line-removed"> 888     }</span>
 889 
 890     void apply(GraphicsContext&amp;) const override;
 891 
 892     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_path.fastBoundingRect(); }
 893 
 894     const Path m_path;
 895 };
 896 
<a name="131" id="anc131"></a>
















 897 class DrawFocusRingPath : public DrawingItem {
 898 public:
 899     static Ref&lt;DrawFocusRingPath&gt; create(const Path&amp; path, float width, float offset, const Color&amp; color)
 900     {
 901         return adoptRef(*new DrawFocusRingPath(path, width, offset, color));
 902     }
 903 
<a name="132" id="anc132"></a>

 904     const Path&amp; path() const { return m_path; }
 905     float width() const { return m_width; }
 906     float offset() const { return m_offset; }
 907     const Color&amp; color() const { return m_color; }
 908 
<a name="133" id="anc133"></a>


 909 private:
<a name="134" id="anc134"></a><span class="line-modified"> 910     DrawFocusRingPath(const Path&amp; path, float width, float offset, const Color&amp; color)</span>
<span class="line-removed"> 911         : DrawingItem(ItemType::DrawFocusRingPath)</span>
<span class="line-removed"> 912         , m_path(path)</span>
<span class="line-removed"> 913         , m_width(width)</span>
<span class="line-removed"> 914         , m_offset(offset)</span>
<span class="line-removed"> 915         , m_color(color)</span>
<span class="line-removed"> 916     {</span>
<span class="line-removed"> 917     }</span>
 918 
 919     void apply(GraphicsContext&amp;) const override;
 920 
 921     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override;
 922 
 923     const Path m_path;
 924     float m_width;
 925     float m_offset;
 926     Color m_color;
 927 };
 928 
<a name="135" id="anc135"></a>


































 929 class DrawFocusRingRects : public DrawingItem {
 930 public:
 931     static Ref&lt;DrawFocusRingRects&gt; create(const Vector&lt;FloatRect&gt;&amp; rects, float width, float offset, const Color&amp; color)
 932     {
 933         return adoptRef(*new DrawFocusRingRects(rects, width, offset, color));
 934     }
 935 
<a name="136" id="anc136"></a>

 936     const Vector&lt;FloatRect&gt; rects() const { return m_rects; }
 937     float width() const { return m_width; }
 938     float offset() const { return m_offset; }
 939     const Color&amp; color() const { return m_color; }
 940 
<a name="137" id="anc137"></a>


 941 private:
<a name="138" id="anc138"></a><span class="line-modified"> 942     DrawFocusRingRects(const Vector&lt;FloatRect&gt;&amp; rects, float width, float offset, const Color&amp; color)</span>
<span class="line-removed"> 943         : DrawingItem(ItemType::DrawFocusRingRects)</span>
<span class="line-removed"> 944         , m_rects(rects)</span>
<span class="line-removed"> 945         , m_width(width)</span>
<span class="line-removed"> 946         , m_offset(offset)</span>
<span class="line-removed"> 947         , m_color(color)</span>
<span class="line-removed"> 948     {</span>
<span class="line-removed"> 949     }</span>
 950 
 951     void apply(GraphicsContext&amp;) const override;
 952 
 953     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override;
 954 
 955     Vector&lt;FloatRect&gt; m_rects;
 956     float m_width;
 957     float m_offset;
 958     Color m_color;
 959 };
 960 
<a name="139" id="anc139"></a>


































 961 class FillRect : public DrawingItem {
 962 public:
 963     static Ref&lt;FillRect&gt; create(const FloatRect&amp; rect)
 964     {
 965         return adoptRef(*new FillRect(rect));
 966     }
 967 
<a name="140" id="anc140"></a>

 968     FloatRect rect() const { return m_rect; }
 969 
<a name="141" id="anc141"></a>


 970 private:
<a name="142" id="anc142"></a><span class="line-modified"> 971     FillRect(const FloatRect&amp; rect)</span>
<span class="line-removed"> 972         : DrawingItem(ItemType::FillRect)</span>
<span class="line-removed"> 973         , m_rect(rect)</span>
<span class="line-removed"> 974     {</span>
<span class="line-removed"> 975     }</span>
 976 
 977     void apply(GraphicsContext&amp;) const override;
 978     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_rect; }
 979 
 980     FloatRect m_rect;
 981 };
 982 
<a name="143" id="anc143"></a>
















 983 // FIXME: Make these inherit from FillRect proper.
 984 class FillRectWithColor : public DrawingItem {
 985 public:
 986     static Ref&lt;FillRectWithColor&gt; create(const FloatRect&amp; rect, const Color&amp; color)
 987     {
 988         return adoptRef(*new FillRectWithColor(rect, color));
 989     }
 990 
<a name="144" id="anc144"></a>

 991     FloatRect rect() const { return m_rect; }
 992     const Color&amp; color() const { return m_color; }
 993 
<a name="145" id="anc145"></a>


 994 private:
<a name="146" id="anc146"></a><span class="line-modified"> 995     FillRectWithColor(const FloatRect&amp; rect, const Color&amp; color)</span>
<span class="line-removed"> 996         : DrawingItem(ItemType::FillRectWithColor)</span>
<span class="line-removed"> 997         , m_rect(rect)</span>
<span class="line-removed"> 998         , m_color(color)</span>
<span class="line-removed"> 999     {</span>
<span class="line-removed">1000     }</span>
1001 
1002     void apply(GraphicsContext&amp;) const override;
1003     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_rect; }
1004 
1005     FloatRect m_rect;
1006     Color m_color;
1007 };
1008 
<a name="147" id="anc147"></a>






















1009 class FillRectWithGradient : public DrawingItem {
1010 public:
1011     static Ref&lt;FillRectWithGradient&gt; create(const FloatRect&amp; rect, Gradient&amp; gradient)
1012     {
1013         return adoptRef(*new FillRectWithGradient(rect, gradient));
1014     }
1015 
<a name="148" id="anc148"></a>

1016     FloatRect rect() const { return m_rect; }
1017 
<a name="149" id="anc149"></a>


1018 private:
<a name="150" id="anc150"></a><span class="line-modified">1019     FillRectWithGradient(const FloatRect&amp; rect, Gradient&amp; gradient)</span>
<span class="line-removed">1020         : DrawingItem(ItemType::FillRectWithGradient)</span>
<span class="line-removed">1021         , m_rect(rect)</span>
<span class="line-removed">1022         , m_gradient(gradient)</span>
<span class="line-removed">1023     {</span>
<span class="line-removed">1024     }</span>
1025 
1026     void apply(GraphicsContext&amp;) const override;
1027     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_rect; }
1028 
1029     FloatRect m_rect;
1030     mutable Ref&lt;Gradient&gt; m_gradient; // FIXME: Make this not mutable
1031 };
1032 
<a name="151" id="anc151"></a>





















1033 class FillCompositedRect : public DrawingItem {
1034 public:
1035     static Ref&lt;FillCompositedRect&gt; create(const FloatRect&amp; rect, const Color&amp; color, CompositeOperator op, BlendMode blendMode)
1036     {
1037         return adoptRef(*new FillCompositedRect(rect, color, op, blendMode));
1038     }
1039 
<a name="152" id="anc152"></a>

1040     FloatRect rect() const { return m_rect; }
1041     const Color&amp; color() const { return m_color; }
1042     CompositeOperator compositeOperator() const { return m_op; }
1043     BlendMode blendMode() const { return m_blendMode; }
1044 
<a name="153" id="anc153"></a>


1045 private:
<a name="154" id="anc154"></a><span class="line-modified">1046     FillCompositedRect(const FloatRect&amp; rect, const Color&amp; color, CompositeOperator op, BlendMode blendMode)</span>
<span class="line-removed">1047         : DrawingItem(ItemType::FillCompositedRect)</span>
<span class="line-removed">1048         , m_rect(rect)</span>
<span class="line-removed">1049         , m_color(color)</span>
<span class="line-removed">1050         , m_op(op)</span>
<span class="line-removed">1051         , m_blendMode(blendMode)</span>
<span class="line-removed">1052     {</span>
<span class="line-removed">1053     }</span>
1054 
1055     void apply(GraphicsContext&amp;) const override;
1056     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_rect; }
1057 
1058     FloatRect m_rect;
1059     Color m_color;
1060     CompositeOperator m_op;
1061     BlendMode m_blendMode;
1062 };
1063 
<a name="155" id="anc155"></a>


































1064 class FillRoundedRect : public DrawingItem {
1065 public:
1066     static Ref&lt;FillRoundedRect&gt; create(const FloatRoundedRect&amp; rect, const Color&amp; color, BlendMode blendMode)
1067     {
1068         return adoptRef(*new FillRoundedRect(rect, color, blendMode));
1069     }
1070 
<a name="156" id="anc156"></a>

1071     const FloatRoundedRect&amp; roundedRect() const { return m_rect; }
1072     const Color&amp; color() const { return m_color; }
1073     BlendMode blendMode() const { return m_blendMode; }
1074 
<a name="157" id="anc157"></a>


1075 private:
<a name="158" id="anc158"></a><span class="line-modified">1076     FillRoundedRect(const FloatRoundedRect&amp; rect, const Color&amp; color, BlendMode blendMode)</span>
<span class="line-removed">1077         : DrawingItem(ItemType::FillRoundedRect)</span>
<span class="line-removed">1078         , m_rect(rect)</span>
<span class="line-removed">1079         , m_color(color)</span>
<span class="line-removed">1080         , m_blendMode(blendMode)</span>
<span class="line-removed">1081     {</span>
<span class="line-removed">1082     }</span>
1083 
1084     void apply(GraphicsContext&amp;) const override;
1085     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_rect.rect(); }
1086 
1087     FloatRoundedRect m_rect;
1088     Color m_color;
1089     BlendMode m_blendMode;
1090 };
1091 
<a name="159" id="anc159"></a>




























1092 class FillRectWithRoundedHole : public DrawingItem {
1093 public:
1094     static Ref&lt;FillRectWithRoundedHole&gt; create(const FloatRect&amp; rect, const FloatRoundedRect&amp; roundedHoleRect, const Color&amp; color)
1095     {
1096         return adoptRef(*new FillRectWithRoundedHole(rect, roundedHoleRect, color));
1097     }
1098 
<a name="160" id="anc160"></a>

1099     const FloatRect&amp; rect() const { return m_rect; }
1100     const FloatRoundedRect&amp; roundedHoleRect() const { return m_roundedHoleRect; }
1101     const Color&amp; color() const { return m_color; }
1102 
<a name="161" id="anc161"></a>


1103 private:
<a name="162" id="anc162"></a><span class="line-modified">1104     FillRectWithRoundedHole(const FloatRect&amp; rect, const FloatRoundedRect&amp; roundedHoleRect, const Color&amp; color)</span>
<span class="line-removed">1105         : DrawingItem(ItemType::FillRectWithRoundedHole)</span>
<span class="line-removed">1106         , m_rect(rect)</span>
<span class="line-removed">1107         , m_roundedHoleRect(roundedHoleRect)</span>
<span class="line-removed">1108         , m_color(color)</span>
<span class="line-removed">1109     {</span>
<span class="line-removed">1110     }</span>
1111 
1112     void apply(GraphicsContext&amp;) const override;
1113     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_rect; }
1114 
1115     FloatRect m_rect;
1116     FloatRoundedRect m_roundedHoleRect;
1117     Color m_color;
1118 };
1119 
<a name="163" id="anc163"></a>




























1120 class FillPath : public DrawingItem {
1121 public:
1122     static Ref&lt;FillPath&gt; create(const Path&amp; path)
1123     {
1124         return adoptRef(*new FillPath(path));
1125     }
1126 
<a name="164" id="anc164"></a>

1127     const Path&amp; path() const { return m_path; }
1128 
<a name="165" id="anc165"></a>


1129 private:
<a name="166" id="anc166"></a><span class="line-modified">1130     FillPath(const Path&amp; path)</span>
<span class="line-removed">1131         : DrawingItem(ItemType::FillPath)</span>
<span class="line-removed">1132         , m_path(path)</span>
<span class="line-removed">1133     {</span>
<span class="line-removed">1134     }</span>
1135 
1136     void apply(GraphicsContext&amp;) const override;
1137     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_path.fastBoundingRect(); }
1138 
1139     const Path m_path;
1140 };
1141 
<a name="167" id="anc167"></a>
















1142 class FillEllipse : public DrawingItem {
1143 public:
1144     static Ref&lt;FillEllipse&gt; create(const FloatRect&amp; rect)
1145     {
1146         return adoptRef(*new FillEllipse(rect));
1147     }
1148 
<a name="168" id="anc168"></a>

1149     FloatRect rect() const { return m_rect; }
1150 
<a name="169" id="anc169"></a>


1151 private:
<a name="170" id="anc170"></a><span class="line-modified">1152     FillEllipse(const FloatRect&amp; rect)</span>
<span class="line-removed">1153         : DrawingItem(ItemType::FillEllipse)</span>
<span class="line-removed">1154         , m_rect(rect)</span>
<span class="line-removed">1155     {</span>
<span class="line-removed">1156     }</span>
1157 
1158     void apply(GraphicsContext&amp;) const override;
1159 
1160     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_rect; }
1161 
1162     FloatRect m_rect;
1163 };
1164 
<a name="171" id="anc171"></a>
















1165 class StrokeRect : public DrawingItem {
1166 public:
1167     static Ref&lt;StrokeRect&gt; create(const FloatRect&amp; rect, float lineWidth)
1168     {
1169         return adoptRef(*new StrokeRect(rect, lineWidth));
1170     }
1171 
<a name="172" id="anc172"></a>

1172     FloatRect rect() const { return m_rect; }
1173     float lineWidth() const { return m_lineWidth; }
1174 
<a name="173" id="anc173"></a>


1175 private:
<a name="174" id="anc174"></a><span class="line-modified">1176     StrokeRect(const FloatRect&amp; rect, float lineWidth)</span>
<span class="line-removed">1177         : DrawingItem(ItemType::StrokeRect)</span>
<span class="line-removed">1178         , m_rect(rect)</span>
<span class="line-removed">1179         , m_lineWidth(lineWidth)</span>
<span class="line-removed">1180     {</span>
<span class="line-removed">1181     }</span>
1182 
1183     void apply(GraphicsContext&amp;) const override;
1184     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override;
1185 
1186     FloatRect m_rect;
1187     float m_lineWidth;
1188 };
1189 
<a name="175" id="anc175"></a>






















1190 class StrokePath : public DrawingItem {
1191 public:
1192     static Ref&lt;StrokePath&gt; create(const Path&amp; path)
1193     {
1194         return adoptRef(*new StrokePath(path));
1195     }
1196 
<a name="176" id="anc176"></a>

1197     const Path&amp; path() const { return m_path; }
1198 
<a name="177" id="anc177"></a>


1199 private:
<a name="178" id="anc178"></a><span class="line-modified">1200     StrokePath(const Path&amp; path)</span>
<span class="line-removed">1201         : DrawingItem(ItemType::StrokePath)</span>
<span class="line-removed">1202         , m_path(path)</span>
<span class="line-removed">1203     {</span>
<span class="line-removed">1204     }</span>
1205 
1206     void apply(GraphicsContext&amp;) const override;
1207     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override;
1208 
1209     const Path m_path;
<a name="179" id="anc179"></a><span class="line-removed">1210     FloatPoint m_blockLocation;</span>
1211 };
1212 
<a name="180" id="anc180"></a>
















1213 class StrokeEllipse : public DrawingItem {
1214 public:
1215     static Ref&lt;StrokeEllipse&gt; create(const FloatRect&amp; rect)
1216     {
1217         return adoptRef(*new StrokeEllipse(rect));
1218     }
1219 
<a name="181" id="anc181"></a>

1220     FloatRect rect() const { return m_rect; }
1221 
<a name="182" id="anc182"></a>


1222 private:
<a name="183" id="anc183"></a><span class="line-modified">1223     StrokeEllipse(const FloatRect&amp; rect)</span>
<span class="line-removed">1224         : DrawingItem(ItemType::StrokeEllipse)</span>
<span class="line-removed">1225         , m_rect(rect)</span>
<span class="line-removed">1226     {</span>
<span class="line-removed">1227     }</span>
1228 
1229     void apply(GraphicsContext&amp;) const override;
1230     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override;
1231 
1232     FloatRect m_rect;
1233 };
1234 
<a name="184" id="anc184"></a>
















1235 class ClearRect : public DrawingItem {
1236 public:
1237     static Ref&lt;ClearRect&gt; create(const FloatRect&amp; rect)
1238     {
1239         return adoptRef(*new ClearRect(rect));
1240     }
1241 
<a name="185" id="anc185"></a>

1242     FloatRect rect() const { return m_rect; }
1243 
<a name="186" id="anc186"></a>


1244 private:
<a name="187" id="anc187"></a><span class="line-modified">1245     ClearRect(const FloatRect&amp; rect)</span>
<span class="line-removed">1246         : DrawingItem(ItemType::ClearRect)</span>
<span class="line-removed">1247         , m_rect(rect)</span>
<span class="line-removed">1248     {</span>
<span class="line-removed">1249     }</span>
1250 
1251     void apply(GraphicsContext&amp;) const override;
1252     Optional&lt;FloatRect&gt; localBounds(const GraphicsContext&amp;) const override { return m_rect; }
1253 
1254     FloatRect m_rect;
1255 };
1256 
<a name="188" id="anc188"></a>
















1257 #if USE(CG)
1258 class ApplyStrokePattern : public Item {
1259 public:
1260     static Ref&lt;ApplyStrokePattern&gt; create()
1261     {
1262         return adoptRef(*new ApplyStrokePattern);
1263     }
1264 
<a name="189" id="anc189"></a>




1265 private:
<a name="190" id="anc190"></a><span class="line-modified">1266     ApplyStrokePattern()</span>
<span class="line-removed">1267         : Item(ItemType::ApplyStrokePattern)</span>
<span class="line-removed">1268     {</span>
<span class="line-removed">1269     }</span>
1270 
1271     void apply(GraphicsContext&amp;) const override;
1272 };
1273 
<a name="191" id="anc191"></a>










1274 class ApplyFillPattern : public Item {
1275 public:
1276     static Ref&lt;ApplyFillPattern&gt; create()
1277     {
1278         return adoptRef(*new ApplyFillPattern);
1279     }
1280 
<a name="192" id="anc192"></a>




1281 private:
<a name="193" id="anc193"></a><span class="line-modified">1282     ApplyFillPattern()</span>
<span class="line-removed">1283         : Item(ItemType::ApplyFillPattern)</span>
<span class="line-removed">1284     {</span>
<span class="line-removed">1285     }</span>
1286 
1287     void apply(GraphicsContext&amp;) const override;
1288 };
<a name="194" id="anc194"></a>










1289 #endif
1290 
1291 class ApplyDeviceScaleFactor : public Item {
1292 public:
1293     static Ref&lt;ApplyDeviceScaleFactor&gt; create(float scaleFactor)
1294     {
1295         return adoptRef(*new ApplyDeviceScaleFactor(scaleFactor));
1296     }
1297 
<a name="195" id="anc195"></a>

1298     float scaleFactor() const { return m_scaleFactor; }
1299 
<a name="196" id="anc196"></a>


1300 private:
<a name="197" id="anc197"></a><span class="line-modified">1301     ApplyDeviceScaleFactor(float scaleFactor)</span>
<span class="line-removed">1302         : Item(ItemType::ApplyDeviceScaleFactor)</span>
<span class="line-removed">1303         , m_scaleFactor(scaleFactor)</span>
<span class="line-removed">1304     {</span>
<span class="line-removed">1305     }</span>
1306 
1307     void apply(GraphicsContext&amp;) const override;
1308 
1309     float m_scaleFactor;
1310 };
1311 
<a name="198" id="anc198"></a>

















1312 WTF::TextStream&amp; operator&lt;&lt;(WTF::TextStream&amp;, const Item&amp;);
1313 
<a name="199" id="anc199"></a>














































































































































































































































































































































































1314 } // namespace DisplayList
1315 } // namespace WebCore
1316 
1317 
1318 #define SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_DRAWINGITEM(ToValueTypeName, predicate) \
1319 SPECIALIZE_TYPE_TRAITS_BEGIN(WebCore::DisplayList::ToValueTypeName) \
1320     static bool isType(const WebCore::DisplayList::Item&amp; object) { return object.predicate; } \
1321 SPECIALIZE_TYPE_TRAITS_END()
1322 
1323 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_DRAWINGITEM(DrawingItem, isDrawingItem())
1324 
1325 #define SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(ToValueTypeName) \
1326 SPECIALIZE_TYPE_TRAITS_BEGIN(WebCore::DisplayList::ToValueTypeName) \
1327     static bool isType(const WebCore::DisplayList::Item&amp; item) { return item.type() == WebCore::DisplayList::ItemType::ToValueTypeName; } \
1328 SPECIALIZE_TYPE_TRAITS_END()
1329 
1330 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(Save)
1331 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(Restore)
1332 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(Translate)
1333 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(Rotate)
1334 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(Scale)
<a name="200" id="anc200"></a>
1335 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(ConcatenateCTM)
1336 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(SetState)
1337 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(SetLineCap)
1338 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(SetLineDash)
1339 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(SetLineJoin)
1340 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(SetMiterLimit)
1341 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(Clip)
1342 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(ClipOut)
1343 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(ClipOutToPath)
1344 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(ClipPath)
1345 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawGlyphs)
1346 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawImage)
1347 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawTiledImage)
1348 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawTiledScaledImage)
1349 #if USE(CG) || USE(CAIRO)
1350 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawNativeImage)
1351 #endif
1352 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawPattern)
1353 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawRect)
1354 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawLine)
1355 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawLinesForText)
1356 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawDotsForDocumentMarker)
1357 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawEllipse)
1358 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawPath)
1359 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawFocusRingPath)
1360 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(DrawFocusRingRects)
1361 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(FillRect)
1362 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(FillRectWithColor)
1363 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(FillRectWithGradient)
1364 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(FillCompositedRect)
1365 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(FillRoundedRect)
1366 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(FillRectWithRoundedHole)
1367 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(FillPath)
1368 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(FillEllipse)
1369 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(StrokeRect)
1370 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(StrokePath)
1371 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(StrokeEllipse)
1372 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(ClearRect)
1373 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(BeginTransparencyLayer)
1374 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(EndTransparencyLayer)
1375 #if USE(CG)
1376 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(ApplyStrokePattern)
1377 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(ApplyFillPattern)
1378 #endif
1379 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(ApplyDeviceScaleFactor)
1380 SPECIALIZE_TYPE_TRAITS_DISPLAYLIST_ITEM(ClearShadow)
1381 
<a name="201" id="anc201"></a>




























































<a name="202" id="anc202"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="202" type="hidden" />
</body>
</html>