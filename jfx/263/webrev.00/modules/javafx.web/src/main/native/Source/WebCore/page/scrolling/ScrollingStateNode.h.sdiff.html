<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/page/scrolling/ScrollingStateNode.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ScrollingMomentumCalculator.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="ScrollingStateScrollingNode.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/page/scrolling/ScrollingStateNode.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 77         : m_layerID(layerID)
 78         , m_representation(PlatformLayerIDRepresentation)
 79     {
 80     }
 81 
 82     LayerRepresentation(const LayerRepresentation&amp; other)
 83         : m_typelessPlatformLayer(other.m_typelessPlatformLayer)
 84         , m_layerID(other.m_layerID)
 85         , m_representation(other.m_representation)
 86     {
 87         if (m_representation == PlatformLayerRepresentation)
 88             retainPlatformLayer(m_typelessPlatformLayer);
 89     }
 90 
 91     ~LayerRepresentation()
 92     {
 93         if (m_representation == PlatformLayerRepresentation)
 94             releasePlatformLayer(m_typelessPlatformLayer);
 95     }
 96 
<span class="line-modified"> 97     operator GraphicsLayer*() const</span>
 98     {
 99         ASSERT(m_representation == GraphicsLayerRepresentation);
100         return m_graphicsLayer.get();
101     }
102 
<span class="line-modified">103     operator PlatformLayer*() const</span>
104     {
105         ASSERT(m_representation == PlatformLayerRepresentation);
106         return makePlatformLayerTyped(m_typelessPlatformLayer);
107     }
108 
109     GraphicsLayer::PlatformLayerID layerID() const
110     {
111         return m_layerID;
112     }
113 
<span class="line-modified">114     operator GraphicsLayer::PlatformLayerID() const</span>
115     {
116         ASSERT(m_representation != PlatformLayerRepresentation);
117         return m_layerID;
118     }
119 
120     LayerRepresentation&amp; operator=(const LayerRepresentation&amp; other)
121     {
122         m_graphicsLayer = other.m_graphicsLayer;
123         m_typelessPlatformLayer = other.m_typelessPlatformLayer;
124         m_layerID = other.m_layerID;
125         m_representation = other.m_representation;
126 
127         if (m_representation == PlatformLayerRepresentation)
128             retainPlatformLayer(m_typelessPlatformLayer);
129 
130         return *this;
131     }
132 
















133     bool operator==(const LayerRepresentation&amp; other) const
134     {
135         if (m_representation != other.m_representation)
136             return false;
137         switch (m_representation) {
138         case EmptyRepresentation:
139             return true;
140         case GraphicsLayerRepresentation:
141             return m_graphicsLayer == other.m_graphicsLayer
142                 &amp;&amp; m_layerID == other.m_layerID;
143         case PlatformLayerRepresentation:
144             return m_typelessPlatformLayer == other.m_typelessPlatformLayer;
145         case PlatformLayerIDRepresentation:
146             return m_layerID == other.m_layerID;
147         }
148         ASSERT_NOT_REACHED();
149         return true;
150     }
151 
152     LayerRepresentation toRepresentation(Type representation) const
153     {
154         switch (representation) {
155         case EmptyRepresentation:
156             return LayerRepresentation();
157         case GraphicsLayerRepresentation:
158             ASSERT(m_representation == GraphicsLayerRepresentation);
159             return LayerRepresentation(m_graphicsLayer.get());
160         case PlatformLayerRepresentation:
161             return m_graphicsLayer ? m_graphicsLayer-&gt;platformLayer() : nullptr;
162         case PlatformLayerIDRepresentation:
163             return LayerRepresentation(m_layerID);
164         }

165         return LayerRepresentation();
166     }
167 
168     bool representsGraphicsLayer() const { return m_representation == GraphicsLayerRepresentation; }
169     bool representsPlatformLayerID() const { return m_representation == PlatformLayerIDRepresentation; }
170 
171 private:
172     WEBCORE_EXPORT static void retainPlatformLayer(void* typelessPlatformLayer);
173     WEBCORE_EXPORT static void releasePlatformLayer(void* typelessPlatformLayer);
174     WEBCORE_EXPORT static PlatformLayer* makePlatformLayerTyped(void* typelessPlatformLayer);
175     WEBCORE_EXPORT static void* makePlatformLayerTypeless(PlatformLayer*);
176 
177     RefPtr&lt;GraphicsLayer&gt; m_graphicsLayer;
178     void* m_typelessPlatformLayer { nullptr };
179     GraphicsLayer::PlatformLayerID m_layerID { 0 };
180     Type m_representation { EmptyRepresentation };
181 };
182 
183 class ScrollingStateNode : public ThreadSafeRefCounted&lt;ScrollingStateNode&gt; {
184     WTF_MAKE_FAST_ALLOCATED;
</pre>
</td>
<td>
<hr />
<pre>
 77         : m_layerID(layerID)
 78         , m_representation(PlatformLayerIDRepresentation)
 79     {
 80     }
 81 
 82     LayerRepresentation(const LayerRepresentation&amp; other)
 83         : m_typelessPlatformLayer(other.m_typelessPlatformLayer)
 84         , m_layerID(other.m_layerID)
 85         , m_representation(other.m_representation)
 86     {
 87         if (m_representation == PlatformLayerRepresentation)
 88             retainPlatformLayer(m_typelessPlatformLayer);
 89     }
 90 
 91     ~LayerRepresentation()
 92     {
 93         if (m_representation == PlatformLayerRepresentation)
 94             releasePlatformLayer(m_typelessPlatformLayer);
 95     }
 96 
<span class="line-modified"> 97     explicit operator GraphicsLayer*() const</span>
 98     {
 99         ASSERT(m_representation == GraphicsLayerRepresentation);
100         return m_graphicsLayer.get();
101     }
102 
<span class="line-modified">103     explicit operator PlatformLayer*() const</span>
104     {
105         ASSERT(m_representation == PlatformLayerRepresentation);
106         return makePlatformLayerTyped(m_typelessPlatformLayer);
107     }
108 
109     GraphicsLayer::PlatformLayerID layerID() const
110     {
111         return m_layerID;
112     }
113 
<span class="line-modified">114     explicit operator GraphicsLayer::PlatformLayerID() const</span>
115     {
116         ASSERT(m_representation != PlatformLayerRepresentation);
117         return m_layerID;
118     }
119 
120     LayerRepresentation&amp; operator=(const LayerRepresentation&amp; other)
121     {
122         m_graphicsLayer = other.m_graphicsLayer;
123         m_typelessPlatformLayer = other.m_typelessPlatformLayer;
124         m_layerID = other.m_layerID;
125         m_representation = other.m_representation;
126 
127         if (m_representation == PlatformLayerRepresentation)
128             retainPlatformLayer(m_typelessPlatformLayer);
129 
130         return *this;
131     }
132 
<span class="line-added">133     explicit operator bool() const</span>
<span class="line-added">134     {</span>
<span class="line-added">135         switch (m_representation) {</span>
<span class="line-added">136         case EmptyRepresentation:</span>
<span class="line-added">137             return false;</span>
<span class="line-added">138         case GraphicsLayerRepresentation:</span>
<span class="line-added">139             return !!m_graphicsLayer;</span>
<span class="line-added">140         case PlatformLayerRepresentation:</span>
<span class="line-added">141             return !!m_typelessPlatformLayer;</span>
<span class="line-added">142         case PlatformLayerIDRepresentation:</span>
<span class="line-added">143             return !!m_layerID;</span>
<span class="line-added">144         }</span>
<span class="line-added">145         ASSERT_NOT_REACHED();</span>
<span class="line-added">146         return false;</span>
<span class="line-added">147     }</span>
<span class="line-added">148 </span>
149     bool operator==(const LayerRepresentation&amp; other) const
150     {
151         if (m_representation != other.m_representation)
152             return false;
153         switch (m_representation) {
154         case EmptyRepresentation:
155             return true;
156         case GraphicsLayerRepresentation:
157             return m_graphicsLayer == other.m_graphicsLayer
158                 &amp;&amp; m_layerID == other.m_layerID;
159         case PlatformLayerRepresentation:
160             return m_typelessPlatformLayer == other.m_typelessPlatformLayer;
161         case PlatformLayerIDRepresentation:
162             return m_layerID == other.m_layerID;
163         }
164         ASSERT_NOT_REACHED();
165         return true;
166     }
167 
168     LayerRepresentation toRepresentation(Type representation) const
169     {
170         switch (representation) {
171         case EmptyRepresentation:
172             return LayerRepresentation();
173         case GraphicsLayerRepresentation:
174             ASSERT(m_representation == GraphicsLayerRepresentation);
175             return LayerRepresentation(m_graphicsLayer.get());
176         case PlatformLayerRepresentation:
177             return m_graphicsLayer ? m_graphicsLayer-&gt;platformLayer() : nullptr;
178         case PlatformLayerIDRepresentation:
179             return LayerRepresentation(m_layerID);
180         }
<span class="line-added">181         ASSERT_NOT_REACHED();</span>
182         return LayerRepresentation();
183     }
184 
185     bool representsGraphicsLayer() const { return m_representation == GraphicsLayerRepresentation; }
186     bool representsPlatformLayerID() const { return m_representation == PlatformLayerIDRepresentation; }
187 
188 private:
189     WEBCORE_EXPORT static void retainPlatformLayer(void* typelessPlatformLayer);
190     WEBCORE_EXPORT static void releasePlatformLayer(void* typelessPlatformLayer);
191     WEBCORE_EXPORT static PlatformLayer* makePlatformLayerTyped(void* typelessPlatformLayer);
192     WEBCORE_EXPORT static void* makePlatformLayerTypeless(PlatformLayer*);
193 
194     RefPtr&lt;GraphicsLayer&gt; m_graphicsLayer;
195     void* m_typelessPlatformLayer { nullptr };
196     GraphicsLayer::PlatformLayerID m_layerID { 0 };
197     Type m_representation { EmptyRepresentation };
198 };
199 
200 class ScrollingStateNode : public ThreadSafeRefCounted&lt;ScrollingStateNode&gt; {
201     WTF_MAKE_FAST_ALLOCATED;
</pre>
</td>
</tr>
</table>
<center><a href="ScrollingMomentumCalculator.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="ScrollingStateScrollingNode.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>