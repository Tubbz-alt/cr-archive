<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/jit/JITCode.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="JITCode.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="JITCodeMap.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/jit/JITCode.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
175     }
176 
177     template&lt;typename PointerType&gt;
178     static JITType jitTypeFor(PointerType jitCode)
179     {
180         if (!jitCode)
181             return JITType::None;
182         return jitCode-&gt;jitType();
183     }
184 
185     virtual CodePtr&lt;JSEntryPtrTag&gt; addressForCall(ArityCheckMode) = 0;
186     virtual void* executableAddressAtOffset(size_t offset) = 0;
187     void* executableAddress() { return executableAddressAtOffset(0); }
188     virtual void* dataAddressAtOffset(size_t offset) = 0;
189     virtual unsigned offsetOf(void* pointerIntoCode) = 0;
190 
191     virtual DFG::CommonData* dfgCommon();
192     virtual DFG::JITCode* dfg();
193     virtual FTL::JITCode* ftl();
194     virtual FTL::ForOSREntryJITCode* ftlForOSREntry();

195 
196     virtual void validateReferences(const TrackedReferences&amp;);
197 
198     JSValue execute(VM*, ProtoCallFrame*);
199 
200     void* start() { return dataAddressAtOffset(0); }
201     virtual size_t size() = 0;
202     void* end() { return reinterpret_cast&lt;void*&gt;(reinterpret_cast&lt;uintptr_t&gt;(start()) + size()); }
203 
204     virtual bool contains(void*) = 0;
205 
206 #if ENABLE(JIT)
207     virtual RegisterSet liveRegistersToPreserveAtExceptionHandlingCallSite(CodeBlock*, CallSiteIndex);
208     virtual Optional&lt;CodeOrigin&gt; findPC(CodeBlock*, void* pc) { UNUSED_PARAM(pc); return WTF::nullopt; }
209 #endif
210 
211     Intrinsic intrinsic() { return m_intrinsic; }
212 
213     bool isShared() const { return m_shareAttribute == ShareAttribute::Shared; }
214 
</pre>
<hr />
<pre>
220 };
221 
222 class JITCodeWithCodeRef : public JITCode {
223 protected:
224     JITCodeWithCodeRef(JITType);
225     JITCodeWithCodeRef(CodeRef&lt;JSEntryPtrTag&gt;, JITType, JITCode::ShareAttribute);
226 
227 public:
228     virtual ~JITCodeWithCodeRef();
229 
230     void* executableAddressAtOffset(size_t offset) override;
231     void* dataAddressAtOffset(size_t offset) override;
232     unsigned offsetOf(void* pointerIntoCode) override;
233     size_t size() override;
234     bool contains(void*) override;
235 
236 protected:
237     CodeRef&lt;JSEntryPtrTag&gt; m_ref;
238 };
239 

240 class DirectJITCode : public JITCodeWithCodeRef {

241 public:
242     DirectJITCode(JITType);
243     DirectJITCode(CodeRef&lt;JSEntryPtrTag&gt;, CodePtr&lt;JSEntryPtrTag&gt; withArityCheck, JITType, JITCode::ShareAttribute = JITCode::ShareAttribute::NotShared);
244     DirectJITCode(CodeRef&lt;JSEntryPtrTag&gt;, CodePtr&lt;JSEntryPtrTag&gt; withArityCheck, JITType, Intrinsic, JITCode::ShareAttribute = JITCode::ShareAttribute::NotShared); // For generated thunk.
245     virtual ~DirectJITCode();
246 
247     CodePtr&lt;JSEntryPtrTag&gt; addressForCall(ArityCheckMode) override;
248 
249 protected:
250     void initializeCodeRefForDFG(CodeRef&lt;JSEntryPtrTag&gt;, CodePtr&lt;JSEntryPtrTag&gt; withArityCheck);
251 
252 private:
253     CodePtr&lt;JSEntryPtrTag&gt; m_withArityCheck;
254 };
255 
256 class NativeJITCode : public JITCodeWithCodeRef {
257 public:
258     NativeJITCode(JITType);
259     NativeJITCode(CodeRef&lt;JSEntryPtrTag&gt;, JITType, Intrinsic, JITCode::ShareAttribute = JITCode::ShareAttribute::NotShared);
260     virtual ~NativeJITCode();
</pre>
</td>
<td>
<hr />
<pre>
175     }
176 
177     template&lt;typename PointerType&gt;
178     static JITType jitTypeFor(PointerType jitCode)
179     {
180         if (!jitCode)
181             return JITType::None;
182         return jitCode-&gt;jitType();
183     }
184 
185     virtual CodePtr&lt;JSEntryPtrTag&gt; addressForCall(ArityCheckMode) = 0;
186     virtual void* executableAddressAtOffset(size_t offset) = 0;
187     void* executableAddress() { return executableAddressAtOffset(0); }
188     virtual void* dataAddressAtOffset(size_t offset) = 0;
189     virtual unsigned offsetOf(void* pointerIntoCode) = 0;
190 
191     virtual DFG::CommonData* dfgCommon();
192     virtual DFG::JITCode* dfg();
193     virtual FTL::JITCode* ftl();
194     virtual FTL::ForOSREntryJITCode* ftlForOSREntry();
<span class="line-added">195     virtual void shrinkToFit(const ConcurrentJSLocker&amp;);</span>
196 
197     virtual void validateReferences(const TrackedReferences&amp;);
198 
199     JSValue execute(VM*, ProtoCallFrame*);
200 
201     void* start() { return dataAddressAtOffset(0); }
202     virtual size_t size() = 0;
203     void* end() { return reinterpret_cast&lt;void*&gt;(reinterpret_cast&lt;uintptr_t&gt;(start()) + size()); }
204 
205     virtual bool contains(void*) = 0;
206 
207 #if ENABLE(JIT)
208     virtual RegisterSet liveRegistersToPreserveAtExceptionHandlingCallSite(CodeBlock*, CallSiteIndex);
209     virtual Optional&lt;CodeOrigin&gt; findPC(CodeBlock*, void* pc) { UNUSED_PARAM(pc); return WTF::nullopt; }
210 #endif
211 
212     Intrinsic intrinsic() { return m_intrinsic; }
213 
214     bool isShared() const { return m_shareAttribute == ShareAttribute::Shared; }
215 
</pre>
<hr />
<pre>
221 };
222 
223 class JITCodeWithCodeRef : public JITCode {
224 protected:
225     JITCodeWithCodeRef(JITType);
226     JITCodeWithCodeRef(CodeRef&lt;JSEntryPtrTag&gt;, JITType, JITCode::ShareAttribute);
227 
228 public:
229     virtual ~JITCodeWithCodeRef();
230 
231     void* executableAddressAtOffset(size_t offset) override;
232     void* dataAddressAtOffset(size_t offset) override;
233     unsigned offsetOf(void* pointerIntoCode) override;
234     size_t size() override;
235     bool contains(void*) override;
236 
237 protected:
238     CodeRef&lt;JSEntryPtrTag&gt; m_ref;
239 };
240 
<span class="line-added">241 DECLARE_ALLOCATOR_WITH_HEAP_IDENTIFIER(DirectJITCode);</span>
242 class DirectJITCode : public JITCodeWithCodeRef {
<span class="line-added">243     WTF_MAKE_STRUCT_FAST_ALLOCATED_WITH_HEAP_IDENTIFIER(DirectJITCode);</span>
244 public:
245     DirectJITCode(JITType);
246     DirectJITCode(CodeRef&lt;JSEntryPtrTag&gt;, CodePtr&lt;JSEntryPtrTag&gt; withArityCheck, JITType, JITCode::ShareAttribute = JITCode::ShareAttribute::NotShared);
247     DirectJITCode(CodeRef&lt;JSEntryPtrTag&gt;, CodePtr&lt;JSEntryPtrTag&gt; withArityCheck, JITType, Intrinsic, JITCode::ShareAttribute = JITCode::ShareAttribute::NotShared); // For generated thunk.
248     virtual ~DirectJITCode();
249 
250     CodePtr&lt;JSEntryPtrTag&gt; addressForCall(ArityCheckMode) override;
251 
252 protected:
253     void initializeCodeRefForDFG(CodeRef&lt;JSEntryPtrTag&gt;, CodePtr&lt;JSEntryPtrTag&gt; withArityCheck);
254 
255 private:
256     CodePtr&lt;JSEntryPtrTag&gt; m_withArityCheck;
257 };
258 
259 class NativeJITCode : public JITCodeWithCodeRef {
260 public:
261     NativeJITCode(JITType);
262     NativeJITCode(CodeRef&lt;JSEntryPtrTag&gt;, JITType, Intrinsic, JITCode::ShareAttribute = JITCode::ShareAttribute::NotShared);
263     virtual ~NativeJITCode();
</pre>
</td>
</tr>
</table>
<center><a href="JITCode.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="JITCodeMap.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>