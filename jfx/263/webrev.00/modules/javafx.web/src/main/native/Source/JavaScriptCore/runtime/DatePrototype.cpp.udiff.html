<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/DatePrototype.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DateInstanceCache.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DatePrototype.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/runtime/DatePrototype.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -67,56 +67,54 @@</span>
  #include &lt;CoreFoundation/CoreFoundation.h&gt;
  #endif
  
  namespace JSC {
  
<span class="udiff-line-modified-removed">- using namespace WTF;</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetDate(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetDay(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetFullYear(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetHours(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMilliSeconds(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMinutes(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMonth(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetSeconds(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetTimezoneOffset(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCDate(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCDay(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCFullYear(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCHours(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMilliseconds(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMinutes(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMonth(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCSeconds(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetYear(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetDate(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetFullYear(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetHours(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMilliSeconds(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMinutes(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMonth(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetSeconds(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetTime(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCDate(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCFullYear(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCHours(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMilliseconds(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMinutes(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMonth(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCSeconds(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetYear(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToDateString(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleDateString(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleString(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleTimeString(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToPrimitiveSymbol(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToString(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToTimeString(ExecState*);</span>
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToUTCString(ExecState*);</span>
<span class="udiff-line-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToISOString(ExecState*);</span>
<span class="udiff-line-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToJSON(ExecState*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetDate(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetDay(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetFullYear(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetHours(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMilliSeconds(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMinutes(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMonth(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetSeconds(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetTimezoneOffset(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCDate(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCDay(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCFullYear(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCHours(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMilliseconds(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMinutes(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMonth(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCSeconds(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetYear(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetDate(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetFullYear(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetHours(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMilliSeconds(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMinutes(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMonth(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetSeconds(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetTime(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCDate(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCFullYear(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCHours(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMilliseconds(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMinutes(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMonth(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCSeconds(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetYear(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToDateString(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleDateString(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleString(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleTimeString(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToPrimitiveSymbol(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToString(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToTimeString(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToUTCString(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToISOString(JSGlobalObject*, CallFrame*);</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToJSON(JSGlobalObject*, CallFrame*);</span>
  
  }
  
  #include &quot;DatePrototype.lut.h&quot;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -140,29 +138,29 @@</span>
      if (string == &quot;full&quot;)
          return kCFDateFormatterFullStyle;
      return defaultStyle;
  }
  
<span class="udiff-line-modified-removed">- static JSCell* formatLocaleDate(ExecState* exec, DateInstance*, double timeInMilliseconds, LocaleDateTimeFormat format)</span>
<span class="udiff-line-modified-added">+ static JSCell* formatLocaleDate(JSGlobalObject* globalObject, CallFrame* callFrame, DateInstance*, double timeInMilliseconds, LocaleDateTimeFormat format)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      CFDateFormatterStyle dateStyle = (format != LocaleTime ? kCFDateFormatterLongStyle : kCFDateFormatterNoStyle);
      CFDateFormatterStyle timeStyle = (format != LocaleDate ? kCFDateFormatterLongStyle : kCFDateFormatterNoStyle);
  
      bool useCustomFormat = false;
      String customFormatString;
  
<span class="udiff-line-modified-removed">-     String arg0String = exec-&gt;argument(0).toWTFString(exec);</span>
<span class="udiff-line-modified-removed">-     if (arg0String == &quot;custom&quot; &amp;&amp; !exec-&gt;argument(1).isUndefined()) {</span>
<span class="udiff-line-modified-added">+     String arg0String = callFrame-&gt;argument(0).toWTFString(globalObject);</span>
<span class="udiff-line-modified-added">+     if (arg0String == &quot;custom&quot; &amp;&amp; !callFrame-&gt;argument(1).isUndefined()) {</span>
          useCustomFormat = true;
<span class="udiff-line-modified-removed">-         customFormatString = exec-&gt;argument(1).toWTFString(exec);</span>
<span class="udiff-line-modified-removed">-     } else if (format == LocaleDateAndTime &amp;&amp; !exec-&gt;argument(1).isUndefined()) {</span>
<span class="udiff-line-modified-added">+         customFormatString = callFrame-&gt;argument(1).toWTFString(globalObject);</span>
<span class="udiff-line-modified-added">+     } else if (format == LocaleDateAndTime &amp;&amp; !callFrame-&gt;argument(1).isUndefined()) {</span>
          dateStyle = styleFromArgString(arg0String, dateStyle);
<span class="udiff-line-modified-removed">-         timeStyle = styleFromArgString(exec-&gt;argument(1).toWTFString(exec), timeStyle);</span>
<span class="udiff-line-modified-removed">-     } else if (format != LocaleTime &amp;&amp; !exec-&gt;argument(0).isUndefined())</span>
<span class="udiff-line-modified-added">+         timeStyle = styleFromArgString(callFrame-&gt;argument(1).toWTFString(globalObject), timeStyle);</span>
<span class="udiff-line-modified-added">+     } else if (format != LocaleTime &amp;&amp; !callFrame-&gt;argument(0).isUndefined())</span>
          dateStyle = styleFromArgString(arg0String, dateStyle);
<span class="udiff-line-modified-removed">-     else if (format != LocaleDate &amp;&amp; !exec-&gt;argument(0).isUndefined())</span>
<span class="udiff-line-modified-added">+     else if (format != LocaleDate &amp;&amp; !callFrame-&gt;argument(0).isUndefined())</span>
          timeStyle = styleFromArgString(arg0String, timeStyle);
  
      CFAbsoluteTime absoluteTime = floor(timeInMilliseconds / msPerSecond) - kCFAbsoluteTimeIntervalSince1970;
  
      auto formatter = adoptCF(CFDateFormatterCreate(kCFAllocatorDefault, adoptCF(CFLocaleCopyCurrent()).get(), dateStyle, timeStyle));
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -171,13 +169,13 @@</span>
      return jsNontrivialString(vm, adoptCF(CFDateFormatterCreateStringWithAbsoluteTime(kCFAllocatorDefault, formatter.get(), absoluteTime)).get());
  }
  
  #elif !UCONFIG_NO_FORMATTING
  
<span class="udiff-line-modified-removed">- static JSCell* formatLocaleDate(ExecState* exec, DateInstance*, double timeInMilliseconds, LocaleDateTimeFormat format)</span>
<span class="udiff-line-modified-added">+ static JSCell* formatLocaleDate(JSGlobalObject* globalObject, CallFrame*, DateInstance*, double timeInMilliseconds, LocaleDateTimeFormat format)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      UDateFormatStyle timeStyle = (format != LocaleDate ? UDAT_LONG : UDAT_NONE);
      UDateFormatStyle dateStyle = (format != LocaleTime ? UDAT_LONG : UDAT_NONE);
  
      UErrorCode status = U_ZERO_ERROR;
      UDateFormat* df = udat_open(timeStyle, dateStyle, 0, 0, -1, 0, 0, &amp;status);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -194,13 +192,13 @@</span>
      return jsNontrivialString(vm, String(buffer, length));
  }
  
  #else
  
<span class="udiff-line-modified-removed">- static JSCell* formatLocaleDate(ExecState* exec, const GregorianDateTime&amp; gdt, LocaleDateTimeFormat format)</span>
<span class="udiff-line-modified-added">+ static JSCell* formatLocaleDate(JSGlobalObject* globalObject, CallFrame* callFrame, const GregorianDateTime&amp; gdt, LocaleDateTimeFormat format)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
  #if OS(WINDOWS)
      SYSTEMTIME systemTime;
      memset(&amp;systemTime, 0, sizeof(systemTime));
      systemTime.wYear = gdt.year();
      systemTime.wMonth = gdt.month() + 1;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -308,90 +306,90 @@</span>
  
      return jsNontrivialString(vm, timebuffer);
  #endif // OS(WINDOWS)
  }
  
<span class="udiff-line-modified-removed">- static JSCell* formatLocaleDate(ExecState* exec, DateInstance* dateObject, double, LocaleDateTimeFormat format)</span>
<span class="udiff-line-modified-added">+ static JSCell* formatLocaleDate(JSGlobalObject* globalObject, CallFrame* callFrame, DateInstance* dateObject, double, LocaleDateTimeFormat format)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = dateObject-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = dateObject-&gt;gregorianDateTime(vm);</span>
      if (!gregorianDateTime)
          return jsNontrivialString(vm, &quot;Invalid Date&quot;_s);
<span class="udiff-line-modified-removed">-     return formatLocaleDate(exec, *gregorianDateTime, format);</span>
<span class="udiff-line-modified-added">+     return formatLocaleDate(globalObject, callFrame, *gregorianDateTime, format);</span>
  }
  
  #endif // OS(DARWIN) &amp;&amp; USE(CF)
  
<span class="udiff-line-modified-removed">- static EncodedJSValue formateDateInstance(ExecState* exec, DateTimeFormat format, bool asUTCVariant)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue formateDateInstance(JSGlobalObject* globalObject, CallFrame* callFrame, DateTimeFormat format, bool asUTCVariant)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
      const GregorianDateTime* gregorianDateTime = asUTCVariant
<span class="udiff-line-modified-removed">-         ? thisDateObj-&gt;gregorianDateTimeUTC(exec)</span>
<span class="udiff-line-modified-removed">-         : thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+         ? thisDateObj-&gt;gregorianDateTimeUTC(vm)</span>
<span class="udiff-line-modified-added">+         : thisDateObj-&gt;gregorianDateTime(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNontrivialString(vm, String(&quot;Invalid Date&quot;_s)));
  
      return JSValue::encode(jsNontrivialString(vm, formatDateTime(*gregorianDateTime, format, asUTCVariant)));
  }
  
  // Converts a list of arguments sent to a Date member function into milliseconds, updating
  // ms (representing milliseconds) and t (representing the rest of the date structure) appropriately.
  //
  // Format of member function: f([hour,] [min,] [sec,] [ms])
<span class="udiff-line-modified-removed">- static bool fillStructuresUsingTimeArgs(ExecState* exec, int maxArgs, double* ms, GregorianDateTime* t)</span>
<span class="udiff-line-modified-added">+ static bool fillStructuresUsingTimeArgs(JSGlobalObject* globalObject, CallFrame* callFrame, int maxArgs, double* ms, GregorianDateTime* t)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
  
      double milliseconds = 0;
      bool ok = true;
      int idx = 0;
<span class="udiff-line-modified-removed">-     int numArgs = exec-&gt;argumentCount();</span>
<span class="udiff-line-modified-added">+     int numArgs = callFrame-&gt;argumentCount();</span>
  
      // JS allows extra trailing arguments -- ignore them
      if (numArgs &gt; maxArgs)
          numArgs = maxArgs;
  
      // hours
      if (maxArgs &gt;= 4 &amp;&amp; idx &lt; numArgs) {
          t-&gt;setHour(0);
<span class="udiff-line-modified-removed">-         double hours = exec-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(exec);</span>
<span class="udiff-line-modified-added">+         double hours = callFrame-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(globalObject);</span>
          RETURN_IF_EXCEPTION(scope, false);
          ok = std::isfinite(hours);
          milliseconds += hours * msPerHour;
      }
  
      // minutes
      if (maxArgs &gt;= 3 &amp;&amp; idx &lt; numArgs &amp;&amp; ok) {
          t-&gt;setMinute(0);
<span class="udiff-line-modified-removed">-         double minutes = exec-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(exec);</span>
<span class="udiff-line-modified-added">+         double minutes = callFrame-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(globalObject);</span>
          RETURN_IF_EXCEPTION(scope, false);
          ok = std::isfinite(minutes);
          milliseconds += minutes * msPerMinute;
      }
  
      // seconds
      if (maxArgs &gt;= 2 &amp;&amp; idx &lt; numArgs &amp;&amp; ok) {
          t-&gt;setSecond(0);
<span class="udiff-line-modified-removed">-         double seconds = exec-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(exec);</span>
<span class="udiff-line-modified-added">+         double seconds = callFrame-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(globalObject);</span>
          RETURN_IF_EXCEPTION(scope, false);
          ok = std::isfinite(seconds);
          milliseconds += seconds * msPerSecond;
      }
  
      if (!ok)
          return false;
  
      // milliseconds
      if (idx &lt; numArgs) {
<span class="udiff-line-modified-removed">-         double millis = exec-&gt;uncheckedArgument(idx).toIntegerPreserveNaN(exec);</span>
<span class="udiff-line-modified-added">+         double millis = callFrame-&gt;uncheckedArgument(idx).toIntegerPreserveNaN(globalObject);</span>
          RETURN_IF_EXCEPTION(scope, false);
          ok = std::isfinite(millis);
          milliseconds += millis;
      } else
          milliseconds += *ms;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -402,40 +400,40 @@</span>
  
  // Converts a list of arguments sent to a Date member function into years, months, and milliseconds, updating
  // ms (representing milliseconds) and t (representing the rest of the date structure) appropriately.
  //
  // Format of member function: f([years,] [months,] [days])
<span class="udiff-line-modified-removed">- static bool fillStructuresUsingDateArgs(ExecState *exec, int maxArgs, double *ms, GregorianDateTime *t)</span>
<span class="udiff-line-modified-added">+ static bool fillStructuresUsingDateArgs(JSGlobalObject* globalObject, CallFrame* callFrame, int maxArgs, double *ms, GregorianDateTime *t)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
  
      int idx = 0;
      bool ok = true;
<span class="udiff-line-modified-removed">-     int numArgs = exec-&gt;argumentCount();</span>
<span class="udiff-line-modified-added">+     int numArgs = callFrame-&gt;argumentCount();</span>
  
      // JS allows extra trailing arguments -- ignore them
      if (numArgs &gt; maxArgs)
          numArgs = maxArgs;
  
      // years
      if (maxArgs &gt;= 3 &amp;&amp; idx &lt; numArgs) {
<span class="udiff-line-modified-removed">-         double years = exec-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(exec);</span>
<span class="udiff-line-modified-added">+         double years = callFrame-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(globalObject);</span>
          RETURN_IF_EXCEPTION(scope, false);
          ok = std::isfinite(years);
          t-&gt;setYear(toInt32(years));
      }
      // months
      if (maxArgs &gt;= 2 &amp;&amp; idx &lt; numArgs &amp;&amp; ok) {
<span class="udiff-line-modified-removed">-         double months = exec-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(exec);</span>
<span class="udiff-line-modified-added">+         double months = callFrame-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(globalObject);</span>
          RETURN_IF_EXCEPTION(scope, false);
          ok = std::isfinite(months);
          t-&gt;setMonth(toInt32(months));
      }
      // days
      if (idx &lt; numArgs &amp;&amp; ok) {
<span class="udiff-line-modified-removed">-         double days = exec-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(exec);</span>
<span class="udiff-line-modified-added">+         double days = callFrame-&gt;uncheckedArgument(idx++).toIntegerPreserveNaN(globalObject);</span>
          RETURN_IF_EXCEPTION(scope, false);
          ok = std::isfinite(days);
          t-&gt;setMonthDay(0);
          *ms += days * msPerDay;
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -452,29 +450,30 @@</span>
    toDateString          dateProtoFuncToDateString            DontEnum|Function       0
    toTimeString          dateProtoFuncToTimeString            DontEnum|Function       0
    toLocaleString        dateProtoFuncToLocaleString          DontEnum|Function       0
    toLocaleDateString    dateProtoFuncToLocaleDateString      DontEnum|Function       0
    toLocaleTimeString    dateProtoFuncToLocaleTimeString      DontEnum|Function       0
<span class="udiff-line-modified-removed">-   valueOf               dateProtoFuncGetTime                 DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getTime               dateProtoFuncGetTime                 DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getFullYear           dateProtoFuncGetFullYear             DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getUTCFullYear        dateProtoFuncGetUTCFullYear          DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getMonth              dateProtoFuncGetMonth                DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getUTCMonth           dateProtoFuncGetUTCMonth             DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getDate               dateProtoFuncGetDate                 DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getUTCDate            dateProtoFuncGetUTCDate              DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getDay                dateProtoFuncGetDay                  DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getUTCDay             dateProtoFuncGetUTCDay               DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getHours              dateProtoFuncGetHours                DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getUTCHours           dateProtoFuncGetUTCHours             DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getMinutes            dateProtoFuncGetMinutes              DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getUTCMinutes         dateProtoFuncGetUTCMinutes           DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getSeconds            dateProtoFuncGetSeconds              DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getUTCSeconds         dateProtoFuncGetUTCSeconds           DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getMilliseconds       dateProtoFuncGetMilliSeconds         DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getUTCMilliseconds    dateProtoFuncGetUTCMilliseconds      DontEnum|Function       0</span>
<span class="udiff-line-modified-removed">-   getTimezoneOffset     dateProtoFuncGetTimezoneOffset       DontEnum|Function       0</span>
<span class="udiff-line-modified-added">+   valueOf               dateProtoFuncGetTime                 DontEnum|Function       0  DatePrototypeGetTimeIntrinsic</span>
<span class="udiff-line-modified-added">+   getTime               dateProtoFuncGetTime                 DontEnum|Function       0  DatePrototypeGetTimeIntrinsic</span>
<span class="udiff-line-modified-added">+   getFullYear           dateProtoFuncGetFullYear             DontEnum|Function       0  DatePrototypeGetFullYearIntrinsic</span>
<span class="udiff-line-modified-added">+   getUTCFullYear        dateProtoFuncGetUTCFullYear          DontEnum|Function       0  DatePrototypeGetUTCFullYearIntrinsic</span>
<span class="udiff-line-modified-added">+   getMonth              dateProtoFuncGetMonth                DontEnum|Function       0  DatePrototypeGetMonthIntrinsic</span>
<span class="udiff-line-modified-added">+   getUTCMonth           dateProtoFuncGetUTCMonth             DontEnum|Function       0  DatePrototypeGetUTCMonthIntrinsic</span>
<span class="udiff-line-modified-added">+   getDate               dateProtoFuncGetDate                 DontEnum|Function       0  DatePrototypeGetDateIntrinsic</span>
<span class="udiff-line-modified-added">+   getUTCDate            dateProtoFuncGetUTCDate              DontEnum|Function       0  DatePrototypeGetUTCDateIntrinsic</span>
<span class="udiff-line-modified-added">+   getDay                dateProtoFuncGetDay                  DontEnum|Function       0  DatePrototypeGetDayIntrinsic</span>
<span class="udiff-line-modified-added">+   getUTCDay             dateProtoFuncGetUTCDay               DontEnum|Function       0  DatePrototypeGetUTCDayIntrinsic</span>
<span class="udiff-line-modified-added">+   getHours              dateProtoFuncGetHours                DontEnum|Function       0  DatePrototypeGetHoursIntrinsic</span>
<span class="udiff-line-modified-added">+   getUTCHours           dateProtoFuncGetUTCHours             DontEnum|Function       0  DatePrototypeGetUTCHoursIntrinsic</span>
<span class="udiff-line-modified-added">+   getMinutes            dateProtoFuncGetMinutes              DontEnum|Function       0  DatePrototypeGetMinutesIntrinsic</span>
<span class="udiff-line-modified-added">+   getUTCMinutes         dateProtoFuncGetUTCMinutes           DontEnum|Function       0  DatePrototypeGetUTCMinutesIntrinsic</span>
<span class="udiff-line-modified-added">+   getSeconds            dateProtoFuncGetSeconds              DontEnum|Function       0  DatePrototypeGetSecondsIntrinsic</span>
<span class="udiff-line-modified-added">+   getUTCSeconds         dateProtoFuncGetUTCSeconds           DontEnum|Function       0  DatePrototypeGetUTCSecondsIntrinsic</span>
<span class="udiff-line-modified-added">+   getMilliseconds       dateProtoFuncGetMilliSeconds         DontEnum|Function       0  DatePrototypeGetMillisecondsIntrinsic</span>
<span class="udiff-line-modified-added">+   getUTCMilliseconds    dateProtoFuncGetUTCMilliseconds      DontEnum|Function       0  DatePrototypeGetUTCMillisecondsIntrinsic</span>
<span class="udiff-line-modified-added">+   getTimezoneOffset     dateProtoFuncGetTimezoneOffset       DontEnum|Function       0  DatePrototypeGetTimezoneOffsetIntrinsic</span>
<span class="udiff-line-added">+   getYear               dateProtoFuncGetYear                 DontEnum|Function       0  DatePrototypeGetYearIntrinsic</span>
    setTime               dateProtoFuncSetTime                 DontEnum|Function       1
    setMilliseconds       dateProtoFuncSetMilliSeconds         DontEnum|Function       1
    setUTCMilliseconds    dateProtoFuncSetUTCMilliseconds      DontEnum|Function       1
    setSeconds            dateProtoFuncSetSeconds              DontEnum|Function       2
    setUTCSeconds         dateProtoFuncSetUTCSeconds           DontEnum|Function       2
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -487,11 +486,10 @@</span>
    setMonth              dateProtoFuncSetMonth                DontEnum|Function       2
    setUTCMonth           dateProtoFuncSetUTCMonth             DontEnum|Function       2
    setFullYear           dateProtoFuncSetFullYear             DontEnum|Function       3
    setUTCFullYear        dateProtoFuncSetUTCFullYear          DontEnum|Function       3
    setYear               dateProtoFuncSetYear                 DontEnum|Function       1
<span class="udiff-line-removed">-   getYear               dateProtoFuncGetYear                 DontEnum|Function       0</span>
    toJSON                dateProtoFuncToJSON                  DontEnum|Function       1
  @end
  */
  
  // ECMA 15.9.4
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -523,35 +521,35 @@</span>
      // The constructor will be added later, after DateConstructor has been built.
  }
  
  // Functions
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToString(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToString(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
      const bool asUTCVariant = false;
<span class="udiff-line-modified-removed">-     return formateDateInstance(exec, DateTimeFormatDateAndTime, asUTCVariant);</span>
<span class="udiff-line-modified-added">+     return formateDateInstance(globalObject, callFrame, DateTimeFormatDateAndTime, asUTCVariant);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToUTCString(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToUTCString(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
      const bool asUTCVariant = true;
<span class="udiff-line-modified-removed">-     return formateDateInstance(exec, DateTimeFormatDateAndTime, asUTCVariant);</span>
<span class="udiff-line-modified-added">+     return formateDateInstance(globalObject, callFrame, DateTimeFormatDateAndTime, asUTCVariant);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToISOString(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToISOString(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
      if (!std::isfinite(thisDateObj-&gt;internalNumber()))
<span class="udiff-line-modified-removed">-         return throwVMError(exec, scope, createRangeError(exec, &quot;Invalid Date&quot;_s));</span>
<span class="udiff-line-modified-added">+         return throwVMError(globalObject, scope, createRangeError(globalObject, &quot;Invalid Date&quot;_s));</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNontrivialString(vm, String(&quot;Invalid Date&quot;_s)));
      // Maximum amount of space we need in buffer: 7 (max. digits in year) + 2 * 5 (2 characters each for month, day, hour, minute, second) + 4 (. + 3 digits for milliseconds)
      // 6 for formatting and one for null termination = 28. We add one extra character to allow us to force null termination.
      char buffer[28];
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -571,396 +569,397 @@</span>
          return JSValue::encode(jsEmptyString(vm));
  
      return JSValue::encode(jsNontrivialString(vm, String(buffer, charactersWritten)));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToDateString(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToDateString(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
      const bool asUTCVariant = false;
<span class="udiff-line-modified-removed">-     return formateDateInstance(exec, DateTimeFormatDate, asUTCVariant);</span>
<span class="udiff-line-modified-added">+     return formateDateInstance(globalObject, callFrame, DateTimeFormatDate, asUTCVariant);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToTimeString(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToTimeString(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
      const bool asUTCVariant = false;
<span class="udiff-line-modified-removed">-     return formateDateInstance(exec, DateTimeFormatTime, asUTCVariant);</span>
<span class="udiff-line-modified-added">+     return formateDateInstance(globalObject, callFrame, DateTimeFormatTime, asUTCVariant);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleString(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleString(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     return JSValue::encode(formatLocaleDate(exec, thisDateObj, thisDateObj-&gt;internalNumber(), LocaleDateAndTime));</span>
<span class="udiff-line-modified-added">+     return JSValue::encode(formatLocaleDate(globalObject, callFrame, thisDateObj, thisDateObj-&gt;internalNumber(), LocaleDateAndTime));</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleDateString(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleDateString(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     return JSValue::encode(formatLocaleDate(exec, thisDateObj, thisDateObj-&gt;internalNumber(), LocaleDate));</span>
<span class="udiff-line-modified-added">+     return JSValue::encode(formatLocaleDate(globalObject, callFrame, thisDateObj, thisDateObj-&gt;internalNumber(), LocaleDate));</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleTimeString(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToLocaleTimeString(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     return JSValue::encode(formatLocaleDate(exec, thisDateObj, thisDateObj-&gt;internalNumber(), LocaleTime));</span>
<span class="udiff-line-modified-added">+     return JSValue::encode(formatLocaleDate(globalObject, callFrame, thisDateObj, thisDateObj-&gt;internalNumber(), LocaleTime));</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToPrimitiveSymbol(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToPrimitiveSymbol(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      if (!thisValue.isObject())
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Date.prototype[Symbol.toPrimitive] expected |this| to be an object.&quot;);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Date.prototype[Symbol.toPrimitive] expected |this| to be an object.&quot;);</span>
      JSObject* thisObject = jsCast&lt;JSObject*&gt;(thisValue);
  
<span class="udiff-line-modified-removed">-     if (!exec-&gt;argumentCount())</span>
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;Date.prototype[Symbol.toPrimitive] expected a first argument.&quot;);</span>
<span class="udiff-line-modified-added">+     if (!callFrame-&gt;argumentCount())</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;Date.prototype[Symbol.toPrimitive] expected a first argument.&quot;);</span>
  
<span class="udiff-line-modified-removed">-     JSValue hintValue = exec-&gt;uncheckedArgument(0);</span>
<span class="udiff-line-modified-removed">-     PreferredPrimitiveType type = toPreferredPrimitiveType(exec, hintValue);</span>
<span class="udiff-line-modified-added">+     JSValue hintValue = callFrame-&gt;uncheckedArgument(0);</span>
<span class="udiff-line-modified-added">+     PreferredPrimitiveType type = toPreferredPrimitiveType(globalObject, hintValue);</span>
      RETURN_IF_EXCEPTION(scope, encodedJSValue());
  
      if (type == NoPreference)
          type = PreferString;
  
<span class="udiff-line-modified-removed">-     RELEASE_AND_RETURN(scope, JSValue::encode(thisObject-&gt;ordinaryToPrimitive(exec, type)));</span>
<span class="udiff-line-modified-added">+     RELEASE_AND_RETURN(scope, JSValue::encode(thisObject-&gt;ordinaryToPrimitive(globalObject, type)));</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetTime(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetTime(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
      return JSValue::encode(jsNumber(thisDateObj-&gt;internalNumber()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetFullYear(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetFullYear(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;year()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCFullYear(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCFullYear(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;year()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMonth(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMonth(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;month()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMonth(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMonth(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;month()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetDate(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetDate(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;monthDay()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCDate(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCDate(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;monthDay()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetDay(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetDay(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;weekDay()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCDay(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCDay(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;weekDay()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetHours(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetHours(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;hour()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCHours(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCHours(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;hour()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMinutes(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMinutes(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;minute()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMinutes(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMinutes(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;minute()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetSeconds(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetSeconds(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;second()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCSeconds(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCSeconds(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTimeUTC(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;second()));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMilliSeconds(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetMilliSeconds(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
      double milli = thisDateObj-&gt;internalNumber();
      if (std::isnan(milli))
          return JSValue::encode(jsNaN());
  
      double secs = floor(milli / msPerSecond);
      double ms = milli - secs * msPerSecond;
<span class="udiff-line-modified-removed">-     return JSValue::encode(jsNumber(ms));</span>
<span class="udiff-line-modified-added">+     // Since timeClip makes internalNumber integer milliseconds, this result is always int32_t.</span>
<span class="udiff-line-added">+     return JSValue::encode(jsNumber(static_cast&lt;int32_t&gt;(ms)));</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMilliseconds(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetUTCMilliseconds(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
      double milli = thisDateObj-&gt;internalNumber();
      if (std::isnan(milli))
          return JSValue::encode(jsNaN());
  
      double secs = floor(milli / msPerSecond);
      double ms = milli - secs * msPerSecond;
<span class="udiff-line-modified-removed">-     return JSValue::encode(jsNumber(ms));</span>
<span class="udiff-line-modified-added">+     // Since timeClip makes internalNumber integer milliseconds, this result is always int32_t.</span>
<span class="udiff-line-added">+     return JSValue::encode(jsNumber(static_cast&lt;int32_t&gt;(ms)));</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetTimezoneOffset(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetTimezoneOffset(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
<span class="udiff-line-modified-removed">-     return JSValue::encode(jsNumber(-gregorianDateTime-&gt;utcOffset() / minutesPerHour));</span>
<span class="udiff-line-modified-added">+     return JSValue::encode(jsNumber(-gregorianDateTime-&gt;utcOffsetInMinute()));</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetTime(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetTime(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     double milli = timeClip(exec-&gt;argument(0).toNumber(exec));</span>
<span class="udiff-line-modified-added">+     double milli = timeClip(callFrame-&gt;argument(0).toNumber(globalObject));</span>
      RETURN_IF_EXCEPTION(scope, encodedJSValue());
      thisDateObj-&gt;setInternalNumber(milli);
      return JSValue::encode(jsNumber(milli));
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue setNewValueFromTimeArgs(ExecState* exec, int numArgsToUse, WTF::TimeType inputTimeType)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue setNewValueFromTimeArgs(JSGlobalObject* globalObject, CallFrame* callFrame, int numArgsToUse, WTF::TimeType inputTimeType)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
      double milli = thisDateObj-&gt;internalNumber();
  
<span class="udiff-line-modified-removed">-     if (!exec-&gt;argumentCount() || std::isnan(milli)) {</span>
<span class="udiff-line-modified-added">+     if (!callFrame-&gt;argumentCount() || std::isnan(milli)) {</span>
          thisDateObj-&gt;setInternalNumber(PNaN);
          return JSValue::encode(jsNaN());
      }
  
      double secs = floor(milli / msPerSecond);
      double ms = milli - secs * msPerSecond;
  
      const GregorianDateTime* other = inputTimeType == WTF::UTCTime
<span class="udiff-line-modified-removed">-         ? thisDateObj-&gt;gregorianDateTimeUTC(exec)</span>
<span class="udiff-line-modified-removed">-         : thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+         ? thisDateObj-&gt;gregorianDateTimeUTC(vm)</span>
<span class="udiff-line-modified-added">+         : thisDateObj-&gt;gregorianDateTime(vm);</span>
      if (!other)
          return JSValue::encode(jsNaN());
  
<span class="udiff-line-modified-removed">-     GregorianDateTime gregorianDateTime;</span>
<span class="udiff-line-modified-removed">-     gregorianDateTime.copyFrom(*other);</span>
<span class="udiff-line-removed">-     bool success = fillStructuresUsingTimeArgs(exec, numArgsToUse, &amp;ms, &amp;gregorianDateTime);</span>
<span class="udiff-line-modified-added">+     GregorianDateTime gregorianDateTime(*other);</span>
<span class="udiff-line-modified-added">+     bool success = fillStructuresUsingTimeArgs(globalObject, callFrame, numArgsToUse, &amp;ms, &amp;gregorianDateTime);</span>
      RETURN_IF_EXCEPTION(scope, encodedJSValue());
      if (!success) {
          thisDateObj-&gt;setInternalNumber(PNaN);
          return JSValue::encode(jsNaN());
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -969,20 +968,20 @@</span>
      double result = timeClip(newUTCDate);
      thisDateObj-&gt;setInternalNumber(result);
      return JSValue::encode(jsNumber(result));
  }
  
<span class="udiff-line-modified-removed">- static EncodedJSValue setNewValueFromDateArgs(ExecState* exec, int numArgsToUse, WTF::TimeType inputTimeType)</span>
<span class="udiff-line-modified-added">+ static EncodedJSValue setNewValueFromDateArgs(JSGlobalObject* globalObject, CallFrame* callFrame, int numArgsToUse, WTF::TimeType inputTimeType)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     if (!exec-&gt;argumentCount()) {</span>
<span class="udiff-line-modified-added">+     if (!callFrame-&gt;argumentCount()) {</span>
          thisDateObj-&gt;setInternalNumber(PNaN);
          return JSValue::encode(jsNaN());
      }
  
      double milli = thisDateObj-&gt;internalNumber();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -992,18 +991,18 @@</span>
      if (numArgsToUse == 3 &amp;&amp; std::isnan(milli))
          msToGregorianDateTime(vm, 0, WTF::UTCTime, gregorianDateTime);
      else {
          ms = milli - floor(milli / msPerSecond) * msPerSecond;
          const GregorianDateTime* other = inputTimeType == WTF::UTCTime
<span class="udiff-line-modified-removed">-             ? thisDateObj-&gt;gregorianDateTimeUTC(exec)</span>
<span class="udiff-line-modified-removed">-             : thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+             ? thisDateObj-&gt;gregorianDateTimeUTC(vm)</span>
<span class="udiff-line-modified-added">+             : thisDateObj-&gt;gregorianDateTime(vm);</span>
          if (!other)
              return JSValue::encode(jsNaN());
<span class="udiff-line-modified-removed">-         gregorianDateTime.copyFrom(*other);</span>
<span class="udiff-line-modified-added">+         gregorianDateTime = *other;</span>
      }
  
<span class="udiff-line-modified-removed">-     bool success = fillStructuresUsingDateArgs(exec, numArgsToUse, &amp;ms, &amp;gregorianDateTime);</span>
<span class="udiff-line-modified-added">+     bool success = fillStructuresUsingDateArgs(globalObject, callFrame, numArgsToUse, &amp;ms, &amp;gregorianDateTime);</span>
      RETURN_IF_EXCEPTION(scope, encodedJSValue());
      if (!success) {
          thisDateObj-&gt;setInternalNumber(PNaN);
          return JSValue::encode(jsNaN());
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1012,90 +1011,90 @@</span>
      double result = timeClip(newUTCDate);
      thisDateObj-&gt;setInternalNumber(result);
      return JSValue::encode(jsNumber(result));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMilliSeconds(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMilliSeconds(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromTimeArgs(exec, 1, WTF::LocalTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromTimeArgs(globalObject, callFrame, 1, WTF::LocalTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMilliseconds(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMilliseconds(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromTimeArgs(exec, 1, WTF::UTCTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromTimeArgs(globalObject, callFrame, 1, WTF::UTCTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetSeconds(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetSeconds(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromTimeArgs(exec, 2, WTF::LocalTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromTimeArgs(globalObject, callFrame, 2, WTF::LocalTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCSeconds(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCSeconds(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromTimeArgs(exec, 2, WTF::UTCTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromTimeArgs(globalObject, callFrame, 2, WTF::UTCTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMinutes(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMinutes(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromTimeArgs(exec, 3, WTF::LocalTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromTimeArgs(globalObject, callFrame, 3, WTF::LocalTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMinutes(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMinutes(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromTimeArgs(exec, 3, WTF::UTCTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromTimeArgs(globalObject, callFrame, 3, WTF::UTCTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetHours(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetHours(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromTimeArgs(exec, 4, WTF::LocalTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromTimeArgs(globalObject, callFrame, 4, WTF::LocalTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCHours(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCHours(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromTimeArgs(exec, 4, WTF::UTCTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromTimeArgs(globalObject, callFrame, 4, WTF::UTCTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetDate(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetDate(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromDateArgs(exec, 1, WTF::LocalTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromDateArgs(globalObject, callFrame, 1, WTF::LocalTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCDate(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCDate(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromDateArgs(exec, 1, WTF::UTCTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromDateArgs(globalObject, callFrame, 1, WTF::UTCTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMonth(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetMonth(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromDateArgs(exec, 2, WTF::LocalTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromDateArgs(globalObject, callFrame, 2, WTF::LocalTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMonth(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCMonth(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromDateArgs(exec, 2, WTF::UTCTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromDateArgs(globalObject, callFrame, 2, WTF::UTCTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetFullYear(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetFullYear(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromDateArgs(exec, 3, WTF::LocalTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromDateArgs(globalObject, callFrame, 3, WTF::LocalTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCFullYear(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetUTCFullYear(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     return setNewValueFromDateArgs(exec, 3, WTF::UTCTime);</span>
<span class="udiff-line-modified-added">+     return setNewValueFromDateArgs(globalObject, callFrame, 3, WTF::UTCTime);</span>
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncSetYear(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncSetYear(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     if (!exec-&gt;argumentCount()) {</span>
<span class="udiff-line-modified-added">+     if (!callFrame-&gt;argumentCount()) {</span>
          thisDateObj-&gt;setInternalNumber(PNaN);
          return JSValue::encode(jsNaN());
      }
  
      double milli = thisDateObj-&gt;internalNumber();
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1107,15 +1106,15 @@</span>
          // the time must be reset to +0 if it is NaN.
          msToGregorianDateTime(vm, 0, WTF::UTCTime, gregorianDateTime);
      else {
          double secs = floor(milli / msPerSecond);
          ms = milli - secs * msPerSecond;
<span class="udiff-line-modified-removed">-         if (const GregorianDateTime* other = thisDateObj-&gt;gregorianDateTime(exec))</span>
<span class="udiff-line-modified-removed">-             gregorianDateTime.copyFrom(*other);</span>
<span class="udiff-line-modified-added">+         if (const GregorianDateTime* other = thisDateObj-&gt;gregorianDateTime(vm))</span>
<span class="udiff-line-modified-added">+             gregorianDateTime = *other;</span>
      }
  
<span class="udiff-line-modified-removed">-     double year = exec-&gt;argument(0).toIntegerPreserveNaN(exec);</span>
<span class="udiff-line-modified-added">+     double year = callFrame-&gt;argument(0).toIntegerPreserveNaN(globalObject);</span>
      RETURN_IF_EXCEPTION(scope, encodedJSValue());
      if (!std::isfinite(year)) {
          thisDateObj-&gt;setInternalNumber(PNaN);
          return JSValue::encode(jsNaN());
      }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1125,49 +1124,49 @@</span>
      double result = timeClip(timeInMilliseconds);
      thisDateObj-&gt;setInternalNumber(result);
      return JSValue::encode(jsNumber(result));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncGetYear(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncGetYear(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
      auto* thisDateObj = jsDynamicCast&lt;DateInstance*&gt;(vm, thisValue);
      if (UNLIKELY(!thisDateObj))
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope);</span>
  
<span class="udiff-line-modified-removed">-     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(exec);</span>
<span class="udiff-line-modified-added">+     const GregorianDateTime* gregorianDateTime = thisDateObj-&gt;gregorianDateTime(vm);</span>
      if (!gregorianDateTime)
          return JSValue::encode(jsNaN());
  
      // NOTE: IE returns the full year even in getYear.
      return JSValue::encode(jsNumber(gregorianDateTime-&gt;year() - 1900));
  }
  
<span class="udiff-line-modified-removed">- EncodedJSValue JSC_HOST_CALL dateProtoFuncToJSON(ExecState* exec)</span>
<span class="udiff-line-modified-added">+ EncodedJSValue JSC_HOST_CALL dateProtoFuncToJSON(JSGlobalObject* globalObject, CallFrame* callFrame)</span>
  {
<span class="udiff-line-modified-removed">-     VM&amp; vm = exec-&gt;vm();</span>
<span class="udiff-line-modified-added">+     VM&amp; vm = globalObject-&gt;vm();</span>
      auto scope = DECLARE_THROW_SCOPE(vm);
<span class="udiff-line-modified-removed">-     JSValue thisValue = exec-&gt;thisValue();</span>
<span class="udiff-line-modified-removed">-     JSObject* object = jsCast&lt;JSObject*&gt;(thisValue.toThis(exec, NotStrictMode));</span>
<span class="udiff-line-modified-added">+     JSValue thisValue = callFrame-&gt;thisValue();</span>
<span class="udiff-line-modified-added">+     JSObject* object = thisValue.toObject(globalObject);</span>
      RETURN_IF_EXCEPTION(scope, encodedJSValue());
  
<span class="udiff-line-modified-removed">-     JSValue timeValue = object-&gt;toPrimitive(exec, PreferNumber);</span>
<span class="udiff-line-modified-added">+     JSValue timeValue = object-&gt;toPrimitive(globalObject, PreferNumber);</span>
      RETURN_IF_EXCEPTION(scope, encodedJSValue());
<span class="udiff-line-modified-removed">-     if (timeValue.isNumber() &amp;&amp; !(timeValue.isInt32() || std::isfinite(timeValue.asDouble())))</span>
<span class="udiff-line-modified-added">+     if (timeValue.isNumber() &amp;&amp; !std::isfinite(timeValue.asNumber()))</span>
          return JSValue::encode(jsNull());
  
<span class="udiff-line-modified-removed">-     JSValue toISOValue = object-&gt;get(exec, vm.propertyNames-&gt;toISOString);</span>
<span class="udiff-line-modified-added">+     JSValue toISOValue = object-&gt;get(globalObject, vm.propertyNames-&gt;toISOString);</span>
      RETURN_IF_EXCEPTION(scope, encodedJSValue());
  
      CallData callData;
      CallType callType = getCallData(vm, toISOValue, callData);
      if (callType == CallType::None)
<span class="udiff-line-modified-removed">-         return throwVMTypeError(exec, scope, &quot;toISOString is not a function&quot;_s);</span>
<span class="udiff-line-modified-added">+         return throwVMTypeError(globalObject, scope, &quot;toISOString is not a function&quot;_s);</span>
  
<span class="udiff-line-modified-removed">-     JSValue result = call(exec, asObject(toISOValue), callType, callData, object, *vm.emptyList);</span>
<span class="udiff-line-modified-added">+     JSValue result = call(globalObject, asObject(toISOValue), callType, callData, object, *vm.emptyList);</span>
      RETURN_IF_EXCEPTION(scope, encodedJSValue());
      return JSValue::encode(result);
  }
  
  } // namespace JSC
</pre>
<center><a href="DateInstanceCache.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DatePrototype.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>