<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/dom/MouseRelatedEvent.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (C) 2001 Peter Kelly (pmk@post.com)
  3  * Copyright (C) 2001 Tobias Anton (anton@stud.fbi.fh-darmstadt.de)
  4  * Copyright (C) 2006 Samuel Weinig (sam.weinig@gmail.com)
  5  * Copyright (C) 2003, 2004, 2005, 2006, 2013 Apple Inc.
  6  *
  7  * This library is free software; you can redistribute it and/or
  8  * modify it under the terms of the GNU Library General Public
  9  * License as published by the Free Software Foundation; either
 10  * version 2 of the License, or (at your option) any later version.
 11  *
 12  * This library is distributed in the hope that it will be useful,
 13  * but WITHOUT ANY WARRANTY; without even the implied warranty of
 14  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 15  * Library General Public License for more details.
 16  *
 17  * You should have received a copy of the GNU Library General Public License
 18  * along with this library; see the file COPYING.LIB.  If not, write to
 19  * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 20  * Boston, MA 02110-1301, USA.
 21  *
 22  */
 23 
 24 #pragma once
 25 
 26 #include &quot;LayoutPoint.h&quot;
 27 #include &quot;UIEventWithKeyState.h&quot;
 28 
 29 namespace WebCore {
 30 
 31 class FrameView;
 32 
 33 struct MouseRelatedEventInit : public EventModifierInit {
 34     int screenX { 0 };
 35     int screenY { 0 };
 36 };
 37 
 38 // Internal only: Helper class for what&#39;s common between mouse and wheel events.
 39 class MouseRelatedEvent : public UIEventWithKeyState {
<a name="1" id="anc1"></a><span class="line-added"> 40     WTF_MAKE_ISO_ALLOCATED(MouseRelatedEvent);</span>
 41 public:
 42     enum class IsSimulated : uint8_t { Yes, No };
 43 
 44     // Note that these values are adjusted to counter the effects of zoom, so that values
 45     // exposed via DOM APIs are invariant under zooming.
 46     int screenX() const { return m_screenLocation.x(); }
 47     int screenY() const { return m_screenLocation.y(); }
 48     const IntPoint&amp; screenLocation() const { return m_screenLocation; }
 49     int clientX() const { return m_clientLocation.x(); }
 50     int clientY() const { return m_clientLocation.y(); }
 51 #if ENABLE(POINTER_LOCK)
 52     int movementX() const { return m_movementDelta.x(); }
 53     int movementY() const { return m_movementDelta.y(); }
 54 #endif
 55     const LayoutPoint&amp; clientLocation() const { return m_clientLocation; }
 56     int layerX() override;
 57     int layerY() override;
 58     WEBCORE_EXPORT int offsetX();
 59     WEBCORE_EXPORT int offsetY();
 60     bool isSimulated() const { return m_isSimulated; }
 61     void setIsSimulated(bool value) { m_isSimulated = value; }
 62     int pageX() const final;
 63     int pageY() const final;
 64     FloatPoint locationInRootViewCoordinates() const;
 65     virtual const LayoutPoint&amp; pageLocation() const;
 66     WEBCORE_EXPORT int x() const;
 67     WEBCORE_EXPORT int y() const;
 68 
 69     // Page point in &quot;absolute&quot; coordinates (i.e. post-zoomed, page-relative coords,
 70     // usable with RenderObject::absoluteToLocal).
 71     const LayoutPoint&amp; absoluteLocation() const { return m_absoluteLocation; }
 72 
 73     static FrameView* frameViewFromWindowProxy(WindowProxy*);
 74 
 75     static LayoutPoint pagePointToClientPoint(LayoutPoint pagePoint, FrameView*);
 76     static LayoutPoint pagePointToAbsolutePoint(LayoutPoint pagePoint, FrameView*);
 77 
 78 protected:
 79     MouseRelatedEvent() = default;
 80     MouseRelatedEvent(const AtomString&amp; type, CanBubble, IsCancelable, IsComposed, MonotonicTime, RefPtr&lt;WindowProxy&gt;&amp;&amp;, int detail,
 81         const IntPoint&amp; screenLocation, const IntPoint&amp; windowLocation, const IntPoint&amp; movementDelta, OptionSet&lt;Modifier&gt; modifiers,
 82         IsSimulated = IsSimulated::No, IsTrusted = IsTrusted::Yes);
 83     MouseRelatedEvent(const AtomString&amp; type, IsCancelable, MonotonicTime, RefPtr&lt;WindowProxy&gt;&amp;&amp;, const IntPoint&amp; globalLocation, OptionSet&lt;Modifier&gt;);
 84     MouseRelatedEvent(const AtomString&amp; type, const MouseRelatedEventInit&amp;, IsTrusted = IsTrusted::No);
 85 
 86     void initCoordinates();
 87     void initCoordinates(const LayoutPoint&amp; clientLocation);
 88     void receivedTarget() final;
 89 
 90     void computePageLocation();
 91     void computeRelativePosition();
 92 
 93     float documentToAbsoluteScaleFactor() const;
 94 
 95     // Expose these so MouseEvent::initMouseEvent can set them.
 96     IntPoint m_screenLocation;
 97     LayoutPoint m_clientLocation;
 98 #if ENABLE(POINTER_LOCK)
 99     LayoutPoint m_movementDelta;
100 #endif
101 
102 private:
103     void init(bool isSimulated, const IntPoint&amp;);
104 
105     LayoutPoint m_pageLocation;
106     LayoutPoint m_layerLocation;
107     LayoutPoint m_offsetLocation;
108     LayoutPoint m_absoluteLocation;
109     bool m_isSimulated { false };
110     bool m_hasCachedRelativePosition { false };
111 };
112 
113 } // namespace WebCore
<a name="2" id="anc2"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="2" type="hidden" />
</body>
</html>