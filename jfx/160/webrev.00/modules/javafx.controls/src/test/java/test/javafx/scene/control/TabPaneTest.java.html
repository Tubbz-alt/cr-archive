<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.controls/src/test/java/test/javafx/scene/control/TabPaneTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
   1 /*
   2  * Copyright (c) 2010, 2020, Oracle and/or its affiliates. All rights reserved.
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 package test.javafx.scene.control;
  27 
  28 import com.sun.javafx.scene.SceneHelper;
  29 import static test.com.sun.javafx.scene.control.infrastructure.ControlTestUtils.assertPseudoClassDoesNotExist;
  30 import static test.com.sun.javafx.scene.control.infrastructure.ControlTestUtils.assertPseudoClassExists;
  31 import static test.com.sun.javafx.scene.control.infrastructure.ControlTestUtils.assertStyleClassContains;
  32 import static org.junit.Assert.assertEquals;
  33 import static org.junit.Assert.assertFalse;
  34 import static org.junit.Assert.assertNotNull;
  35 import static org.junit.Assert.assertNull;
  36 import static org.junit.Assert.assertSame;
  37 import static org.junit.Assert.assertTrue;
  38 import static org.junit.Assert.fail;
  39 
  40 import test.com.sun.javafx.scene.control.infrastructure.StageLoader;
  41 import javafx.application.Platform;
  42 import javafx.beans.property.BooleanProperty;
  43 import javafx.beans.property.DoubleProperty;
  44 import javafx.beans.property.ObjectProperty;
  45 import javafx.beans.property.SimpleBooleanProperty;
  46 import javafx.beans.property.SimpleDoubleProperty;
  47 import javafx.beans.property.SimpleObjectProperty;
  48 import javafx.beans.value.ChangeListener;
  49 import javafx.css.CssMetaData;
  50 import javafx.css.StyleableProperty;
  51 import javafx.event.Event;
  52 import javafx.geometry.Bounds;
  53 import javafx.geometry.Side;
  54 import javafx.scene.Group;
  55 import javafx.scene.Scene;
  56 import javafx.scene.input.KeyEvent;
  57 import javafx.scene.input.MouseEvent;
  58 import javafx.scene.layout.StackPane;
  59 import javafx.scene.layout.VBox;
  60 import javafx.stage.Stage;
  61 
  62 import org.junit.Before;
  63 import org.junit.Ignore;
  64 import org.junit.Test;
  65 
  66 import test.com.sun.javafx.pgstub.StubToolkit;
  67 import test.com.sun.javafx.scene.control.infrastructure.KeyEventFirer;
  68 import test.com.sun.javafx.scene.control.infrastructure.MouseEventGenerator;
  69 import com.sun.javafx.scene.input.KeyCodeMap;
  70 import com.sun.javafx.tk.Toolkit;
  71 
  72 import java.util.Arrays;
  73 import java.util.HashMap;
  74 import java.util.LinkedList;
  75 import java.util.List;
  76 import java.util.Map;
  77 import javafx.scene.control.Button;
  78 import javafx.scene.control.ContextMenu;
  79 import javafx.scene.control.ScrollPane;
  80 import javafx.scene.control.SingleSelectionModel;
  81 import javafx.scene.control.SingleSelectionModelShim;
  82 import javafx.scene.control.skin.TabPaneSkin;
  83 import javafx.scene.control.skin.TabPaneSkinShim;
  84 import javafx.scene.control.SplitPane;
  85 import javafx.scene.control.Tab;
  86 import javafx.scene.control.TabPane;
  87 import javafx.scene.control.TabPaneShim;
  88 
  89 import java.lang.ref.WeakReference;
  90 
  91 public class TabPaneTest {
  92     private TabPane tabPane;//Empty string
  93     private Toolkit tk;
  94     private SingleSelectionModel&lt;Tab&gt; sm;
  95     private Tab tab1;
  96     private Tab tab2;
  97     private Tab tab3;
  98     private Scene scene;
  99     private Stage stage;
 100     private StackPane root;
 101 
 102     @Before public void setup() {
 103         tk = (StubToolkit)Toolkit.getToolkit();//This step is not needed (Just to make sure StubToolkit is loaded into VM)
 104         tabPane = new TabPane();
 105         tab1 = new Tab(&quot;one&quot;);
 106         tab2 = new Tab(&quot;two&quot;);
 107         tab3 = new Tab(&quot;three&quot;);
 108         sm = TabPaneShim.getTabPaneSelectionModel(tabPane);
 109         root = new StackPane();
 110         scene = new Scene(root);
 111         stage = new Stage();
 112         stage.setScene(scene);
 113     }
 114 
 115     /*********************************************************************
 116      * Helper methods                                                    *
 117      ********************************************************************/
 118 
 119     private void show() {
 120         stage.show();
 121         stage.requestFocus();
 122     }
 123 
 124     /*********************************************************************
 125      * Tests for default values                                         *
 126      ********************************************************************/
 127 
 128     @Test public void defaultConstructorShouldSetStyleClassTo_tabpane() {
 129         assertStyleClassContains(tabPane, &quot;tab-pane&quot;);
 130     }
 131 
 132     @Test public void defaultConstructorSelectionModelNotNull() {
 133         assertNotNull(tabPane.getSelectionModel());
 134     }
 135 
 136     @Test public void defaultConstructorInitialTabsEmpty() {
 137         assertNotNull(tabPane.getTabs());
 138         assertEquals(tabPane.getTabs().size(), 0.0, 0.0);
 139     }
 140 
 141     @Test public void defaultSideIsTop() {
 142         assertSame(tabPane.getSide(), Side.TOP);
 143     }
 144 
 145     @Test public void defaultConstructorTabClosingPolicy() {
 146         assertNotNull(tabPane.getTabClosingPolicy());
 147         assertSame(tabPane.getTabClosingPolicy(), TabPane.TabClosingPolicy.SELECTED_TAB);
 148     }
 149 
 150     @Test public void defaultConstructorRotateGraphic() {
 151         assertFalse(tabPane.isRotateGraphic());
 152     }
 153 
 154     @Test public void defaultTabMinWidth() {
 155         assertEquals(tabPane.getTabMinWidth(), 0.0, 0.0);
 156     }
 157 
 158     @Test public void defaultTabMaxWidth() {
 159         assertEquals(tabPane.getTabMaxWidth(), Double.MAX_VALUE, 0.0);
 160     }
 161 
 162     @Test public void defaultTabMinHeight() {
 163         assertEquals(tabPane.getTabMinHeight(), 0.0, 0.0);
 164     }
 165 
 166     @Test public void defaultTabMaxHeight() {
 167         assertEquals(tabPane.getTabMaxHeight(), Double.MAX_VALUE, 0.0);
 168     }
 169 
 170     @Test public void defaultSelectionModelEmpty() {
 171         assertTrue(tabPane.getSelectionModel().isEmpty());
 172     }
 173 
 174     @Test public void initialBoundsInParentMatchesWidthAndHeight() {
 175         TabPane testPane = new TabPane();
 176         testPane.resize(400, 400);
 177         testPane.setSkin(new TabPaneSkin(testPane));
 178         Bounds boundsInParent = testPane.getBoundsInParent();
 179         assertEquals(testPane.getWidth(), boundsInParent.getWidth(), 0.0);
 180         assertEquals(testPane.getHeight(), boundsInParent.getHeight(), 0.0);
 181     }
 182 
 183     /*********************************************************************
 184      * Tests for property binding                                        *
 185      ********************************************************************/
 186 
 187     @Test public void checkSelectionModelPropertyBind() {
 188         ObjectProperty objPr = new SimpleObjectProperty&lt;SingleSelectionModel&lt;Tab&gt;&gt;(null);
 189         tabPane.selectionModelProperty().bind(objPr);
 190         assertNull(&quot;selectionModel cannot be bound&quot;, tabPane.selectionModelProperty().getValue());
 191         objPr.setValue(sm);
 192         assertSame(&quot;selectionModel cannot be bound&quot;, tabPane.selectionModelProperty().getValue(), sm);
 193     }
 194 
 195     @Test public void checkSidePropertyBind() {
 196         ObjectProperty objPr = new SimpleObjectProperty&lt;Side&gt;(Side.BOTTOM);
 197         tabPane.sideProperty().bind(objPr);
 198         assertSame(&quot;side cannot be bound&quot;, tabPane.sideProperty().getValue(), Side.BOTTOM);
 199         objPr.setValue(Side.RIGHT);
 200         assertSame(&quot;side cannot be bound&quot;, tabPane.sideProperty().getValue(), Side.RIGHT);
 201     }
 202 
 203     @Test public void checkTabClosingPropertyBind() {
 204         ObjectProperty objPr = new SimpleObjectProperty&lt;TabPane.TabClosingPolicy&gt;(TabPane.TabClosingPolicy.UNAVAILABLE);
 205         tabPane.tabClosingPolicyProperty().bind(objPr);
 206         assertSame(&quot;side cannot be bound&quot;, tabPane.tabClosingPolicyProperty().getValue(), TabPane.TabClosingPolicy.UNAVAILABLE);
 207         objPr.setValue(TabPane.TabClosingPolicy.ALL_TABS);
 208         assertSame(&quot;side cannot be bound&quot;, tabPane.tabClosingPolicyProperty().getValue(), TabPane.TabClosingPolicy.ALL_TABS);
 209     }
 210 
 211     @Test public void checkRotateGraphicsPropertyBind() {
 212         BooleanProperty objPr = new SimpleBooleanProperty(false);
 213         tabPane.rotateGraphicProperty().bind(objPr);
 214         assertFalse(&quot;rotateGraphic cannot be bound&quot;, tabPane.rotateGraphicProperty().getValue());
 215         objPr.setValue(true);
 216         assertTrue(&quot;rotateGraphic cannot be bound&quot;, tabPane.rotateGraphicProperty().getValue());
 217     }
 218 
 219     @Test public void checkTabMinWidthPropertyBind() {
 220         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 221         tabPane.tabMinWidthProperty().bind(objPr);
 222         assertEquals(&quot;tabMinWidthProperty cannot be bound&quot;, tabPane.tabMinWidthProperty().getValue(), 2.0, 0.0);
 223         objPr.setValue(5.0);
 224         assertEquals(&quot;tabMinWidthProperty cannot be bound&quot;, tabPane.tabMinWidthProperty().getValue(), 5.0, 0.0);
 225     }
 226 
 227     @Test public void checkTabMaxWidthPropertyBind() {
 228         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 229         tabPane.tabMaxWidthProperty().bind(objPr);
 230         assertEquals(&quot;tabMaxWidthProperty cannot be bound&quot;, tabPane.tabMaxWidthProperty().getValue(), 2.0, 0.0);
 231         objPr.setValue(5.0);
 232         assertEquals(&quot;tabMaxWidthProperty cannot be bound&quot;, tabPane.tabMaxWidthProperty().getValue(), 5.0, 0.0);
 233     }
 234 
 235 
 236     @Test public void checkTabMinHeightPropertyBind() {
 237         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 238         tabPane.tabMinHeightProperty().bind(objPr);
 239         assertEquals(&quot;tabMinHeightProperty cannot be bound&quot;, tabPane.tabMinHeightProperty().getValue(), 2.0, 0.0);
 240         objPr.setValue(5.0);
 241         assertEquals(&quot;tabMinHeightProperty cannot be bound&quot;, tabPane.tabMinHeightProperty().getValue(), 5.0, 0.0);
 242     }
 243 
 244     @Test public void checkTabMaxHeightPropertyBind() {
 245         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 246         tabPane.tabMaxHeightProperty().bind(objPr);
 247         assertEquals(&quot;tabMaxHeightProperty cannot be bound&quot;, tabPane.tabMaxHeightProperty().getValue(), 2.0, 0.0);
 248         objPr.setValue(5.0);
 249         assertEquals(&quot;tabMaxHeightProperty cannot be bound&quot;, tabPane.tabMaxHeightProperty().getValue(), 5.0, 0.0);
 250     }
 251 
 252     @Test public void selectionModelPropertyHasBeanReference() {
 253         assertSame(tabPane, tabPane.selectionModelProperty().getBean());
 254     }
 255 
 256     @Test public void selectionModelPropertyHasName() {
 257         assertEquals(&quot;selectionModel&quot;, tabPane.selectionModelProperty().getName());
 258     }
 259 
 260     @Test public void sidePropertyHasBeanReference() {
 261         assertSame(tabPane, tabPane.sideProperty().getBean());
 262     }
 263 
 264     @Test public void sidePropertyHasName() {
 265         assertEquals(&quot;side&quot;, tabPane.sideProperty().getName());
 266     }
 267 
 268     @Test public void tabClosingPolicyPropertyHasBeanReference() {
 269         assertSame(tabPane, tabPane.tabClosingPolicyProperty().getBean());
 270     }
 271 
 272     @Test public void tabClosingPolicyPropertyHasName() {
 273         assertEquals(&quot;tabClosingPolicy&quot;, tabPane.tabClosingPolicyProperty().getName());
 274     }
 275 
 276     @Test public void rotateGraphicPropertyHasBeanReference() {
 277         assertSame(tabPane, tabPane.rotateGraphicProperty().getBean());
 278     }
 279 
 280     @Test public void rotateGraphicPropertyHasName() {
 281         assertEquals(&quot;rotateGraphic&quot;, tabPane.rotateGraphicProperty().getName());
 282     }
 283 
 284     @Test public void tabMinWidthPropertyHasBeanReference() {
 285         assertSame(tabPane, tabPane.tabMinWidthProperty().getBean());
 286     }
 287 
 288     @Test public void tabMinWidthPropertyHasName() {
 289         assertEquals(&quot;tabMinWidth&quot;, tabPane.tabMinWidthProperty().getName());
 290     }
 291 
 292     @Test public void tabMaxWidthPropertyHasBeanReference() {
 293         assertSame(tabPane, tabPane.tabMaxWidthProperty().getBean());
 294     }
 295 
 296     @Test public void tabMaxWidthPropertyHasName() {
 297         assertEquals(&quot;tabMaxWidth&quot;, tabPane.tabMaxWidthProperty().getName());
 298     }
 299 
 300     @Test public void tabMinHeightPropertyHasBeanReference() {
 301         assertSame(tabPane, tabPane.tabMinHeightProperty().getBean());
 302     }
 303 
 304     @Test public void tabMinHeightPropertyHasName() {
 305         assertEquals(&quot;tabMinHeight&quot;, tabPane.tabMinHeightProperty().getName());
 306     }
 307 
 308     @Test public void tabMaxHeightPropertyHasBeanReference() {
 309         assertSame(tabPane, tabPane.tabMaxHeightProperty().getBean());
 310     }
 311 
 312     @Test public void tabMaxHeightPropertyHasName() {
 313         assertEquals(&quot;tabMaxHeight&quot;, tabPane.tabMaxHeightProperty().getName());
 314     }
 315 
 316 
 317     /*********************************************************************
 318      * Check for Pseudo classes                                          *
 319      ********************************************************************/
 320 
 321     @Test public void settingSideSetsPseudoClass() {
 322         tabPane.setSide(Side.BOTTOM);
 323         assertPseudoClassExists(tabPane, &quot;bottom&quot;);
 324         assertPseudoClassDoesNotExist(tabPane, &quot;top&quot;);
 325         assertPseudoClassDoesNotExist(tabPane, &quot;left&quot;);
 326         assertPseudoClassDoesNotExist(tabPane, &quot;right&quot;);
 327     }
 328 
 329     @Test public void clearingSideClearsPseudoClass() {
 330         tabPane.setSide(Side.BOTTOM);
 331         tabPane.setSide(Side.LEFT);
 332         assertPseudoClassExists(tabPane, &quot;left&quot;);
 333         assertPseudoClassDoesNotExist(tabPane, &quot;bottom&quot;);
 334         assertPseudoClassDoesNotExist(tabPane, &quot;top&quot;);
 335         assertPseudoClassDoesNotExist(tabPane, &quot;right&quot;);
 336     }
 337 
 338 
 339     /*********************************************************************
 340      * CSS related Tests                                                 *
 341      ********************************************************************/
 342 
 343     @Test public void whenTabMinWidthIsBound_impl_cssSettable_ReturnsFalse() {
 344         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinWidthProperty()).getCssMetaData();
 345         assertTrue(styleable.isSettable(tabPane));
 346         DoubleProperty other = new SimpleDoubleProperty(30.0);
 347         tabPane.tabMinWidthProperty().bind(other);
 348         assertFalse(styleable.isSettable(tabPane));
 349     }
 350 
 351     @Test public void whenTabMinWidthIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 352         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinWidthProperty()).getCssMetaData();
 353         assertTrue(styleable.isSettable(tabPane));
 354     }
 355 
 356     @Test public void canSpecifyTabMinWidthViaCSS() {
 357         ((StyleableProperty)tabPane.tabMinWidthProperty()).applyStyle(null, 34.0);
 358         assertEquals(34.0, tabPane.getTabMinWidth(), 0.0);
 359     }
 360 
 361     @Test public void whenTabMaxWidthIsBound_impl_cssSettable_ReturnsFalse() {
 362         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxWidthProperty()).getCssMetaData();
 363         assertTrue(styleable.isSettable(tabPane));
 364         DoubleProperty other = new SimpleDoubleProperty(30.0);
 365         tabPane.tabMaxWidthProperty().bind(other);
 366         assertFalse(styleable.isSettable(tabPane));
 367     }
 368 
 369     @Test public void whenTabMaxWidthIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 370         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxWidthProperty()).getCssMetaData();
 371         assertTrue(styleable.isSettable(tabPane));
 372     }
 373 
 374     @Test public void canSpecifyTabMaxWidthViaCSS() {
 375         ((StyleableProperty)tabPane.tabMaxWidthProperty()).applyStyle(null, 34.0);
 376         assertEquals(34.0, tabPane.getTabMaxWidth(), 0.0);
 377     }
 378 
 379     @Test public void whenTabMinHeightIsBound_impl_cssSettable_ReturnsFalse() {
 380         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinHeightProperty()).getCssMetaData();
 381         assertTrue(styleable.isSettable(tabPane));
 382         DoubleProperty other = new SimpleDoubleProperty(30.0);
 383         tabPane.tabMinHeightProperty().bind(other);
 384         assertFalse(styleable.isSettable(tabPane));
 385     }
 386 
 387     @Test public void whenTabMinHeightIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 388         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinHeightProperty()).getCssMetaData();
 389         assertTrue(styleable.isSettable(tabPane));
 390     }
 391 
 392     @Test public void canSpecifyTabMinHeightViaCSS() {
 393         ((StyleableProperty)tabPane.tabMinHeightProperty()).applyStyle(null, 34.0);
 394         assertEquals(34.0, tabPane.getTabMinHeight(), 0.0);
 395     }
 396 
 397     @Test public void whenTabMaxHeightIsBound_impl_cssSettable_ReturnsFalse() {
 398         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxHeightProperty()).getCssMetaData();
 399         assertTrue(styleable.isSettable(tabPane));
 400         DoubleProperty other = new SimpleDoubleProperty(30.0);
 401         tabPane.tabMaxHeightProperty().bind(other);
 402         assertFalse(styleable.isSettable(tabPane));
 403     }
 404 
 405     @Test public void whenTabMaxHeightIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 406         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxHeightProperty()).getCssMetaData();
 407         assertTrue(styleable.isSettable(tabPane));
 408     }
 409 
 410     @Test public void canSpecifyTabMaxHeightViaCSS() {
 411         ((StyleableProperty)tabPane.tabMaxHeightProperty()).applyStyle(null, 34.0);
 412         assertEquals(34.0, tabPane.getTabMaxHeight(), 0.0);
 413     }
 414 
 415 
 416     /*********************************************************************
 417      * Miscellaneous Tests                                               *
 418      ********************************************************************/
 419 
 420     @Test public void setSelectionModelAndSeeValueIsReflectedInModel() {
 421         tabPane.setSelectionModel(sm);
 422         assertSame(tabPane.selectionModelProperty().getValue(), sm);
 423     }
 424 
 425     @Test public void setselectionModelAndSeeValue() {
 426         tabPane.setSelectionModel(sm);
 427         assertSame(tabPane.getSelectionModel(), sm);
 428     }
 429 
 430     @Test public void setSideAndSeeValueIsReflectedInModel() {
 431         tabPane.setSide(Side.BOTTOM);
 432         assertSame(tabPane.sideProperty().getValue(), Side.BOTTOM);
 433     }
 434 
 435     @Test public void setSideAndSeeValue() {
 436         tabPane.setSide(Side.LEFT);
 437         assertSame(tabPane.getSide(), Side.LEFT);
 438     }
 439 
 440     @Test public void setTabClosingPolicyAndSeeValueIsReflectedInModel() {
 441         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.ALL_TABS);
 442         assertSame(tabPane.tabClosingPolicyProperty().getValue(), TabPane.TabClosingPolicy.ALL_TABS);
 443     }
 444 
 445     @Test public void setTabClosingPolicyAndSeeValue() {
 446         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.UNAVAILABLE);
 447         assertSame(tabPane.getTabClosingPolicy(), TabPane.TabClosingPolicy.UNAVAILABLE);
 448     }
 449 
 450     @Test public void setTabDragPolicyAndSeeValueIsReflectedInModel() {
 451         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.REORDER);
 452         assertSame(TabPane.TabDragPolicy.REORDER, tabPane.tabDragPolicyProperty().getValue());
 453 
 454         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.FIXED);
 455         assertSame(TabPane.TabDragPolicy.FIXED, tabPane.tabDragPolicyProperty().getValue());
 456     }
 457 
 458     @Test public void setTabDragPolicyAndSeeValue() {
 459         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.REORDER);
 460         assertSame(TabPane.TabDragPolicy.REORDER, tabPane.getTabDragPolicy());
 461 
 462         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.FIXED);
 463         assertSame(TabPane.TabDragPolicy.FIXED, tabPane.getTabDragPolicy());
 464     }
 465 
 466     @Test public void tabDragPolicyReorderAndAsymmetricMouseEvent() {
 467         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.REORDER);
 468         tabPane.getTabs().add(tab1);
 469         tabPane.getTabs().add(tab2);
 470         root.getChildren().add(tabPane);
 471         show();
 472 
 473         root.layout();
 474 
 475         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
 476         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
 477 
 478         SceneHelper.processMouseEvent(scene,
 479             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_RELEASED, xval+75, yval+20));
 480         tk.firePulse();
 481 
 482         SceneHelper.processMouseEvent(scene,
 483                 MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_DRAGGED, xval+75, yval+20));
 484         tk.firePulse();
 485     }
 486 
 487     @Test public void setRotateGraphicAndSeeValueIsReflectedInModel() {
 488         tabPane.setRotateGraphic(true);
 489         assertTrue(tabPane.rotateGraphicProperty().getValue());
 490     }
 491 
 492     @Test public void setRotateGraphicAndSeeValue() {
 493         tabPane.setRotateGraphic(true);
 494         assertTrue(tabPane.isRotateGraphic());
 495     }
 496 
 497     @Test public void setTabMinWidthAndSeeValueIsReflectedInModel() {
 498         tabPane.setTabMinWidth(30.0);
 499         assertEquals(tabPane.tabMinWidthProperty().getValue(), 30.0, 0.0);
 500     }
 501 
 502     @Test public void setTabMinWidthAndSeeValue() {
 503         tabPane.setTabMinWidth(30.0);
 504         assertEquals(tabPane.getTabMinWidth(), 30.0, 0.0);
 505     }
 506 
 507     @Test public void setTabMaxWidthAndSeeValueIsReflectedInModel() {
 508         tabPane.setTabMaxWidth(30.0);
 509         assertEquals(tabPane.tabMaxWidthProperty().getValue(), 30.0, 0.0);
 510     }
 511 
 512     @Test public void setTabMaxWidthAndSeeValue() {
 513         tabPane.setTabMaxWidth(30.0);
 514         assertEquals(tabPane.getTabMaxWidth(), 30.0, 0.0);
 515     }
 516 
 517     @Test public void setTabMinHeightAndSeeValueIsReflectedInModel() {
 518         tabPane.setTabMinHeight(30.0);
 519         assertEquals(tabPane.tabMinHeightProperty().getValue(), 30.0, 0.0);
 520     }
 521 
 522     @Test public void setTabMinHeightAndSeeValue() {
 523         tabPane.setTabMinHeight(30.0);
 524         assertEquals(tabPane.getTabMinHeight(), 30.0, 0.0);
 525     }
 526 
 527     @Test public void setTabMaxHeightAndSeeValueIsReflectedInModel() {
 528         tabPane.setTabMaxHeight(30.0);
 529         assertEquals(tabPane.tabMaxHeightProperty().getValue(), 30.0, 0.0);
 530     }
 531 
 532     @Test public void setTabMaxHeightAndSeeValue() {
 533         tabPane.setTabMaxHeight(30.0);
 534         assertEquals(tabPane.getTabMaxHeight(), 30.0, 0.0);
 535     }
 536 
 537     @Test public void addTabsCheckItemCountInSelectionModel() {
 538         tabPane.getTabs().add(tab1);
 539         tabPane.getTabs().add(tab2);
 540         assertEquals(SingleSelectionModelShim.getItemCount(tabPane.getSelectionModel()), 2.0, 0.0);
 541     }
 542 
 543     @Test public void addTabsCheckItemInSelectionModel() {
 544         tabPane.getTabs().add(tab1);
 545         tabPane.getTabs().add(tab2);
 546         assertSame(SingleSelectionModelShim.getModelItem(tabPane.getSelectionModel(), 0), tab1);
 547         assertSame(SingleSelectionModelShim.getModelItem(tabPane.getSelectionModel(), 1), tab2);
 548     }
 549 
 550     @Test public void addTabsCheckSelectUsingObjInSelectionModel() {
 551         tabPane.getTabs().add(tab1);
 552         tabPane.getTabs().add(tab2);
 553         tabPane.getSelectionModel().select(tab1);
 554         assertTrue(tabPane.getSelectionModel().isSelected(0));
 555     }
 556 
 557     @Test public void addTabsCheckSelectUsingIndexInSelectionModel() {
 558         tabPane.getTabs().add(tab1);
 559         tabPane.getTabs().add(tab2);
 560         tabPane.getSelectionModel().select(1);
 561         assertTrue(tabPane.getSelectionModel().isSelected(1));
 562     }
 563 
 564     @Test public void addTabsCheckClearAndSelectUsingIndexInSelectionModel() {
 565         tabPane.getTabs().add(tab1);
 566         tabPane.getTabs().add(tab2);
 567         tabPane.getSelectionModel().clearAndSelect(1);
 568         assertTrue(tabPane.getSelectionModel().isSelected(1));
 569     }
 570 
 571     @Test public void addTabsCheckSelectMultipleItemsAndClearOneItemInSelectionModel() {
 572         tabPane.getTabs().add(tab1);
 573         tabPane.getTabs().add(tab2);
 574         tabPane.getSelectionModel().select(0);
 575         tabPane.getSelectionModel().select(1);
 576         tabPane.getSelectionModel().clearSelection(0);
 577         assertFalse(tabPane.getSelectionModel().isSelected(0));
 578         assertTrue(tabPane.getSelectionModel().isSelected(1));
 579     }
 580 
 581     @Test public void addTabsCheckSelectMultipleItemsAndClearAllSelectionInSelectionModel() {
 582         tabPane.getTabs().add(tab1);
 583         tabPane.getTabs().add(tab2);
 584         tabPane.getSelectionModel().select(0);
 585         tabPane.getSelectionModel().select(1);
 586         tabPane.getSelectionModel().clearSelection();
 587         assertFalse(tabPane.getSelectionModel().isSelected(0));
 588         assertFalse(tabPane.getSelectionModel().isSelected(1));
 589         assertTrue(tabPane.getSelectionModel().isEmpty());
 590     }
 591 
 592     @Test public void addTabsCheckSelectUsingIteratorKindOfMethodsInSelectionModel() {
 593         tabPane.getTabs().add(tab1);
 594         tabPane.getTabs().add(tab2);
 595         tabPane.getSelectionModel().selectFirst();
 596         assertTrue(tabPane.getSelectionModel().isSelected(0));
 597         assertFalse(tabPane.getSelectionModel().isSelected(1));
 598         tabPane.getSelectionModel().selectNext();
 599         assertFalse(tabPane.getSelectionModel().isSelected(0));
 600         assertTrue(tabPane.getSelectionModel().isSelected(1));
 601         tabPane.getSelectionModel().clearSelection();
 602         tabPane.getSelectionModel().selectLast();
 603         assertFalse(tabPane.getSelectionModel().isSelected(0));
 604         assertTrue(tabPane.getSelectionModel().isSelected(1));
 605         tabPane.getSelectionModel().selectPrevious();
 606         assertTrue(tabPane.getSelectionModel().isSelected(0));
 607         assertFalse(tabPane.getSelectionModel().isSelected(1));
 608     }
 609 
 610     @Test public void flipTabOrder_RT20156() {
 611         tabPane.setSkin(new TabPaneSkin(tabPane));
 612         tabPane.getTabs().add(tab1);
 613         tabPane.getTabs().add(tab2);
 614         tabPane.getTabs().add(tab3);
 615 
 616         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 617         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 618         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 619 
 620         final int lastTabIndex = tabPane.getTabs().size()-1;
 621         final Tab lastTab = tabPane.getTabs().get(lastTabIndex);
 622         tabPane.getTabs().remove(lastTabIndex);
 623         tabPane.getTabs().add(0, lastTab);
 624 
 625         assertEquals(&quot;three&quot;, tabPane.getTabs().get(0).getText());
 626         assertEquals(&quot;one&quot;, tabPane.getTabs().get(1).getText());
 627         assertEquals(&quot;two&quot;, tabPane.getTabs().get(2).getText());
 628         assertTrue(tabPane.getSelectionModel().isSelected(1));
 629     }
 630 
 631     @Test public void disableAllTabs() {
 632         tabPane.setSkin(new TabPaneSkin(tabPane));
 633         tabPane.getTabs().add(tab1);
 634         tabPane.getTabs().add(tab2);
 635         tabPane.getTabs().add(tab3);
 636 
 637         tab1.setDisable(true);
 638         tab2.setDisable(true);
 639         tab3.setDisable(true);
 640 
 641         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 642         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 643     }
 644 
 645     @Test public void disableFirstTabs() {
 646         tabPane.setSkin(new TabPaneSkin(tabPane));
 647         tabPane.getTabs().add(tab1);
 648         tabPane.getTabs().add(tab2);
 649         tabPane.getTabs().add(tab3);
 650 
 651         tab1.setDisable(true);
 652         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 653         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 654     }
 655 
 656     @Test public void disableATabAndSelectItByIndex() {
 657         tabPane.setSkin(new TabPaneSkin(tabPane));
 658         tabPane.getTabs().add(tab1);
 659         tabPane.getTabs().add(tab2);
 660         tabPane.getTabs().add(tab3);
 661 
 662         tab2.setDisable(true);
 663         tabPane.getSelectionModel().select(1);
 664         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 665         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 666     }
 667 
 668     @Test public void selectByIndexADisableTab() {
 669         tabPane.setSkin(new TabPaneSkin(tabPane));
 670         tabPane.getTabs().add(tab1);
 671         tabPane.getTabs().add(tab2);
 672         tabPane.getTabs().add(tab3);
 673 
 674         tabPane.getSelectionModel().select(1);
 675         tab2.setDisable(true);
 676         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 677         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 678         assertTrue(tab2.isDisable());
 679     }
 680 
 681     @Test public void disableATabAndSelectItByTab() {
 682         tabPane.setSkin(new TabPaneSkin(tabPane));
 683         tabPane.getTabs().add(tab1);
 684         tabPane.getTabs().add(tab2);
 685         tabPane.getTabs().add(tab3);
 686 
 687         tab2.setDisable(true);
 688         tabPane.getSelectionModel().select(tab2);
 689         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 690         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 691     }
 692 
 693     @Test public void selectByTabADisableTab() {
 694         tabPane.setSkin(new TabPaneSkin(tabPane));
 695         tabPane.getTabs().add(tab1);
 696         tabPane.getTabs().add(tab2);
 697         tabPane.getTabs().add(tab3);
 698 
 699         tabPane.getSelectionModel().select(tab2);
 700         tab2.setDisable(true);
 701         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 702         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 703         assertTrue(tab2.isDisable());
 704     }
 705 
 706     @Test public void navigateOverDisableTab() {
 707         tabPane.getTabs().add(tab1);
 708         tabPane.getTabs().add(tab2);
 709         tabPane.getTabs().add(tab3);
 710 
 711         root.getChildren().add(tabPane);
 712         show();
 713         tabPane.requestFocus();
 714 
 715         assertTrue(tabPane.isFocused());
 716 
 717         tab2.setDisable(true);
 718         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 719         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 720         assertTrue(tab2.isDisable());
 721 
 722         KeyEventFirer keyboard = new KeyEventFirer(tabPane);
 723         keyboard.doRightArrowPress();
 724 
 725         assertEquals(2, tabPane.getSelectionModel().getSelectedIndex());
 726         assertEquals(tab3, tabPane.getSelectionModel().getSelectedItem());
 727 
 728         keyboard.doLeftArrowPress();
 729 
 730         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 731         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 732     }
 733 
 734     @Ignore
 735     @Test public void mousePressSelectsATab_RT20476() {
 736         tabPane.getTabs().add(tab1);
 737         tabPane.getTabs().add(tab2);
 738         tabPane.getTabs().add(tab3);
 739 
 740         tab1.setContent(new Button(&quot;TAB1&quot;));
 741         tab2.setContent(new Button(&quot;TAB2&quot;));
 742         tab3.setContent(new Button(&quot;TAB3&quot;));
 743 
 744         root.getChildren().add(tabPane);
 745         show();
 746 
 747         root.applyCss();
 748         root.resize(300, 300);
 749         root.layout();
 750 
 751         tk.firePulse();
 752         assertTrue(tabPane.isFocused());
 753 
 754         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
 755         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
 756 
 757         SceneHelper.processMouseEvent(scene,
 758             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval+75, yval+20));
 759         tk.firePulse();
 760 
 761         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 762         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 763     }
 764 
 765     private int counter = 0;
 766     @Ignore
 767     @Test public void setOnSelectionChangedFiresTwice_RT21089() {
 768         tabPane.getTabs().add(tab1);
 769         tabPane.getTabs().add(tab2);
 770 
 771         tab1.setContent(new Button(&quot;TAB1&quot;));
 772         tab2.setContent(new Button(&quot;TAB2&quot;));
 773 
 774         root.getChildren().add(tabPane);
 775         show();
 776 
 777         root.applyCss();
 778         root.resize(300, 300);
 779         root.layout();
 780 
 781         tk.firePulse();
 782         assertTrue(tabPane.isFocused());
 783 
 784         tab2.setOnSelectionChanged(event -&gt; {
 785             assertEquals(0, counter++);
 786         });
 787 
 788         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
 789         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
 790 
 791         SceneHelper.processMouseEvent(scene,
 792             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval+75, yval+20));
 793         tk.firePulse();
 794 
 795         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 796 
 797         SceneHelper.processMouseEvent(scene,
 798             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval+75, yval+20));
 799         tk.firePulse();
 800         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 801     }
 802 
 803     @Test public void unableToSelectNextTabWhenFirstTabIsClosed_RT22326() {
 804         tabPane.getTabs().add(tab1);
 805         tabPane.getTabs().add(tab2);
 806         tabPane.getTabs().add(tab3);
 807 
 808         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 809         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 810         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 811 
 812         tabPane.getTabs().remove(tab1);
 813 
 814         assertEquals(2, tabPane.getTabs().size());
 815         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 816         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 817         tabPane.getSelectionModel().selectNext();
 818         assertEquals(tab3, tabPane.getSelectionModel().getSelectedItem());
 819     }
 820 
 821     @Test public void removeFirstTabNextTabShouldBeSelected() {
 822         tabPane.getTabs().add(tab1);
 823         tabPane.getTabs().add(tab2);
 824         tabPane.getTabs().add(tab3);
 825 
 826         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 827         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 828         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 829 
 830         tabPane.getTabs().remove(tab1);
 831 
 832         assertEquals(2, tabPane.getTabs().size());
 833         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 834         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 835     }
 836 
 837     @Test public void selectionModelShouldNotBeNullWhenClosingFirstTab_RT22925() {
 838         tabPane.getTabs().add(tab1);
 839         tabPane.getTabs().add(tab2);
 840         tabPane.getTabs().add(tab3);
 841 
 842         tabPane.getSelectionModel().selectedItemProperty().addListener((ov, t, t1) -&gt; {
 843             assertEquals(t.getText(), &quot;one&quot;);
 844             assertEquals(t1.getText(), &quot;two&quot;);
 845         });
 846 
 847         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 848         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 849         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 850 
 851         tabPane.getTabs().remove(tab1);
 852 
 853         assertEquals(2, tabPane.getTabs().size());
 854         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 855         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 856     }
 857 
 858 
 859     boolean button1Focused = false;
 860     @Test public void focusTraversalShouldLookInsideEmbeddedEngines() {
 861 
 862         Button b1 = new Button(&quot;Button1&quot;);
 863         final ChangeListener&lt;Boolean&gt; focusListener = (observable, oldVal, newVal) -&gt; {
 864             button1Focused = true;
 865         };
 866         b1.focusedProperty().addListener(focusListener);
 867 
 868         final ScrollPane sp = new ScrollPane();
 869         final VBox vbox1 = new VBox();
 870         vbox1.setSpacing(10);
 871         vbox1.setTranslateX(10);
 872         vbox1.setTranslateY(10);
 873         vbox1.getChildren().addAll(b1);
 874         tab1.setContent(vbox1);
 875         sp.setContent(vbox1);
 876         tab1.setContent(sp);
 877         tabPane.getTabs().add(tab1);
 878 
 879         tabPane.getTabs().add(tab2);
 880 
 881         final Scene scene1 = new Scene(new Group(), 400, 400);
 882         ((Group)scene1.getRoot()).getChildren().add(tabPane);
 883 
 884         stage.setScene(scene1);
 885         stage.show();
 886         stage.requestFocus();
 887 
 888         final KeyEvent tabEvent = new KeyEvent(KeyEvent.KEY_PRESSED, &quot;&quot;, &quot;&quot;, KeyCodeMap.valueOf(0x09),
 889                                                          false, false, false, false);
 890         Platform.runLater(() -&gt; {
 891             tabPane.requestFocus();
 892             Event.fireEvent(tabPane, tabEvent);
 893 
 894         });
 895 
 896         assertTrue(button1Focused);
 897 
 898     }
 899 
 900     @Test public void test_rt_35013() {
 901         SplitPane splitPane = new SplitPane();
 902         splitPane.getItems().addAll(new Button(&quot;Button1&quot;), new Button(&quot;Button2&quot;));
 903 
 904         TabPane tabPane = new TabPane();
 905         Tab emptyTab;
 906         Tab splitTab = new Tab(&quot;SplitPane Tab&quot;);
 907         splitTab.setContent(splitPane);
 908         tabPane.getTabs().addAll(emptyTab = new Tab(&quot;Empty Tab&quot;), splitTab);
 909 
 910         StageLoader sl = new StageLoader(tabPane);
 911 
 912         tabPane.getSelectionModel().select(emptyTab);
 913         Toolkit.getToolkit().firePulse();
 914         assertFalse(splitPane.getParent().isVisible());
 915 
 916         tabPane.getSelectionModel().select(splitTab);
 917         Toolkit.getToolkit().firePulse();
 918         assertTrue(splitPane.getParent().isVisible());
 919 
 920         sl.dispose();
 921     }
 922 
 923     @Test public void test_rt_36456_default_selectionMovesBackwardOne() {
 924         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 925         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 926         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 927 
 928         TabPane tabPane = new TabPane();
 929         tabPane.getTabs().addAll(tab0, tab1, tab2);
 930         tabPane.getSelectionModel().select(tab1);
 931 
 932         StageLoader sl = new StageLoader(tabPane);
 933 
 934         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 935         tabPane.getTabs().remove(tab1);
 936         assertEquals(tab0, tabPane.getSelectionModel().getSelectedItem());
 937 
 938         sl.dispose();
 939     }
 940 
 941     @Test public void test_rt_36456_selectionMovesBackwardTwoSkippingDisabledTab() {
 942         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 943         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 944         tab1.setDisable(true);
 945         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 946 
 947         TabPane tabPane = new TabPane();
 948         tabPane.getTabs().addAll(tab0, tab1, tab2);
 949         tabPane.getSelectionModel().select(tab2);
 950 
 951         StageLoader sl = new StageLoader(tabPane);
 952 
 953         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 954         tabPane.getTabs().remove(tab2);
 955 
 956         // selection should jump from tab2 to tab0, as tab1 is disabled
 957         assertEquals(tab0, tabPane.getSelectionModel().getSelectedItem());
 958 
 959         sl.dispose();
 960     }
 961 
 962     @Test public void test_rt_36456_selectionMovesForwardOne() {
 963         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 964         tab0.setDisable(true);
 965         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 966         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 967 
 968         TabPane tabPane = new TabPane();
 969         tabPane.getTabs().addAll(tab0, tab1, tab2);
 970         tabPane.getSelectionModel().select(tab1);
 971 
 972         StageLoader sl = new StageLoader(tabPane);
 973 
 974         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 975         tabPane.getTabs().remove(tab1);
 976 
 977         // selection should move to the next non-disabled tab - in this case tab2
 978         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 979 
 980         sl.dispose();
 981     }
 982 
 983     @Test public void test_rt_36456_selectionMovesForwardTwoSkippingDisabledTab() {
 984         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 985         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 986         tab1.setDisable(true);
 987         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 988 
 989         TabPane tabPane = new TabPane();
 990         tabPane.getTabs().addAll(tab0, tab1, tab2);
 991         tabPane.getSelectionModel().select(tab0);
 992 
 993         StageLoader sl = new StageLoader(tabPane);
 994 
 995         Tab selectedTab = tabPane.getSelectionModel().getSelectedItem();
 996         assertEquals(tab0, selectedTab);
 997         tabPane.getTabs().remove(tab0);
 998 
 999         // selection should move to the next non-disabled tab - in this case tab2
1000         selectedTab = tabPane.getSelectionModel().getSelectedItem();
1001         assertEquals(tab2.getText() + &quot; != &quot; +  tab2.getText(), tab2, selectedTab);
1002 
1003         sl.dispose();
1004     }
1005 
1006     @Test public void test_rt_36908() {
1007         TabPane pane = new TabPane();
1008         final Tab disabled = new Tab(&quot;Disabled&quot;);
1009         disabled.setDisable(true);
1010 
1011         Tab tab1 = new Tab(&quot;Tab 1&quot;);
1012         Tab tab2 = new Tab(&quot;Tab 2&quot;);
1013         pane.getTabs().addAll(disabled, tab1, tab2);
1014 
1015         assertEquals(1, pane.getSelectionModel().getSelectedIndex());
1016         assertEquals(tab1, pane.getSelectionModel().getSelectedItem());
1017     }
1018 
1019     @Test public void test_rt_24658() {
1020         Button btn = new Button(&quot;Button&quot;);
1021         final Tab disabled = new Tab(&quot;Disabled&quot;);
1022         disabled.setContent(btn);
1023 
1024         TabPane pane = new TabPane();
1025         pane.getTabs().addAll(disabled);
1026 
1027         assertEquals(0, pane.getSelectionModel().getSelectedIndex());
1028         assertEquals(disabled, pane.getSelectionModel().getSelectedItem());
1029         assertFalse(btn.isDisabled());
1030 
1031         disabled.setDisable(true);
1032         assertTrue(btn.isDisabled());
1033 
1034         disabled.setDisable(false);
1035         assertFalse(btn.isDisabled());
1036     }
1037 
1038     @Test public void test_rt_38382_noAddToTabPane() {
1039         test_rt_38382(false);
1040     }
1041 
1042     @Test public void test_rt_38382_addToTabPane() {
1043         test_rt_38382(true);
1044     }
1045 
1046     public void test_rt_38382(boolean addToTabPane) {
1047         final List&lt;String&gt; names = Arrays.asList(
1048                 &quot;Biomass&quot;,
1049                 &quot;Exploitable Population Biomass&quot;,
1050                 &quot;MSY&quot;,
1051                 &quot;Yield&quot;,
1052                 &quot;Recruitment&quot;,
1053                 &quot;Catch&quot;,
1054                 &quot;Effort&quot;);
1055         final Map&lt;Tab, List&lt;String&gt;&gt; fooMap = new HashMap&lt;&gt;();
1056         final List&lt;Tab&gt; tabList = new LinkedList&lt;&gt;();
1057         for (String name : names) {
1058             final Tab tab = new Tab();
1059             tab.setText(name);
1060             fooMap.put(tab, new LinkedList&lt;&gt;());
1061             tabList.add(tab);
1062         }
1063         TabPane tabPane = new TabPane();
1064 
1065         if (addToTabPane) {
1066             tabPane.getTabs().setAll(tabList);
1067         }
1068 
1069         fooMap.entrySet().forEach(entry -&gt; {
1070             final Tab tab = entry.getKey();
1071             assertTrue(tabList.contains(tab));
1072             assertTrue(fooMap.containsKey(tab));
1073         });
1074     }
1075 
1076     // Test for JDK-8189424
1077     int selectionChangeCount = 0;
1078     @Test public void testTabClosingEventAndSelectionChange() {
1079         Tab t1 = new Tab(&quot;&quot;);
1080         Tab t2 = new Tab(&quot;&quot;);
1081         tabPane.getTabs().add(t1);
1082         tabPane.getTabs().add(t2);
1083         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.ALL_TABS);
1084 
1085         tabPane.getSelectionModel().selectedItemProperty().addListener((ov, oldTab, newTab) -&gt; {
1086             selectionChangeCount++;
1087         });
1088         t1.setOnCloseRequest((event) -&gt; {
1089             event.consume();
1090             tabPane.getTabs().remove(t1);
1091         });
1092 
1093         root.getChildren().add(tabPane);
1094         show();
1095 
1096         root.applyCss();
1097         root.resize(300, 300);
1098         root.layout();
1099 
1100         tk.firePulse();
1101         assertTrue(tabPane.isFocused());
1102 
1103         tabPane.getSelectionModel().select(t1);
1104 
1105         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
1106         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
1107 
1108         SceneHelper.processMouseEvent(scene,
1109             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval + 19, yval + 17));
1110         tk.firePulse();
1111         SceneHelper.processMouseEvent(scene,
1112             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_RELEASED, xval + 19, yval + 17));
1113         tk.firePulse();
1114 
1115         assertEquals(1, tabPane.getTabs().size());
1116         assertEquals(t2, tabPane.getSelectionModel().getSelectedItem());
1117         assertEquals(1, selectionChangeCount);
1118 
1119         tabPane.getTabs().remove(t2);
1120     }
1121 
1122     // Test for JDK-8193495
1123     @Test public void testQuickRemoveAddTab() {
1124         int tabHeaderMinWidth = 200;
1125         int tabHeaderMinHeight = 50;
1126         tabPane.setMaxSize(400, 200);
1127         tabPane.setTabMinWidth(tabHeaderMinWidth);
1128         tabPane.setTabMinHeight(tabHeaderMinHeight);
1129         tabPane.getTabs().addAll(tab1, tab2, tab3);
1130         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.UNAVAILABLE);
1131 
1132         root.getChildren().add(tabPane);
1133         show();
1134         tabPane.requestFocus();
1135         tk.firePulse();
1136         assertTrue(tabPane.isFocused());
1137 
1138         tabPane.getTabs().add(1, tabPane.getTabs().remove(0));
1139         tk.firePulse();
1140         tabPane.getSelectionModel().select(tab1);
1141         tk.firePulse();
1142 
1143         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
1144         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
1145 
1146         SceneHelper.processMouseEvent(scene,
1147             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval + 19, yval + 17));
1148         tk.firePulse();
1149         SceneHelper.processMouseEvent(scene,
1150             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval + 19, yval + 17));
1151         tk.firePulse();
1152 
1153         assertEquals(&quot;Tabpane should have 3 tabs.&quot;, 3, tabPane.getTabs().size());
1154         assertEquals(&quot;tab2 should be at index 0.&quot;, tab2, tabPane.getSelectionModel().getSelectedItem());
1155     }
1156 
1157     // Test for JDK-8154039
1158     WeakReference&lt;Tab&gt; weakTab;
1159     @Test public void testSelectNonChildTab() {
1160         tabPane.getTabs().addAll(tab1);
1161         root.getChildren().add(tabPane);
1162         show();
1163         tk.firePulse();
1164         weakTab = new WeakReference&lt;&gt;(new Tab(&quot;NonChildTab&quot;));
1165         tabPane.getSelectionModel().select(weakTab.get());
1166         tk.firePulse();
1167         attemptGC(10);
1168         tk.firePulse();
1169         assertNull(weakTab.get());
1170     }
1171 
1172     private void attemptGC(int n) {
1173         // Attempt gc n times
1174         for (int i = 0; i &lt; n; i++) {
1175             System.gc();
1176             System.runFinalization();
1177 
1178             if (weakTab.get() == null) {
1179                 break;
1180             }
1181             try {
1182                 Thread.sleep(500);
1183             } catch (InterruptedException e) {
1184                 fail(&quot;InterruptedException occurred during Thread.sleep()&quot;);
1185             }
1186         }
1187     }
1188 
1189     // Test for JDK-8157690
1190     @Test public void testPopupItemsOnSortingTabs() {
1191         tabPane.setMaxSize(20, 20);
1192         root.getChildren().add(tabPane);
1193         tabPane.getTabs().addAll(tab1, tab2, tab3);
1194         show();
1195         tk.firePulse();
1196         TabPaneSkin tbSkin = (TabPaneSkin) tabPane.getSkin();
1197         assertNotNull(tbSkin);
1198         ContextMenu tabsMenu = TabPaneSkinShim.getTabsMenu(tbSkin);
1199         assertNotNull(tabsMenu);
1200         assertEquals(&quot;ContextMenu should contain 3 items.&quot;, 3, tabsMenu.getItems().size());
1201 
1202         tabPane.getTabs().sort((o1, o2) -&gt; sortCompare(o1, o2));
1203         tk.firePulse();
1204         assertEquals(&quot;ContextMenu should contain 3 items.&quot;, 3, tabsMenu.getItems().size());
1205     }
1206 
1207     private int sortCompare(Tab t1, Tab t2) {
1208         return t2.getText().compareTo(t1.getText());
1209     }
1210 }
    </pre>
  </body>
</html>