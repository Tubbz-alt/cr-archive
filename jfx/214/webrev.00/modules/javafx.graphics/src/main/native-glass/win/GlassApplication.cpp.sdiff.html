<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.graphics/src/main/native-glass/win/GlassApplication.cpp</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../native-font/fontpath.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="Utils.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.graphics/src/main/native-glass/win/GlassApplication.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
338 }
339 
340 /* static */
341 ULONG GlassApplication::DecrementAccessibility()
342 {
343     return InterlockedDecrement(&amp;GlassApplication::s_accessibilityCount);
344 }
345 
346 /* static */
347 ULONG GlassApplication::GetAccessibilityCount()
348 {
349     return GlassApplication::s_accessibilityCount;
350 }
351 
352 /*******************************************************
353  * JNI section
354  *******************************************************/
355 
356 extern &quot;C&quot; {
357 

358 BOOL WINAPI DllMain(HANDLE hinstDLL, DWORD dwReason, LPVOID lpvReserved)
359 {
360     if (dwReason == DLL_PROCESS_ATTACH) {
361         GlassApplication::SetHInstance((HINSTANCE)hinstDLL);
362     }
363     return TRUE;
364 }

365 
366 /*
367  * Class:     com_sun_glass_ui_win_WinApplication
368  * Method:    initIDs
369  * Signature: ()V
370  */
371 JNIEXPORT void JNICALL Java_com_sun_glass_ui_win_WinApplication_initIDs
372   (JNIEnv *env, jclass cls, jfloat overrideUIScale)
373 {





374     GlassApplication::overrideUIScale = overrideUIScale;
375 
376     javaIDs.Application.reportExceptionMID =
377         env-&gt;GetStaticMethodID(cls, &quot;reportException&quot;, &quot;(Ljava/lang/Throwable;)V&quot;);
378     ASSERT(javaIDs.Application.reportExceptionMID);
379     if (CheckAndClearException(env)) return;
380 
381     javaIDs.Application.notifyThemeChangedMID =
382         env-&gt;GetMethodID(cls, &quot;notifyThemeChanged&quot;, &quot;(Ljava/lang/String;)Z&quot;);
383     ASSERT(javaIDs.Application.notifyThemeChangedMID);
384     if (CheckAndClearException(env)) return;
385 
386     //NOTE: substitute the cls
387     cls = (jclass)env-&gt;FindClass(&quot;java/lang/Runnable&quot;);
388     if (CheckAndClearException(env)) return;
389 
390     javaIDs.Runnable.run = env-&gt;GetMethodID(cls, &quot;run&quot;, &quot;()V&quot;);
391     ASSERT(javaIDs.Runnable.run);
392     if (CheckAndClearException(env)) return;
393 }
</pre>
</td>
<td>
<hr />
<pre>
338 }
339 
340 /* static */
341 ULONG GlassApplication::DecrementAccessibility()
342 {
343     return InterlockedDecrement(&amp;GlassApplication::s_accessibilityCount);
344 }
345 
346 /* static */
347 ULONG GlassApplication::GetAccessibilityCount()
348 {
349     return GlassApplication::s_accessibilityCount;
350 }
351 
352 /*******************************************************
353  * JNI section
354  *******************************************************/
355 
356 extern &quot;C&quot; {
357 
<span class="line-added">358 #ifndef STATIC_BUILD</span>
359 BOOL WINAPI DllMain(HANDLE hinstDLL, DWORD dwReason, LPVOID lpvReserved)
360 {
361     if (dwReason == DLL_PROCESS_ATTACH) {
362         GlassApplication::SetHInstance((HINSTANCE)hinstDLL);
363     }
364     return TRUE;
365 }
<span class="line-added">366 #endif</span>
367 
368 /*
369  * Class:     com_sun_glass_ui_win_WinApplication
370  * Method:    initIDs
371  * Signature: ()V
372  */
373 JNIEXPORT void JNICALL Java_com_sun_glass_ui_win_WinApplication_initIDs
374   (JNIEnv *env, jclass cls, jfloat overrideUIScale)
375 {
<span class="line-added">376 #ifdef STATIC_BUILD</span>
<span class="line-added">377     HINSTANCE hInstExe = ::GetModuleHandle(NULL);</span>
<span class="line-added">378     GlassApplication::SetHInstance((HINSTANCE)hInstExe);</span>
<span class="line-added">379 #endif</span>
<span class="line-added">380 </span>
381     GlassApplication::overrideUIScale = overrideUIScale;
382 
383     javaIDs.Application.reportExceptionMID =
384         env-&gt;GetStaticMethodID(cls, &quot;reportException&quot;, &quot;(Ljava/lang/Throwable;)V&quot;);
385     ASSERT(javaIDs.Application.reportExceptionMID);
386     if (CheckAndClearException(env)) return;
387 
388     javaIDs.Application.notifyThemeChangedMID =
389         env-&gt;GetMethodID(cls, &quot;notifyThemeChanged&quot;, &quot;(Ljava/lang/String;)Z&quot;);
390     ASSERT(javaIDs.Application.notifyThemeChangedMID);
391     if (CheckAndClearException(env)) return;
392 
393     //NOTE: substitute the cls
394     cls = (jclass)env-&gt;FindClass(&quot;java/lang/Runnable&quot;);
395     if (CheckAndClearException(env)) return;
396 
397     javaIDs.Runnable.run = env-&gt;GetMethodID(cls, &quot;run&quot;, &quot;()V&quot;);
398     ASSERT(javaIDs.Runnable.run);
399     if (CheckAndClearException(env)) return;
400 }
</pre>
</td>
</tr>
</table>
<center><a href="../../native-font/fontpath.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="Utils.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>