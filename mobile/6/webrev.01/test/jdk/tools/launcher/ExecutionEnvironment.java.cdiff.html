<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/tools/launcher/ExecutionEnvironment.java</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../jlink/plugins/SystemModuleDescriptors/SystemModulesTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="RunpathTest.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/tools/launcher/ExecutionEnvironment.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2009, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2009, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 172,46 ***</span>
      /*
       * This test ensures that LD_LIBRARY_PATH* values are interpreted by the VM
       * and the expected java.library.path behaviour.
       * For Generic platforms (All *nixes):
       *    * All LD_LIBRARY_PATH variable should be on java.library.path
<span class="line-removed">-      * For Solaris 32-bit</span>
<span class="line-removed">-      *    * The LD_LIBRARY_PATH_32 should override LD_LIBRARY_PATH if specified</span>
<span class="line-removed">-      * For Solaris 64-bit</span>
<span class="line-removed">-      *    * The LD_LIBRARY_PATH_64 should override LD_LIBRARY_PATH if specified</span>
       */
      @Test
      void testJavaLibraryPath() {
          TestResult tr;
  
          Map&lt;String, String&gt; env = new HashMap&lt;&gt;();
  
<span class="line-modified">!         if (TestHelper.isSolaris) {</span>
<span class="line-modified">!             // no override</span>
<span class="line-modified">!             env.clear();</span>
<span class="line-removed">-             env.put(LD_LIBRARY_PATH, LD_LIBRARY_PATH_VALUE);</span>
<span class="line-removed">-             tr = doExec(env, javaCmd, &quot;-jar&quot;, testJarFile.getAbsolutePath());</span>
<span class="line-removed">-             verifyJavaLibraryPathGeneric(tr);</span>
<span class="line-removed">- </span>
<span class="line-removed">-             env.clear();</span>
<span class="line-removed">-             for (String x : LD_PATH_STRINGS) {</span>
<span class="line-removed">-                 String pairs[] = x.split(&quot;=&quot;);</span>
<span class="line-removed">-                 env.put(pairs[0], pairs[1]);</span>
<span class="line-removed">-             }</span>
<span class="line-removed">- </span>
<span class="line-removed">-             // verify the override occurs for 64-bit system</span>
<span class="line-removed">-             tr = doExec(env, javaCmd, &quot;-jar&quot;, testJarFile.getAbsolutePath());</span>
<span class="line-removed">-             verifyJavaLibraryPathOverride(tr, false);</span>
<span class="line-removed">-         } else {</span>
<span class="line-removed">-             for (String x : LD_PATH_STRINGS) {</span>
<span class="line-removed">-                 String pairs[] = x.split(&quot;=&quot;);</span>
<span class="line-removed">-                 env.put(pairs[0], pairs[1]);</span>
<span class="line-removed">-             }</span>
<span class="line-removed">- </span>
<span class="line-removed">-             tr = doExec(env, javaCmd, &quot;-jar&quot;, testJarFile.getAbsolutePath());</span>
<span class="line-removed">-             verifyJavaLibraryPathGeneric(tr);</span>
          }
      }
  
      private void verifyJavaLibraryPathGeneric(TestResult tr) {
          if (!tr.matches(&quot;java.library.path=.*&quot; + LD_LIBRARY_PATH_VALUE + &quot;.*&quot;)) {
              flagError(tr, &quot;testJavaLibraryPath: java.library.path does not contain &quot; +
<span class="line-new-header">--- 172,24 ---</span>
      /*
       * This test ensures that LD_LIBRARY_PATH* values are interpreted by the VM
       * and the expected java.library.path behaviour.
       * For Generic platforms (All *nixes):
       *    * All LD_LIBRARY_PATH variable should be on java.library.path
       */
      @Test
      void testJavaLibraryPath() {
          TestResult tr;
  
          Map&lt;String, String&gt; env = new HashMap&lt;&gt;();
  
<span class="line-modified">!         for (String x : LD_PATH_STRINGS) {</span>
<span class="line-modified">!             String pairs[] = x.split(&quot;=&quot;);</span>
<span class="line-modified">!             env.put(pairs[0], pairs[1]);</span>
          }
<span class="line-added">+ </span>
<span class="line-added">+         tr = doExec(env, javaCmd, &quot;-jar&quot;, testJarFile.getAbsolutePath());</span>
<span class="line-added">+         verifyJavaLibraryPathGeneric(tr);</span>
      }
  
      private void verifyJavaLibraryPathGeneric(TestResult tr) {
          if (!tr.matches(&quot;java.library.path=.*&quot; + LD_LIBRARY_PATH_VALUE + &quot;.*&quot;)) {
              flagError(tr, &quot;testJavaLibraryPath: java.library.path does not contain &quot; +
</pre>
<center><a href="../jlink/plugins/SystemModuleDescriptors/SystemModulesTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="RunpathTest.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>