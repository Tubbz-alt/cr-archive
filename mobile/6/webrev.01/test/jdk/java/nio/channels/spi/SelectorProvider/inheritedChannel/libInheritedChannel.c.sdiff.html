<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff test/jdk/java/nio/channels/spi/SelectorProvider/inheritedChannel/libInheritedChannel.c</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="InheritedChannelTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../charset/Charset/DefaultCharsetTest.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/nio/channels/spi/SelectorProvider/inheritedChannel/libInheritedChannel.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
118         return;
119     }
120 
121     for (i=0; i&lt;cmdlen; i++) {
122         jstring str = (*env)-&gt;GetObjectArrayElement(env, cmdarray, i);
123         cmdv[i] = (char *) getString8859_1Chars(env, str);
124         if (cmdv[i] == NULL) {
125             return;
126         }
127     }
128 
129     /*
130      * Command array must have NULL as the last entry
131      */
132     cmdv[cmdlen] = NULL;
133 
134     /*
135      * Launch the program. As this isn&#39;t a complete inetd or Runtime.exec
136      * implementation we don&#39;t have a reaper to pick up child exit status.
137      */
<span class="line-removed">138 #ifdef __solaris__</span>
<span class="line-removed">139     pid = fork1();</span>
<span class="line-removed">140 #else</span>
141     pid = fork();
<span class="line-removed">142 #endif</span>
143     if (pid != 0) {
144         if (pid &lt; 0) {
145             ThrowException(env, &quot;java/io/IOException&quot;, &quot;fork failed&quot;);
146         }
147         return;
148     }
149 
150     /*
151      * We need to close all file descriptors except for serviceFd. To
152      * get the list of open file descriptos we read through /proc/self/fd (/dev/fd)
153      * but to open this requires a file descriptor. We could use a specific
154      * file descriptor and fdopendir but Linux doesn&#39;t seem to support
155      * fdopendir. Instead we use opendir and make an assumption on the
156      * file descriptor that is used (by opening &amp; closing a file).
157      */
158     thisFd = open(&quot;/dev/fd&quot;, O_RDONLY);
159     if (thisFd &lt; 0) {
160         _exit(-1);
161     }
162 
</pre>
</td>
<td>
<hr />
<pre>
118         return;
119     }
120 
121     for (i=0; i&lt;cmdlen; i++) {
122         jstring str = (*env)-&gt;GetObjectArrayElement(env, cmdarray, i);
123         cmdv[i] = (char *) getString8859_1Chars(env, str);
124         if (cmdv[i] == NULL) {
125             return;
126         }
127     }
128 
129     /*
130      * Command array must have NULL as the last entry
131      */
132     cmdv[cmdlen] = NULL;
133 
134     /*
135      * Launch the program. As this isn&#39;t a complete inetd or Runtime.exec
136      * implementation we don&#39;t have a reaper to pick up child exit status.
137      */



138     pid = fork();

139     if (pid != 0) {
140         if (pid &lt; 0) {
141             ThrowException(env, &quot;java/io/IOException&quot;, &quot;fork failed&quot;);
142         }
143         return;
144     }
145 
146     /*
147      * We need to close all file descriptors except for serviceFd. To
148      * get the list of open file descriptos we read through /proc/self/fd (/dev/fd)
149      * but to open this requires a file descriptor. We could use a specific
150      * file descriptor and fdopendir but Linux doesn&#39;t seem to support
151      * fdopendir. Instead we use opendir and make an assumption on the
152      * file descriptor that is used (by opening &amp; closing a file).
153      */
154     thisFd = open(&quot;/dev/fd&quot;, O_RDONLY);
155     if (thisFd &lt; 0) {
156         _exit(-1);
157     }
158 
</pre>
</td>
</tr>
</table>
<center><a href="InheritedChannelTest.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../charset/Charset/DefaultCharsetTest.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>