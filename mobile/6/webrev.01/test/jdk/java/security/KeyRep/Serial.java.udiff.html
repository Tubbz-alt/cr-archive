<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff test/jdk/java/security/KeyRep/Serial.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../../rmi/reliability/launch_reliability.ksh.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../KeyStore/TestKeyStoreBasic.java.udiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/security/KeyRep/Serial.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2003, 2004, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -86,33 +86,30 @@</span>
          if (!rsaKp2.getPublic().equals(rsaKp.getPublic()) ||
              !rsaKp2.getPrivate().equals(rsaKp.getPrivate())) {
              throw new SecurityException(&quot;RSA test failed&quot;);
          }
  
<span class="udiff-line-modified-removed">-         // exclude test is ECF provider is installed, see 4923290</span>
<span class="udiff-line-modified-removed">-         if (Security.getProvider(&quot;SunPKCS11-Solaris&quot;) == null) {</span>
<span class="udiff-line-modified-removed">-             // generate DH key pair</span>
<span class="udiff-line-modified-removed">-             kpg = KeyPairGenerator.getInstance(&quot;DiffieHellman&quot;, JCE);</span>
<span class="udiff-line-modified-removed">-             kpg.initialize(new DHParameterSpec(skip1024Modulus, skip1024Base));</span>
<span class="udiff-line-modified-removed">-             KeyPair dhKp = kpg.genKeyPair();</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-             // serialize DH key pair</span>
<span class="udiff-line-modified-removed">-             baos.reset();</span>
<span class="udiff-line-modified-removed">-             oos = new ObjectOutputStream(baos);</span>
<span class="udiff-line-modified-removed">-             oos.writeObject(dhKp);</span>
<span class="udiff-line-modified-removed">-             oos.close();</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-             // deserialize DH key pair</span>
<span class="udiff-line-modified-removed">-             ois = new ObjectInputStream</span>
<span class="udiff-line-modified-removed">-                             (new ByteArrayInputStream(baos.toByteArray()));</span>
<span class="udiff-line-modified-removed">-             KeyPair dhKp2 = (KeyPair)ois.readObject();</span>
<span class="udiff-line-modified-removed">-             ois.close();</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-             if (!dhKp2.getPublic().equals(dhKp.getPublic()) ||</span>
<span class="udiff-line-removed">-                 !dhKp2.getPrivate().equals(dhKp.getPrivate())) {</span>
<span class="udiff-line-removed">-                 throw new SecurityException(&quot;DH test failed&quot;);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-modified-added">+         // generate DH key pair</span>
<span class="udiff-line-modified-added">+         kpg = KeyPairGenerator.getInstance(&quot;DiffieHellman&quot;, JCE);</span>
<span class="udiff-line-modified-added">+         kpg.initialize(new DHParameterSpec(skip1024Modulus, skip1024Base));</span>
<span class="udiff-line-modified-added">+         KeyPair dhKp = kpg.genKeyPair();</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // serialize DH key pair</span>
<span class="udiff-line-modified-added">+         baos.reset();</span>
<span class="udiff-line-modified-added">+         oos = new ObjectOutputStream(baos);</span>
<span class="udiff-line-modified-added">+         oos.writeObject(dhKp);</span>
<span class="udiff-line-modified-added">+         oos.close();</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // deserialize DH key pair</span>
<span class="udiff-line-modified-added">+         ois = new ObjectInputStream</span>
<span class="udiff-line-modified-added">+                         (new ByteArrayInputStream(baos.toByteArray()));</span>
<span class="udiff-line-modified-added">+         KeyPair dhKp2 = (KeyPair)ois.readObject();</span>
<span class="udiff-line-modified-added">+         ois.close();</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         if (!dhKp2.getPublic().equals(dhKp.getPublic()) ||</span>
<span class="udiff-line-modified-added">+             !dhKp2.getPrivate().equals(dhKp.getPrivate())) {</span>
<span class="udiff-line-modified-added">+             throw new SecurityException(&quot;DH test failed&quot;);</span>
          }
  
          // generate RC5 key
          SecretKeySpec rc5Key = new SecretKeySpec(new byte[128], &quot;RC5&quot;);
  
</pre>
<center><a href="../../rmi/reliability/launch_reliability.ksh.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../KeyStore/TestKeyStoreBasic.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>