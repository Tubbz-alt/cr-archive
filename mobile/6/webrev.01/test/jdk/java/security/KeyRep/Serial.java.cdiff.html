<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/java/security/KeyRep/Serial.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="../../rmi/reliability/launch_reliability.ksh.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../KeyStore/TestKeyStoreBasic.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/java/security/KeyRep/Serial.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2004, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 86,33 ***</span>
          if (!rsaKp2.getPublic().equals(rsaKp.getPublic()) ||
              !rsaKp2.getPrivate().equals(rsaKp.getPrivate())) {
              throw new SecurityException(&quot;RSA test failed&quot;);
          }
  
<span class="line-modified">!         // exclude test is ECF provider is installed, see 4923290</span>
<span class="line-modified">!         if (Security.getProvider(&quot;SunPKCS11-Solaris&quot;) == null) {</span>
<span class="line-modified">!             // generate DH key pair</span>
<span class="line-modified">!             kpg = KeyPairGenerator.getInstance(&quot;DiffieHellman&quot;, JCE);</span>
<span class="line-modified">!             kpg.initialize(new DHParameterSpec(skip1024Modulus, skip1024Base));</span>
<span class="line-modified">!             KeyPair dhKp = kpg.genKeyPair();</span>
<span class="line-modified">! </span>
<span class="line-modified">!             // serialize DH key pair</span>
<span class="line-modified">!             baos.reset();</span>
<span class="line-modified">!             oos = new ObjectOutputStream(baos);</span>
<span class="line-modified">!             oos.writeObject(dhKp);</span>
<span class="line-modified">!             oos.close();</span>
<span class="line-modified">! </span>
<span class="line-modified">!             // deserialize DH key pair</span>
<span class="line-modified">!             ois = new ObjectInputStream</span>
<span class="line-modified">!                             (new ByteArrayInputStream(baos.toByteArray()));</span>
<span class="line-modified">!             KeyPair dhKp2 = (KeyPair)ois.readObject();</span>
<span class="line-modified">!             ois.close();</span>
<span class="line-modified">! </span>
<span class="line-modified">!             if (!dhKp2.getPublic().equals(dhKp.getPublic()) ||</span>
<span class="line-removed">-                 !dhKp2.getPrivate().equals(dhKp.getPrivate())) {</span>
<span class="line-removed">-                 throw new SecurityException(&quot;DH test failed&quot;);</span>
<span class="line-removed">-             }</span>
          }
  
          // generate RC5 key
          SecretKeySpec rc5Key = new SecretKeySpec(new byte[128], &quot;RC5&quot;);
  
<span class="line-new-header">--- 86,30 ---</span>
          if (!rsaKp2.getPublic().equals(rsaKp.getPublic()) ||
              !rsaKp2.getPrivate().equals(rsaKp.getPrivate())) {
              throw new SecurityException(&quot;RSA test failed&quot;);
          }
  
<span class="line-modified">!         // generate DH key pair</span>
<span class="line-modified">!         kpg = KeyPairGenerator.getInstance(&quot;DiffieHellman&quot;, JCE);</span>
<span class="line-modified">!         kpg.initialize(new DHParameterSpec(skip1024Modulus, skip1024Base));</span>
<span class="line-modified">!         KeyPair dhKp = kpg.genKeyPair();</span>
<span class="line-modified">! </span>
<span class="line-modified">!         // serialize DH key pair</span>
<span class="line-modified">!         baos.reset();</span>
<span class="line-modified">!         oos = new ObjectOutputStream(baos);</span>
<span class="line-modified">!         oos.writeObject(dhKp);</span>
<span class="line-modified">!         oos.close();</span>
<span class="line-modified">! </span>
<span class="line-modified">!         // deserialize DH key pair</span>
<span class="line-modified">!         ois = new ObjectInputStream</span>
<span class="line-modified">!                         (new ByteArrayInputStream(baos.toByteArray()));</span>
<span class="line-modified">!         KeyPair dhKp2 = (KeyPair)ois.readObject();</span>
<span class="line-modified">!         ois.close();</span>
<span class="line-modified">! </span>
<span class="line-modified">!         if (!dhKp2.getPublic().equals(dhKp.getPublic()) ||</span>
<span class="line-modified">!             !dhKp2.getPrivate().equals(dhKp.getPrivate())) {</span>
<span class="line-modified">!             throw new SecurityException(&quot;DH test failed&quot;);</span>
          }
  
          // generate RC5 key
          SecretKeySpec rc5Key = new SecretKeySpec(new byte[128], &quot;RC5&quot;);
  
</pre>
<center><a href="../../rmi/reliability/launch_reliability.ksh.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="../KeyStore/TestKeyStoreBasic.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>