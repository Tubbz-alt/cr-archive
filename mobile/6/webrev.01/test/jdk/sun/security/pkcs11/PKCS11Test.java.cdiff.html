<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/jdk/sun/security/pkcs11/PKCS11Test.java</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="Mac/MacSameTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="Provider/ConfigQuotedString.sh.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/jdk/sun/security/pkcs11/PKCS11Test.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 137,23 ***</span>
              }
          }
          pkcs11 = p;
      }
  
<span class="line-removed">-     /*</span>
<span class="line-removed">-      * Use Solaris SPARC 11.2 or later to avoid an intermittent failure</span>
<span class="line-removed">-      * when running SunPKCS11-Solaris (8044554)</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     static boolean isBadSolarisSparc(Provider p) {</span>
<span class="line-removed">-         if (&quot;SunPKCS11-Solaris&quot;.equals(p.getName()) &amp;&amp; badSolarisSparc) {</span>
<span class="line-removed">-             System.out.println(&quot;SunPKCS11-Solaris provider requires &quot; +</span>
<span class="line-removed">-                 &quot;Solaris SPARC 11.2 or later, skipping&quot;);</span>
<span class="line-removed">-             return true;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-         return false;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      // Return a SunPKCS11 provider configured with the specified config file
      static Provider getSunPKCS11(String config) throws Exception {
          if (pkcs11 == null) {
              throw new NoSuchProviderException(&quot;No PKCS11 provider available&quot;);
          }
<span class="line-new-header">--- 137,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 682,14 ***</span>
          if (osMap != null) {
              return osMap;
          }
  
          osMap = new HashMap&lt;&gt;();
<span class="line-removed">-         osMap.put(&quot;SunOS-sparc-32&quot;, new String[] { &quot;/usr/lib/mps/&quot; });</span>
<span class="line-removed">-         osMap.put(&quot;SunOS-sparcv9-64&quot;, new String[] { &quot;/usr/lib/mps/64/&quot; });</span>
<span class="line-removed">-         osMap.put(&quot;SunOS-x86-32&quot;, new String[] { &quot;/usr/lib/mps/&quot; });</span>
<span class="line-removed">-         osMap.put(&quot;SunOS-amd64-64&quot;, new String[] { &quot;/usr/lib/mps/64/&quot; });</span>
          osMap.put(&quot;Linux-i386-32&quot;, new String[] {
                  &quot;/usr/lib/i386-linux-gnu/&quot;,
                  &quot;/usr/lib32/&quot;,
                  &quot;/usr/lib/&quot; });
          osMap.put(&quot;Linux-amd64-64&quot;, new String[] {
<span class="line-new-header">--- 669,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 745,18 ***</span>
          return nssLibPaths.toArray(new String[nssLibPaths.size()]);
      }
  
      private final static char[] hexDigits = &quot;0123456789abcdef&quot;.toCharArray();
  
<span class="line-removed">-     private static final String distro = distro();</span>
<span class="line-removed">- </span>
<span class="line-removed">-     static final boolean badSolarisSparc =</span>
<span class="line-removed">-             System.getProperty(&quot;os.name&quot;).equals(&quot;SunOS&quot;) &amp;&amp;</span>
<span class="line-removed">-             System.getProperty(&quot;os.arch&quot;).equals(&quot;sparcv9&quot;) &amp;&amp;</span>
<span class="line-removed">-             System.getProperty(&quot;os.version&quot;).compareTo(&quot;5.11&quot;) &lt;= 0 &amp;&amp;</span>
<span class="line-removed">-             getDistro().compareTo(&quot;11.2&quot;) &lt; 0;</span>
<span class="line-removed">- </span>
      public static String toString(byte[] b) {
          if (b == null) {
              return &quot;(null)&quot;;
          }
          StringBuilder sb = new StringBuilder(b.length * 3);
<span class="line-new-header">--- 728,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 836,33 ***</span>
              }
          }
          return algorithms;
      }
  
<span class="line-removed">-     /**</span>
<span class="line-removed">-      * Get the identifier for the operating system distribution</span>
<span class="line-removed">-      */</span>
<span class="line-removed">-     static String getDistro() {</span>
<span class="line-removed">-         return distro;</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
<span class="line-removed">-     private static String distro() {</span>
<span class="line-removed">-         if (props.getProperty(&quot;os.name&quot;).equals(&quot;SunOS&quot;)) {</span>
<span class="line-removed">-             try (BufferedReader in =</span>
<span class="line-removed">-                          new BufferedReader(new InputStreamReader(</span>
<span class="line-removed">-                                  Runtime.getRuntime().exec(&quot;uname -v&quot;).getInputStream()))) {</span>
<span class="line-removed">- </span>
<span class="line-removed">-                 return in.readLine();</span>
<span class="line-removed">-             } catch (Exception e) {</span>
<span class="line-removed">-                 throw new RuntimeException(&quot;Failed to determine distro.&quot;, e);</span>
<span class="line-removed">-             }</span>
<span class="line-removed">-         } else {</span>
<span class="line-removed">-             // Not used outside Solaris</span>
<span class="line-removed">-             return null;</span>
<span class="line-removed">-         }</span>
<span class="line-removed">-     }</span>
<span class="line-removed">- </span>
      static byte[] generateData(int length) {
          byte data[] = new byte[length];
          for (int i=0; i&lt;data.length; i++) {
              data[i] = (byte) (i % 256);
          }
<span class="line-new-header">--- 811,10 ---</span>
</pre>
<center><a href="Mac/MacSameTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="Provider/ConfigQuotedString.sh.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>