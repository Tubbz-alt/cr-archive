<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/hotspot/lib/JvmMapfile.gmk</title>
    <link rel="stylesheet" href="../../../style.css" />
  </head>
<body>
<center><a href="JvmFeatures.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../../index.html" target="_top">index</a> <a href="JvmOverrideFiles.gmk.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/hotspot/lib/JvmMapfile.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2013, 2019, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 31 ifeq ($(call And, $(call isTargetOs, windows) $(call isTargetCpu, x86_64)), false)
 32   # On Windows x86_64, we should not have any symbols at all, since that
 33   # results in duplicate warnings from the linker (JDK-8043491).
 34   SYMBOLS_SRC += $(TOPDIR)/make/hotspot/symbols/symbols-shared
 35 endif
 36 
 37 ifeq ($(call isTargetOsType, unix), true)
 38   SYMBOLS_SRC += $(TOPDIR)/make/hotspot/symbols/symbols-unix
 39 endif
 40 
 41 ifneq ($(wildcard $(TOPDIR)/make/hotspot/symbols/symbols-$(OPENJDK_TARGET_OS)), )
 42   SYMBOLS_SRC += $(TOPDIR)/make/hotspot/symbols/symbols-$(OPENJDK_TARGET_OS)
 43 endif
 44 
 45 ifneq ($(findstring debug, $(DEBUG_LEVEL)), )
 46   ifneq ($(wildcard $(TOPDIR)/make/hotspot/symbols/symbols-$(OPENJDK_TARGET_OS)-debug), )
 47     SYMBOLS_SRC += $(TOPDIR)/make/hotspot/symbols/symbols-$(OPENJDK_TARGET_OS)-debug
 48   endif
 49 endif
 50 
<span class="line-removed"> 51 ifeq ($(call isTargetOs, solaris), true)</span>
<span class="line-removed"> 52   ifeq ($(call check-jvm-feature, dtrace), true)</span>
<span class="line-removed"> 53     # Additional mapfiles that are only used when dtrace is enabled</span>
<span class="line-removed"> 54     ifeq ($(call check-jvm-feature, compiler2), true)</span>
<span class="line-removed"> 55       # This also covers the case of compiler1+compiler2.</span>
<span class="line-removed"> 56       SYMBOLS_SRC += $(TOPDIR)/make/hotspot/symbols/symbols-solaris-dtrace-compiler2</span>
<span class="line-removed"> 57     else ifeq ($(call check-jvm-feature, compiler1), true)</span>
<span class="line-removed"> 58       SYMBOLS_SRC += $(TOPDIR)/make/hotspot/symbols/symbols-solaris-dtrace-compiler1</span>
<span class="line-removed"> 59     endif</span>
<span class="line-removed"> 60   endif</span>
<span class="line-removed"> 61 endif</span>
<span class="line-removed"> 62 </span>
 63 ################################################################################
 64 # Create a dynamic list of symbols from the built object files. This is highly
 65 # platform dependent.
 66 
 67 ifeq ($(call isTargetOs, linux), true)
 68   DUMP_SYMBOLS_CMD := $(NM) --defined-only *.o
 69   ifneq ($(FILTER_SYMBOLS_PATTERN), )
 70     FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)|
 71   endif
 72   FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)^_ZTV|^gHotSpotVM|^UseSharedSpaces$$
 73   FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)|^_ZN9Arguments17SharedArchivePathE$$
 74   FILTER_SYMBOLS_AWK_SCRIPT := \
 75       &#39;{ \
 76         if ($$3 ~ /$(FILTER_SYMBOLS_PATTERN)/) print $$3; \
 77       }&#39;
 78 
<span class="line-removed"> 79 else ifeq ($(call isTargetOs, solaris), true)</span>
<span class="line-removed"> 80   DUMP_SYMBOLS_CMD := $(NM) -p *.o</span>
<span class="line-removed"> 81   ifneq ($(FILTER_SYMBOLS_PATTERN), )</span>
<span class="line-removed"> 82     FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)|</span>
<span class="line-removed"> 83   endif</span>
<span class="line-removed"> 84   FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)^__1c.*__vtbl_$$|^gHotSpotVM</span>
<span class="line-removed"> 85   FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)|^UseSharedSpaces$$</span>
<span class="line-removed"> 86   FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)|^__1cJArgumentsRSharedArchivePath_$$</span>
<span class="line-removed"> 87   FILTER_SYMBOLS_AWK_SCRIPT := \</span>
<span class="line-removed"> 88       &#39;{ \</span>
<span class="line-removed"> 89         if ($$2 == &quot;U&quot;) next; \</span>
<span class="line-removed"> 90         if ($$3 ~ /$(FILTER_SYMBOLS_PATTERN)/) print $$3; \</span>
<span class="line-removed"> 91       }&#39;</span>
<span class="line-removed"> 92 </span>
 93 else ifeq ($(call isTargetOs, macosx), true)
 94   # nm on macosx prints out &quot;warning: nm: no name list&quot; to stderr for
 95   # files without symbols. Hide this, even at the expense of hiding real errors.
 96   DUMP_SYMBOLS_CMD := $(NM) -Uj *.o 2&gt; /dev/null
 97   ifneq ($(FILTER_SYMBOLS_PATTERN), )
 98     FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)|
 99   endif
100   FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)^_ZTV|^gHotSpotVM
101   FILTER_SYMBOLS_AWK_SCRIPT := \
102       &#39;{ \
103         if ($$3 ~ /$(FILTER_SYMBOLS_PATTERN)/) print $$3; \
104       }&#39;
105 
106 # NOTE: The script is from the old build. It is broken and finds no symbols.
107 # The script below might be what was intended, but it failes to link with tons
108 # of &#39;cannot export hidden symbol vtable for X&#39;.
109 #  &#39;{ if ($$1 ~ /^__ZTV/ || $$1 ~ /^_gHotSpotVM/) print substr($$1, 2) }&#39;
110 else ifeq ($(call isTargetOs, aix), true)
111   # NOTE: The old build had the solution below. This should to be fixed in
112   # configure instead.
</pre>
</td>
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2013, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 31 ifeq ($(call And, $(call isTargetOs, windows) $(call isTargetCpu, x86_64)), false)
 32   # On Windows x86_64, we should not have any symbols at all, since that
 33   # results in duplicate warnings from the linker (JDK-8043491).
 34   SYMBOLS_SRC += $(TOPDIR)/make/hotspot/symbols/symbols-shared
 35 endif
 36 
 37 ifeq ($(call isTargetOsType, unix), true)
 38   SYMBOLS_SRC += $(TOPDIR)/make/hotspot/symbols/symbols-unix
 39 endif
 40 
 41 ifneq ($(wildcard $(TOPDIR)/make/hotspot/symbols/symbols-$(OPENJDK_TARGET_OS)), )
 42   SYMBOLS_SRC += $(TOPDIR)/make/hotspot/symbols/symbols-$(OPENJDK_TARGET_OS)
 43 endif
 44 
 45 ifneq ($(findstring debug, $(DEBUG_LEVEL)), )
 46   ifneq ($(wildcard $(TOPDIR)/make/hotspot/symbols/symbols-$(OPENJDK_TARGET_OS)-debug), )
 47     SYMBOLS_SRC += $(TOPDIR)/make/hotspot/symbols/symbols-$(OPENJDK_TARGET_OS)-debug
 48   endif
 49 endif
 50 












 51 ################################################################################
 52 # Create a dynamic list of symbols from the built object files. This is highly
 53 # platform dependent.
 54 
 55 ifeq ($(call isTargetOs, linux), true)
 56   DUMP_SYMBOLS_CMD := $(NM) --defined-only *.o
 57   ifneq ($(FILTER_SYMBOLS_PATTERN), )
 58     FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)|
 59   endif
 60   FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)^_ZTV|^gHotSpotVM|^UseSharedSpaces$$
 61   FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)|^_ZN9Arguments17SharedArchivePathE$$
 62   FILTER_SYMBOLS_AWK_SCRIPT := \
 63       &#39;{ \
 64         if ($$3 ~ /$(FILTER_SYMBOLS_PATTERN)/) print $$3; \
 65       }&#39;
 66 














 67 else ifeq ($(call isTargetOs, macosx), true)
 68   # nm on macosx prints out &quot;warning: nm: no name list&quot; to stderr for
 69   # files without symbols. Hide this, even at the expense of hiding real errors.
 70   DUMP_SYMBOLS_CMD := $(NM) -Uj *.o 2&gt; /dev/null
 71   ifneq ($(FILTER_SYMBOLS_PATTERN), )
 72     FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)|
 73   endif
 74   FILTER_SYMBOLS_PATTERN := $(FILTER_SYMBOLS_PATTERN)^_ZTV|^gHotSpotVM
 75   FILTER_SYMBOLS_AWK_SCRIPT := \
 76       &#39;{ \
 77         if ($$3 ~ /$(FILTER_SYMBOLS_PATTERN)/) print $$3; \
 78       }&#39;
 79 
 80 # NOTE: The script is from the old build. It is broken and finds no symbols.
 81 # The script below might be what was intended, but it failes to link with tons
 82 # of &#39;cannot export hidden symbol vtable for X&#39;.
 83 #  &#39;{ if ($$1 ~ /^__ZTV/ || $$1 ~ /^_gHotSpotVM/) print substr($$1, 2) }&#39;
 84 else ifeq ($(call isTargetOs, aix), true)
 85   # NOTE: The old build had the solution below. This should to be fixed in
 86   # configure instead.
</pre>
</td>
</tr>
</table>
<center><a href="JvmFeatures.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../../index.html" target="_top">index</a> <a href="JvmOverrideFiles.gmk.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>