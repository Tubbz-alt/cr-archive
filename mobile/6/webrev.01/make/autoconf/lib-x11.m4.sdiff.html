<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/autoconf/lib-x11.m4</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
<body>
<center><a href="lib-std.m4.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="libraries.m4.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/autoconf/lib-x11.m4</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2011, 2018, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 71           fi
 72         fi
 73       fi
 74     fi
 75 
 76     # Now let autoconf do it&#39;s magic
 77     AC_PATH_X
 78     AC_PATH_XTRA
 79 
 80     # AC_PATH_XTRA creates X_LIBS and sometimes adds -R flags. When cross compiling
 81     # this doesn&#39;t make sense so we remove it.
 82     if test &quot;x$COMPILE_TYPE&quot; = xcross; then
 83       X_LIBS=`$ECHO $X_LIBS | $SED &#39;s/-R \{0,1\}[[^ ]]*//g&#39;`
 84     fi
 85 
 86     if test &quot;x$no_x&quot; = xyes; then
 87       HELP_MSG_MISSING_DEPENDENCY([x11])
 88       AC_MSG_ERROR([Could not find X11 libraries. $HELP_MSG])
 89     fi
 90 
<span class="line-removed"> 91     if test &quot;x$OPENJDK_TARGET_OS&quot; = xsolaris; then</span>
<span class="line-removed"> 92       OPENWIN_HOME=&quot;/usr/openwin&quot;</span>
<span class="line-removed"> 93       X_CFLAGS=&quot;-I$SYSROOT$OPENWIN_HOME/include -I$SYSROOT$OPENWIN_HOME/include/X11/extensions&quot;</span>
<span class="line-removed"> 94       X_LIBS=&quot;-L$SYSROOT$OPENWIN_HOME/lib$OPENJDK_TARGET_CPU_ISADIR \</span>
<span class="line-removed"> 95           -R$OPENWIN_HOME/lib$OPENJDK_TARGET_CPU_ISADIR&quot;</span>
<span class="line-removed"> 96     fi</span>
<span class="line-removed"> 97 </span>
 98     AC_LANG_PUSH(C)
 99     OLD_CFLAGS=&quot;$CFLAGS&quot;
100     CFLAGS=&quot;$CFLAGS $SYSROOT_CFLAGS $X_CFLAGS&quot;
101 
102     HEADERS_TO_CHECK=&quot;X11/extensions/shape.h X11/extensions/Xrender.h X11/extensions/XTest.h X11/Intrinsic.h&quot;
103     # There is no Xrandr extension on AIX
104     if test &quot;x$OPENJDK_TARGET_OS&quot; = xaix; then
105       X_CFLAGS=&quot;$X_CFLAGS -DNO_XRANDR&quot;
106     else
107       HEADERS_TO_CHECK=&quot;$HEADERS_TO_CHECK X11/extensions/Xrandr.h&quot;
108     fi
109 
110     # Need to include Xlib.h and Xutil.h to avoid &quot;present but cannot be compiled&quot; warnings on Solaris 10
111     AC_CHECK_HEADERS([$HEADERS_TO_CHECK],
112         [X11_HEADERS_OK=yes],
113         [X11_HEADERS_OK=no; break],
114         [
115           # include &lt;X11/Xlib.h&gt;
116           # include &lt;X11/Xutil.h&gt;
117         ]
118     )
119 
120     if test &quot;x$X11_HEADERS_OK&quot; = xno; then
121       HELP_MSG_MISSING_DEPENDENCY([x11])
122       AC_MSG_ERROR([Could not find all X11 headers (shape.h Xrender.h Xrandr.h XTest.h Intrinsic.h). $HELP_MSG])
123     fi
124 
<span class="line-removed">125     # If XLinearGradient isn&#39;t available in Xrender.h, signal that it needs to be</span>
<span class="line-removed">126     # defined in libawt_xawt.</span>
<span class="line-removed">127     AC_MSG_CHECKING([if XlinearGradient is defined in Xrender.h])</span>
<span class="line-removed">128     AC_COMPILE_IFELSE(</span>
<span class="line-removed">129         [AC_LANG_PROGRAM([[#include &lt;X11/extensions/Xrender.h&gt;]],</span>
<span class="line-removed">130             [[XLinearGradient x;]])],</span>
<span class="line-removed">131         [AC_MSG_RESULT([yes])],</span>
<span class="line-removed">132         [AC_MSG_RESULT([no])</span>
<span class="line-removed">133          X_CFLAGS=&quot;$X_CFLAGS -DSOLARIS10_NO_XRENDER_STRUCTS&quot;])</span>
<span class="line-removed">134 </span>
135     CFLAGS=&quot;$OLD_CFLAGS&quot;
136     AC_LANG_POP(C)
137   fi # NEEDS_LIB_X11
138 
139   AC_SUBST(X_CFLAGS)
140   AC_SUBST(X_LIBS)
141 ])
</pre>
</td>
<td>
<hr />
<pre>
  1 #
<span class="line-modified">  2 # Copyright (c) 2011, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4 #
  5 # This code is free software; you can redistribute it and/or modify it
  6 # under the terms of the GNU General Public License version 2 only, as
  7 # published by the Free Software Foundation.  Oracle designates this
  8 # particular file as subject to the &quot;Classpath&quot; exception as provided
  9 # by Oracle in the LICENSE file that accompanied this code.
 10 #
 11 # This code is distributed in the hope that it will be useful, but WITHOUT
 12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14 # version 2 for more details (a copy is included in the LICENSE file that
 15 # accompanied this code).
 16 #
 17 # You should have received a copy of the GNU General Public License version
 18 # 2 along with this work; if not, write to the Free Software Foundation,
 19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20 #
 21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22 # or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
 71           fi
 72         fi
 73       fi
 74     fi
 75 
 76     # Now let autoconf do it&#39;s magic
 77     AC_PATH_X
 78     AC_PATH_XTRA
 79 
 80     # AC_PATH_XTRA creates X_LIBS and sometimes adds -R flags. When cross compiling
 81     # this doesn&#39;t make sense so we remove it.
 82     if test &quot;x$COMPILE_TYPE&quot; = xcross; then
 83       X_LIBS=`$ECHO $X_LIBS | $SED &#39;s/-R \{0,1\}[[^ ]]*//g&#39;`
 84     fi
 85 
 86     if test &quot;x$no_x&quot; = xyes; then
 87       HELP_MSG_MISSING_DEPENDENCY([x11])
 88       AC_MSG_ERROR([Could not find X11 libraries. $HELP_MSG])
 89     fi
 90 







 91     AC_LANG_PUSH(C)
 92     OLD_CFLAGS=&quot;$CFLAGS&quot;
 93     CFLAGS=&quot;$CFLAGS $SYSROOT_CFLAGS $X_CFLAGS&quot;
 94 
 95     HEADERS_TO_CHECK=&quot;X11/extensions/shape.h X11/extensions/Xrender.h X11/extensions/XTest.h X11/Intrinsic.h&quot;
 96     # There is no Xrandr extension on AIX
 97     if test &quot;x$OPENJDK_TARGET_OS&quot; = xaix; then
 98       X_CFLAGS=&quot;$X_CFLAGS -DNO_XRANDR&quot;
 99     else
100       HEADERS_TO_CHECK=&quot;$HEADERS_TO_CHECK X11/extensions/Xrandr.h&quot;
101     fi
102 
103     # Need to include Xlib.h and Xutil.h to avoid &quot;present but cannot be compiled&quot; warnings on Solaris 10
104     AC_CHECK_HEADERS([$HEADERS_TO_CHECK],
105         [X11_HEADERS_OK=yes],
106         [X11_HEADERS_OK=no; break],
107         [
108           # include &lt;X11/Xlib.h&gt;
109           # include &lt;X11/Xutil.h&gt;
110         ]
111     )
112 
113     if test &quot;x$X11_HEADERS_OK&quot; = xno; then
114       HELP_MSG_MISSING_DEPENDENCY([x11])
115       AC_MSG_ERROR([Could not find all X11 headers (shape.h Xrender.h Xrandr.h XTest.h Intrinsic.h). $HELP_MSG])
116     fi
117 










118     CFLAGS=&quot;$OLD_CFLAGS&quot;
119     AC_LANG_POP(C)
120   fi # NEEDS_LIB_X11
121 
122   AC_SUBST(X_CFLAGS)
123   AC_SUBST(X_LIBS)
124 ])
</pre>
</td>
</tr>
</table>
<center><a href="lib-std.m4.sdiff.html" target="_top">&lt; prev</a> <a href="../../index.html" target="_top">index</a> <a href="libraries.m4.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>