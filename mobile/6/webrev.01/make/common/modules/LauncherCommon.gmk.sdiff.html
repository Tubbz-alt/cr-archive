<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/common/modules/LauncherCommon.gmk</title>
    <link rel="stylesheet" href="../../../style.css" />
  </head>
<body>
<center><a href="../Utils.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../../index.html" target="_top">index</a> <a href="LibCommon.gmk.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/common/modules/LauncherCommon.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 23 # questions.
 24 #
 25 
 26 include JdkNativeCompilation.gmk
 27 include Modules.gmk
 28 include ProcessMarkdown.gmk
 29 include ToolsJdk.gmk
 30 
 31 # Tell the compiler not to export any functions unless declared so in
 32 # the source code. On Windows, this is the default and cannot be changed.
 33 # On Mac, we have always exported all symbols, probably due to oversight
 34 # and/or misunderstanding. To emulate this, don&#39;t hide any symbols
 35 # by default.
 36 # On AIX/xlc we need at least xlc 13.1 for the symbol hiding (see JDK-8214063)
 37 # Also provide an override for non-conformant libraries.
 38 ifeq ($(TOOLCHAIN_TYPE), gcc)
 39   LAUNCHER_CFLAGS += -fvisibility=hidden
 40   LDFLAGS_JDKEXE += -Wl,--exclude-libs,ALL
 41 else ifeq ($(TOOLCHAIN_TYPE), clang)
 42   LAUNCHER_CFLAGS += -fvisibility=hidden
<span class="line-removed"> 43 else ifeq ($(TOOLCHAIN_TYPE), solstudio)</span>
<span class="line-removed"> 44   LAUNCHER_CFLAGS += -xldscope=hidden</span>
 45 endif
 46 
 47 LAUNCHER_SRC := $(TOPDIR)/src/java.base/share/native/launcher
 48 LAUNCHER_CFLAGS += -I$(TOPDIR)/src/java.base/share/native/launcher \
 49     -I$(TOPDIR)/src/java.base/share/native/libjli \
 50     -I$(TOPDIR)/src/java.base/$(OPENJDK_TARGET_OS_TYPE)/native/libjli \
 51     -I$(TOPDIR)/src/java.base/$(OPENJDK_TARGET_OS)/native/libjli \
 52     #
 53 
 54 ifeq ($(call isTargetOs, ios), true)
 55   LAUNCHER_CFLAGS += -I$(TOPDIR)/src/java.base/macosx/native/libjli
 56 fi
 57 
 58 GLOBAL_VERSION_INFO_RESOURCE := $(TOPDIR)/src/java.base/windows/native/common/version.rc
 59 MACOSX_PLIST_DIR := $(TOPDIR)/src/java.base/macosx/native/launcher
 60 JAVA_MANIFEST := $(TOPDIR)/src/java.base/windows/native/launcher/java.manifest
 61 
 62 ################################################################################
 63 # Build standard launcher.
 64 
</pre>
<hr />
<pre>
131           -lstdc++ -liconv
132     endif
133   endif
134 
135   ifeq ($(USE_EXTERNAL_LIBZ), true)
136     $1_LIBS += -lz
137   endif
138 
139   $1_WINDOWS_JLI_LIB := $(call FindStaticLib, java.base, jli, /libjli)
140 
141   $$(eval $$(call SetupJdkExecutable, BUILD_LAUNCHER_$1, \
142       NAME := $1, \
143       EXTRA_FILES := $(LAUNCHER_SRC)/main.c, \
144       OPTIMIZATION := $$($1_OPTIMIZATION), \
145       CFLAGS := $$(CFLAGS_JDKEXE) \
146           $$(LAUNCHER_CFLAGS) \
147           $$(VERSION_CFLAGS) \
148           -DLAUNCHER_NAME=&#39;&quot;$$(LAUNCHER_NAME)&quot;&#39; \
149           -DPROGNAME=&#39;&quot;$1&quot;&#39; \
150           $$($1_CFLAGS), \
<span class="line-removed">151       CFLAGS_solaris := -KPIC, \</span>
152       CFLAGS_windows := $$($1_CFLAGS_windows), \
153       DISABLED_WARNINGS_gcc := unused-function, \
154       LDFLAGS := $$(LDFLAGS_JDKEXE) \
155           $$(call SET_EXECUTABLE_ORIGIN) \
156           $$($1_LDFLAGS), \
157       LDFLAGS_linux := $$(call SET_EXECUTABLE_ORIGIN,/../lib) \
158           -L$(call FindLibDirForModule, java.base), \
159       LDFLAGS_macosx := $$(call SET_EXECUTABLE_ORIGIN,/../lib) \
160           -L$(call FindLibDirForModule, java.base), \
<span class="line-removed">161       LDFLAGS_solaris := $$(call SET_EXECUTABLE_ORIGIN,/../lib) \</span>
<span class="line-removed">162           -L$(call FindLibDirForModule, java.base), \</span>
163       LDFLAGS_aix := -L$(SUPPORT_OUTPUTDIR)/native/java.base, \
164       LIBS := $(JDKEXE_LIBS) $$($1_LIBS), \
165       LIBS_linux := -ljli -lpthread $(LIBDL), \
166       LIBS_macosx := -ljli -framework Cocoa -framework Security \
167           -framework ApplicationServices, \
<span class="line-removed">168       LIBS_solaris := -ljli -lthread $(LIBDL), \</span>
169       LIBS_aix := -ljli_static, \
170       LIBS_windows := $$($1_WINDOWS_JLI_LIB) \
171           $(SUPPORT_OUTPUTDIR)/native/java.base/libjava/java.lib, \
172       OUTPUT_DIR := $$($1_OUTPUT_DIR), \
173       VERSIONINFO_RESOURCE := $$($1_VERSION_INFO_RESOURCE), \
174       EXTRA_RC_FLAGS := $$($1_EXTRA_RC_FLAGS), \
175       MANIFEST := $(JAVA_MANIFEST), \
176       MANIFEST_VERSION := $(VERSION_NUMBER_FOUR_POSITIONS), \
177   ))
178 
179   $1 += $$(BUILD_LAUNCHER_$1)
180   TARGETS += $$($1)
181 
182   ifeq ($(call isTargetOs, aix), true)
183     $$(BUILD_LAUNCHER_$1): $(call FindStaticLib, java.base, jli_static)
184   endif
185 
186   ifeq ($(call isTargetOs, windows), true)
187     $$(BUILD_LAUNCHER_$1): $(call FindStaticLib, java.base, java, /libjava) \
188         $$($1_WINDOWS_JLI_LIB)
</pre>
</td>
<td>
<hr />
<pre>
 23 # questions.
 24 #
 25 
 26 include JdkNativeCompilation.gmk
 27 include Modules.gmk
 28 include ProcessMarkdown.gmk
 29 include ToolsJdk.gmk
 30 
 31 # Tell the compiler not to export any functions unless declared so in
 32 # the source code. On Windows, this is the default and cannot be changed.
 33 # On Mac, we have always exported all symbols, probably due to oversight
 34 # and/or misunderstanding. To emulate this, don&#39;t hide any symbols
 35 # by default.
 36 # On AIX/xlc we need at least xlc 13.1 for the symbol hiding (see JDK-8214063)
 37 # Also provide an override for non-conformant libraries.
 38 ifeq ($(TOOLCHAIN_TYPE), gcc)
 39   LAUNCHER_CFLAGS += -fvisibility=hidden
 40   LDFLAGS_JDKEXE += -Wl,--exclude-libs,ALL
 41 else ifeq ($(TOOLCHAIN_TYPE), clang)
 42   LAUNCHER_CFLAGS += -fvisibility=hidden


 43 endif
 44 
 45 LAUNCHER_SRC := $(TOPDIR)/src/java.base/share/native/launcher
 46 LAUNCHER_CFLAGS += -I$(TOPDIR)/src/java.base/share/native/launcher \
 47     -I$(TOPDIR)/src/java.base/share/native/libjli \
 48     -I$(TOPDIR)/src/java.base/$(OPENJDK_TARGET_OS_TYPE)/native/libjli \
 49     -I$(TOPDIR)/src/java.base/$(OPENJDK_TARGET_OS)/native/libjli \
 50     #
 51 
 52 ifeq ($(call isTargetOs, ios), true)
 53   LAUNCHER_CFLAGS += -I$(TOPDIR)/src/java.base/macosx/native/libjli
 54 fi
 55 
 56 GLOBAL_VERSION_INFO_RESOURCE := $(TOPDIR)/src/java.base/windows/native/common/version.rc
 57 MACOSX_PLIST_DIR := $(TOPDIR)/src/java.base/macosx/native/launcher
 58 JAVA_MANIFEST := $(TOPDIR)/src/java.base/windows/native/launcher/java.manifest
 59 
 60 ################################################################################
 61 # Build standard launcher.
 62 
</pre>
<hr />
<pre>
129           -lstdc++ -liconv
130     endif
131   endif
132 
133   ifeq ($(USE_EXTERNAL_LIBZ), true)
134     $1_LIBS += -lz
135   endif
136 
137   $1_WINDOWS_JLI_LIB := $(call FindStaticLib, java.base, jli, /libjli)
138 
139   $$(eval $$(call SetupJdkExecutable, BUILD_LAUNCHER_$1, \
140       NAME := $1, \
141       EXTRA_FILES := $(LAUNCHER_SRC)/main.c, \
142       OPTIMIZATION := $$($1_OPTIMIZATION), \
143       CFLAGS := $$(CFLAGS_JDKEXE) \
144           $$(LAUNCHER_CFLAGS) \
145           $$(VERSION_CFLAGS) \
146           -DLAUNCHER_NAME=&#39;&quot;$$(LAUNCHER_NAME)&quot;&#39; \
147           -DPROGNAME=&#39;&quot;$1&quot;&#39; \
148           $$($1_CFLAGS), \

149       CFLAGS_windows := $$($1_CFLAGS_windows), \
150       DISABLED_WARNINGS_gcc := unused-function, \
151       LDFLAGS := $$(LDFLAGS_JDKEXE) \
152           $$(call SET_EXECUTABLE_ORIGIN) \
153           $$($1_LDFLAGS), \
154       LDFLAGS_linux := $$(call SET_EXECUTABLE_ORIGIN,/../lib) \
155           -L$(call FindLibDirForModule, java.base), \
156       LDFLAGS_macosx := $$(call SET_EXECUTABLE_ORIGIN,/../lib) \
157           -L$(call FindLibDirForModule, java.base), \


158       LDFLAGS_aix := -L$(SUPPORT_OUTPUTDIR)/native/java.base, \
159       LIBS := $(JDKEXE_LIBS) $$($1_LIBS), \
160       LIBS_linux := -ljli -lpthread $(LIBDL), \
161       LIBS_macosx := -ljli -framework Cocoa -framework Security \
162           -framework ApplicationServices, \

163       LIBS_aix := -ljli_static, \
164       LIBS_windows := $$($1_WINDOWS_JLI_LIB) \
165           $(SUPPORT_OUTPUTDIR)/native/java.base/libjava/java.lib, \
166       OUTPUT_DIR := $$($1_OUTPUT_DIR), \
167       VERSIONINFO_RESOURCE := $$($1_VERSION_INFO_RESOURCE), \
168       EXTRA_RC_FLAGS := $$($1_EXTRA_RC_FLAGS), \
169       MANIFEST := $(JAVA_MANIFEST), \
170       MANIFEST_VERSION := $(VERSION_NUMBER_FOUR_POSITIONS), \
171   ))
172 
173   $1 += $$(BUILD_LAUNCHER_$1)
174   TARGETS += $$($1)
175 
176   ifeq ($(call isTargetOs, aix), true)
177     $$(BUILD_LAUNCHER_$1): $(call FindStaticLib, java.base, jli_static)
178   endif
179 
180   ifeq ($(call isTargetOs, windows), true)
181     $$(BUILD_LAUNCHER_$1): $(call FindStaticLib, java.base, java, /libjava) \
182         $$($1_WINDOWS_JLI_LIB)
</pre>
</td>
</tr>
</table>
<center><a href="../Utils.gmk.sdiff.html" target="_top">&lt; prev</a> <a href="../../../index.html" target="_top">index</a> <a href="LibCommon.gmk.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>