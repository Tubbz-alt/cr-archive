<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/macosx/classes/com/apple/laf/AquaCaret.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../java.base/windows/native/libnet/net_util_md.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="AquaSpinnerUI.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/macosx/classes/com/apple/laf/AquaCaret.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package com.apple.laf;
 27 
<span class="line-modified"> 28 import java.awt.*;</span>
<span class="line-modified"> 29 import java.awt.event.*;</span>



 30 import java.awt.geom.Rectangle2D;
<span class="line-modified"> 31 import java.beans.*;</span>

 32 
<span class="line-modified"> 33 import javax.swing.*;</span>

 34 import javax.swing.border.Border;
 35 import javax.swing.plaf.UIResource;
<span class="line-modified"> 36 import javax.swing.text.*;</span>



 37 
 38 @SuppressWarnings(&quot;serial&quot;) // Superclass is not serializable across versions
 39 public class AquaCaret extends DefaultCaret
 40         implements UIResource, PropertyChangeListener {
 41 
 42     private boolean isMultiLineEditor;
 43     private boolean mFocused = false;
 44     private boolean fPainting = false;
 45 
 46     @Override
 47     public void install(final JTextComponent c) {
 48         super.install(c);
 49         isMultiLineEditor = c instanceof JTextArea || c instanceof JEditorPane;
 50         c.addPropertyChangeListener(this);
 51     }
 52 
 53     @Override
 54     public void deinstall(final JTextComponent c) {
 55         c.removePropertyChangeListener(this);
 56         super.deinstall(c);
</pre>
<hr />
<pre>
134         super.focusGained(e);
135     }
136 
137     @Override
138     public void focusLost(final FocusEvent e) {
139         mFocused = false;
140         shouldSelectAllOnFocus = true;
141         if (isMultiLineEditor) {
142             setVisible(false);
143             getComponent().repaint();
144         } else {
145             super.focusLost(e);
146         }
147     }
148 
149     // This fixes the problem where when on the mac you have to ctrl left click to
150     // get popup triggers the caret has code that only looks at button number.
151     // see radar # 3125390
152     @Override
153     public void mousePressed(final MouseEvent e) {
<span class="line-modified">154         if (!e.isPopupTrigger()) {</span>

155             super.mousePressed(e);
156             shouldSelectAllOnFocus = false;
157         }
158     }
159 
160     /**
161      * Damages the area surrounding the caret to cause
162      * it to be repainted in a new location.  If paint()
163      * is reimplemented, this method should also be
164      * reimplemented.  This method should update the
165      * caret bounds (x, y, width, and height).
166      *
167      * @param r  the current location of the caret
168      * @see #paint
169      */
170     @Override
171     protected synchronized void damage(final Rectangle r) {
172         if (r == null || fPainting) return;
173 
174         x = r.x - 4;
</pre>
</td>
<td>
<hr />
<pre>
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package com.apple.laf;
 27 
<span class="line-modified"> 28 import java.awt.Graphics;</span>
<span class="line-modified"> 29 import java.awt.Insets;</span>
<span class="line-added"> 30 import java.awt.Rectangle;</span>
<span class="line-added"> 31 import java.awt.event.FocusEvent;</span>
<span class="line-added"> 32 import java.awt.event.MouseEvent;</span>
 33 import java.awt.geom.Rectangle2D;
<span class="line-modified"> 34 import java.beans.PropertyChangeEvent;</span>
<span class="line-added"> 35 import java.beans.PropertyChangeListener;</span>
 36 
<span class="line-modified"> 37 import javax.swing.JEditorPane;</span>
<span class="line-added"> 38 import javax.swing.JTextArea;</span>
 39 import javax.swing.border.Border;
 40 import javax.swing.plaf.UIResource;
<span class="line-modified"> 41 import javax.swing.text.DefaultCaret;</span>
<span class="line-added"> 42 import javax.swing.text.Highlighter;</span>
<span class="line-added"> 43 import javax.swing.text.JTextComponent;</span>
<span class="line-added"> 44 import javax.swing.SwingUtilities;</span>
 45 
 46 @SuppressWarnings(&quot;serial&quot;) // Superclass is not serializable across versions
 47 public class AquaCaret extends DefaultCaret
 48         implements UIResource, PropertyChangeListener {
 49 
 50     private boolean isMultiLineEditor;
 51     private boolean mFocused = false;
 52     private boolean fPainting = false;
 53 
 54     @Override
 55     public void install(final JTextComponent c) {
 56         super.install(c);
 57         isMultiLineEditor = c instanceof JTextArea || c instanceof JEditorPane;
 58         c.addPropertyChangeListener(this);
 59     }
 60 
 61     @Override
 62     public void deinstall(final JTextComponent c) {
 63         c.removePropertyChangeListener(this);
 64         super.deinstall(c);
</pre>
<hr />
<pre>
142         super.focusGained(e);
143     }
144 
145     @Override
146     public void focusLost(final FocusEvent e) {
147         mFocused = false;
148         shouldSelectAllOnFocus = true;
149         if (isMultiLineEditor) {
150             setVisible(false);
151             getComponent().repaint();
152         } else {
153             super.focusLost(e);
154         }
155     }
156 
157     // This fixes the problem where when on the mac you have to ctrl left click to
158     // get popup triggers the caret has code that only looks at button number.
159     // see radar # 3125390
160     @Override
161     public void mousePressed(final MouseEvent e) {
<span class="line-modified">162         if (!e.isPopupTrigger() &amp;&amp; !(SwingUtilities.isLeftMouseButton(e) &amp;&amp;</span>
<span class="line-added">163                 e.getClickCount() == 3)) {</span>
164             super.mousePressed(e);
165             shouldSelectAllOnFocus = false;
166         }
167     }
168 
169     /**
170      * Damages the area surrounding the caret to cause
171      * it to be repainted in a new location.  If paint()
172      * is reimplemented, this method should also be
173      * reimplemented.  This method should update the
174      * caret bounds (x, y, width, and height).
175      *
176      * @param r  the current location of the caret
177      * @see #paint
178      */
179     @Override
180     protected synchronized void damage(final Rectangle r) {
181         if (r == null || fPainting) return;
182 
183         x = r.x - 4;
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../java.base/windows/native/libnet/net_util_md.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="AquaSpinnerUI.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>