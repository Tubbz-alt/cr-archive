<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/native/libmlib_image/mlib_ImageConvMxN_ext.c</title>
    <link rel="stylesheet" href="../../../../../style.css" />
  </head>
<body>
<center><a href="mlib_ImageConvMxN_Fp.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="mlib_ImageConv_16ext.c.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/native/libmlib_image/mlib_ImageConvMxN_ext.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2013, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
131   mlib_d64 *dst1 = dst + 1;
132   mlib_s32 i, j;
133 
134   for (j = 0; j &lt; m; j += 3, src += 3 * nch, dkernel += 3) {
135     const mlib_s32 *src2 = src + 2 * nch;
136     mlib_d64 hval0 = dkernel[0];
137     mlib_d64 hval1 = dkernel[1];
138     mlib_d64 hval2 = dkernel[2];
139     mlib_d64 val0 = src[0];
140     mlib_d64 val1 = src[nch];
141     mlib_d64 dval = dst[0];
142 
143     if (j == m - 2) {
144       hval2 = 0.f;
145     }
146     else if (j == m - 1) {
147       hval1 = 0.f;
148       hval2 = 0.f;
149     }
150 
<span class="line-removed">151 #ifdef __SUNPRO_C</span>
<span class="line-removed">152 #pragma pipeloop(0)</span>
<span class="line-removed">153 #endif /* __SUNPRO_C */</span>
154     for (i = 0; i &lt; n; i++) {
155       mlib_d64 dval0 = val0 * hval0 + dval;
156       mlib_d64 val2 = src2[i * nch];
157 
158       dval = dst1[i];
159       dval0 += val1 * hval1;
160       dval0 += val2 * hval2;
161       val0 = val1;
162       val1 = val2;
163 
164       dst[i] = dval0;
165     }
166   }
167 }
168 
169 /***************************************************************/
170 void mlib_ImageConvMxNMedian_S32(mlib_s32 *dst,
171                                  mlib_d64 *src,
172                                  mlib_s32 n,
173                                  mlib_s32 nch)
174 {
175   mlib_s32 i;
176 
<span class="line-removed">177 #ifdef __SUNPRO_C</span>
<span class="line-removed">178 #pragma pipeloop(0)</span>
<span class="line-removed">179 #endif /* __SUNPRO_C */</span>
180   for (i = 0; i &lt; n; i++) {
181     mlib_s32 res;
182 
183     CLAMP_S32(res, src[i]);
184     src[i] = 0.5;
185     dst[i * nch] = res;
186   }
187 }
188 
189 /***************************************************************/
190 void mlib_ImageConvMxNS322S32_ext(mlib_s32       *dst,
191                                   const mlib_s32 *src,
192                                   mlib_s32       n,
193                                   mlib_s32       nch,
194                                   mlib_s32       dx_l,
195                                   mlib_s32       dx_r)
196 {
197   mlib_s32 i;
198   mlib_d64 val = src[0];
199 
200   for (i = 0; i &lt; dx_l; i++)
201     dst[i] = (mlib_s32) val;
<span class="line-removed">202 #ifdef __SUNPRO_C</span>
<span class="line-removed">203 #pragma pipeloop(0)</span>
<span class="line-removed">204 #endif /* __SUNPRO_C */</span>
205   for (; i &lt; n - dx_r; i++)
206     dst[i] = src[nch * (i - dx_l)];
207   val = dst[n - dx_r - 1];
208   for (; i &lt; n; i++)
209     dst[i] = (mlib_s32) val;
210 }
211 
212 /***************************************************************/
213 mlib_status mlib_convMxNext_s32(mlib_image       *dst,
214                                 const mlib_image *src,
215                                 const mlib_s32   *kernel,
216                                 mlib_s32         m,
217                                 mlib_s32         n,
218                                 mlib_s32         dx_l,
219                                 mlib_s32         dx_r,
220                                 mlib_s32         dy_t,
221                                 mlib_s32         dy_b,
222                                 mlib_s32         scale,
223                                 mlib_s32         cmask)
224 {
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
131   mlib_d64 *dst1 = dst + 1;
132   mlib_s32 i, j;
133 
134   for (j = 0; j &lt; m; j += 3, src += 3 * nch, dkernel += 3) {
135     const mlib_s32 *src2 = src + 2 * nch;
136     mlib_d64 hval0 = dkernel[0];
137     mlib_d64 hval1 = dkernel[1];
138     mlib_d64 hval2 = dkernel[2];
139     mlib_d64 val0 = src[0];
140     mlib_d64 val1 = src[nch];
141     mlib_d64 dval = dst[0];
142 
143     if (j == m - 2) {
144       hval2 = 0.f;
145     }
146     else if (j == m - 1) {
147       hval1 = 0.f;
148       hval2 = 0.f;
149     }
150 



151     for (i = 0; i &lt; n; i++) {
152       mlib_d64 dval0 = val0 * hval0 + dval;
153       mlib_d64 val2 = src2[i * nch];
154 
155       dval = dst1[i];
156       dval0 += val1 * hval1;
157       dval0 += val2 * hval2;
158       val0 = val1;
159       val1 = val2;
160 
161       dst[i] = dval0;
162     }
163   }
164 }
165 
166 /***************************************************************/
167 void mlib_ImageConvMxNMedian_S32(mlib_s32 *dst,
168                                  mlib_d64 *src,
169                                  mlib_s32 n,
170                                  mlib_s32 nch)
171 {
172   mlib_s32 i;
173 



174   for (i = 0; i &lt; n; i++) {
175     mlib_s32 res;
176 
177     CLAMP_S32(res, src[i]);
178     src[i] = 0.5;
179     dst[i * nch] = res;
180   }
181 }
182 
183 /***************************************************************/
184 void mlib_ImageConvMxNS322S32_ext(mlib_s32       *dst,
185                                   const mlib_s32 *src,
186                                   mlib_s32       n,
187                                   mlib_s32       nch,
188                                   mlib_s32       dx_l,
189                                   mlib_s32       dx_r)
190 {
191   mlib_s32 i;
192   mlib_d64 val = src[0];
193 
194   for (i = 0; i &lt; dx_l; i++)
195     dst[i] = (mlib_s32) val;



196   for (; i &lt; n - dx_r; i++)
197     dst[i] = src[nch * (i - dx_l)];
198   val = dst[n - dx_r - 1];
199   for (; i &lt; n; i++)
200     dst[i] = (mlib_s32) val;
201 }
202 
203 /***************************************************************/
204 mlib_status mlib_convMxNext_s32(mlib_image       *dst,
205                                 const mlib_image *src,
206                                 const mlib_s32   *kernel,
207                                 mlib_s32         m,
208                                 mlib_s32         n,
209                                 mlib_s32         dx_l,
210                                 mlib_s32         dx_r,
211                                 mlib_s32         dy_t,
212                                 mlib_s32         dy_b,
213                                 mlib_s32         scale,
214                                 mlib_s32         cmask)
215 {
</pre>
</td>
</tr>
</table>
<center><a href="mlib_ImageConvMxN_Fp.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../index.html" target="_top">index</a> <a href="mlib_ImageConv_16ext.c.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>