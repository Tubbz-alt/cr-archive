<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.desktop/share/classes/sun/font/FileFontStrike.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="FileFont.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="FontUtilities.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/share/classes/sun/font/FileFontStrike.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2014, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
205         }
206         /* First, see if native code should be used to create the glyph.
207          * GDI will return the integer metrics, not fractional metrics, which
208          * may be requested for this strike, so we would require here that :
209          * desc.fmHint != INTVAL_FRACTIONALMETRICS_ON
210          * except that the advance returned by GDI is always overwritten by
211          * the JDK rasteriser supplied one (see getGlyphImageFromWindows()).
212          */
213         if (FontUtilities.isWindows &amp;&amp; isXPorLater &amp;&amp;
214             !FontUtilities.useJDKScaler &amp;&amp;
215             !GraphicsEnvironment.isHeadless() &amp;&amp;
216             !fileFont.useJavaRasterizer &amp;&amp;
217             (desc.aaHint == INTVAL_TEXT_ANTIALIAS_LCD_HRGB ||
218              desc.aaHint == INTVAL_TEXT_ANTIALIAS_LCD_HBGR) &amp;&amp;
219             (matrix[1] == 0.0 &amp;&amp; matrix[2] == 0.0 &amp;&amp;
220              matrix[0] == matrix[3] &amp;&amp;
221              matrix[0] &gt;= 3.0 &amp;&amp; matrix[0] &lt;= 100.0) &amp;&amp;
222             !((TrueTypeFont)fileFont).useEmbeddedBitmapsForSize(intPtSize)) {
223             useNatives = true;
224         }
<span class="line-removed">225         else if (fileFont.checkUseNatives() &amp;&amp; desc.aaHint==0 &amp;&amp; !algoStyle) {</span>
<span class="line-removed">226             /* Check its a simple scale of a pt size in the range</span>
<span class="line-removed">227              * where native bitmaps typically exist (6-36 pts) */</span>
<span class="line-removed">228             if (matrix[1] == 0.0 &amp;&amp; matrix[2] == 0.0 &amp;&amp;</span>
<span class="line-removed">229                 matrix[0] &gt;= 6.0 &amp;&amp; matrix[0] &lt;= 36.0 &amp;&amp;</span>
<span class="line-removed">230                 matrix[0] == matrix[3]) {</span>
<span class="line-removed">231                 useNatives = true;</span>
<span class="line-removed">232                 int numNatives = fileFont.nativeFonts.length;</span>
<span class="line-removed">233                 nativeStrikes = new NativeStrike[numNatives];</span>
<span class="line-removed">234                 /* Maybe initialise these strikes lazily?. But we</span>
<span class="line-removed">235                  * know we need at least one</span>
<span class="line-removed">236                  */</span>
<span class="line-removed">237                 for (int i=0; i&lt;numNatives; i++) {</span>
<span class="line-removed">238                     nativeStrikes[i] =</span>
<span class="line-removed">239                         new NativeStrike(fileFont.nativeFonts[i], desc, false);</span>
<span class="line-removed">240                 }</span>
<span class="line-removed">241             }</span>
<span class="line-removed">242         }</span>
243         if (FontUtilities.isLogging() &amp;&amp; FontUtilities.isWindows) {
244             FontUtilities.getLogger().info
245                 (&quot;Strike for &quot; + fileFont + &quot; at size = &quot; + intPtSize +
246                  &quot; use natives = &quot; + useNatives +
247                  &quot; useJavaRasteriser = &quot; + fileFont.useJavaRasterizer +
248                  &quot; AAHint = &quot; + desc.aaHint +
249                  &quot; Has Embedded bitmaps = &quot; +
250                  ((TrueTypeFont)fileFont).
251                  useEmbeddedBitmapsForSize(intPtSize));
252         }
253         this.disposer = new FontStrikeDisposer(fileFont, desc, pScalerContext);
254 
255         /* Always get the image and the advance together for smaller sizes
256          * that are likely to be important to rendering performance.
257          * The pixel size of 48.0 can be thought of as
258          * &quot;maximumSizeForGetImageWithAdvance&quot;.
259          * This should be no greater than OutlineTextRender.THRESHOLD.
260          */
261         double maxSz = 48.0;
262         getImageWithAdvance =
</pre>
</td>
<td>
<hr />
<pre>
  1 /*
<span class="line-modified">  2  * Copyright (c) 2003, 2020, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
</pre>
<hr />
<pre>
205         }
206         /* First, see if native code should be used to create the glyph.
207          * GDI will return the integer metrics, not fractional metrics, which
208          * may be requested for this strike, so we would require here that :
209          * desc.fmHint != INTVAL_FRACTIONALMETRICS_ON
210          * except that the advance returned by GDI is always overwritten by
211          * the JDK rasteriser supplied one (see getGlyphImageFromWindows()).
212          */
213         if (FontUtilities.isWindows &amp;&amp; isXPorLater &amp;&amp;
214             !FontUtilities.useJDKScaler &amp;&amp;
215             !GraphicsEnvironment.isHeadless() &amp;&amp;
216             !fileFont.useJavaRasterizer &amp;&amp;
217             (desc.aaHint == INTVAL_TEXT_ANTIALIAS_LCD_HRGB ||
218              desc.aaHint == INTVAL_TEXT_ANTIALIAS_LCD_HBGR) &amp;&amp;
219             (matrix[1] == 0.0 &amp;&amp; matrix[2] == 0.0 &amp;&amp;
220              matrix[0] == matrix[3] &amp;&amp;
221              matrix[0] &gt;= 3.0 &amp;&amp; matrix[0] &lt;= 100.0) &amp;&amp;
222             !((TrueTypeFont)fileFont).useEmbeddedBitmapsForSize(intPtSize)) {
223             useNatives = true;
224         }


















225         if (FontUtilities.isLogging() &amp;&amp; FontUtilities.isWindows) {
226             FontUtilities.getLogger().info
227                 (&quot;Strike for &quot; + fileFont + &quot; at size = &quot; + intPtSize +
228                  &quot; use natives = &quot; + useNatives +
229                  &quot; useJavaRasteriser = &quot; + fileFont.useJavaRasterizer +
230                  &quot; AAHint = &quot; + desc.aaHint +
231                  &quot; Has Embedded bitmaps = &quot; +
232                  ((TrueTypeFont)fileFont).
233                  useEmbeddedBitmapsForSize(intPtSize));
234         }
235         this.disposer = new FontStrikeDisposer(fileFont, desc, pScalerContext);
236 
237         /* Always get the image and the advance together for smaller sizes
238          * that are likely to be important to rendering performance.
239          * The pixel size of 48.0 can be thought of as
240          * &quot;maximumSizeForGetImageWithAdvance&quot;.
241          * This should be no greater than OutlineTextRender.THRESHOLD.
242          */
243         double maxSz = 48.0;
244         getImageWithAdvance =
</pre>
</td>
</tr>
</table>
<center><a href="FileFont.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="FontUtilities.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>