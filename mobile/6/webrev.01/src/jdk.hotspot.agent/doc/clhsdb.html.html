<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New src/jdk.hotspot.agent/doc/clhsdb.html</title>
    <link rel="stylesheet" href="../../../style.css" />
  </head>
  <body>
    <pre>
  1 &lt;html&gt;
  2 &lt;head&gt;
  3 &lt;title&gt;
  4 Command line HSDB
  5 &lt;/title&gt;
  6 &lt;/head&gt;
  7 &lt;body&gt;
  8 
  9 &lt;h1&gt;Command line HSDB&lt;/h1&gt;
 10 &lt;p&gt;
 11 When debugging remote core dumps it is easier to work with command line tools instead of
 12 GUI tools. Command line HSDB (CLHSDB) tool is alternative to SA GUI tool HSDB.
 13 &lt;/p&gt;
 14 
 15 &lt;p&gt;
 16 There is also JavaScript based SA command line interface called &lt;a href=&quot;jsdb.html&quot;&gt;jsdb&lt;/a&gt;.
 17 But, CLHSDB supports Unix shell-like (or dbx/gdb-like) command line interface with
 18 support for output redirection/appending (familiar &amp;gt;, &amp;gt;&amp;gt;), command history and so on.
 19 Each CLHSDB command can have zero or more arguments and optionally end with output redirection
 20 (or append) to a file. Commands may be stored in a file and run using &lt;b&gt;source&lt;/b&gt; command.
 21 &lt;b&gt;help&lt;/b&gt; command prints usage message for all supported commands (or a specific command)
 22 &lt;/p&gt;
 23 
 24 &lt;h3&gt;Shell/batch scripts to run command line HSDB&lt;/h3&gt;
 25 
 26 &lt;ul&gt;
 27 &lt;li&gt;clhsdbproc.sh
 28 &lt;li&gt;clhsdbproc64.sh
 29 &lt;li&gt;clhsdbwindbg.bat
 30 &lt;li&gt;clhsdbwindbg64.bat
 31 &lt;/ul&gt;
 32 
 33 &lt;h3&gt;Annotated output of CLHSDB help command&lt;/h3&gt;
 34 
 35 &lt;pre&gt;
 36 &lt;code&gt;
 37 Available commands:
 38   assert true | false &lt;font color=&quot;red&quot;&gt;turn on/off asserts in SA code&lt;/font&gt;
 39   attach pid | exec core  &lt;font color=&quot;red&quot;&gt;attach SA to a process or core&lt;/font&gt;
 40   buildreplayjars [all | boot | app] &lt;font color=&quot;red&quot;&gt;build jars for replay, boot.jar for bootclasses, app.jar for application classes&lt;/font&gt;
 41   class name &lt;font color=&quot;red&quot;&gt;find a Java class from debuggee and print oop&lt;/font&gt;
 42   classes &lt;font color=&quot;red&quot;&gt;print all loaded Java classes with Klass*&lt;/font&gt;
 43   detach &lt;font color=&quot;red&quot;&gt;detach SA from current target&lt;/font&gt;
 44   dis address [ length ]  &lt;font color=&quot;red&quot;&gt;disassemble (x86) specified number of instructions from given address&lt;/font&gt;
 45   dissemble address &lt;font color=&quot;red&quot;&gt;disassemble nmethod&lt;/font&gt;
 46   dumpcfg -a | id &lt;font color=&quot;red&quot;&gt;Dump the PhaseCFG for every compiler thread that has one live&lt;/font&gt;
 47   dumpclass { address | name } [ directory ] &lt;font color=&quot;red&quot;&gt;dump .class file for given Klass* or class name&lt;/font&gt;
 48   dumpcodecache &lt;font color=&quot;red&quot;&gt;dump codecache contents&lt;/font&gt;
 49   dumpheap [ file ] &lt;font color=&quot;red&quot;&gt;dump heap in hprof binary format&lt;/font&gt;
 50   dumpideal -a | id &lt;font color=&quot;red&quot;&gt;dump ideal graph like debug flag -XX:+PrintIdeal&lt;/font&gt;
 51   dumpilt -a | id &lt;font color=&quot;red&quot;&gt;dump inline tree for C2 compilation&lt;/font&gt;
 52   dumpreplaydata &amp;lt;address&amp;gt; | -a | &amp;lt;thread_id&amp;gt; [&amp;gt;replay.txt] &lt;font color=&quot;red&quot;&gt;dump replay data into a file&lt;/font&gt;
 53   echo [ true | false ] &lt;font color=&quot;red&quot;&gt;turn on/off command echo mode&lt;/font&gt;
 54   examine [ address/count ] | [ address,address] &lt;font color=&quot;red&quot;&gt;show contents of memory from given address&lt;/font&gt;
 55   field [ type [ name fieldtype isStatic offset address ] ] &lt;font color=&quot;red&quot;&gt;print info about a field of HotSpot type&lt;/font&gt;
 56   findpc address &lt;font color=&quot;red&quot;&gt;print info. about pointer location&lt;/font&gt;
 57   flags [ flag ] &lt;font color=&quot;red&quot;&gt;show all -XX flag name value pairs. or just show given flag&lt;/font&gt;
 58   help [ command ] &lt;font color=&quot;red&quot;&gt;print help message for all commands or just given command&lt;/font&gt;
 59   history &lt;font color=&quot;red&quot;&gt;show command history. usual !command-number syntax works.&lt;/font&gt;
 60   inspect expression &lt;font color=&quot;red&quot;&gt;inspect a given oop&lt;/font&gt;
 61   intConstant [ name [ value ] ] &lt;font color=&quot;red&quot;&gt;print out hotspot integer constant(s)&lt;/font&gt;
 62   jdis address &lt;font color=&quot;red&quot;&gt;show bytecode disassembly of a given Method*&lt;/font&gt;
 63   jhisto &lt;font color=&quot;red&quot;&gt;show Java heap histogram&lt;/font&gt;
 64   jseval script &lt;font color=&quot;red&quot;&gt;evaluate a given string as JavaScript code&lt;/font&gt;
 65   jsload file &lt;font color=&quot;red&quot;&gt;load and evaluate a JavaScript file&lt;/font&gt;
 66   jstack [-v] &lt;font color=&quot;red&quot;&gt;show Java stack trace of all Java threads. -v is verbose mode&lt;/font&gt;
 67   livenmethods &lt;font color=&quot;red&quot;&gt;show all live nmethods&lt;/font&gt;
 68   longConstant [ name [ value ] ] &lt;font color=&quot;red&quot;&gt;print out hotspot long constant(s)s&lt;/font&gt;
 69   mem address [ length ] &lt;font color=&quot;red&quot;&gt;show contents of memory -- also shows closest ELF/COFF symbol if found&lt;/font&gt;
 70   pmap &lt;font color=&quot;red&quot;&gt;show Solaris pmap-like output&lt;/font&gt;
 71   print expression &lt;font color=&quot;red&quot;&gt;print given Klass*, Method* or arbitrary address&lt;/font&gt;
 72   printas type expression &lt;font color=&quot;red&quot;&gt;print given address as given HotSpot type. eg. print JavaThread &amp;lt;address&amp;gt;&lt;/font&gt;
 73   printmdo -a | expression &lt;font color=&quot;red&quot;&gt;print method data oop&lt;/font&gt;
 74   printstatics [ type ] &lt;font color=&quot;red&quot;&gt;print static fields of given HotSpot type (or all types if none specified)&lt;/font&gt;
 75   pstack [-v] &lt;font color=&quot;red&quot;&gt;show mixed mode stack trace for all Java, non-Java threads. -v is verbose mode&lt;/font&gt;
 76   quit &lt;font color=&quot;red&quot;&gt;quit CLHSDB tool&lt;/font&gt;
 77   reattach &lt;font color=&quot;red&quot;&gt;detach and re-attach SA to current target&lt;/font&gt;
 78   revptrs  &lt;font color=&quot;red&quot;&gt;find liveness of oops&lt;/font&gt;
 79   scanoops start end [ type ] &lt;font color=&quot;red&quot;&gt;scan a Oop from given start to end address&lt;/font&gt;
 80   search [ heap | codecache | threads ] value &lt;font color=&quot;red&quot;&gt;search a value in heap or codecache or threads&lt;/font&gt;
 81   source filename &lt;font color=&quot;red&quot;&gt;load and execute CLHSDB commands from given file&lt;/font&gt;
 82   symbol name &lt;font color=&quot;red&quot;&gt;show address of a given ELF/COFF symbol&lt;/font&gt;
 83   sysprops &lt;font color=&quot;red&quot;&gt;show all Java System properties&lt;/font&gt;
 84   thread id &lt;font color=&quot;red&quot;&gt;show thread of id&lt;/font&gt;
 85   threads &lt;font color=&quot;red&quot;&gt;show all Java threads&lt;/font&gt;
 86   tokenize ...
 87   type [ type [ name super isOop isInteger isUnsigned size ] ] &lt;font color=&quot;red&quot;&gt;show info. on HotSpot type&lt;/font&gt;
 88   universe &lt;font color=&quot;red&quot;&gt;print gc universe&lt;/font&gt;
 89   vmstructsdump &lt;font color=&quot;red&quot;&gt;dump hotspot type library in text&lt;/font&gt;
 90   verbose true | false &lt;font color=&quot;red&quot;&gt;turn on/off verbose mode&lt;/font&gt;
 91   versioncheck [ true | false ] &lt;font color=&quot;red&quot;&gt;turn on/off debuggee VM version check&lt;/font&gt;
 92   whatis address &lt;font color=&quot;red&quot;&gt;print info about any arbitrary address&lt;/font&gt;
 93   where { -a | id } &lt;font color=&quot;red&quot;&gt;print Java stack trace of given Java thread or all Java threads (-a)&lt;/font&gt;
 94 &lt;/code&gt;
 95 &lt;/pre&gt;
 96 
 97 &lt;h3&gt;JavaScript integration&lt;/h3&gt;
 98 
 99 &lt;p&gt;Few CLHSDB commands are already implemented in JavaScript. It is possible to extend CLHSDB command set
100 by implementing more commands in a JavaScript file and by loading it by &lt;b&gt;jsload&lt;/b&gt; command. &lt;b&gt;jseval&lt;/b&gt;
101 command may be used to evaluate arbitrary JavaScript expression from a string. Any JavaScript function
102 may be exposed as a CLHSDB command by registering it using JavaScript &lt;b&gt;&lt;code&gt;registerCommand&lt;/code&gt;&lt;/b&gt;
103 function. This function accepts command name, usage and name of the JavaScript implementation function
104 as arguments.
105 &lt;/p&gt;
106 
107 &lt;h3&gt;Simple CLHSDB command implemented in JavaScript&lt;/h3&gt;
108 
109 &lt;b&gt;File: test.js&lt;/b&gt;
110 &lt;pre&gt;
111 &lt;code&gt;
112 function helloImpl(name) {
113     println(&quot;hello, &quot; + name);
114 }
115 
116 // register the above JavaScript function as CLHSDB command
117 registerCommand(&quot;hello&quot;, &quot;hello name&quot;, &quot;helloImpl&quot;);
118 &lt;/code&gt;
119 &lt;/pre&gt;
120 ---------&lt;br&gt;
121 
122 &quot;test.js&quot; can be loaded in CLHSDB prompt using &lt;b&gt;jsload&lt;/b&gt; command using
123 
124 &lt;pre&gt;
125 &lt;code&gt;
126 hsdb&amp;gt; jsload test.js
127 &lt;/code&gt;
128 &lt;/pre&gt;
129 
130 &lt;h3&gt;Compilation Replay&lt;/h3&gt;
131 &lt;p&gt;
132 When a java process crashes in compiled method, usually a core file is saved.
133 The replay function can reproduce the compiling process in the core.
134 &lt;a href=&quot;cireplay.html&quot;&gt;cireplay.html&lt;/a&gt;
135 
136 &lt;/body&gt;
137 &lt;/html&gt;
    </pre>
  </body>
</html>