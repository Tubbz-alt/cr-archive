<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/runtime/thread.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="stackValue.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../services/memTracker.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/runtime/thread.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 334   ThreadLocalStorage::set_thread(this);
 335   assert(Thread::current() == ThreadLocalStorage::thread(), &quot;TLS mismatch!&quot;);
 336 }
 337 
 338 void Thread::clear_thread_current() {
 339   assert(Thread::current() == ThreadLocalStorage::thread(), &quot;TLS mismatch!&quot;);
 340 #ifndef USE_LIBRARY_BASED_TLS_ONLY
 341   _thr_current = NULL;
 342 #endif
 343   ThreadLocalStorage::set_thread(NULL);
 344 }
 345 
 346 void Thread::record_stack_base_and_size() {
 347   // Note: at this point, Thread object is not yet initialized. Do not rely on
 348   // any members being initialized. Do not rely on Thread::current() being set.
 349   // If possible, refrain from doing anything which may crash or assert since
 350   // quite probably those crash dumps will be useless.
 351   set_stack_base(os::current_stack_base());
 352   set_stack_size(os::current_stack_size());
 353 
<span class="line-removed"> 354 #ifdef SOLARIS</span>
<span class="line-removed"> 355   if (os::is_primordial_thread()) {</span>
<span class="line-removed"> 356     os::Solaris::correct_stack_boundaries_for_primordial_thread(this);</span>
<span class="line-removed"> 357   }</span>
<span class="line-removed"> 358 #endif</span>
<span class="line-removed"> 359 </span>
 360   // Set stack limits after thread is initialized.
 361   if (is_Java_thread()) {
 362     ((JavaThread*) this)-&gt;set_stack_overflow_limit();
 363     ((JavaThread*) this)-&gt;set_reserved_stack_activation(stack_base());
 364   }
 365 }
 366 
 367 #if INCLUDE_NMT
 368 void Thread::register_thread_stack_with_NMT() {
 369   MemTracker::record_thread_stack(stack_end(), stack_size());
 370 }
 371 #endif // INCLUDE_NMT
 372 
 373 void Thread::call_run() {
 374   DEBUG_ONLY(_run_state = CALL_RUN;)
 375 
 376   // At this point, Thread object should be fully initialized and
 377   // Thread::current() should be set.
 378 
 379   assert(Thread::current_or_null() != NULL, &quot;current thread is unset&quot;);
</pre>
</td>
<td>
<hr />
<pre>
 334   ThreadLocalStorage::set_thread(this);
 335   assert(Thread::current() == ThreadLocalStorage::thread(), &quot;TLS mismatch!&quot;);
 336 }
 337 
 338 void Thread::clear_thread_current() {
 339   assert(Thread::current() == ThreadLocalStorage::thread(), &quot;TLS mismatch!&quot;);
 340 #ifndef USE_LIBRARY_BASED_TLS_ONLY
 341   _thr_current = NULL;
 342 #endif
 343   ThreadLocalStorage::set_thread(NULL);
 344 }
 345 
 346 void Thread::record_stack_base_and_size() {
 347   // Note: at this point, Thread object is not yet initialized. Do not rely on
 348   // any members being initialized. Do not rely on Thread::current() being set.
 349   // If possible, refrain from doing anything which may crash or assert since
 350   // quite probably those crash dumps will be useless.
 351   set_stack_base(os::current_stack_base());
 352   set_stack_size(os::current_stack_size());
 353 






 354   // Set stack limits after thread is initialized.
 355   if (is_Java_thread()) {
 356     ((JavaThread*) this)-&gt;set_stack_overflow_limit();
 357     ((JavaThread*) this)-&gt;set_reserved_stack_activation(stack_base());
 358   }
 359 }
 360 
 361 #if INCLUDE_NMT
 362 void Thread::register_thread_stack_with_NMT() {
 363   MemTracker::record_thread_stack(stack_end(), stack_size());
 364 }
 365 #endif // INCLUDE_NMT
 366 
 367 void Thread::call_run() {
 368   DEBUG_ONLY(_run_state = CALL_RUN;)
 369 
 370   // At this point, Thread object should be fully initialized and
 371   // Thread::current() should be set.
 372 
 373   assert(Thread::current_or_null() != NULL, &quot;current thread is unset&quot;);
</pre>
</td>
</tr>
</table>
<center><a href="stackValue.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../services/memTracker.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>