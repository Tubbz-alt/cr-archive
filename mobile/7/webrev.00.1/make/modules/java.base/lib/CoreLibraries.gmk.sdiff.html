<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff make/modules/java.base/lib/CoreLibraries.gmk</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../../../autoconf/libraries.m4.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../../src/java.base/macosx/native/libjli/java_md_macosx.m.sdiff.html" target="_top">next &gt;</a></center>    <h2>make/modules/java.base/lib/CoreLibraries.gmk</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 63     LIBVERIFY_OPTIMIZATION := LOW
 64   endif
 65 endif
 66 
 67 $(eval $(call SetupJdkLibrary, BUILD_LIBVERIFY, \
 68     NAME := verify, \
 69     OPTIMIZATION := $(LIBVERIFY_OPTIMIZATION), \
 70     CFLAGS := $(CFLAGS_JDKLIB), \
 71     LDFLAGS := $(LDFLAGS_JDKLIB) \
 72         $(call SET_SHARED_LIBRARY_ORIGIN), \
 73     LIBS_unix := -ljvm, \
 74     LIBS_windows := jvm.lib, \
 75 ))
 76 
 77 TARGETS += $(BUILD_LIBVERIFY)
 78 
 79 ##########################################################################################
 80 
 81 LIBJAVA_CFLAGS := -DARCHPROPNAME=&#39;&quot;$(OPENJDK_TARGET_CPU_OSARCH)&quot;&#39;
 82 
<span class="line-modified"> 83 ifeq ($(call isTargetOs, macosx), true)</span>
 84   BUILD_LIBJAVA_java_props_md.c_CFLAGS := -x objective-c
 85   BUILD_LIBJAVA_java_props_macosx.c_CFLAGS := -x objective-c
 86 endif
 87 
 88 $(eval $(call SetupJdkLibrary, BUILD_LIBJAVA, \
 89     NAME := java, \
 90     OPTIMIZATION := HIGH, \
 91     CFLAGS := $(CFLAGS_JDKLIB) \
 92         $(LIBJAVA_CFLAGS), \
 93     jdk_util.c_CFLAGS := $(VERSION_CFLAGS), \
 94     EXTRA_HEADER_DIRS := libfdlibm, \
 95     WARNINGS_AS_ERRORS_xlc := false, \
 96     DISABLED_WARNINGS_gcc := unused-result unused-function, \
 97     LDFLAGS := $(LDFLAGS_JDKLIB) \
 98         $(call SET_SHARED_LIBRARY_ORIGIN), \
 99     LDFLAGS_macosx := -L$(SUPPORT_OUTPUTDIR)/native/$(MODULE)/, \
100     LDFLAGS_windows := -delayload:shell32.dll, \
101     LIBS := $(BUILD_LIBFDLIBM_TARGET), \
102     LIBS_unix := -ljvm, \
103     LIBS_linux := $(LIBDL), \
</pre>
<hr />
<pre>
150 $(eval $(call SetupJdkLibrary, BUILD_LIBJIMAGE, \
151     NAME := jimage, \
152     TOOLCHAIN := TOOLCHAIN_LINK_CXX, \
153     OPTIMIZATION := LOW, \
154     CFLAGS := $(CFLAGS_JDKLIB), \
155     CXXFLAGS := $(CXXFLAGS_JDKLIB), \
156     CFLAGS_unix := -UDEBUG, \
157     LDFLAGS := $(LDFLAGS_JDKLIB) $(LDFLAGS_CXX_JDK) \
158         $(call SET_SHARED_LIBRARY_ORIGIN), \
159     LIBS_unix := -ljvm -ldl $(LIBCXX), \
160     LIBS_macosx := -lc++, \
161     LIBS_windows := jvm.lib, \
162 ))
163 
164 $(BUILD_LIBJIMAGE): $(BUILD_LIBJAVA)
165 
166 TARGETS += $(BUILD_LIBJIMAGE)
167 
168 ##########################################################################################
169 
<span class="line-modified">170 ifeq ($(call isTargetOs, macosx), true)</span>
171   LIBJLI_EXCLUDE_FILES += java_md.c
172 endif
173 
174 ifeq ($(call isTargetOs, windows), true)
175   # Supply the name of the C runtime lib.
176   LIBJLI_CFLAGS += -DMSVCR_DLL_NAME=&#39;&quot;$(notdir $(MSVCR_DLL))&quot;&#39;
177   ifneq ($(VCRUNTIME_1_DLL), )
178     LIBJLI_CFLAGS += -DVCRUNTIME_1_DLL_NAME=&#39;&quot;$(notdir $(VCRUNTIME_1_DLL))&quot;&#39;
179   endif
180   ifneq ($(MSVCP_DLL), )
181     LIBJLI_CFLAGS += -DMSVCP_DLL_NAME=&#39;&quot;$(notdir $(MSVCP_DLL))&quot;&#39;
182   endif
183 endif
184 
185 LIBJLI_CFLAGS += $(LIBZ_CFLAGS)
186 
187 ifneq ($(USE_EXTERNAL_LIBZ), true)
188   LIBJLI_EXTRA_FILES += \
189       $(addprefix $(TOPDIR)/src/java.base/share/native/libzip/zlib/, \
190           inflate.c \
191           inftrees.c \
192           inffast.c \
193           zadler32.c \
194           zcrc32.c \
195           zutil.c \
196       )
197 endif
198 
199 $(eval $(call SetupJdkLibrary, BUILD_LIBJLI, \
200     NAME := jli, \
201     OUTPUT_DIR := $(INSTALL_LIBRARIES_HERE), \
202     EXCLUDE_FILES := $(LIBJLI_EXCLUDE_FILES), \
203     EXTRA_FILES := $(LIBJLI_EXTRA_FILES), \
204     OPTIMIZATION := HIGH, \
205     CFLAGS := $(CFLAGS_JDKLIB) $(LIBJLI_CFLAGS), \

206     DISABLED_WARNINGS_gcc := unused-function implicit-fallthrough, \
207     DISABLED_WARNINGS_clang := sometimes-uninitialized format-nonliteral, \
208     LDFLAGS := $(LDFLAGS_JDKLIB) \
209         $(call SET_SHARED_LIBRARY_ORIGIN), \
210     LIBS_unix := $(LIBZ_LIBS), \
211     LIBS_linux := $(LIBDL) -lpthread, \
212     LIBS_aix := $(LIBDL),\
213     LIBS_macosx := -framework Cocoa -framework Security -framework ApplicationServices, \
214     LIBS_windows := advapi32.lib comctl32.lib user32.lib, \
215 ))
216 
217 TARGETS += $(BUILD_LIBJLI)
218 
219 LIBJLI_SRC_DIRS := $(call FindSrcDirsForComponent, java.base, libjli)
220 
221 ifeq ($(call isTargetOs, aix), true)
222   # AIX also requires a static libjli because the compiler doesn&#39;t support &#39;-rpath&#39;
223   $(eval $(call SetupNativeCompilation, BUILD_LIBJLI_STATIC, \
224       NAME := jli_static, \
225       TYPE := STATIC_LIBRARY, \
</pre>
</td>
<td>
<hr />
<pre>
 63     LIBVERIFY_OPTIMIZATION := LOW
 64   endif
 65 endif
 66 
 67 $(eval $(call SetupJdkLibrary, BUILD_LIBVERIFY, \
 68     NAME := verify, \
 69     OPTIMIZATION := $(LIBVERIFY_OPTIMIZATION), \
 70     CFLAGS := $(CFLAGS_JDKLIB), \
 71     LDFLAGS := $(LDFLAGS_JDKLIB) \
 72         $(call SET_SHARED_LIBRARY_ORIGIN), \
 73     LIBS_unix := -ljvm, \
 74     LIBS_windows := jvm.lib, \
 75 ))
 76 
 77 TARGETS += $(BUILD_LIBVERIFY)
 78 
 79 ##########################################################################################
 80 
 81 LIBJAVA_CFLAGS := -DARCHPROPNAME=&#39;&quot;$(OPENJDK_TARGET_CPU_OSARCH)&quot;&#39;
 82 
<span class="line-modified"> 83 ifeq ($(call isTargetOs, macosx ios), true)</span>
 84   BUILD_LIBJAVA_java_props_md.c_CFLAGS := -x objective-c
 85   BUILD_LIBJAVA_java_props_macosx.c_CFLAGS := -x objective-c
 86 endif
 87 
 88 $(eval $(call SetupJdkLibrary, BUILD_LIBJAVA, \
 89     NAME := java, \
 90     OPTIMIZATION := HIGH, \
 91     CFLAGS := $(CFLAGS_JDKLIB) \
 92         $(LIBJAVA_CFLAGS), \
 93     jdk_util.c_CFLAGS := $(VERSION_CFLAGS), \
 94     EXTRA_HEADER_DIRS := libfdlibm, \
 95     WARNINGS_AS_ERRORS_xlc := false, \
 96     DISABLED_WARNINGS_gcc := unused-result unused-function, \
 97     LDFLAGS := $(LDFLAGS_JDKLIB) \
 98         $(call SET_SHARED_LIBRARY_ORIGIN), \
 99     LDFLAGS_macosx := -L$(SUPPORT_OUTPUTDIR)/native/$(MODULE)/, \
100     LDFLAGS_windows := -delayload:shell32.dll, \
101     LIBS := $(BUILD_LIBFDLIBM_TARGET), \
102     LIBS_unix := -ljvm, \
103     LIBS_linux := $(LIBDL), \
</pre>
<hr />
<pre>
150 $(eval $(call SetupJdkLibrary, BUILD_LIBJIMAGE, \
151     NAME := jimage, \
152     TOOLCHAIN := TOOLCHAIN_LINK_CXX, \
153     OPTIMIZATION := LOW, \
154     CFLAGS := $(CFLAGS_JDKLIB), \
155     CXXFLAGS := $(CXXFLAGS_JDKLIB), \
156     CFLAGS_unix := -UDEBUG, \
157     LDFLAGS := $(LDFLAGS_JDKLIB) $(LDFLAGS_CXX_JDK) \
158         $(call SET_SHARED_LIBRARY_ORIGIN), \
159     LIBS_unix := -ljvm -ldl $(LIBCXX), \
160     LIBS_macosx := -lc++, \
161     LIBS_windows := jvm.lib, \
162 ))
163 
164 $(BUILD_LIBJIMAGE): $(BUILD_LIBJAVA)
165 
166 TARGETS += $(BUILD_LIBJIMAGE)
167 
168 ##########################################################################################
169 
<span class="line-modified">170 ifeq ($(call isTargetOs, macosx ios), true)</span>
171   LIBJLI_EXCLUDE_FILES += java_md.c
172 endif
173 
174 ifeq ($(call isTargetOs, windows), true)
175   # Supply the name of the C runtime lib.
176   LIBJLI_CFLAGS += -DMSVCR_DLL_NAME=&#39;&quot;$(notdir $(MSVCR_DLL))&quot;&#39;
177   ifneq ($(VCRUNTIME_1_DLL), )
178     LIBJLI_CFLAGS += -DVCRUNTIME_1_DLL_NAME=&#39;&quot;$(notdir $(VCRUNTIME_1_DLL))&quot;&#39;
179   endif
180   ifneq ($(MSVCP_DLL), )
181     LIBJLI_CFLAGS += -DMSVCP_DLL_NAME=&#39;&quot;$(notdir $(MSVCP_DLL))&quot;&#39;
182   endif
183 endif
184 
185 LIBJLI_CFLAGS += $(LIBZ_CFLAGS)
186 
187 ifneq ($(USE_EXTERNAL_LIBZ), true)
188   LIBJLI_EXTRA_FILES += \
189       $(addprefix $(TOPDIR)/src/java.base/share/native/libzip/zlib/, \
190           inflate.c \
191           inftrees.c \
192           inffast.c \
193           zadler32.c \
194           zcrc32.c \
195           zutil.c \
196       )
197 endif
198 
199 $(eval $(call SetupJdkLibrary, BUILD_LIBJLI, \
200     NAME := jli, \
201     OUTPUT_DIR := $(INSTALL_LIBRARIES_HERE), \
202     EXCLUDE_FILES := $(LIBJLI_EXCLUDE_FILES), \
203     EXTRA_FILES := $(LIBJLI_EXTRA_FILES), \
204     OPTIMIZATION := HIGH, \
205     CFLAGS := $(CFLAGS_JDKLIB) $(LIBJLI_CFLAGS), \
<span class="line-added">206     CFLAGS_ios := -I$(TOPDIR)/src/java.base/macosx/native/libjli, \</span>
207     DISABLED_WARNINGS_gcc := unused-function implicit-fallthrough, \
208     DISABLED_WARNINGS_clang := sometimes-uninitialized format-nonliteral, \
209     LDFLAGS := $(LDFLAGS_JDKLIB) \
210         $(call SET_SHARED_LIBRARY_ORIGIN), \
211     LIBS_unix := $(LIBZ_LIBS), \
212     LIBS_linux := $(LIBDL) -lpthread, \
213     LIBS_aix := $(LIBDL),\
214     LIBS_macosx := -framework Cocoa -framework Security -framework ApplicationServices, \
215     LIBS_windows := advapi32.lib comctl32.lib user32.lib, \
216 ))
217 
218 TARGETS += $(BUILD_LIBJLI)
219 
220 LIBJLI_SRC_DIRS := $(call FindSrcDirsForComponent, java.base, libjli)
221 
222 ifeq ($(call isTargetOs, aix), true)
223   # AIX also requires a static libjli because the compiler doesn&#39;t support &#39;-rpath&#39;
224   $(eval $(call SetupNativeCompilation, BUILD_LIBJLI_STATIC, \
225       NAME := jli_static, \
226       TYPE := STATIC_LIBRARY, \
</pre>
</td>
</tr>
</table>
<center><a href="../../../autoconf/libraries.m4.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../../src/java.base/macosx/native/libjli/java_md_macosx.m.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>